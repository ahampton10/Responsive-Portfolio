<!DOCTYPE html>
<!-- saved from url=(0096)https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/10374419/ -->
<html class="configuration-production overthrow-enabled not-touch not-native" lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\:form{display:block;}</style>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    
    
  
  <script type="text/javascript" async="" src="./Sales _ Screaming Eagle Sports_files/filestack.js"></script><script type="text/javascript" async="" src="./Sales _ Screaming Eagle Sports_files/ecommerce.js"></script><script type="text/javascript" async="" src="./Sales _ Screaming Eagle Sports_files/mixpanel-2.2.min.js"></script><script async="" src="./Sales _ Screaming Eagle Sports_files/analytics.js"></script><script type="text/javascript">
    (function(){
      
      var lowercase = function(string){ return typeof string === 'string' ? string.toLowerCase() : string; };
      var androidString = (/android (\d+)/.exec(lowercase((window.navigator || {}).userAgent)) || [])[1];
      var androidVersion = parseInt(androidString, 10);
      var isBoxee = /Boxee/i.test((window.navigator || {}).userAgent);
      var supportsPushState = !!(window.history && window.history.pushState && !(androidVersion < 4) && !isBoxee);

      
      if(supportsPushState){
        return;
      }

      var path = window.location.pathname;

      
      if(path === '/'){
        return;
      }
      document.cookie = "fh-proxy=no";
      window.location.replace('/#!' + path + window.location.search);
    })();
  </script>


    <title>Sales | Screaming Eagle Sports</title>

    
  
      
      <meta name="HandheldFriendly" content="True">
      

      <meta name="viewport" content="width=device-width, initial-scale=1">

      

      <meta name="robots" content="noindex,nofollow">

      

      
      

      

      <meta name="description" content="Book directly online with live availability, whether you&#39;re at a computer or on the go.">
      <meta name="author" content="FareHarbor">

      <meta property="og:site_name" content="FareHarbor">
      <meta property="og:type" content="website">
      <meta property="og:image" content="https://fh-sites.imgix.net/sites/278/2016/10/05042712/fh-og-250.png">
      <meta property="og:url" content="https://fareharbor.com/">
      <meta property="og:title" content="Booking powered by FareHarbor">
      <meta property="og:description" content="Book directly online with live availability, whether you&#39;re at a computer or on the go.">

      

      <meta name="twitter:card" content="summary">
      <meta name="twitter:site" content="@fareharbor">
      <meta name="twitter:title" content="Booking powered by FareHarbor">
      <meta name="twitter:description" content="Book directly online with live availability, whether you&#39;re at a computer or on the go.">
      <meta name="twitter:image" content="https://fh-sites.imgix.net/sites/278/2016/08/25032613/fh-twitter-120.png">

      
      <meta name="google-translate-customization" content="668029a602982ab-172fa8225400b696-gdf830a777263d809-e">

    

  
  <meta name="fragment" content="!">

  
    <!--<base href="/">--><base href=".">
  


    
      


  
  
  <script type="text/javascript">
    (function(){
      if(self === top){
        var css = document.getElementById('frame-bust-css');
        css.parentNode.removeChild(css);
      }
      else {
        top.location = self.location;
      }
    })();
  </script>


    

    <link rel="canonical" href="https://fareharbor.com/thelonestarcarriagecompany">

    
    
      <link rel="shortcut icon" href="https://fareharbor.com/favicon-orange.ico">
    

    <link rel="apple-touch-icon" href="https://dp58aslhmbcib.cloudfront.net/static/images/touch-icons/touch-icon-iphone.png?99774cb15b0528a7a2caeeb2a01921cc3e14532e">
    <link rel="apple-touch-icon" sizes="72x72" href="https://dp58aslhmbcib.cloudfront.net/static/images/touch-icons/touch-icon-ipad.png?99774cb15b0528a7a2caeeb2a01921cc3e14532e">
    <link rel="apple-touch-icon" sizes="114x114" href="https://dp58aslhmbcib.cloudfront.net/static/images/touch-icons/touch-icon-iphone-retina.png?99774cb15b0528a7a2caeeb2a01921cc3e14532e">
    <link rel="apple-touch-icon" sizes="144x144" href="https://dp58aslhmbcib.cloudfront.net/static/images/touch-icons/touch-icon-ipad-retina.png?99774cb15b0528a7a2caeeb2a01921cc3e14532e">

    
    
      <link rel="stylesheet" href="./Sales _ Screaming Eagle Sports_files/ec17ebe77762.css" type="text/css">
    

    
  <script type="text/javascript">
    window.$$loadTime = new Date();
  </script>

  
      
  
        <script type="text/javascript">
          (function(){
            window.slipstream = {};
            window.slipstream.protocol = "https";
            window.slipstream.domain = "fareharbor.com";
            window.slipstream.checkinDomain = "fhchk.co";
            window.slipstream.version = JSON.parse("{\u0022commit\u0022:\u002299774cb15b0528a7a2caeeb2a01921cc3e14532e\u0022,\u0022version\u0022:\u002210.3.228\u0022,\u0022deploy_time\u0022:\u00222019\u002D10\u002D15T12:04:14\u0022,\u0022branch\u0022:\u0022production\u0022}");
            window.slipstream.configuration = "production";

            window.slipstream.isReadonlyEnabled = JSON.parse("false");

            window.slipstream.contactPhone = "";

            window.slipstream.pusherKey = "f33ed50fef915db4c8e4";

            window.slipstream.storedValueCardFeeableRules = JSON.parse("{\u0022VI\u0022:{\u0022is_unrestricted\u0022:true},\u0022GU\u0022:{\u0022is_unrestricted\u0022:true},\u0022US\u0022:{\u0022unrestricted_provinces\u0022:[\u0022AK\u0022,\u0022AL\u0022,\u0022AZ\u0022,\u0022CT\u0022,\u0022DC\u0022,\u0022DE\u0022,\u0022FL\u0022,\u0022GA\u0022,\u0022IA\u0022,\u0022ID\u0022,\u0022IL\u0022,\u0022KS\u0022,\u0022KY\u0022,\u0022MA\u0022,\u0022MD\u0022,\u0022ME\u0022,\u0022MI\u0022,\u0022MS\u0022,\u0022MT\u0022,\u0022NC\u0022,\u0022ND\u0022,\u0022NE\u0022,\u0022NH\u0022,\u0022NJ\u0022,\u0022NM\u0022,\u0022NV\u0022,\u0022NY\u0022,\u0022PA\u0022,\u0022SC\u0022,\u0022SD\u0022,\u0022TX\u0022,\u0022UT\u0022,\u0022VA\u0022,\u0022WI\u0022,\u0022WV\u0022,\u0022WY\u0022],\u0022province_rules\u0022:{\u0022HI\u0022:{\u0022amount\u0022:500,\u0022type\u0022:\u0022maximum\u0022},\u0022LA\u0022:{\u0022amount\u0022:100,\u0022type\u0022:\u0022flat\u0022}}}}");


            

            
              window.slipstream.csrfToken = "SKeM6dh0LbVrXqVdxp5qp1kDa6xvqWJP";
            

            window.slipstream.remoteFileDomain = "www.filepicker.io";
            window.slipstream.remoteFileCdnDomain = "d1a2dkr8rai8e2.cloudfront.net";

            

            
              window.slipstream.currentUser = JSON.parse("{\u0022is_inactive\u0022:false,\u0022nags\u0022:{\u0022downtime_alert\u0022:{\u0022status\u0022:\u0022\u0022,\u0022is_dismissed\u0022:false},\u0022availability_overlay_redesign\u0022:{\u0022status\u0022:\u0022viewed\u0022,\u0022is_dismissed\u0022:true}},\u0022default_custom_manifest\u0022:null,\u0022unicode\u0022:\u0022Alexandria Hampton\u0022,\u0022is_hidden\u0022:false,\u0022group\u0022:{\u0022name\u0022:\u0022FareHarbor Admin\u0022,\u0022group_permissions\u0022:{\u0022can_edit_availabilities\u0022:true,\u0022can_edit_users\u0022:true,\u0022can_edit_sheets\u0022:true,\u0022can_view_stored_value_cards\u0022:true,\u0022can_edit_waivers\u0022:true,\u0022can_edit_groups\u0022:true,\u0022can_view_network\u0022:true,\u0022can_edit_private_properties_custom_fields\u0022:true,\u0022can_edit_group_overrides\u0022:true,\u0022can_view_contacts_report\u0022:true,\u0022can_edit_network\u0022:true,\u0022can_edit_private_properties_company_payments\u0022:true,\u0022can_view_bookings\u0022:true,\u0022can_list_associated_items\u0022:true,\u0022can_view_customer_types_summary_report\u0022:true,\u0022can_edit_cancellation_policies\u0022:true,\u0022can_view_items_section\u0022:true,\u0022can_view_checkin_statuses\u0022:true,\u0022can_view_amounts\u0022:true,\u0022can_edit_roles\u0022:true,\u0022can_edit_booking_explicit_totals\u0022:true,\u0022can_view_transportation\u0022:true,\u0022can_create_credit_card_payments\u0022:true,\u0022can_book_closed_availabilities\u0022:true,\u0022can_edit_reseller\u0022:true,\u0022can_view_advanced_report\u0022:true,\u0022can_edit_resources\u0022:true,\u0022can_view_groups\u0022:true,\u0022can_view_desks_summary_report\u0022:true,\u0022can_edit_resource_uses\u0022:true,\u0022can_view_revenue_summary_report\u0022:true,\u0022can_edit_bookings\u0022:true,\u0022can_edit_translations\u0022:true,\u0022can_edit_custom_calendars\u0022:true,\u0022can_view_booking_types_summary_report\u0022:true,\u0022can_edit_private_properties_users\u0022:true,\u0022can_edit_waiver_instances\u0022:true,\u0022can_create_in_store_payments\u0022:true,\u0022can_view_customers\u0022:true,\u0022can_edit_line_items\u0022:true,\u0022can_edit_refunds\u0022:true,\u0022can_edit_crew_members\u0022:true,\u0022can_edit_custom_manifests\u0022:true,\u0022can_edit_booking_notes\u0022:true,\u0022can_edit_tag_instances\u0022:true,\u0022can_view_items\u0022:true,\u0022can_book_hidden_fields\u0022:true,\u0022can_edit_transportation\u0022:true,\u0022can_skip_payment\u0022:true,\u0022can_list_unlisted_items\u0022:true,\u0022can_edit_supported_languages\u0022:true,\u0022can_override_transportation\u0022:true,\u0022can_edit_campaigns\u0022:true,\u0022can_create_refund_uploads\u0022:true,\u0022can_view_blocks\u0022:true,\u0022can_view_pickup_locations_summary_report\u0022:true,\u0022can_view_crew_members\u0022:true,\u0022can_view_customer_checkin_status\u0022:true,\u0022can_edit_private_properties_company\u0022:true,\u0022can_view_invoice_amounts\u0022:true,\u0022can_edit_desks\u0022:true,\u0022can_view_activities\u0022:true,\u0022can_view_roles\u0022:true,\u0022can_edit_booking_affiliations\u0022:true,\u0022can_view_viator\u0022:true,\u0022can_edit_companies\u0022:true,\u0022can_view_companies_report\u0022:true,\u0022can_view_private_custom_fields\u0022:true,\u0022can_edit_in_store_payment_types\u0022:true,\u0022can_edit_customer_types\u0022:true,\u0022can_view_custom_field_summary_report\u0022:true,\u0022can_view_private_properties_activities\u0022:true,\u0022can_edit_flow_nodes\u0022:true,\u0022can_view_custom_reports\u0022:true,\u0022can_view_agents_summary_report\u0022:true,\u0022can_view_manifest_section\u0022:true,\u0022can_edit_custom_fields\u0022:true,\u0022can_view_custom_manifests\u0022:true,\u0022can_view_transactions_report\u0022:true,\u0022can_edit_codes\u0022:true,\u0022can_create_direct_uploads\u0022:true,\u0022can_view_users_summary_report\u0022:true,\u0022can_view_activities_self\u0022:true,\u0022can_edit_locations\u0022:true,\u0022can_view_admin_section\u0022:true,\u0022can_view_private_properties_company\u0022:true,\u0022can_edit_booking_explicit_invoice_prices\u0022:true,\u0022can_view_in_store_payment_types\u0022:true,\u0022can_create_bookings\u0022:true,\u0022can_view_volume_report\u0022:true,\u0022can_edit_notifications\u0022:true,\u0022can_edit_private_properties_items\u0022:true,\u0022can_edit_items\u0022:true,\u0022can_view_cards\u0022:true,\u0022can_skip_cardholder_info\u0022:true,\u0022can_view_in_progress_reports_report\u0022:true,\u0022can_edit_pricing\u0022:true,\u0022can_edit_multiple_availabilities\u0022:true,\u0022can_view_contacts\u0022:true,\u0022can_cancel_eligible_bookings\u0022:true,\u0022can_edit_canned_messages\u0022:true,\u0022can_view_campaigns_summary_report\u0022:true,\u0022can_edit_booking_restrictions\u0022:true,\u0022can_view_private_items\u0022:true,\u0022can_view_sheets\u0022:true,\u0022can_create_custom_refunds\u0022:true,\u0022can_view_disputes_report\u0022:true,\u0022can_edit_stored_value_cards\u0022:true,\u0022can_view_booking_notes\u0022:true,\u0022can_view_sms_notifications\u0022:true,\u0022can_view_campaigns\u0022:true,\u0022can_edit_accounting\u0022:true,\u0022can_view_reports\u0022:true,\u0022can_create_invoice_uploads\u0022:true,\u0022can_edit_invoices\u0022:true,\u0022can_view_group_overrides\u0022:true,\u0022can_edit_company\u0022:true,\u0022can_view_availabilities\u0022:true,\u0022can_view_bookings_section\u0022:true,\u0022can_create_credit_card_payments_without_cvv\u0022:true,\u0022can_view_bookings_report\u0022:true,\u0022can_create_availabilities\u0022:true,\u0022can_view_items_summary_report\u0022:true,\u0022can_view_invoices\u0022:true,\u0022can_edit_blocks\u0022:true,\u0022can_edit_sms_notifications\u0022:true,\u0022can_view_codes\u0022:true,\u0022can_view_custom_calendars\u0022:true,\u0022can_view_network_settings\u0022:true,\u0022can_create_affiliate_payments\u0022:true,\u0022can_edit_booking_affiliation_info\u0022:true,\u0022can_overuse_resources\u0022:true,\u0022can_view_bank_accounts\u0022:true,\u0022can_view_payments_report\u0022:true,\u0022can_view_users\u0022:true,\u0022can_view_company\u0022:true,\u0022can_edit_ticket_layouts\u0022:true,\u0022can_edit_custom_field_values\u0022:true,\u0022can_overuse_codes\u0022:true,\u0022can_edit_private_properties_accounting\u0022:true,\u0022can_edit_crew_members_self_assignable\u0022:true,\u0022can_view_line_items\u0022:true,\u0022can_view_supported_languages\u0022:true,\u0022can_edit_checkin_statuses\u0022:true,\u0022can_view_private_properties_bookings\u0022:true,\u0022can_view_accounting\u0022:true,\u0022can_edit_agents\u0022:true,\u0022can_view_dashboard_section\u0022:true,\u0022can_change_price_sheets\u0022:true,\u0022can_view_custom_field_values\u0022:true,\u0022can_create_deferred_payments\u0022:true,\u0022can_create_stored_value_card_payments\u0022:true,\u0022can_edit_contacts\u0022:true,\u0022can_view_unbookable_availabilities\u0022:true,\u0022can_view_customer_types\u0022:true,\u0022can_edit_customer_checkin_status\u0022:true,\u0022can_view_crew_summary_report\u0022:true,\u0022can_view_waiver_instances\u0022:true,\u0022can_edit_analytics_services\u0022:true,\u0022can_view_reseller\u0022:true,\u0022can_edit_activities\u0022:true,\u0022can_view_notifications\u0022:true,\u0022can_view_custom_fields\u0022:true,\u0022can_edit_private_properties_network\u0022:true,\u0022can_edit_payments\u0022:true,\u0022can_view_payments\u0022:true,\u0022can_view_lodgings_summary_report\u0022:true,\u0022can_edit_custom_reports\u0022:true,\u0022can_view_availability_capacities\u0022:true,\u0022can_edit_viator\u0022:true,\u0022can_overbook_availabilities\u0022:true,\u0022can_edit_review_express\u0022:true,\u0022can_view_resources\u0022:true,\u0022can_edit_images\u0022:true,\u0022can_view_canned_messages\u0022:true,\u0022can_cancel_bookings\u0022:true,\u0022can_edit_hotels\u0022:true,\u0022can_view_activities_feed\u0022:true,\u0022can_view_waivers\u0022:true,\u0022can_view_line_items_summary_report\u0022:true},\u0022company\u0022:{\u0022processor_currency\u0022:\u0022usd\u0022,\u0022name\u0022:\u0022FareHarbor\u0022,\u0022uri\u0022:\u0022\u005C/api\u005C/v1\u005C/companies\u005C/admin\u005C/\u0022,\u0022pk\u0022:2,\u0022shortname\u0022:\u0022admin\u0022,\u0022display_processor_currency\u0022:\u0022US dollars\u0022,\u0022cls\u0022:\u0022Company\u0022},\u0022uri\u0022:\u0022\u005C/api\u005C/v1\u005C/companies\u005C/admin\u005C/groups\u005C/17644\u005C/\u0022,\u0022in_use_count\u0022:770,\u0022unicode\u0022:\u0022FareHarbor Admin\u0022,\u0022type\u0022:\u0022company\u0022,\u0022pk\u0022:17644,\u0022conditions\u0022:{\u0022max_company_tier\u0022:null},\u0022cls\u0022:\u0022Group\u0022},\u0022admin_group\u0022:{\u0022name\u0022:\u0022FareHarbor Admin\u0022,\u0022group_permissions\u0022:{\u0022can_edit_availabilities\u0022:true,\u0022can_edit_users\u0022:true,\u0022can_edit_sheets\u0022:true,\u0022can_view_stored_value_cards\u0022:true,\u0022can_edit_waivers\u0022:true,\u0022can_edit_groups\u0022:true,\u0022can_view_network\u0022:true,\u0022can_edit_private_properties_custom_fields\u0022:true,\u0022can_edit_group_overrides\u0022:true,\u0022can_view_contacts_report\u0022:true,\u0022can_edit_network\u0022:true,\u0022can_edit_private_properties_company_payments\u0022:true,\u0022can_view_bookings\u0022:true,\u0022can_list_associated_items\u0022:true,\u0022can_view_customer_types_summary_report\u0022:true,\u0022can_edit_cancellation_policies\u0022:true,\u0022can_view_items_section\u0022:true,\u0022can_view_checkin_statuses\u0022:true,\u0022can_view_amounts\u0022:true,\u0022can_edit_roles\u0022:true,\u0022can_edit_booking_explicit_totals\u0022:true,\u0022can_view_transportation\u0022:true,\u0022can_create_credit_card_payments\u0022:true,\u0022can_book_closed_availabilities\u0022:true,\u0022can_edit_reseller\u0022:true,\u0022can_view_advanced_report\u0022:true,\u0022can_edit_resources\u0022:true,\u0022can_view_groups\u0022:true,\u0022can_view_desks_summary_report\u0022:true,\u0022can_edit_resource_uses\u0022:true,\u0022can_view_revenue_summary_report\u0022:true,\u0022can_edit_bookings\u0022:true,\u0022can_edit_translations\u0022:true,\u0022can_edit_custom_calendars\u0022:true,\u0022can_view_booking_types_summary_report\u0022:true,\u0022can_edit_private_properties_users\u0022:true,\u0022can_edit_waiver_instances\u0022:true,\u0022can_create_in_store_payments\u0022:true,\u0022can_view_customers\u0022:true,\u0022can_edit_line_items\u0022:true,\u0022can_edit_refunds\u0022:true,\u0022can_edit_crew_members\u0022:true,\u0022can_edit_custom_manifests\u0022:true,\u0022can_edit_booking_notes\u0022:true,\u0022can_edit_tag_instances\u0022:true,\u0022can_view_items\u0022:true,\u0022can_book_hidden_fields\u0022:true,\u0022can_edit_transportation\u0022:true,\u0022can_skip_payment\u0022:true,\u0022can_list_unlisted_items\u0022:true,\u0022can_edit_supported_languages\u0022:true,\u0022can_override_transportation\u0022:true,\u0022can_edit_campaigns\u0022:true,\u0022can_create_refund_uploads\u0022:true,\u0022can_view_blocks\u0022:true,\u0022can_view_pickup_locations_summary_report\u0022:true,\u0022can_view_crew_members\u0022:true,\u0022can_view_customer_checkin_status\u0022:true,\u0022can_edit_private_properties_company\u0022:true,\u0022can_view_invoice_amounts\u0022:true,\u0022can_edit_desks\u0022:true,\u0022can_view_activities\u0022:true,\u0022can_view_roles\u0022:true,\u0022can_edit_booking_affiliations\u0022:true,\u0022can_view_viator\u0022:true,\u0022can_edit_companies\u0022:true,\u0022can_view_companies_report\u0022:true,\u0022can_view_private_custom_fields\u0022:true,\u0022can_edit_in_store_payment_types\u0022:true,\u0022can_edit_customer_types\u0022:true,\u0022can_view_custom_field_summary_report\u0022:true,\u0022can_view_private_properties_activities\u0022:true,\u0022can_edit_flow_nodes\u0022:true,\u0022can_view_custom_reports\u0022:true,\u0022can_view_agents_summary_report\u0022:true,\u0022can_view_manifest_section\u0022:true,\u0022can_edit_custom_fields\u0022:true,\u0022can_view_custom_manifests\u0022:true,\u0022can_view_transactions_report\u0022:true,\u0022can_edit_codes\u0022:true,\u0022can_create_direct_uploads\u0022:true,\u0022can_view_users_summary_report\u0022:true,\u0022can_view_activities_self\u0022:true,\u0022can_edit_locations\u0022:true,\u0022can_view_admin_section\u0022:true,\u0022can_view_private_properties_company\u0022:true,\u0022can_edit_booking_explicit_invoice_prices\u0022:true,\u0022can_view_in_store_payment_types\u0022:true,\u0022can_create_bookings\u0022:true,\u0022can_view_volume_report\u0022:true,\u0022can_edit_notifications\u0022:true,\u0022can_edit_private_properties_items\u0022:true,\u0022can_edit_items\u0022:true,\u0022can_view_cards\u0022:true,\u0022can_skip_cardholder_info\u0022:true,\u0022can_view_in_progress_reports_report\u0022:true,\u0022can_edit_pricing\u0022:true,\u0022can_edit_multiple_availabilities\u0022:true,\u0022can_view_contacts\u0022:true,\u0022can_cancel_eligible_bookings\u0022:true,\u0022can_edit_canned_messages\u0022:true,\u0022can_view_campaigns_summary_report\u0022:true,\u0022can_edit_booking_restrictions\u0022:true,\u0022can_view_private_items\u0022:true,\u0022can_view_sheets\u0022:true,\u0022can_create_custom_refunds\u0022:true,\u0022can_view_disputes_report\u0022:true,\u0022can_edit_stored_value_cards\u0022:true,\u0022can_view_booking_notes\u0022:true,\u0022can_view_sms_notifications\u0022:true,\u0022can_view_campaigns\u0022:true,\u0022can_edit_accounting\u0022:true,\u0022can_view_reports\u0022:true,\u0022can_create_invoice_uploads\u0022:true,\u0022can_edit_invoices\u0022:true,\u0022can_view_group_overrides\u0022:true,\u0022can_edit_company\u0022:true,\u0022can_view_availabilities\u0022:true,\u0022can_view_bookings_section\u0022:true,\u0022can_create_credit_card_payments_without_cvv\u0022:true,\u0022can_view_bookings_report\u0022:true,\u0022can_create_availabilities\u0022:true,\u0022can_view_items_summary_report\u0022:true,\u0022can_view_invoices\u0022:true,\u0022can_edit_blocks\u0022:true,\u0022can_edit_sms_notifications\u0022:true,\u0022can_view_codes\u0022:true,\u0022can_view_custom_calendars\u0022:true,\u0022can_view_network_settings\u0022:true,\u0022can_create_affiliate_payments\u0022:true,\u0022can_edit_booking_affiliation_info\u0022:true,\u0022can_overuse_resources\u0022:true,\u0022can_view_bank_accounts\u0022:true,\u0022can_view_payments_report\u0022:true,\u0022can_view_users\u0022:true,\u0022can_view_company\u0022:true,\u0022can_edit_ticket_layouts\u0022:true,\u0022can_edit_custom_field_values\u0022:true,\u0022can_overuse_codes\u0022:true,\u0022can_edit_private_properties_accounting\u0022:true,\u0022can_edit_crew_members_self_assignable\u0022:true,\u0022can_view_line_items\u0022:true,\u0022can_view_supported_languages\u0022:true,\u0022can_edit_checkin_statuses\u0022:true,\u0022can_view_private_properties_bookings\u0022:true,\u0022can_view_accounting\u0022:true,\u0022can_edit_agents\u0022:true,\u0022can_view_dashboard_section\u0022:true,\u0022can_change_price_sheets\u0022:true,\u0022can_view_custom_field_values\u0022:true,\u0022can_create_deferred_payments\u0022:true,\u0022can_create_stored_value_card_payments\u0022:true,\u0022can_edit_contacts\u0022:true,\u0022can_view_unbookable_availabilities\u0022:true,\u0022can_view_customer_types\u0022:true,\u0022can_edit_customer_checkin_status\u0022:true,\u0022can_view_crew_summary_report\u0022:true,\u0022can_view_waiver_instances\u0022:true,\u0022can_edit_analytics_services\u0022:true,\u0022can_view_reseller\u0022:true,\u0022can_edit_activities\u0022:true,\u0022can_view_notifications\u0022:true,\u0022can_view_custom_fields\u0022:true,\u0022can_edit_private_properties_network\u0022:true,\u0022can_edit_payments\u0022:true,\u0022can_view_payments\u0022:true,\u0022can_view_lodgings_summary_report\u0022:true,\u0022can_edit_custom_reports\u0022:true,\u0022can_view_availability_capacities\u0022:true,\u0022can_edit_viator\u0022:true,\u0022can_overbook_availabilities\u0022:true,\u0022can_edit_review_express\u0022:true,\u0022can_view_resources\u0022:true,\u0022can_edit_images\u0022:true,\u0022can_view_canned_messages\u0022:true,\u0022can_cancel_bookings\u0022:true,\u0022can_edit_hotels\u0022:true,\u0022can_view_activities_feed\u0022:true,\u0022can_view_waivers\u0022:true,\u0022can_view_line_items_summary_report\u0022:true},\u0022company\u0022:{\u0022processor_currency\u0022:\u0022usd\u0022,\u0022name\u0022:\u0022FareHarbor\u0022,\u0022uri\u0022:\u0022\u005C/api\u005C/v1\u005C/companies\u005C/admin\u005C/\u0022,\u0022pk\u0022:2,\u0022shortname\u0022:\u0022admin\u0022,\u0022display_processor_currency\u0022:\u0022US dollars\u0022,\u0022cls\u0022:\u0022Company\u0022},\u0022uri\u0022:\u0022\u005C/api\u005C/v1\u005C/companies\u005C/admin\u005C/groups\u005C/17644\u005C/\u0022,\u0022in_use_count\u0022:770,\u0022unicode\u0022:\u0022FareHarbor Admin\u0022,\u0022type\u0022:\u0022company\u0022,\u0022pk\u0022:17644,\u0022conditions\u0022:{\u0022max_company_tier\u0022:null},\u0022cls\u0022:\u0022Group\u0022},\u0022related_group_overrides\u0022:[],\u0022pk\u0022:114549,\u0022email\u0022:\u0022alexandria.hampton@fareharbor.com\u0022,\u0022cls\u0022:\u0022User\u0022,\u0022username\u0022:\u0022alexandria.hampton\u0022,\u0022calendar_token\u0022:\u0022\u0022,\u0022subscriptions\u0022:[],\u0022company\u0022:{\u0022is_default_processor_connected\u0022:true,\u0022is_balanced_connected\u0022:true,\u0022is_verification_enabled_for_default_processor_default_bank_account\u0022:false,\u0022features\u0022:{\u0022emv_provider\u0022:\u0022\u0022,\u0022is_international_sms_enabled\u0022:true,\u0022is_legacy_reports_enabled\u0022:true,\u0022is_task_based_payouts_enabled\u0022:false,\u0022is_online_book_form_tax_types_enabled\u0022:false,\u0022is_tax_type_breakdown_enabled\u0022:false,\u0022is_picthrive_enabled\u0022:false,\u0022sofort_processing_flat_fee\u0022:29,\u0022is_verify_contact_name_enabled\u0022:false,\u0022is_group_overrides_enabled\u0022:false,\u0022is_custom_tax_enabled\u0022:false,\u0022is_aggregate_tax_enabled\u0022:true,\u0022is_tax_inclusion_enabled\u0022:false,\u0022is_legacy_dropdown_sku_receipt_display_enabled\u0022:false,\u0022is_extended_breakdown_enabled\u0022:false,\u0022is_sonar_enabled\u0022:false,\u0022is_day_view_enabled\u0022:true,\u0022is_limited_past_booking_updates_enabled\u0022:false,\u0022is_verify_company_location_enabled\u0022:false,\u0022stored_value_card_background\u0022:\u0022\u0022,\u0022is_connect_enabled\u0022:false,\u0022is_sofort_payments_enabled\u0022:false,\u0022is_all_online_ui_languages_enabled\u0022:false,\u0022is_email_calendar_schema_enabled\u0022:false,\u0022is_stripe_level_2_enabled\u0022:false,\u0022included_tax_rate\u0022:null,\u0022is_auto_open_enabled\u0022:false,\u0022is_payout_creation_error_emails_enabled\u0022:false,\u0022is_ideal_payments_enabled\u0022:false,\u0022is_cart_enabled\u0022:false,\u0022is_suggested_items_enabled\u0022:false,\u0022is_sca_enabled\u0022:false,\u0022is_tos_override_enabled\u0022:false,\u0022is_seating_enabled\u0022:false,\u0022ideal_processing_fee_rate\u0022:0.0,\u0022is_cancellation_policies_enabled\u0022:true,\u0022login_provider_type\u0022:\u0022google\u0022,\u0022is_ticket_layouts_enabled\u0022:false,\u0022is_single_color_printer_enabled\u0022:false,\u0022login_provider_restriction\u0022:\u0022fareharbor.com, booking.com\u0022,\u0022is_transportation_enabled\u0022:true,\u0022is_online_cancellation_enabled\u0022:false,\u0022is_amount_due_on_receipts_enabled\u0022:false,\u0022is_payments_report_legacy\u0022:false,\u0022is_login_provider_enabled\u0022:true,\u0022tier\u0022:null,\u0022is_item_colors_enabled\u0022:false,\u0022is_dashboard_orders_enabled\u0022:false,\u0022is_online_stored_value_card_redemption_enabled\u0022:false,\u0022tax_display_name\u0022:\u0022\u0022,\u0022is_locations_enabled\u0022:false,\u0022is_stored_value_card_booking_fees_enabled\u0022:true,\u0022sofort_processing_fee_rate\u0022:0.0,\u0022is_company_level_requirement_groups_enabled\u0022:false,\u0022is_tagging_enabled\u0022:false,\u0022is_labs_enabled\u0022:false,\u0022is_verify_postal_codes_enabled\u0022:false,\u0022is_login_provider_required\u0022:true,\u0022is_emv_enabled\u0022:false,\u0022is_processor_onboarding_enabled\u0022:true,\u0022is_total_sheet_discounts_enabled\u0022:false,\u0022is_combined_tax_enabled\u0022:false,\u0022is_rating_enabled\u0022:false,\u0022is_alternate_anon_book_form_enabled\u0022:false,\u0022ideal_processing_flat_fee\u0022:29,\u0022is_plain_text_item_descriptions_enabled\u0022:false,\u0022is_checkin_enabled\u0022:false,\u0022is_sunday_based\u0022:true,\u0022is_smartwaiver_webhook_security_enabled\u0022:false,\u0022is_fast_payouts_enabled\u0022:false},\u0022display_language\u0022:\u0022English (US)\u0022,\u0022is_default_processor_tos_accepted\u0022:false,\u0022smartwaiver_url\u0022:\u0022https:\u005C/\u005C/www.smartwaiver.com\u005C/auto\u005C/\u0022,\u0022rolling_window_days\u0022:7,\u0022processing_fee_percentage\u0022:2.9,\u0022is_payout_after_availability\u0022:false,\u0022payout_period_type\u0022:\u0022rolling\u002Dwindow\u002Dperiod\u0022,\u0022smartwaiver_console_url\u0022:\u0022\u0022,\u0022company_features\u0022:{\u0022refund_reserve_autofill_limit\u0022:null,\u0022summarize_booking_customers_minimum\u0022:10,\u0022is_content_translation_enabled\u0022:false,\u0022refund_reserve_recurring_transfer_rate\u0022:0.0,\u0022is_resource_bookable_capacity_enabled\u0022:false,\u0022is_send_rebooked_email_default\u0022:false,\u0022refund_reserve_recurring_transfer_format\u0022:\u0022fixed\u0022,\u0022is_send_cancelled_email_default\u0022:false,\u0022is_send_confirmation_email_default\u0022:false,\u0022refund_reserve_recurring_transfer_amount\u0022:null,\u0022is_refund_reserve_recurring_transfer_enabled\u0022:false},\u0022unicode\u0022:\u0022FareHarbor (admin)\u0022,\u0022is_default_processor_bank_account_connected\u0022:false,\u0022is_unlinked_refunds_enabled\u0022:false,\u0022timezone\u0022:\u0022HST\u0022,\u0022ideal_processing_fee_percentage\u0022:0.0,\u0022is_stripe_connected\u0022:true,\u0022affiliates_count\u0022:0,\u0022partners\u0022:[],\u0022processing_fee_rate\u0022:0.029,\u0022google_analytics_id\u0022:\u0022UA\u002D30982219\u002D3\u0022,\u0022invoice_flat_fee\u0022:30,\u0022is_default_processor_uploads_enabled\u0022:false,\u0022live_at\u0022:null,\u0022is_review_express_enabled\u0022:false,\u0022is_demo_mode_enabled\u0022:false,\u0022is_charter\u0022:false,\u0022anonymous_time_format_type\u0022:\u0022company_locale_default\u0022,\u0022fee_type\u0022:\u0022percentage\u002Dfee\u0022,\u0022default_processor_verification_status\u0022:\u0022unverified\u0022,\u0022invoice_fee_rate\u0022:0.019,\u0022related_group_overrides\u0022:[],\u0022pk\u0022:2,\u0022shortname\u0022:\u0022admin\u0022,\u0022default_processor_type\u0022:\u0022stripe\u0022,\u0022display_processor_currency\u0022:\u0022US dollars\u0022,\u0022processor_country\u0022:\u0022US\u0022,\u0022is_viator_enabled\u0022:false,\u0022is_affiliate\u0022:false,\u0022included_tax_percentage\u0022:null,\u0022viator_supplier_id\u0022:\u0022\u0022,\u0022tiered_fee_schedule\u0022:[{\u0022cutoff\u0022:0,\u0022rate\u0022:\u00220.06\u0022},{\u0022cutoff\u0022:20000,\u0022rate\u0022:\u00220.055\u0022},{\u0022cutoff\u0022:30000,\u0022rate\u0022:\u00220.05\u0022},{\u0022cutoff\u0022:40000,\u0022rate\u0022:\u00220.045\u0022},{\u0022cutoff\u0022:50000,\u0022rate\u0022:\u00220.04\u0022}],\u0022calendar_token\u0022:\u0022cb9ac459\u002Dbcba\u002D420c\u002Db753\u002Db2c64d88525d\u0022,\u0022is_smartwaiver_enabled\u0022:false,\u0022is_default_processor_verified\u0022:false,\u0022refund_reserve_recurring_transfer_percentage\u0022:0.0,\u0022is_linked_refunds_enabled\u0022:true,\u0022is_default_processor_default_bank_account_ready_for_upload\u0022:false,\u0022is_default_processor_default_bank_account_ready_for_payout\u0022:false,\u0022is_admin\u0022:true,\u0022affiliates\u0022:[],\u0022smartwaiver_webhook_url\u0022:\u0022\u005C/integrations\u005C/companies\u005C/admin\u005C/smartwaiver\u005C/\u0022,\u0022flat_fee\u0022:250,\u0022is_invoicing_enabled\u0022:false,\u0022is_payment_setup_complete\u0022:false,\u0022default_processor_identifier\u0022:\u0022acct_1AMkO1Jm4L2tYREg\u0022,\u0022is_boca_enabled\u0022:false,\u0022processor_currency\u0022:\u0022usd\u0022,\u0022name\u0022:\u0022FareHarbor\u0022,\u0022language\u0022:\u0022en\u002Dus\u0022,\u0022statement_text\u0022:\u0022FareHarbor\u0022,\u0022created_at\u0022:\u00222013\u002D02\u002D04T06:21:36+0000\u0022,\u0022sofort_processing_fee_percentage\u0022:0.0,\u0022resources_count\u0022:0,\u0022uri\u0022:\u0022\u005C/api\u005C/v1\u005C/companies\u005C/admin\u005C/\u0022,\u0022scrape_protection\u0022:\u002288525d\u0022,\u0022payment_preference\u0022:\u0022take\u0022,\u0022is_receipts_enabled\u0022:true,\u0022is_sms_enabled\u0022:true,\u0022invoice_fee_percentage\u0022:1.9,\u0022smartwaiver_api_key_new\u0022:\u00222c8cbb542367266bfb787aa0f9e9565c\u0022,\u0022minimum_fee\u0022:250,\u0022processing_flat_fee\u0022:30,\u0022default_dashboard_bookings_view\u0022:\u0022month\u0022,\u0022percentage_fee_rate\u0022:0.06,\u0022smartwaiver_webhook_key\u0022:\u0022\u0022,\u0022cls\u0022:\u0022Company\u0022,\u0022nags\u0022:{\u0022conference_reminder\u0022:{\u0022status\u0022:null,\u0022is_dismissed\u0022:false},\u0022boost\u0022:{\u0022status\u0022:null,\u0022is_dismissed\u0022:false},\u0022new_year_schedule\u0022:{\u0022status\u0022:null,\u0022is_dismissed\u0022:false}},\u0022percentage_fee_percentage\u0022:6.0,\u0022time_format_type\u0022:\u0022company_locale_default\u0022},\u0022partner_group\u0022:null,\u0022is_subscribed_to_owner_emails\u0022:false,\u0022legacy_type\u0022:\u0022employee\u0022,\u0022login_provider_identifier\u0022:null,\u0022default_custom_calendar\u0022:null,\u0022image_cdn_url\u0022:\u0022\u0022,\u0022name\u0022:\u0022Alexandria Hampton\u0022,\u0022language\u0022:\u0022en\u002Dus\u0022,\u0022uri\u0022:\u0022\u005C/api\u005C/v1\u005C/companies\u005C/admin\u005C/users\u005C/alexandria.hampton\u005C/\u0022,\u0022image_url\u0022:\u0022\u0022,\u0022identifier\u0022:\u0022alexandria.hampton@admin\u0022}");
            

            

            
            

            window.slipstream.isSentryClientSideEnabled = JSON.parse("false");
            window.slipstream.unitsLanguageFormats = JSON.parse("{\u0022en\u002Dgb\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e@ \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022.\u0022,\u0022group_symbol\u0022:\u0022,\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u005C/M\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022short_full_year\u0022:\u0022D\u005C/M\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 @ \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022ru\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e\u005Cu0432 \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022\u005Cu00a0\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022Y\u005C/n\u005C/j\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u005C/M\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022M\u005C/D\u0022,\u0022short_full_year\u0022:\u0022D\u005C/M\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u005Cu0432 \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022fr\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022 \u005Cu00e0\u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022\u005Cu00a0\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u005C/M\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022short_full_year\u0022:\u0022D\u005C/M\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u005Cu00e0 \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022de\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003eum \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022.\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j.n.Y\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D.M.YY\u0022,\u0022short_no_year\u0022:\u0022D.M\u0022,\u0022short_full_year\u0022:\u0022D.M.YYYY\u0022,\u0022long\u0022:\u0022dddd, D. MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D. MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D. MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M.YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 um \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022nl\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022 om \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022.\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u002Dn\u002DY\u0022,\u0022date_long\u0022:\u0022l j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022H:i\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u002DM\u002DYY\u0022,\u0022short_no_year\u0022:\u0022D\u002DM\u0022,\u0022short_full_year\u0022:\u0022D\u002DM\u002DYYYY\u0022,\u0022long\u0022:\u0022dddd D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM.\u0022,\u0022long_no_year\u0022:\u0022dddd D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022MM\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022H:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022HH\u0022,\u0022export\u0022:\u0022HH:mm\u0022}}}}},\u0022time_separator\u0022:\u0022 om \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4\u005Cu00a0#,##0.00\u003B\u005Cu00a4\u005Cu00a0\u002D#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022en\u002Dau\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e@ \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022.\u0022,\u0022group_symbol\u0022:\u0022,\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u005C/M\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022short_full_year\u0022:\u0022D\u005C/M\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 @ \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022pt\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e\u005Cu00e0s \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022.\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u005C/M\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022short_full_year\u0022:\u0022D\u005C/M\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u005Cu00e0s \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022no\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u005Cu2212\u0022,\u0022html_time_separator\u0022:\u0022 \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022\u005Cu00a0\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l j. F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022long_no_year\u0022:\u0022dddd D. MMMM\u0022,\u0022day_with_month_abbr\u0022:\u0022D. MMM.\u0022,\u0022short_no_year\u0022:\u0022D.M.\u0022,\u0022long\u0022:\u0022dddd D. MMMM YYYY\u0022,\u0022short\u0022:\u0022D.M.YYYY\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M.YYYY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022H:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH.mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4\u005Cu00a0#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022fr\u002Dca\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022 \u005Cu00e0\u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022\u005Cu00a0\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022n\u005C/j\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, F j Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022M\u005C/D\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022M\u005C/D\u0022,\u0022short_full_year\u0022:\u0022M\u005C/D\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, MMMM Do YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022MMM D\u0022,\u0022long_no_year\u0022:\u0022dddd, MMMM Do\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u005Cu00e0 \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022ca\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003ea les \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022.\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u005C/M\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022short_full_year\u0022:\u0022D\u005C/M\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 a les \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022en\u002Dus\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e@ \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022.\u0022,\u0022group_symbol\u0022:\u0022,\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022n\u005C/j\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, F j Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022M\u005C/D\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022M\u005C/D\u0022,\u0022short_full_year\u0022:\u0022M\u005C/D\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, MMMM Do YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022MMM D\u0022,\u0022long_no_year\u0022:\u0022dddd, MMMM Do\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 @ \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022ko\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022.\u0022,\u0022group_symbol\u0022:\u0022,\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022Y\u005C/n\u005C/j\u0022,\u0022date_long\u0022:\u0022j F Y l\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022A g:i\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022YY.MM.DD\u0022,\u0022short_no_year\u0022:\u0022M.D\u0022,\u0022short_full_year\u0022:\u0022YYYY.MM.DD\u0022,\u0022long\u0022:\u0022YYYY\u005Cub144 MMMM D\u005Cuc77c dddd\u0022,\u0022day_with_month_abbr\u0022:\u0022MMM D\u0022,\u0022long_no_year\u0022:\u0022MMMM D\u005Cuc77c dddd\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022YY.M\u0022,\u0022long\u0022:\u0022YYYY MMMM\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022A h:mm\u0022,\u0022export\u0022:\u0022A hh:mm\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022A h\u0022,\u0022export\u0022:\u0022A hh:mm\u0022}}}}},\u0022time_separator\u0022:\u0022 \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022it\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003ealle \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022.\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u005C/M\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022short_full_year\u0022:\u0022D\u005C/M\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 alle \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022da\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022 kl. \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022.\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l j. F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022long_no_year\u0022:\u0022dddd D. MMMM\u0022,\u0022day_with_month_abbr\u0022:\u0022D. MMM.\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022long\u0022:\u0022dddd D. MMMM YYYY\u0022,\u0022short\u0022:\u0022D\u005C/M\u005C/YYYY\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022H.mm\u0022,\u0022export\u0022:\u0022HH.mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h.mma\u0022,\u0022export\u0022:\u0022hh.mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH.mm\u0022,\u0022export\u0022:\u0022HH.mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh.mma\u0022}}}}},\u0022time_separator\u0022:\u0022 kl. \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022zh\u002Dcn\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022.\u0022,\u0022group_symbol\u0022:\u0022,\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022Y\u005C/j\u005C/n\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022YY\u005C/M\u005C/D\u0022,\u0022short_no_year\u0022:\u0022M\u005C/D\u0022,\u0022short_full_year\u0022:\u0022YYYY\u005C/M\u005C/D\u0022,\u0022long\u0022:\u0022YYYY\u005Cu5e74M\u005Cu6708D\u005Cu65e5ddddAh\u005Cu70b9mm\u005Cu5206\u0022,\u0022day_with_month_abbr\u0022:\u0022M\u005Cu6708D\u005Cu65e5\u0022,\u0022long_no_year\u0022:\u0022M\u005Cu6708D\u005Cu65e5ddddAh\u005Cu70b9mm\u005Cu5206\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022YY\u005C/M\u0022,\u0022long\u0022:\u0022YYYY\u005Cu5e74M\u005Cu6708\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022yi\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e\u005Cud83d\u005Cudc31 \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022.\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022n\u005Cud83c\u005Cudfb8j\u005Cud83c\u005Cudfb8Y\u0022,\u0022date_long\u0022:\u0022l, F j Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022M\u005Cud83c\u005Cudfb8D\u005Cud83c\u005Cudfb8YY\u0022,\u0022short_no_year\u0022:\u0022M\u005Cud83c\u005Cudfb8D\u0022,\u0022short_full_year\u0022:\u0022M\u005Cud83c\u005Cudfb8D\u005Cud83c\u005Cudfb8YYYY\u0022,\u0022long\u0022:\u0022dddd, MMMM Do YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022MMM D\u0022,\u0022long_no_year\u0022:\u0022dddd , MMMM Do\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005Cud83c\u005Cudfb8YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH\u005Cu25f4mm\u0022,\u0022export\u0022:\u0022HH\u005Cu25f4mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h\u005Cu25f4mma\u0022,\u0022export\u0022:\u0022hh\u005Cu25f4mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH\u005Cu25f4mm\u0022,\u0022export\u0022:\u0022HH\u005Cu25f4mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh\u005Cu25f4mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u005Cud83d\u005Cudc31 \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022fi\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u005Cu2212\u0022,\u0022html_time_separator\u0022:\u0022 klo \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022\u005Cu00a0\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l j. F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022long_no_year\u0022:\u0022dddd D. MMMM\u0022,\u0022day_with_month_abbr\u0022:\u0022D.M.\u0022,\u0022short_no_year\u0022:\u0022D.M.\u0022,\u0022long\u0022:\u0022dddd D. MMMM YYYY\u0022,\u0022short\u0022:\u0022D.M.YYYY\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M.YYYY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022H.mm\u0022,\u0022export\u0022:\u0022HH.mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h.mma\u0022,\u0022export\u0022:\u0022hh.mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH.mm\u0022,\u0022export\u0022:\u0022HH.mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh.mma\u0022}}}}},\u0022time_separator\u0022:\u0022 klo \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022sv\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u005Cu2212\u0022,\u0022html_time_separator\u0022:\u0022 \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022\u005Cu00a0\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l j. F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022long_no_year\u0022:\u0022dddd D MMMM\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM.\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022long\u0022:\u0022dddd D MMMM YYYY\u0022,\u0022short\u0022:\u0022YYYY\u002DMM\u002DDD\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022YYYY\u002DMM\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022H:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH.mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022ja\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022.\u0022,\u0022group_symbol\u0022:\u0022,\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022Y\u005C/n\u005C/j\u0022,\u0022date_long\u0022:\u0022Y F j l\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022YY\u005C/M\u005C/D\u0022,\u0022short_no_year\u0022:\u0022M\u005C/D\u0022,\u0022short_full_year\u0022:\u0022YYYY\u005C/M\u005C/D\u0022,\u0022long\u0022:\u0022YYYY\u005Cu5e74M\u005Cu6708D\u005Cu65e5 dddd\u0022,\u0022day_with_month_abbr\u0022:\u0022M\u005Cu6708D\u005Cu65e5\u0022,\u0022long_no_year\u0022:\u0022M\u005Cu6708D\u005Cu65e5 dddd\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022YY\u005C/M\u0022,\u0022long\u0022:\u0022YYYY MMMM\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022es\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003ea las \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022,\u0022,\u0022group_symbol\u0022:\u0022.\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022j\u005C/n\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, j F Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022D\u005C/M\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022D\u005C/M\u0022,\u0022short_full_year\u0022:\u0022D\u005C/M\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, D MMMM YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022D MMM\u0022,\u0022long_no_year\u0022:\u0022dddd, D MMMM\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002224_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 a las \u0022,\u0022currency_pattern\u0022:\u0022#,##0.00\u005Cu00a0\u005Cu00a4\u0022,\u0022percent_pattern\u0022:\u0022#,##0\u005Cu00a0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022},\u0022en\u002Dca\u0022:{\u0022minus_sign_symbol\u0022:\u0022\u002D\u0022,\u0022html_time_separator\u0022:\u0022\u005Cu003cbr\u005C/\u005Cu003e@ \u0022,\u0022decimal_pattern\u0022:\u0022#,##0.###\u0022,\u0022decimal_symbol\u0022:\u0022.\u0022,\u0022group_symbol\u0022:\u0022,\u0022,\u0022server\u0022:{\u0022date\u0022:\u0022n\u005C/j\u005C/Y\u0022,\u0022date_long\u0022:\u0022l, F j Y\u0022,\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:\u0022H:i\u0022,\u002212_hour\u0022:\u0022g:iA\u0022}}}},\u0022percent_symbol\u0022:\u0022%\u0022,\u0022client\u0022:{\u0022date\u0022:{\u0022short\u0022:\u0022M\u005C/D\u005C/YY\u0022,\u0022short_no_year\u0022:\u0022M\u005C/D\u0022,\u0022short_full_year\u0022:\u0022M\u005C/D\u005C/YYYY\u0022,\u0022long\u0022:\u0022dddd, MMMM Do YYYY\u0022,\u0022day_with_month_abbr\u0022:\u0022MMM D\u0022,\u0022long_no_year\u0022:\u0022dddd, MMMM Do\u0022},\u0022month\u0022:{\u0022short\u0022:\u0022M\u005C/YY\u0022,\u0022long\u0022:\u0022MMMM YYYY\u0022},\u0022time\u0022:{\u0022exact\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022h:mma\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}},\u0022top_of_hour\u0022:{\u0022default\u0022:\u002212_hour\u0022,\u0022values\u0022:{\u002224_hour\u0022:{\u0022default\u0022:\u0022HH:mm\u0022,\u0022export\u0022:\u0022HH:mm\u0022},\u002212_hour\u0022:{\u0022default\u0022:\u0022ha\u0022,\u0022export\u0022:\u0022hh:mma\u0022}}}}},\u0022time_separator\u0022:\u0022 @ \u0022,\u0022currency_pattern\u0022:\u0022\u005Cu00a4#,##0.00\u0022,\u0022percent_pattern\u0022:\u0022#,##0%\u0022,\u0022plus_sign_symbol\u0022:\u0022+\u0022}}");
            window.slipstream.unitsLanguageCodes = JSON.parse("[\u0022en\u002Dus\u0022,\u0022en\u002Dau\u0022,\u0022en\u002Dca\u0022,\u0022en\u002Dgb\u0022,\u0022ca\u0022,\u0022zh\u002Dcn\u0022,\u0022da\u0022,\u0022nl\u0022,\u0022fi\u0022,\u0022fr\u0022,\u0022fr\u002Dca\u0022,\u0022de\u0022,\u0022it\u0022,\u0022ja\u0022,\u0022ko\u0022,\u0022no\u0022,\u0022pt\u0022,\u0022ru\u0022,\u0022es\u0022,\u0022sv\u0022]");
            window.slipstream.unitsLanguage = JSON.parse("\u0022en\u002Dus\u0022");
            window.slipstream.acceptLanguage = "en-US,en";
            window.slipstream.displayLanguages = JSON.parse("{\u0022el\u0022:{\u0022name\u0022:\u0022Greek\u0022,\u0022name_local\u0022:\u0022\u005Cu0395\u005Cu03bb\u005Cu03bb\u005Cu03b7\u005Cu03bd\u005Cu03b9\u005Cu03ba\u005Cu03ac\u0022},\u0022eo\u0022:{\u0022name\u0022:\u0022Esperanto\u0022,\u0022name_local\u0022:\u0022Esperanto\u0022},\u0022en\u0022:{\u0022name\u0022:\u0022English\u0022,\u0022name_local\u0022:\u0022English\u0022},\u0022ro\u0022:{\u0022name\u0022:\u0022Romanian\u0022,\u0022name_local\u0022:\u0022Rom\u005Cu00e2n\u005Cu0103\u0022},\u0022af\u0022:{\u0022name\u0022:\u0022Afrikaans\u0022,\u0022name_local\u0022:\u0022Afrikaans\u0022},\u0022vi\u0022:{\u0022name\u0022:\u0022Vietnamese\u0022,\u0022name_local\u0022:\u0022Ti\u005Cu00ea\u005Cu0301ng Vi\u005Cu00ea\u005Cu0323t\u0022},\u0022ca\u0022:{\u0022name\u0022:\u0022Catalan\u0022,\u0022name_local\u0022:\u0022Catal\u005Cu00e0\u0022},\u0022en\u002Dus\u0022:{\u0022name\u0022:\u0022English (US)\u0022,\u0022name_local\u0022:\u0022English (US)\u0022},\u0022os\u0022:{\u0022name\u0022:\u0022Ossetic\u0022,\u0022name_local\u0022:\u0022\u005Cu0418\u005Cu0440\u005Cu043e\u005Cu043d\u0022},\u0022it\u0022:{\u0022name\u0022:\u0022Italian\u0022,\u0022name_local\u0022:\u0022Italiano\u0022},\u0022sv\u0022:{\u0022name\u0022:\u0022Swedish\u0022,\u0022name_local\u0022:\u0022Svenska\u0022},\u0022cs\u0022:{\u0022name\u0022:\u0022Czech\u0022,\u0022name_local\u0022:\u0022\u005Cu010desky\u0022},\u0022cy\u0022:{\u0022name\u0022:\u0022Welsh\u0022,\u0022name_local\u0022:\u0022Cymraeg\u0022},\u0022ar\u0022:{\u0022name\u0022:\u0022Arabic\u0022,\u0022name_local\u0022:\u0022\u005Cu0627\u005Cu0644\u005Cu0639\u005Cu0631\u005Cu0628\u005Cu064a\u005Cu0651\u005Cu0629\u0022},\u0022pt\u002Dbr\u0022:{\u0022name\u0022:\u0022Portuguese (Brazil)\u0022,\u0022name_local\u0022:\u0022Portugu\u005Cu00eas Brasileiro\u0022},\u0022mk\u0022:{\u0022name\u0022:\u0022Macedonian\u0022,\u0022name_local\u0022:\u0022\u005Cu041c\u005Cu0430\u005Cu043a\u005Cu0435\u005Cu0434\u005Cu043e\u005Cu043d\u005Cu0441\u005Cu043a\u005Cu0438\u0022},\u0022ga\u0022:{\u0022name\u0022:\u0022Irish\u0022,\u0022name_local\u0022:\u0022Gaeilge\u0022},\u0022fi\u0022:{\u0022name\u0022:\u0022Finnish\u0022,\u0022name_local\u0022:\u0022Suomi\u0022},\u0022eu\u0022:{\u0022name\u0022:\u0022Basque\u0022,\u0022name_local\u0022:\u0022Basque\u0022},\u0022et\u0022:{\u0022name\u0022:\u0022Estonian\u0022,\u0022name_local\u0022:\u0022Eesti\u0022},\u0022az\u0022:{\u0022name\u0022:\u0022Azerbaijani\u0022,\u0022name_local\u0022:\u0022Az\u005Cu0259rbaycan dili\u0022},\u0022id\u0022:{\u0022name\u0022:\u0022Indonesian\u0022,\u0022name_local\u0022:\u0022Bahasa Indonesia\u0022},\u0022es\u0022:{\u0022name\u0022:\u0022Spanish\u0022,\u0022name_local\u0022:\u0022Espa\u005Cu00f1ol\u0022},\u0022en\u002Dgb\u0022:{\u0022name\u0022:\u0022English (UK)\u0022,\u0022name_local\u0022:\u0022English (UK)\u0022},\u0022ru\u0022:{\u0022name\u0022:\u0022Russian\u0022,\u0022name_local\u0022:\u0022\u005Cu0420\u005Cu0443\u005Cu0441\u005Cu0441\u005Cu043a\u005Cu0438\u005Cu0439\u0022},\u0022gl\u0022:{\u0022name\u0022:\u0022Galician\u0022,\u0022name_local\u0022:\u0022Galego\u0022},\u0022lb\u0022:{\u0022name\u0022:\u0022Luxembourgish\u0022,\u0022name_local\u0022:\u0022L\u005Cu00ebtzebuergesch\u0022},\u0022pt\u0022:{\u0022name\u0022:\u0022Portuguese\u0022,\u0022name_local\u0022:\u0022Portugu\u005Cu00eas\u0022},\u0022zh\u002Dcn\u0022:{\u0022name\u0022:\u0022Chinese (Simplified)\u0022,\u0022name_local\u0022:\u0022\u005Cu7b80\u005Cu4f53\u005Cu4e2d\u005Cu6587\u0022},\u0022es\u002Dar\u0022:{\u0022name\u0022:\u0022Spanish (Argentinia)\u0022,\u0022name_local\u0022:\u0022Espa\u005Cu00f1ol de Argentina\u0022},\u0022nb\u0022:{\u0022name\u0022:\u0022Bokmal (Norway)\u0022,\u0022name_local\u0022:\u0022Norsk (Bokm\u005Cu00e5l)\u0022},\u0022tr\u0022:{\u0022name\u0022:\u0022Turkish\u0022,\u0022name_local\u0022:\u0022T\u005Cu00fcrk\u005Cu00e7e\u0022},\u0022ne\u0022:{\u0022name\u0022:\u0022Nepali\u0022,\u0022name_local\u0022:\u0022\u005Cu0928\u005Cu0947\u005Cu092a\u005Cu093e\u005Cu0932\u005Cu0940\u0022},\u0022es\u002Dmx\u0022:{\u0022name\u0022:\u0022Spanish (Mexico)\u0022,\u0022name_local\u0022:\u0022Espa\u005Cu00f1ol de Mexico\u0022},\u0022lv\u0022:{\u0022name\u0022:\u0022Latvian\u0022,\u0022name_local\u0022:\u0022Latvie\u005Cu0161u\u0022},\u0022en\u002Dau\u0022:{\u0022name\u0022:\u0022English (Australia)\u0022,\u0022name_local\u0022:\u0022English (Australia)\u0022},\u0022lt\u0022:{\u0022name\u0022:\u0022Lithuanian\u0022,\u0022name_local\u0022:\u0022Lietuvi\u005Cu0161kai\u0022},\u0022pa\u0022:{\u0022name\u0022:\u0022Punjabi\u0022,\u0022name_local\u0022:\u0022Punjabi\u0022},\u0022sw\u0022:{\u0022name\u0022:\u0022Swahili\u0022,\u0022name_local\u0022:\u0022Kiswahili\u0022},\u0022sr\u0022:{\u0022name\u0022:\u0022Serbian\u0022,\u0022name_local\u0022:\u0022\u005Cu0441\u005Cu0440\u005Cu043f\u005Cu0441\u005Cu043a\u005Cu0438\u0022},\u0022th\u0022:{\u0022name\u0022:\u0022Thai\u0022,\u0022name_local\u0022:\u0022\u005Cu0e20\u005Cu0e32\u005Cu0e29\u005Cu0e32\u005Cu0e44\u005Cu0e17\u005Cu0e22\u0022},\u0022fy\u002Dnl\u0022:{\u0022name\u0022:\u0022Frisian\u0022,\u0022name_local\u0022:\u0022Frisian\u0022},\u0022udm\u0022:{\u0022name\u0022:\u0022Udmurt\u0022,\u0022name_local\u0022:\u0022\u005Cu0423\u005Cu0434\u005Cu043c\u005Cu0443\u005Cu0440\u005Cu0442\u0022},\u0022ia\u0022:{\u0022name\u0022:\u0022Interlingua\u0022,\u0022name_local\u0022:\u0022Interlingua\u0022},\u0022is\u0022:{\u0022name\u0022:\u0022Icelandic\u0022,\u0022name_local\u0022:\u0022\u005Cu00cdslenska\u0022},\u0022pl\u0022:{\u0022name\u0022:\u0022Polish\u0022,\u0022name_local\u0022:\u0022Polski\u0022},\u0022ta\u0022:{\u0022name\u0022:\u0022Tamil\u0022,\u0022name_local\u0022:\u0022\u005Cu0ba4\u005Cu0bae\u005Cu0bbf\u005Cu0bb4\u005Cu0bcd\u0022},\u0022be\u0022:{\u0022name\u0022:\u0022Belarusian\u0022,\u0022name_local\u0022:\u0022\u005Cu0431\u005Cu0435\u005Cu043b\u005Cu0430\u005Cu0440\u005Cu0443\u005Cu0441\u005Cu043a\u005Cu0430\u005Cu044f\u0022},\u0022fr\u0022:{\u0022name\u0022:\u0022French\u0022,\u0022name_local\u0022:\u0022Fran\u005Cu00e7ais\u0022},\u0022bg\u0022:{\u0022name\u0022:\u0022Bulgarian\u0022,\u0022name_local\u0022:\u0022\u005Cu0431\u005Cu044a\u005Cu043b\u005Cu0433\u005Cu0430\u005Cu0440\u005Cu0441\u005Cu043a\u005Cu0438\u0022},\u0022zh\u002Dtw\u0022:{\u0022name\u0022:\u0022Chinese (Traditional)\u0022,\u0022name_local\u0022:\u0022\u005Cu7e41\u005Cu9ad4\u005Cu4e2d\u005Cu6587\u0022},\u0022en\u002Dca\u0022:{\u0022name\u0022:\u0022English (Canada)\u0022,\u0022name_local\u0022:\u0022English (Canada)\u0022},\u0022fr\u002Dca\u0022:{\u0022name\u0022:\u0022French (Canada)\u0022,\u0022name_local\u0022:\u0022Fran\u005Cu00e7ais (Canada)\u0022},\u0022bn\u0022:{\u0022name\u0022:\u0022Bengali\u0022,\u0022name_local\u0022:\u0022\u005Cu09ac\u005Cu09be\u005Cu0982\u005Cu09b2\u005Cu09be\u0022},\u0022es\u002Dve\u0022:{\u0022name\u0022:\u0022Spanish (Venezuela)\u0022,\u0022name_local\u0022:\u0022Espa\u005Cu00f1ol de Venezuela\u0022},\u0022da\u0022:{\u0022name\u0022:\u0022Danish\u0022,\u0022name_local\u0022:\u0022Dansk\u0022},\u0022fa\u0022:{\u0022name\u0022:\u0022Persian\u0022,\u0022name_local\u0022:\u0022\u005Cu0641\u005Cu0627\u005Cu0631\u005Cu0633\u005Cu06cc\u0022},\u0022hi\u0022:{\u0022name\u0022:\u0022Hindi\u0022,\u0022name_local\u0022:\u0022Hindi\u0022},\u0022no\u0022:{\u0022name\u0022:\u0022Norwegian\u0022,\u0022name_local\u0022:\u0022Norsk\u0022},\u0022br\u0022:{\u0022name\u0022:\u0022Breton\u0022,\u0022name_local\u0022:\u0022Brezhoneg\u0022},\u0022bs\u0022:{\u0022name\u0022:\u0022Bosnian\u0022,\u0022name_local\u0022:\u0022Bosanski\u0022},\u0022nl\u0022:{\u0022name\u0022:\u0022Dutch\u0022,\u0022name_local\u0022:\u0022Nederlands\u0022},\u0022hu\u0022:{\u0022name\u0022:\u0022Hungarian\u0022,\u0022name_local\u0022:\u0022Magyar\u0022},\u0022ja\u0022:{\u0022name\u0022:\u0022Japanese\u0022,\u0022name_local\u0022:\u0022\u005Cu65e5\u005Cu672c\u005Cu8a9e\u0022},\u0022he\u0022:{\u0022name\u0022:\u0022Hebrew\u0022,\u0022name_local\u0022:\u0022\u005Cu05e2\u005Cu05d1\u005Cu05e8\u005Cu05d9\u005Cu05ea\u0022},\u0022ka\u0022:{\u0022name\u0022:\u0022Georgian\u0022,\u0022name_local\u0022:\u0022\u005Cu10e5\u005Cu10d0\u005Cu10e0\u005Cu10d7\u005Cu10e3\u005Cu10da\u005Cu10d8\u0022},\u0022es\u002Dni\u0022:{\u0022name\u0022:\u0022Spanish (Nicaragua)\u0022,\u0022name_local\u0022:\u0022Espa\u005Cu00f1ol de Nicaragua\u0022},\u0022nn\u0022:{\u0022name\u0022:\u0022Nynorsk (Norway)\u0022,\u0022name_local\u0022:\u0022Norsk (Nynorsk)\u0022},\u0022kk\u0022:{\u0022name\u0022:\u0022Kazakh\u0022,\u0022name_local\u0022:\u0022\u005Cu049a\u005Cu0430\u005Cu0437\u005Cu0430\u005Cu049b\u0022},\u0022ml\u0022:{\u0022name\u0022:\u0022Malayalam\u0022,\u0022name_local\u0022:\u0022Malayalam\u0022},\u0022sq\u0022:{\u0022name\u0022:\u0022Albanian\u0022,\u0022name_local\u0022:\u0022Shqip\u0022},\u0022mn\u0022:{\u0022name\u0022:\u0022Mongolian\u0022,\u0022name_local\u0022:\u0022Mongolian\u0022},\u0022ko\u0022:{\u0022name\u0022:\u0022Korean\u0022,\u0022name_local\u0022:\u0022\u005Cud55c\u005Cuad6d\u005Cuc5b4\u0022},\u0022kn\u0022:{\u0022name\u0022:\u0022Kannada\u0022,\u0022name_local\u0022:\u0022Kannada\u0022},\u0022km\u0022:{\u0022name\u0022:\u0022Khmer\u0022,\u0022name_local\u0022:\u0022Khmer\u0022},\u0022ur\u0022:{\u0022name\u0022:\u0022Urdu\u0022,\u0022name_local\u0022:\u0022\u005Cu0627\u005Cu0631\u005Cu062f\u005Cu0648\u0022},\u0022hr\u0022:{\u0022name\u0022:\u0022Croatian\u0022,\u0022name_local\u0022:\u0022Hrvatski\u0022},\u0022te\u0022:{\u0022name\u0022:\u0022Telugu\u0022,\u0022name_local\u0022:\u0022\u005Cu0c24\u005Cu0c46\u005Cu0c32\u005Cu0c41\u005Cu0c17\u005Cu0c41\u0022},\u0022de\u0022:{\u0022name\u0022:\u0022German\u0022,\u0022name_local\u0022:\u0022Deutsch\u0022},\u0022sk\u0022:{\u0022name\u0022:\u0022Slovak\u0022,\u0022name_local\u0022:\u0022Slovensk\u005Cu00fd\u0022},\u0022uk\u0022:{\u0022name\u0022:\u0022Ukrainian\u0022,\u0022name_local\u0022:\u0022\u005Cu0423\u005Cu043a\u005Cu0440\u005Cu0430\u005Cu0457\u005Cu043d\u005Cu0441\u005Cu044c\u005Cu043a\u005Cu0430\u0022},\u0022sl\u0022:{\u0022name\u0022:\u0022Slovenian\u0022,\u0022name_local\u0022:\u0022Sloven\u005Cu0161\u005Cu010dina\u0022},\u0022sr\u002Dlatn\u0022:{\u0022name\u0022:\u0022Latin (Serbia)\u0022,\u0022name_local\u0022:\u0022Srpski (Latinica)\u0022},\u0022my\u0022:{\u0022name\u0022:\u0022Burmese\u0022,\u0022name_local\u0022:\u0022\u005Cu1019\u005Cu103c\u005Cu1014\u005Cu103a\u005Cu1019\u005Cu102c\u005Cu1018\u005Cu102c\u005Cu101e\u005Cu102c\u0022},\u0022tt\u0022:{\u0022name\u0022:\u0022Tatar\u0022,\u0022name_local\u0022:\u0022\u005Cu0422\u005Cu0430\u005Cu0442\u005Cu0430\u005Cu0440\u005Cu0447\u005Cu0430\u0022}}");
            window.slipstream.languageCodesSorted = JSON.parse("[\u0022af\u0022,\u0022sq\u0022,\u0022ar\u0022,\u0022az\u0022,\u0022eu\u0022,\u0022be\u0022,\u0022bn\u0022,\u0022nb\u0022,\u0022bs\u0022,\u0022br\u0022,\u0022bg\u0022,\u0022my\u0022,\u0022ca\u0022,\u0022zh\u002Dcn\u0022,\u0022zh\u002Dtw\u0022,\u0022hr\u0022,\u0022cs\u0022,\u0022da\u0022,\u0022nl\u0022,\u0022en\u0022,\u0022en\u002Dau\u0022,\u0022en\u002Dca\u0022,\u0022en\u002Dgb\u0022,\u0022en\u002Dus\u0022,\u0022eo\u0022,\u0022et\u0022,\u0022fi\u0022,\u0022fr\u0022,\u0022fr\u002Dca\u0022,\u0022fy\u002Dnl\u0022,\u0022gl\u0022,\u0022ka\u0022,\u0022de\u0022,\u0022el\u0022,\u0022he\u0022,\u0022hi\u0022,\u0022hu\u0022,\u0022is\u0022,\u0022id\u0022,\u0022ia\u0022,\u0022ga\u0022,\u0022it\u0022,\u0022ja\u0022,\u0022kn\u0022,\u0022kk\u0022,\u0022km\u0022,\u0022ko\u0022,\u0022sr\u002Dlatn\u0022,\u0022lv\u0022,\u0022lt\u0022,\u0022lb\u0022,\u0022mk\u0022,\u0022ml\u0022,\u0022mn\u0022,\u0022ne\u0022,\u0022no\u0022,\u0022nn\u0022,\u0022os\u0022,\u0022fa\u0022,\u0022pl\u0022,\u0022pt\u0022,\u0022pt\u002Dbr\u0022,\u0022pa\u0022,\u0022ro\u0022,\u0022ru\u0022,\u0022sr\u0022,\u0022sk\u0022,\u0022sl\u0022,\u0022es\u0022,\u0022es\u002Dar\u0022,\u0022es\u002Dmx\u0022,\u0022es\u002Dni\u0022,\u0022es\u002Dve\u0022,\u0022sw\u0022,\u0022sv\u0022,\u0022ta\u0022,\u0022tt\u0022,\u0022te\u0022,\u0022th\u0022,\u0022tr\u0022,\u0022udm\u0022,\u0022uk\u0022,\u0022ur\u0022,\u0022vi\u0022,\u0022cy\u0022]");
            window.slipstream.previewLanguage = JSON.parse("null");
            window.slipstream.targetLanguage = JSON.parse("\u0022en\u002Dus\u0022");
            window.slipstream.contentLanguage = JSON.parse("\u0022en\u002Dus\u0022");

            window.slipstream.currencies = JSON.parse("{\u0022usd\u0022:{\u0022symbol\u0022:\u0022$\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022US$\u0022,\u0022ru\u0022:\u0022$\u0022,\u0022fr\u0022:\u0022$US\u0022,\u0022de\u0022:\u0022$\u0022,\u0022nl\u0022:\u0022US$\u0022,\u0022en\u002Dau\u0022:\u0022US$\u0022,\u0022pt\u0022:\u0022US$\u0022,\u0022no\u0022:\u0022USD\u0022,\u0022fr\u002Dca\u0022:\u0022$US\u0022,\u0022ca\u0022:\u0022$\u0022,\u0022en\u002Dus\u0022:\u0022$\u0022,\u0022ko\u0022:\u0022US$\u0022,\u0022it\u0022:\u0022US$\u0022,\u0022da\u0022:\u0022$\u0022,\u0022zh\u002Dcn\u0022:\u0022US$\u0022,\u0022fi\u0022:\u0022$\u0022,\u0022sv\u0022:\u0022US$\u0022,\u0022ja\u0022:\u0022$\u0022,\u0022es\u0022:\u0022$\u0022,\u0022en\u002Dca\u0022:\u0022US$\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022$\u0022},\u0022aud\u0022:{\u0022symbol\u0022:\u0022$\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022A$\u0022,\u0022ru\u0022:\u0022A$\u0022,\u0022fr\u0022:\u0022$AU\u0022,\u0022de\u0022:\u0022AU$\u0022,\u0022nl\u0022:\u0022AU$\u0022,\u0022en\u002Dau\u0022:\u0022$\u0022,\u0022pt\u0022:\u0022AU$\u0022,\u0022no\u0022:\u0022AUD\u0022,\u0022fr\u002Dca\u0022:\u0022$AU\u0022,\u0022ca\u0022:\u0022AU$\u0022,\u0022en\u002Dus\u0022:\u0022A$\u0022,\u0022ko\u0022:\u0022A$\u0022,\u0022it\u0022:\u0022A$\u0022,\u0022da\u0022:\u0022AU$\u0022,\u0022zh\u002Dcn\u0022:\u0022AU$\u0022,\u0022fi\u0022:\u0022AUD\u0022,\u0022sv\u0022:\u0022AUD\u0022,\u0022ja\u0022:\u0022AU$\u0022,\u0022es\u0022:\u0022AUD\u0022,\u0022en\u002Dca\u0022:\u0022A$\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022A$\u0022},\u0022chf\u0022:{\u0022symbol\u0022:\u0022CHF\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022CHF\u0022,\u0022ru\u0022:\u0022CHF\u0022,\u0022fr\u0022:\u0022CHF\u0022,\u0022de\u0022:\u0022CHF\u0022,\u0022nl\u0022:\u0022CHF\u0022,\u0022en\u002Dau\u0022:\u0022CHF\u0022,\u0022pt\u0022:\u0022CHF\u0022,\u0022no\u0022:\u0022CHF\u0022,\u0022fr\u002Dca\u0022:\u0022CHF\u0022,\u0022ca\u0022:\u0022CHF\u0022,\u0022en\u002Dus\u0022:\u0022CHF\u0022,\u0022ko\u0022:\u0022CHF\u0022,\u0022it\u0022:\u0022CHF\u0022,\u0022da\u0022:\u0022CHF\u0022,\u0022zh\u002Dcn\u0022:\u0022CHF\u0022,\u0022fi\u0022:\u0022CHF\u0022,\u0022sv\u0022:\u0022CHF\u0022,\u0022ja\u0022:\u0022CHF\u0022,\u0022es\u0022:\u0022CHF\u0022,\u0022en\u002Dca\u0022:\u0022CHF\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022CHF\u0022},\u0022nok\u0022:{\u0022symbol\u0022:\u0022kr\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022kr\u0022,\u0022ru\u0022:\u0022NOK\u0022,\u0022fr\u0022:\u0022NOK\u0022,\u0022de\u0022:\u0022NOK\u0022,\u0022nl\u0022:\u0022kr\u0022,\u0022en\u002Dau\u0022:\u0022kr\u0022,\u0022pt\u0022:\u0022NOK\u0022,\u0022no\u0022:\u0022kr\u0022,\u0022fr\u002Dca\u0022:\u0022NOK\u0022,\u0022ca\u0022:\u0022NOK\u0022,\u0022en\u002Dus\u0022:\u0022kr\u0022,\u0022ko\u0022:\u0022NOK\u0022,\u0022it\u0022:\u0022NOK\u0022,\u0022da\u0022:\u0022NOK\u0022,\u0022zh\u002Dcn\u0022:\u0022NOK\u0022,\u0022fi\u0022:\u0022NOK\u0022,\u0022sv\u0022:\u0022Nkr\u0022,\u0022ja\u0022:\u0022NOK\u0022,\u0022es\u0022:\u0022NOK\u0022,\u0022en\u002Dca\u0022:\u0022kr\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022kr\u0022},\u0022dkk\u0022:{\u0022symbol\u0022:\u0022kr\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022kr\u0022,\u0022ru\u0022:\u0022DKK\u0022,\u0022fr\u0022:\u0022DKK\u0022,\u0022de\u0022:\u0022DKK\u0022,\u0022nl\u0022:\u0022kr\u0022,\u0022en\u002Dau\u0022:\u0022kr\u0022,\u0022pt\u0022:\u0022DKK\u0022,\u0022no\u0022:\u0022DKK\u0022,\u0022fr\u002Dca\u0022:\u0022DKK\u0022,\u0022ca\u0022:\u0022DKK\u0022,\u0022en\u002Dus\u0022:\u0022kr\u0022,\u0022ko\u0022:\u0022DKK\u0022,\u0022it\u0022:\u0022DKK\u0022,\u0022da\u0022:\u0022kr.\u0022,\u0022zh\u002Dcn\u0022:\u0022DKK\u0022,\u0022fi\u0022:\u0022DKK\u0022,\u0022sv\u0022:\u0022Dkr\u0022,\u0022ja\u0022:\u0022DKK\u0022,\u0022es\u0022:\u0022DKK\u0022,\u0022en\u002Dca\u0022:\u0022kr\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022kr\u0022},\u0022mxn\u0022:{\u0022symbol\u0022:\u0022$\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022MX$\u0022,\u0022ru\u0022:\u0022MX$\u0022,\u0022fr\u0022:\u0022MX$\u0022,\u0022de\u0022:\u0022MX$\u0022,\u0022nl\u0022:\u0022MX$\u0022,\u0022en\u002Dau\u0022:\u0022MX$\u0022,\u0022pt\u0022:\u0022MX$\u0022,\u0022no\u0022:\u0022MXN\u0022,\u0022fr\u002Dca\u0022:\u0022MX$\u0022,\u0022ca\u0022:\u0022MX$\u0022,\u0022en\u002Dus\u0022:\u0022MX$\u0022,\u0022ko\u0022:\u0022MX$\u0022,\u0022it\u0022:\u0022MX$\u0022,\u0022da\u0022:\u0022MX$\u0022,\u0022zh\u002Dcn\u0022:\u0022MX$\u0022,\u0022fi\u0022:\u0022MXN\u0022,\u0022sv\u0022:\u0022MX$\u0022,\u0022ja\u0022:\u0022MX$\u0022,\u0022es\u0022:\u0022MXN\u0022,\u0022en\u002Dca\u0022:\u0022MX$\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022MX$\u0022},\u0022gbp\u0022:{\u0022symbol\u0022:\u0022\u005Cu00a3\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022\u005Cu00a3\u0022,\u0022ru\u0022:\u0022\u005Cu00a3\u0022,\u0022fr\u0022:\u0022\u005Cu00a3GB\u0022,\u0022de\u0022:\u0022\u005Cu00a3\u0022,\u0022nl\u0022:\u0022\u005Cu00a3\u0022,\u0022en\u002Dau\u0022:\u0022\u005Cu00a3\u0022,\u0022pt\u0022:\u0022\u005Cu00a3\u0022,\u0022no\u0022:\u0022\u005Cu00a3\u0022,\u0022fr\u002Dca\u0022:\u0022\u005Cu00a3GB\u0022,\u0022ca\u0022:\u0022\u005Cu00a3\u0022,\u0022en\u002Dus\u0022:\u0022\u005Cu00a3\u0022,\u0022ko\u0022:\u0022\u005Cu00a3\u0022,\u0022it\u0022:\u0022\u005Cu00a3\u0022,\u0022da\u0022:\u0022\u005Cu00a3\u0022,\u0022zh\u002Dcn\u0022:\u0022\u005Cu00a3\u0022,\u0022fi\u0022:\u0022\u005Cu00a3\u0022,\u0022sv\u0022:\u0022GBP\u0022,\u0022ja\u0022:\u0022\u005Cu00a3\u0022,\u0022es\u0022:\u0022GBP\u0022,\u0022en\u002Dca\u0022:\u0022\u005Cu00a3\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022\u005Cu00a3\u0022},\u0022nzd\u0022:{\u0022symbol\u0022:\u0022$\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022NZ$\u0022,\u0022ru\u0022:\u0022NZ$\u0022,\u0022fr\u0022:\u0022$NZ\u0022,\u0022de\u0022:\u0022NZ$\u0022,\u0022nl\u0022:\u0022NZ$\u0022,\u0022en\u002Dau\u0022:\u0022NZ$\u0022,\u0022pt\u0022:\u0022NZ$\u0022,\u0022no\u0022:\u0022NZD\u0022,\u0022fr\u002Dca\u0022:\u0022$NZ\u0022,\u0022ca\u0022:\u0022NZ$\u0022,\u0022en\u002Dus\u0022:\u0022NZ$\u0022,\u0022ko\u0022:\u0022NZ$\u0022,\u0022it\u0022:\u0022NZ$\u0022,\u0022da\u0022:\u0022NZ$\u0022,\u0022zh\u002Dcn\u0022:\u0022NZ$\u0022,\u0022fi\u0022:\u0022NZD\u0022,\u0022sv\u0022:\u0022NZD\u0022,\u0022ja\u0022:\u0022NZ$\u0022,\u0022es\u0022:\u0022NZD\u0022,\u0022en\u002Dca\u0022:\u0022NZ$\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022NZ$\u0022},\u0022eur\u0022:{\u0022symbol\u0022:\u0022\u005Cu20ac\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022\u005Cu20ac\u0022,\u0022ru\u0022:\u0022\u005Cu20ac\u0022,\u0022fr\u0022:\u0022\u005Cu20ac\u0022,\u0022de\u0022:\u0022\u005Cu20ac\u0022,\u0022nl\u0022:\u0022\u005Cu20ac\u0022,\u0022en\u002Dau\u0022:\u0022\u005Cu20ac\u0022,\u0022pt\u0022:\u0022\u005Cu20ac\u0022,\u0022no\u0022:\u0022\u005Cu20ac\u0022,\u0022fr\u002Dca\u0022:\u0022\u005Cu20ac\u0022,\u0022ca\u0022:\u0022\u005Cu20ac\u0022,\u0022en\u002Dus\u0022:\u0022\u005Cu20ac\u0022,\u0022ko\u0022:\u0022\u005Cu20ac\u0022,\u0022it\u0022:\u0022\u005Cu20ac\u0022,\u0022da\u0022:\u0022\u005Cu20ac\u0022,\u0022zh\u002Dcn\u0022:\u0022\u005Cu20ac\u0022,\u0022fi\u0022:\u0022\u005Cu20ac\u0022,\u0022sv\u0022:\u0022\u005Cu20ac\u0022,\u0022ja\u0022:\u0022\u005Cu20ac\u0022,\u0022es\u0022:\u0022\u005Cu20ac\u0022,\u0022en\u002Dca\u0022:\u0022\u005Cu20ac\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022\u005Cu20ac\u0022},\u0022sek\u0022:{\u0022symbol\u0022:\u0022kr\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022kr\u0022,\u0022ru\u0022:\u0022SEK\u0022,\u0022fr\u0022:\u0022SEK\u0022,\u0022de\u0022:\u0022SEK\u0022,\u0022nl\u0022:\u0022kr\u0022,\u0022en\u002Dau\u0022:\u0022kr\u0022,\u0022pt\u0022:\u0022SEK\u0022,\u0022no\u0022:\u0022SEK\u0022,\u0022fr\u002Dca\u0022:\u0022SEK\u0022,\u0022ca\u0022:\u0022SEK\u0022,\u0022en\u002Dus\u0022:\u0022kr\u0022,\u0022ko\u0022:\u0022SEK\u0022,\u0022it\u0022:\u0022SEK\u0022,\u0022da\u0022:\u0022SEK\u0022,\u0022zh\u002Dcn\u0022:\u0022SEK\u0022,\u0022fi\u0022:\u0022SEK\u0022,\u0022sv\u0022:\u0022kr\u0022,\u0022ja\u0022:\u0022SEK\u0022,\u0022es\u0022:\u0022SEK\u0022,\u0022en\u002Dca\u0022:\u0022kr\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022kr\u0022},\u0022sgd\u0022:{\u0022symbol\u0022:\u0022$\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022SG$\u0022,\u0022ru\u0022:\u0022SG$\u0022,\u0022fr\u0022:\u0022$SG\u0022,\u0022de\u0022:\u0022SG$\u0022,\u0022nl\u0022:\u0022SG$\u0022,\u0022en\u002Dau\u0022:\u0022SG$\u0022,\u0022pt\u0022:\u0022SG$\u0022,\u0022no\u0022:\u0022SGD\u0022,\u0022fr\u002Dca\u0022:\u0022$SG\u0022,\u0022ca\u0022:\u0022SGD\u0022,\u0022en\u002Dus\u0022:\u0022SG$\u0022,\u0022ko\u0022:\u0022SG$\u0022,\u0022it\u0022:\u0022SG$\u0022,\u0022da\u0022:\u0022SG$\u0022,\u0022zh\u002Dcn\u0022:\u0022SG$\u0022,\u0022fi\u0022:\u0022SGD\u0022,\u0022sv\u0022:\u0022SGD\u0022,\u0022ja\u0022:\u0022SG$\u0022,\u0022es\u0022:\u0022SGD\u0022,\u0022en\u002Dca\u0022:\u0022SG$\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022SG$\u0022},\u0022hkd\u0022:{\u0022symbol\u0022:\u0022$\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022HK$\u0022,\u0022ru\u0022:\u0022HK$\u0022,\u0022fr\u0022:\u0022HKD\u0022,\u0022de\u0022:\u0022HK$\u0022,\u0022nl\u0022:\u0022HK$\u0022,\u0022en\u002Dau\u0022:\u0022HK$\u0022,\u0022pt\u0022:\u0022HK$\u0022,\u0022no\u0022:\u0022HKD\u0022,\u0022fr\u002Dca\u0022:\u0022HKD\u0022,\u0022ca\u0022:\u0022HK$\u0022,\u0022en\u002Dus\u0022:\u0022HK$\u0022,\u0022ko\u0022:\u0022HK$\u0022,\u0022it\u0022:\u0022HK$\u0022,\u0022da\u0022:\u0022HK$\u0022,\u0022zh\u002Dcn\u0022:\u0022HK$\u0022,\u0022fi\u0022:\u0022HKD\u0022,\u0022sv\u0022:\u0022HKD\u0022,\u0022ja\u0022:\u0022HK$\u0022,\u0022es\u0022:\u0022HKD\u0022,\u0022en\u002Dca\u0022:\u0022HK$\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022HK$\u0022},\u0022cad\u0022:{\u0022symbol\u0022:\u0022$\u0022,\u0022symbol_long_by_language\u0022:{\u0022en\u002Dgb\u0022:\u0022CA$\u0022,\u0022ru\u0022:\u0022CA$\u0022,\u0022fr\u0022:\u0022$CA\u0022,\u0022de\u0022:\u0022CA$\u0022,\u0022nl\u0022:\u0022C$\u0022,\u0022en\u002Dau\u0022:\u0022CA$\u0022,\u0022pt\u0022:\u0022CA$\u0022,\u0022no\u0022:\u0022CAD\u0022,\u0022fr\u002Dca\u0022:\u0022$\u0022,\u0022ca\u0022:\u0022CA$\u0022,\u0022en\u002Dus\u0022:\u0022CA$\u0022,\u0022ko\u0022:\u0022CA$\u0022,\u0022it\u0022:\u0022CA$\u0022,\u0022da\u0022:\u0022CA$\u0022,\u0022zh\u002Dcn\u0022:\u0022CA$\u0022,\u0022fi\u0022:\u0022CAD\u0022,\u0022sv\u0022:\u0022CA$\u0022,\u0022ja\u0022:\u0022CA$\u0022,\u0022es\u0022:\u0022CA$\u0022,\u0022en\u002Dca\u0022:\u0022$\u0022},\u0022decimal_places\u0022:2,\u0022symbol_long\u0022:\u0022CA$\u0022}}");
            window.slipstream.currencyChoices = JSON.parse("[[\u0022aud\u0022,\u0022Australian Dollars (AUD)\u0022],[\u0022cad\u0022,\u0022Canadian Dollars (CAD)\u0022],[\u0022chf\u0022,\u0022Swiss Franc (CHF)\u0022],[\u0022dkk\u0022,\u0022Danish Krone (DKK)\u0022],[\u0022eur\u0022,\u0022Euro (EUR)\u0022],[\u0022gbp\u0022,\u0022British Pounds Sterling (GBP)\u0022],[\u0022hkd\u0022,\u0022Hong Kong Dollars (HKD)\u0022],[\u0022mxn\u0022,\u0022Mexican Peso (MXN)\u0022],[\u0022nok\u0022,\u0022Norwegian Kroner (NOK)\u0022],[\u0022nzd\u0022,\u0022New Zealand Dollars (NZD)\u0022],[\u0022sek\u0022,\u0022Swedish Krona (SEK)\u0022],[\u0022sgd\u0022,\u0022Singapore dollars (SGD)\u0022],[\u0022usd\u0022,\u0022US Dollars (USD)\u0022]]")

            window.slipstream.isWhitelisted = JSON.parse("true");

            window.slipstream.translatableModels = JSON.parse("{\u0022CannedMessage\u0022:{\u0022plural\u0022:\u0022canned messages\u0022,\u0022singular\u0022:\u0022canned message\u0022},\u0022CustomerPrototype\u0022:{\u0022plural\u0022:\u0022customer prototypes\u0022,\u0022singular\u0022:\u0022customer prototype\u0022},\u0022SeatZone\u0022:{\u0022plural\u0022:\u0022seat zones\u0022,\u0022singular\u0022:\u0022seat zone\u0022},\u0022Pickup\u0022:{\u0022plural\u0022:\u0022pickups\u0022,\u0022singular\u0022:\u0022pickup\u0022},\u0022Location\u0022:{\u0022plural\u0022:\u0022locations\u0022,\u0022singular\u0022:\u0022location\u0022},\u0022Resource\u0022:{\u0022plural\u0022:\u0022resources\u0022,\u0022singular\u0022:\u0022resource\u0022},\u0022CancellationPolicy\u0022:{\u0022plural\u0022:\u0022cancellation policies\u0022,\u0022singular\u0022:\u0022cancellation policy\u0022},\u0022Company\u0022:{\u0022plural\u0022:\u0022companies\u0022,\u0022singular\u0022:\u0022company\u0022},\u0022SeatGroup\u0022:{\u0022plural\u0022:\u0022seat groups\u0022,\u0022singular\u0022:\u0022seat group\u0022},\u0022SeatMap\u0022:{\u0022plural\u0022:\u0022seat maps\u0022,\u0022singular\u0022:\u0022seat map\u0022},\u0022FlowNode\u0022:{\u0022plural\u0022:\u0022booking flows\u0022,\u0022singular\u0022:\u0022booking flow\u0022},\u0022CheckinStatus\u0022:{\u0022plural\u0022:\u0022check\u002Din statuses\u0022,\u0022singular\u0022:\u0022check\u002Din status\u0022},\u0022Route\u0022:{\u0022plural\u0022:\u0022routes\u0022,\u0022singular\u0022:\u0022route\u0022},\u0022TaxType\u0022:{\u0022plural\u0022:\u0022tax types\u0022,\u0022singular\u0022:\u0022tax type\u0022},\u0022Item\u0022:{\u0022plural\u0022:\u0022items\u0022,\u0022singular\u0022:\u0022item\u0022},\u0022StoredValueType\u0022:{\u0022plural\u0022:\u0022gift card types\u0022,\u0022singular\u0022:\u0022gift card type\u0022},\u0022CustomerType\u0022:{\u0022plural\u0022:\u0022customer types\u0022,\u0022singular\u0022:\u0022customer type\u0022},\u0022Waiver\u0022:{\u0022plural\u0022:\u0022waivers\u0022,\u0022singular\u0022:\u0022waiver\u0022},\u0022Campaign\u0022:{\u0022plural\u0022:\u0022campaigns\u0022,\u0022singular\u0022:\u0022campaign\u0022},\u0022Seat\u0022:{\u0022plural\u0022:\u0022seats\u0022,\u0022singular\u0022:\u0022seat\u0022},\u0022Lodging\u0022:{\u0022plural\u0022:\u0022lodgings\u0022,\u0022singular\u0022:\u0022lodging\u0022},\u0022CustomField\u0022:{\u0022plural\u0022:\u0022custom fields\u0022,\u0022singular\u0022:\u0022custom field\u0022}}");
            window.slipstream.countryDefaults = JSON.parse("{\u0022BE\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022en\u002Dgb\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Brussels\u0022,\u0022rollingWindowDays\u0022:1,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022FR\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022fr\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Paris\u0022,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022DK\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022dkk\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022da\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:1000,\u0022processingFlatFee\u0022:200,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Copenhagen\u0022,\u0022rollingWindowDays\u0022:1,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022DE\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022de\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Berlin\u0022,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022HK\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022hkd\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:true,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022processingFeeRate\u0022:3.3,\u0022minimumFee\u0022:800,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Asia\u005C/Hong_Kong\u0022,\u0022rollingWindowDays\u0022:1,\u0022processingFlatFee\u0022:235,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022FI\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022fi\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Helsinki\u0022,\u0022rollingWindowDays\u0022:1,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022NL\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:true,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022nl\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DidealProcessingFlatFee\u0022:29,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022features\u002DidealProcessingFeeRate\u0022:0,\u0022timezone\u0022:\u0022Europe\u005C/Amsterdam\u0022,\u0022rollingWindowDays\u0022:1,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022PT\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022pt\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Lisbon\u0022,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022NO\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022nok\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022no\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:1500,\u0022processingFlatFee\u0022:300,\u0022processingFeeRate\u0022:2.3,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Oslo\u0022,\u0022rollingWindowDays\u0022:1,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022NZ\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022en\u002Dau\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022processingFeeRate\u0022:2.4,\u0022minimumFee\u0022:150,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Pacific\u005C/Auckland\u0022,\u0022rollingWindowDays\u0022:1,\u0022processingFlatFee\u0022:30,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022LU\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022processingFeeRate\u0022:2.2,\u0022minimumFee\u0022:100,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Luxembourg\u0022,\u0022processingFlatFee\u0022:30,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022CH\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022chf\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022de\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:125,\u0022processingFeeRate\u0022:2.7,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Zurich\u0022,\u0022processingFlatFee\u0022:30,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022CA\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022cad\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022en\u002Dca\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022processingFeeRate\u0022:2.7,\u0022minimumFee\u0022:150,\u0022percentageFeeRate\u0022:6,\u0022rollingWindowDays\u0022:1,\u0022processingFlatFee\u0022:30,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022IT\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022it\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Rome\u0022,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022AU\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022en\u002Dau\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022processingFeeRate\u0022:1.9,\u0022minimumFee\u0022:150,\u0022percentageFeeRate\u0022:6,\u0022rollingWindowDays\u0022:1,\u0022processingFlatFee\u0022:30,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022AT\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022de\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Vienna\u0022,\u0022rollingWindowDays\u0022:1,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022IE\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022en\u002Dgb\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Dublin\u0022,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022ES\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022eur\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022es\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Madrid\u0022,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022US\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022language\u0022:\u0022en\u002Dus\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFeeRate\u0022:1.9,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022processingFlatFee\u0022:30,\u0022rollingWindowDays\u0022:1},\u0022SG\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022sgd\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:true,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022processingFeeRate\u0022:3.3,\u0022minimumFee\u0022:150,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Asia\u005C/Singapore\u0022,\u0022rollingWindowDays\u0022:1,\u0022processingFlatFee\u0022:50,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022MX\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022es\u0022,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022processingFeeRate\u0022:3.6,\u0022minimumFee\u0022:2000,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022America\u005C/Mexico_City\u0022,\u0022rollingWindowDays\u0022:1,\u0022processingFlatFee\u0022:300,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022SE\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022sek\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022sv\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:1500,\u0022processingFlatFee\u0022:300,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/Stockholm\u0022,\u0022rollingWindowDays\u0022:1,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true},\u0022GB\u0022:{\u0022features\u002DisIdealPaymentsEnabled\u0022:false,\u0022processorCurrency\u0022:\u0022gbp\u0022,\u0022features\u002DisStoredValueCardBookingFeesEnabled\u0022:false,\u0022language\u0022:\u0022en\u002Dgb\u0022,\u0022features\u002DisProcessorOnboardingEnabled\u0022:true,\u0022minimumFee\u0022:100,\u0022processingFlatFee\u0022:30,\u0022processingFeeRate\u0022:2.2,\u0022features\u002DisItemColorsEnabled\u0022:true,\u0022percentageFeeRate\u0022:6,\u0022timezone\u0022:\u0022Europe\u005C/London\u0022,\u0022rollingWindowDays\u0022:1,\u0022features\u002DisScaEnabled\u0022:true,\u0022features\u002DisExtendedBreakdownEnabled\u0022:true}}");
          })();
        </script>
      

  <script type="text/javascript">
    (function(){
      window.slipstream['reports.allColumns'] = JSON.parse("{\u0022COLLECTED_BY_AFFILIATE_TOTAL_COST_TOTAL_COLUMN\u0022:\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,\u0022RECEIPT_COLUMNS\u0022:[[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,false,true]],\u0022COMPANY_COLUMN\u0022:\u0022company\u0022,\u0022USE_COUNT_COLUMN\u0022:\u0022use\u002Dcount\u0022,\u0022LODGING_COLUMN\u0022:\u0022lodging\u0022,\u0022DAY_OF_WEEK_COLUMN\u0022:\u0022day\u002Dof\u002Dweek\u0022,\u0022REFUND_TOTAL_PRICE_COLUMN\u0022:\u0022refund\u002Dtotal\u002Dprice\u0022,\u0022RECEIPT_GROSS_COLUMN\u0022:\u0022receipt\u002Dgross\u0022,\u0022PAYMENT_TOTAL_TAX_BY_TYPE_COLUMN\u0022:\u0022payment\u002Dtotal\u002Dtax\u002Dby\u002Dtype\u0022,\u0022ITEM_NAME_COLUMN\u0022:\u0022item\u002Dname\u0022,\u0022TOTAL_TAX_FOR_TAX_TYPE_COLUMN\u0022:\u0022total\u002Dtax\u002Dfor\u002Dtax\u002Dtype\u0022,\u0022CUSTOMER_PROTOTYPE_COLUMN\u0022:\u0022customer\u002Dprototype\u0022,\u0022AVAILABILITY_PRIVATE_HEADLINE_COLUMN\u0022:\u0022availability\u002Dprivate\u002Dheadline\u0022,\u0022VALID_COLUMNS\u0022:{\u0022Customer\u0022:[[\u0022customer\u002Dtype\u0022,false,true],[\u0022customer\u002Dprototype\u0022,false,true],[\u0022checkin\u002Dstatus\u0022,false,true],[\u0022customer\u002Dcount\u0022,true,true],[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,false,true],[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true]],\u0022LineItem\u0022:[[\u0022created\u002Dat\u0022,false,true],[\u0022created\u002Dat\u002Dtime\u0022,false,true],[\u0022created\u002Dat\u002Ddate\u0022,false,true],[\u0022line\u002Ditem\u002Ddescription\u0022,false,true],[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,false,true],[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true]],\u0022Booking\u0022:[[\u0022booking\u002Did\u0022,false,true],[\u0022booking\u002Dcount\u0022,true,false],[\u0022is\u002Dcancelled\u0022,false,true],[\u0022cancelled\u002Dcount\u0022,true,false],[\u0022created\u002Dat\u0022,false,true],[\u0022created\u002Dat\u002Dtime\u0022,false,true],[\u0022created\u002Dat\u002Ddate\u0022,false,true],[\u0022originally\u002Dbooked\u002Dby\u0022,false,true],[\u0022last\u002Drebooked\u002Dat\u0022,false,true],[\u0022last\u002Drebooked\u002Dat\u002Ddate\u0022,false,true],[\u0022last\u002Drebooked\u002Dat\u002Dtime\u0022,false,true],[\u0022booked\u002Dby\u0022,false,true],[\u0022item\u002Did\u0022,false,true],[\u0022company\u0022,false,true],[\u0022item\u002Dname\u0022,false,true],[\u0022availability\u002Ddatetime\u0022,false,true],[\u0022availability\u002Dstart\u002Dtime\u0022,false,true],[\u0022availability\u002Dstart\u002Ddate\u0022,false,true],[\u0022availability\u002Dend\u002Dtime\u0022,false,true],[\u0022availability\u002Dend\u002Ddate\u0022,false,true],[\u0022availability\u002Did\u0022,false,true],[\u0022day\u002Dof\u002Dweek\u0022,false,true],[\u0022availability\u002Dpublic\u002Dheadline\u0022,false,true],[\u0022availability\u002Dprivate\u002Dheadline\u0022,false,true],[\u0022contact\u002Dname\u0022,false,true],[\u0022contact\u002Dphone\u0022,false,true],[\u0022contact\u002Dlanguage\u0022,false,true],[\u0022sms\u002Dsubscribed\u002Dcount\u0022,true,false],[\u0022is\u002Dsubscribed\u002Dto\u002Dsms\u0022,false,true],[\u0022contact\u002Demail\u0022,false,true],[\u0022email\u002Dsubscribed\u002Dcount\u0022,true,false],[\u0022is\u002Dsubscribed\u002Dto\u002Demail\u0022,false,true],[\u0022booking\u002Dnotes\u0022,false,true],[\u0022customer\u002Dcount\u0022,true,true],[\u0022online\u002Dbooking\u002Dreference\u0022,false,true],[\u0022lodging\u0022,false,true],[\u0022room\u002Dnumber\u0022,false,true],[\u0022pickup\u0022,false,true],[\u0022stop\u002Dtime\u0022,false,true],[\u0022route\u0022,false,true],[\u0022total\u002Dsheet\u0022,false,true],[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022net\u002Dcharter\u002Drevenue\u0022,true,true],[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,true,true],[\u0022receipt\u002Dbooking\u002Dfee\u0022,true,true],[\u0022amount\u002Ddue\u0022,true,true],[\u0022paid\u002Dstatus\u0022,false,true],[\u0022affiliate\u0022,false,true],[\u0022voucher\u002Dnumber\u0022,false,true],[\u0022agent\u0022,false,true],[\u0022desk\u0022,false,true],[\u0022invoice\u002Dsheet\u0022,false,true],[\u0022invoice\u002Dsheet\u002Ddescription\u0022,false,true],[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true],[\u0022is\u002Dinvoiced\u0022,false,true],[\u0022invoiced\u002Dcount\u0022,true,false],[\u0022invoiceable\u002Dto\u002Daffiliate\u0022,true,true],[\u0022invoiced\u002Dto\u002Daffiliate\u0022,true,true],[\u0022invoiceable\u002Dto\u002Dcharter\u0022,true,true],[\u0022invoiced\u002Dto\u002Dcharter\u0022,true,true]],\u0022CustomFieldValue\u0022:[[\u0022custom\u002Dfield\u002Dvalue\u0022,false,true],[\u0022use\u002Dcount\u0022,true,true],[\u0022display\u002Dcount\u0022,true,false],[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,false,true],[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true]],\u0022Payment\u0022:[[\u0022payment\u002Dor\u002Drefund\u0022,false,true],[\u0022payment\u002Dor\u002Drefund\u002Did\u0022,false,true],[\u0022created\u002Dat\u0022,false,true],[\u0022created\u002Dat\u002Dtime\u0022,false,true],[\u0022created\u002Dat\u002Ddate\u0022,false,true],[\u0022payment\u002Duser\u0022,false,true],[\u0022payment\u002Dnote\u002Dlabel\u0022,false,true],[\u0022payment\u002Dnote\u0022,false,true],[\u0022payment\u002Dtype\u0022,false,true],[\u0022affiliate\u002Dpayment\u002Dtype\u0022,false,true],[\u0022credit\u002Dcard\u002Dtype\u0022,false,true],[\u0022credit\u002Dcard\u002Dlast\u002Dfour\u0022,false,true],[\u0022credit\u002Dcard\u002Dpostal\u002Dcode\u0022,false,true],[\u0022stored\u002Dvalue\u002Dcard\u002Dtype\u0022,false,true],[\u0022stored\u002Dvalue\u002Dcard\u002Dnumber\u0022,false,true],[\u0022dispute\u002Dstatus\u0022,false,true],[\u0022payment\u002Dand\u002Drefund\u002Dgross\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dnet\u0022,true,true],[\u0022payment\u002Dinitial\u002Dgross\u0022,true,true],[\u0022payment\u002Dinitial\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022payment\u002Dinitial\u002Dnet\u0022,true,true],[\u0022refund\u002Dgross\u0022,true,true],[\u0022refund\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022refund\u002Dnet\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dprice\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dtax\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dcount\u0022,true,false],[\u0022payment\u002Dcount\u0022,true,false],[\u0022refund\u002Dcount\u0022,true,false]]},\u0022PAYMENT_AND_REFUND_PROCESSING_FEE_COLUMN\u0022:\u0022payment\u002Dand\u002Drefund\u002Dprocessing\u002Dfee\u0022,\u0022CONTACT_PHONE_COLUMN\u0022:\u0022contact\u002Dphone\u0022,\u0022COLLECTED_TOTAL_COST_COLUMNS\u0022:[[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false]],\u0022PAYMENT_OR_REFUND_COLUMN\u0022:\u0022payment\u002Dor\u002Drefund\u0022,\u0022BOOKING_IS_CANCELLED_COLUMN\u0022:\u0022is\u002Dcancelled\u0022,\u0022AFFILIATE_PAYMENT_TYPE_COLUMN\u0022:\u0022affiliate\u002Dpayment\u002Dtype\u0022,\u0022INVOICED_COUNT_COLUMN\u0022:\u0022invoiced\u002Dcount\u0022,\u0022PAYMENT_AND_REFUND_NET_COLUMN\u0022:\u0022payment\u002Dand\u002Drefund\u002Dnet\u0022,\u0022BOOKING_NOTE_COLUMN\u0022:\u0022booking\u002Dnotes\u0022,\u0022BOOKING_COUNT_COLUMN\u0022:\u0022booking\u002Dcount\u0022,\u0022COLLECTED_BY_CHARTER_TOTAL_COST_TAX_COLUMN\u0022:\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,\u0022ALL_INVOICE_COLUMNS\u0022:[[\u0022invoiceable\u002Dto\u002Daffiliate\u0022,true,true],[\u0022invoiced\u002Dto\u002Daffiliate\u0022,true,true],[\u0022invoiceable\u002Dto\u002Dcharter\u0022,true,true],[\u0022invoiced\u002Dto\u002Dcharter\u0022,true,true]],\u0022AVAILABILITY_DATETIME_COLUMN\u0022:\u0022availability\u002Ddatetime\u0022,\u0022CREW_MEMBER_ROLE_COLUMN\u0022:\u0022crew\u002Dmember\u002Drole\u0022,\u0022AVAILABILITY_END_DATE_COLUMN\u0022:\u0022availability\u002Dend\u002Ddate\u0022,\u0022PAYMENT_GROSS_COLUMN\u0022:\u0022payment\u002Dgross\u0022,\u0022INVOICEABLE_TO_AFFILIATE_COLUMN\u0022:\u0022invoiceable\u002Dto\u002Daffiliate\u0022,\u0022PAYMENT_TOTAL_TAX_COLUMN\u0022:\u0022payment\u002Dtotal\u002Dtax\u0022,\u0022RECEIPT_COLLECTED_BY_CHARTER_NET_COLUMN\u0022:\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,\u0022CUSTOM_FIELDS_GROUP_COLUMN\u0022:\u0022custom\u002Dfields\u002Dgroup\u0022,\u0022AVAILABILITY_START_TIME_COLUMN\u0022:\u0022availability\u002Dstart\u002Dtime\u0022,\u0022VOUCHER_NUMBER_COLUMN\u0022:\u0022voucher\u002Dnumber\u0022,\u0022DISPUTE_STATUS_COLUMN\u0022:\u0022dispute\u002Dstatus\u0022,\u0022PAYMENT_INITIAL_GROSS_COLUMN\u0022:\u0022payment\u002Dinitial\u002Dgross\u0022,\u0022PAYMENT_COUNT_COLUMN\u0022:\u0022payment\u002Dcount\u0022,\u0022RECEIPT_COLLECTED_BY_AFFILIATE_COLUMNS\u0022:[[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,false,true]],\u0022COLLECTED_BY_CHARTER_TOTAL_COST_TOTAL_COLUMN\u0022:\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,\u0022LINE_ITEM_DESCRIPTION_COLUMN\u0022:\u0022line\u002Ditem\u002Ddescription\u0022,\u0022SMS_SUBSCRIBED_COUNT_COLUMN\u0022:\u0022sms\u002Dsubscribed\u002Dcount\u0022,\u0022BOOKING_BOOKED_BY_COLUMN\u0022:\u0022booked\u002Dby\u0022,\u0022PAYMENT_AND_REFUND_GROSS_COLUMN\u0022:\u0022payment\u002Dand\u002Drefund\u002Dgross\u0022,\u0022CREATED_AT_DATE_COLUMN\u0022:\u0022created\u002Dat\u002Ddate\u0022,\u0022BOOKING_ID_COLUMN\u0022:\u0022booking\u002Did\u0022,\u0022NET_CHARTER_REVENUE_COLUMN\u0022:\u0022net\u002Dcharter\u002Drevenue\u0022,\u0022TOTAL_COST_TAX_COLUMN\u0022:\u0022total\u002Dcost\u002Dtax\u0022,\u0022AVAILABILITY_START_DATE_COLUMN\u0022:\u0022availability\u002Dstart\u002Ddate\u0022,\u0022TOTAL_SHEET_COLUMN\u0022:\u0022total\u002Dsheet\u0022,\u0022ROOM_COLUMN\u0022:\u0022room\u002Dnumber\u0022,\u0022DESK_COLUMN\u0022:\u0022desk\u0022,\u0022ALL_TOTAL_COST_COLUMNS\u0022:[[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true]],\u0022REFUND_TOTAL_TAX_BY_TYPE_COLUMN\u0022:\u0022refund\u002Dtotal\u002Dtax\u002Dby\u002Dtype\u0022,\u0022TOTAL_COST_TOTAL_PERCENTAGE_COLUMN\u0022:\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,\u0022PAYMENT_TOTAL_TAX_FOR_TAX_TYPE_COLUMN\u0022:\u0022payment\u002Dtotal\u002Dtax\u002Dfor\u002Dtax\u002Dtype\u0022,\u0022COLLECTED_BY_CHARTER_TOTAL_COST_COLUMNS\u0022:[[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true]],\u0022ITEM_ID_COLUMN\u0022:\u0022item\u002Did\u0022,\u0022ONLINE_BOOKING_REFERENCE_COLUMN\u0022:\u0022online\u002Dbooking\u002Dreference\u0022,\u0022CREW_MEMBER_USER_COLUMN\u0022:\u0022crew\u0022,\u0022AFFILIATE_COLUMN\u0022:\u0022affiliate\u0022,\u0022AVAILABILITY_ID_COLUMN\u0022:\u0022availability\u002Did\u0022,\u0022STOP_TIME_COLUMN\u0022:\u0022stop\u002Dtime\u0022,\u0022TOTAL_COST_COLUMNS\u0022:[[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false]],\u0022IS_SUBSCRIBED_TO_EMAIL_COLUMN\u0022:\u0022is\u002Dsubscribed\u002Dto\u002Demail\u0022,\u0022RECEIPT_COLLECTED_BY_AFFILIATE_GROSS_COLUMN\u0022:\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dgross\u0022,\u0022AVAILABILITY_PUBLIC_HEADLINE_COLUMN\u0022:\u0022availability\u002Dpublic\u002Dheadline\u0022,\u0022PAYMENT_AND_REFUND_TOTAL_TAX_COLUMN\u0022:\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dtax\u0022,\u0022CANCELLED_COUNT_COLUMN\u0022:\u0022cancelled\u002Dcount\u0022,\u0022TOTAL_COST_PRICE_COLUMN\u0022:\u0022total\u002Dcost\u002Dprice\u0022,\u0022AFFILIATE_PERCENTAGE_COLUMN\u0022:\u0022affiliate\u002Dpercentage\u0022,\u0022RECEIPT_COLLECTED_BY_CHARTER_GROSS_COLUMN\u0022:\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dgross\u0022,\u0022COLLECTED_TOTAL_COST_TOTAL_PERCENTAGE_COLUMN\u0022:\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,\u0022CONTACT_EMAIL_COLUMN\u0022:\u0022contact\u002Demail\u0022,\u0022IS_INVOICED_COLUMN\u0022:\u0022is\u002Dinvoiced\u0022,\u0022PROCESSOR_BASED_TYPE_COLUMN\u0022:\u0022credit\u002Dcard\u002Dtype\u0022,\u0022REFUND_NET_COLUMN\u0022:\u0022refund\u002Dnet\u0022,\u0022PAYMENT_AND_REFUND_TOTAL_PRICE_COLUMN\u0022:\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dprice\u0022,\u0022PAYMENT_TOTAL_PRICE_COLUMN\u0022:\u0022payment\u002Dtotal\u002Dprice\u0022,\u0022INVOICEABLE_TO_CHARTER_COLUMN\u0022:\u0022invoiceable\u002Dto\u002Dcharter\u0022,\u0022PAYMENT_AND_REFUND_TOTAL_TAX_BY_TYPE_COLUMN\u0022:\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dtax\u002Dby\u002Dtype\u0022,\u0022INVOICE_SHEET_DESCRIPTION_COLUMN\u0022:\u0022invoice\u002Dsheet\u002Ddescription\u0022,\u0022STORED_VALUE_CARD_NUMBER_COLUMN\u0022:\u0022stored\u002Dvalue\u002Dcard\u002Dnumber\u0022,\u0022REFUND_GROSS_COLUMN\u0022:\u0022refund\u002Dgross\u0022,\u0022INVOICED_TO_CHARTER_COLUMN\u0022:\u0022invoiced\u002Dto\u002Dcharter\u0022,\u0022TOTAL_COST_TAX_BY_TYPE_COLUMN\u0022:\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,\u0022PAYMENT_NET_COLUMN\u0022:\u0022payment\u002Dnet\u0022,\u0022PAYMENT_NOTE_LABEL_COLUMN\u0022:\u0022payment\u002Dnote\u002Dlabel\u0022,\u0022RECEIPT_PROCESSING_FEE_COLUMN\u0022:\u0022receipt\u002Dprocessing\u002Dfee\u0022,\u0022AGENT_COLUMN\u0022:\u0022agent\u0022,\u0022INVOICE_COST_PRICE_COLUMN\u0022:\u0022invoice\u002Dcost\u002Dprice\u0022,\u0022COLLECTED_TOTAL_TAX_FOR_TAX_TYPE_COLUMN\u0022:\u0022collected\u002Dtotal\u002Dtax\u002Dfor\u002Dtax\u002Dtype\u0022,\u0022CUSTOM_FIELD_COLUMN\u0022:\u0022custom\u002Dfield\u0022,\u0022EMAIL_SUBSCRIBED_COUNT_COLUMN\u0022:\u0022email\u002Dsubscribed\u002Dcount\u0022,\u0022RECEIPT_COLLECTED_BY_AFFILIATE_NET_COLUMN\u0022:\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,\u0022TOTAL_COST_TOTAL_COLUMN\u0022:\u0022total\u002Dcost\u002Dtotal\u0022,\u0022COLLECTED_TOTAL_COST_TAX_BY_TYPE_COLUMN\u0022:\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,\u0022BOOKING_ORIGINALLY_BOOKED_BY_COLUMN\u0022:\u0022originally\u002Dbooked\u002Dby\u0022,\u0022COLLECTED_BY_AFFILIATE_TOTAL_COST_PRICE_COLUMN\u0022:\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,\u0022ALL_BOOKING_RECEIPT_COLUMNS\u0022:[[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,true,true]],\u0022RECEIPT_COLLECTED_BY_AFFILIATE_PROCESSING_FEE_COLUMN\u0022:\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,\u0022CUSTOMER_TYPE_COLUMN\u0022:\u0022customer\u002Dtype\u0022,\u0022INVOICE_SHEET_COLUMN\u0022:\u0022invoice\u002Dsheet\u0022,\u0022RECEIPT_NET_COLUMN\u0022:\u0022receipt\u002Dnet\u0022,\u0022BOOKING_LAST_REBOOKED_AT_DATE_COLUMN\u0022:\u0022last\u002Drebooked\u002Dat\u002Ddate\u0022,\u0022INVOICED_TO_AFFILIATE_COLUMN\u0022:\u0022invoiced\u002Dto\u002Daffiliate\u0022,\u0022RECEIPT_COLLECTED_BY_CHARTER_COLUMNS\u0022:[[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,false,true]],\u0022COLLECTED_TOTAL_COST_TAX_COLUMN\u0022:\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,\u0022CONTACT_NAME_COLUMN\u0022:\u0022contact\u002Dname\u0022,\u0022PAID_STATUS_COLUMN\u0022:\u0022paid\u002Dstatus\u0022,\u0022STORED_VALUE_CARD_TYPE_COLUMN\u0022:\u0022stored\u002Dvalue\u002Dcard\u002Dtype\u0022,\u0022IS_SUBSCRIBED_TO_SMS_COLUMN\u0022:\u0022is\u002Dsubscribed\u002Dto\u002Dsms\u0022,\u0022ROUTE_COLUMN\u0022:\u0022route\u0022,\u0022CREDIT_CARD_POSTAL_CODE_COLUMN\u0022:\u0022credit\u002Dcard\u002Dpostal\u002Dcode\u0022,\u0022BOOKING_LAST_REBOOKED_AT_TIME_COLUMN\u0022:\u0022last\u002Drebooked\u002Dat\u002Dtime\u0022,\u0022PAYMENT_OR_REFUND_ID_COLUMN\u0022:\u0022payment\u002Dor\u002Drefund\u002Did\u0022,\u0022COLLECTED_TOTAL_COST_PRICE_COLUMN\u0022:\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,\u0022COLLECTED_BY_AFFILIATE_TOTAL_COST_COLUMNS\u0022:[[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true]],\u0022REFUND_COUNT_COLUMN\u0022:\u0022refund\u002Dcount\u0022,\u0022PAYMENT_NOTE_COLUMN\u0022:\u0022payment\u002Dnote\u0022,\u0022REFUND_TOTAL_TAX_COLUMN\u0022:\u0022refund\u002Dtotal\u002Dtax\u0022,\u0022PAYMENT_AND_REFUND_COUNT_COLUMN\u0022:\u0022payment\u002Dand\u002Drefund\u002Dcount\u0022,\u0022CREATED_AT_TIME_COLUMN\u0022:\u0022created\u002Dat\u002Dtime\u0022,\u0022PAYMENT_TYPE_COLUMN\u0022:\u0022payment\u002Dtype\u0022,\u0022CHECKIN_STATUS_COLUMN\u0022:\u0022checkin\u002Dstatus\u0022,\u0022PAYMENT_INITIAL_NET_COLUMN\u0022:\u0022payment\u002Dinitial\u002Dnet\u0022,\u0022CUSTOMER_COUNT_COLUMN\u0022:\u0022customer\u002Dcount\u0022,\u0022DISPLAY_COUNT_COLUMN\u0022:\u0022display\u002Dcount\u0022,\u0022INVOICE_COST_COLUMNS\u0022:[[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true]],\u0022COLLECTED_BY_CHARTER_TOTAL_COST_PRICE_COLUMN\u0022:\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,\u0022REFUND_TOTAL_TAX_FOR_TAX_TYPE_COLUMN\u0022:\u0022refund\u002Dtotal\u002Dtax\u002Dfor\u002Dtax\u002Dtype\u0022,\u0022PAYMENT_USER_COLUMN\u0022:\u0022payment\u002Duser\u0022,\u0022PAYMENT_PROCESSING_FEE_COLUMN\u0022:\u0022payment\u002Dprocessing\u002Dfee\u0022,\u0022RECEIPT_COLLECTED_BY_CHARTER_PROCESSING_FEE_COLUMN\u0022:\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,\u0022COLLECTED_BY_AFFILIATE_TOTAL_COST_TAX_COLUMN\u0022:\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,\u0022CUSTOM_FIELD_VALUE_COLUMN\u0022:\u0022custom\u002Dfield\u002Dvalue\u0022,\u0022COLLECTED_TOTAL_COST_TOTAL_COLUMN\u0022:\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,\u0022ALL_RECEIPT_COLUMNS\u0022:[[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,false,true]],\u0022CONTACT_LANGUAGE_COLUMN\u0022:\u0022contact\u002Dlanguage\u0022,\u0022BILLING_ZIP_CODES_COLUMN\u0022:\u0022billing\u002Dzip\u002Dcodes\u0022,\u0022PAYMENT_INITIAL_PROCESSING_FEE_COLUMN\u0022:\u0022payment\u002Dinitial\u002Dprocessing\u002Dfee\u0022,\u0022AMOUNT_DUE_COLUMN\u0022:\u0022amount\u002Ddue\u0022,\u0022BOOKING_LAST_REBOOKED_AT_COLUMN\u0022:\u0022last\u002Drebooked\u002Dat\u0022,\u0022RECEIPT_BOOKING_FEE_COLUMN\u0022:\u0022receipt\u002Dbooking\u002Dfee\u0022,\u0022PICKUP_COLUMN\u0022:\u0022pickup\u0022,\u0022AVAILABILITY_END_TIME_COLUMN\u0022:\u0022availability\u002Dend\u002Dtime\u0022,\u0022CUSTOMER_BREAKDOWN_COLUMN\u0022:\u0022customer\u002Dbreakdown\u0022,\u0022REFUND_PROCESSING_FEE_COLUMN\u0022:\u0022refund\u002Dprocessing\u002Dfee\u0022,\u0022CREATED_AT_COLUMN\u0022:\u0022created\u002Dat\u0022,\u0022INVOICE_COST_TAX_COLUMN\u0022:\u0022invoice\u002Dcost\u002Dtax\u0022,\u0022INVOICE_COST_TOTAL_COLUMN\u0022:\u0022invoice\u002Dcost\u002Dtotal\u0022,\u0022PROCESSOR_BASED_IDENTIFIER_COLUMN\u0022:\u0022credit\u002Dcard\u002Dlast\u002Dfour\u0022}");
      window.slipstream['reports.allGroups'] = JSON.parse("{\u0022AVAILABILITY_START_AT_HOUR_GROUP\u0022:\u0022availability\u002Dstart\u002Dat\u002Dhour\u0022,\u0022LODGING_GROUP\u0022:\u0022lodging\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_HOUR_GROUP\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022AVAILABILITY_START_AT_MONTH_GROUP\u0022:\u0022availability\u002Dstart\u002Dat\u002Dmonth\u0022,\u0022TOTAL_SHEET_GROUP\u0022:\u0022total\u002Dsheet\u0022,\u0022CUSTOM_FIELD_VALUE_TYPE_GROUP\u0022:\u0022custom\u002Dfield\u002Dvalue\u002Dtype\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_YEAR_GROUP\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022PAYMENT_USER_GROUP\u0022:\u0022payment\u002Duser\u0022,\u0022IN_STORE_PAYMENT_TYPE_GROUP\u0022:\u0022in\u002Dstore\u002Dpayment\u002Dtype\u0022,\u0022AVAILABILITY_START_AT_WEEK_GROUP\u0022:\u0022availability\u002Dstart\u002Dat\u002Dweek\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_WEEK_GROUP\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022CONTACT_LANGUAGE_GROUP\u0022:\u0022contact\u002Dlanguage\u0022,\u0022LINE_ITEM_CREATED_AT_MONTH_GROUP\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022BOOKING_CHECKIN_STATUS_GROUP\u0022:\u0022booking\u002Dcheckin\u002Dstatus\u0022,\u0022PAYMENT_RECOGNIZED_GROUP\u0022:\u0022recognized\u002Dstatus\u0022,\u0022LINE_ITEM_CREATED_AT_WEEK_GROUP\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022AGENT_GROUP\u0022:\u0022agent\u0022,\u0022CREW_MEMBER_USER_GROUP\u0022:\u0022crew\u002Dmember\u0022,\u0022BOOKING_CREATED_AT_WEEK_GROUP\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_DAY_GROUP\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dday\u0022,\u0022AVAILABILITY_START_AT_DAY_GROUP\u0022:\u0022availability\u002Dstart\u002Dat\u002Dday\u0022,\u0022ORIGINAL_USER_GROUP\u0022:\u0022original\u002Duser\u0022,\u0022AVAILABILITY_GROUP\u0022:\u0022availability\u0022,\u0022PROCESSOR_BASED_TYPE_GROUP\u0022:\u0022credit\u002Dcard\u002Dtype\u0022,\u0022LINE_ITEM_CREATED_AT_DAY_GROUP\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dday\u0022,\u0022LINE_ITEM_CREATED_AT_HOUR_GROUP\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022USER_GROUP\u0022:\u0022user\u0022,\u0022AVAILABILITY_START_AT_WEEKDAY_GROUP\u0022:\u0022availability\u002Dstart\u002Dat\u002Dweekday\u0022,\u0022PAYMENT_COLLECTED_GROUP\u0022:\u0022collected\u002Dstatus\u0022,\u0022PAID_STATUS_GROUP\u0022:\u0022paid\u002Dstatus\u0022,\u0022CHECKIN_STATUS_GROUP\u0022:\u0022checkin\u002Dstatus\u0022,\u0022STORED_VALUE_TYPE_GROUP\u0022:\u0022stored\u002Dvalue\u002Dtype\u0022,\u0022CUSTOMER_TYPE_GROUP\u0022:\u0022customer\u002Dtype\u0022,\u0022BOOKING_CREATED_AT_MONTH_GROUP\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_MONTH_GROUP\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022AFFILIATE_GROUP\u0022:\u0022affiliate\u0022,\u0022CUSTOMER_RESOURCE_GROUP\u0022:\u0022customer\u002Dresource\u0022,\u0022CUSTOMER_GROUP\u0022:\u0022customer\u0022,\u0022ITEM_GROUP\u0022:\u0022item\u0022,\u0022SOURCE_GROUP\u0022:\u0022source\u0022,\u0022CUSTOM_FIELD_VALUE_GROUP\u0022:\u0022custom\u002Dfield\u002Dvalue\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_WEEKDAY_GROUP\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dweekday\u0022,\u0022COMPANY_GROUP\u0022:\u0022company\u0022,\u0022CUSTOM_FIELD_GROUP\u0022:\u0022custom\u002Dfield\u0022,\u0022INVOICE_SHEET_GROUP\u0022:\u0022invoice\u002Dsheet\u0022,\u0022CUSTOMER_PROTOTYPE_GROUP\u0022:\u0022customer\u002Dprototype\u0022,\u0022CAMPAIGN_GROUP\u0022:\u0022campaign\u0022,\u0022DESK_GROUP\u0022:\u0022desk\u0022,\u0022CREW_MEMBER_ROLE_GROUP\u0022:\u0022crew\u002Dmember\u002Drole\u0022,\u0022BOOKING_CREATED_AT_HOUR_GROUP\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022AVAILABILITY_START_AT_YEAR_GROUP\u0022:\u0022availability\u002Dstart\u002Dat\u002Dyear\u0022,\u0022BOOKING_CREATED_AT_DAY_GROUP\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dday\u0022,\u0022BOOKING_RESOURCE_GROUP\u0022:\u0022booking\u002Dresource\u0022,\u0022PAYMENT_ACCRUAL_STATUS_GROUP\u0022:\u0022accrual\u002Dstatus\u0022,\u0022BOOKING_GROUP\u0022:\u0022booking\u0022,\u0022PAYMENT_TYPE_GROUP\u0022:\u0022payment\u002Dtype\u0022,\u0022COMPANY_CURRENCY_GROUP\u0022:\u0022company\u002Dcurrency\u0022,\u0022DISPUTE_STATUS_GROUP\u0022:\u0022dispute\u002Dstatus\u0022,\u0022INVOICE_SHEET_RELATIONSHIP_GROUP\u0022:\u0022invoice\u002Dsheet\u002Drelationship\u0022,\u0022BOOKING_CREATED_AT_YEAR_GROUP\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022BOOKING_CREATED_AT_WEEKDAY_GROUP\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dweekday\u0022,\u0022PICKUP_GROUP\u0022:\u0022pickup\u0022,\u0022LINE_ITEM_CREATED_AT_YEAR_GROUP\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022LINE_ITEM_CREATED_AT_WEEKDAY_GROUP\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dweekday\u0022}");
      window.slipstream['reports.allFilters'] = JSON.parse("{\u0022LINE_ITEM_CREATED_AT_YEAR_FILTER_TYPE\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022PAYMENT_TYPE_FILTER_TYPE\u0022:\u0022payment\u002Dtype\u0022,\u0022BOOKING_CREATED_AT_WEEKDAY_FILTER_TYPE\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dweek\u002Dday\u0022,\u0022TOTAL_SHEET_FILTER_TYPE\u0022:\u0022total\u002Dsheet\u0022,\u0022ONLINE_BOOKING_REFERENCE_FILTER_TYPE\u0022:\u0022online\u002Dbooking\u002Dreference\u0022,\u0022HEADLINE_FILTER_TYPE\u0022:\u0022headline\u0022,\u0022AGENT_FILTER_TYPE\u0022:\u0022agent\u0022,\u0022AFFILIATE_FILTER_TYPE\u0022:\u0022affiliate\u0022,\u0022LINE_ITEM_CREATED_AT_WEEKDAY_FILTER_TYPE\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dweek\u002Dday\u0022,\u0022ITEM_FILTER_TYPE\u0022:\u0022item\u0022,\u0022PROCESSOR_BASED_TYPE_FILTER_TYPE\u0022:\u0022credit\u002Dcard\u002Dtype\u0022,\u0022LINE_ITEM_CREATED_AT_HOUR_FILTER_TYPE\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022BOOKING_CREATED_AT_DAY_FILTER_TYPE\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dday\u0022,\u0022CUSTOMER_TYPE_FILTER_TYPE\u0022:\u0022customer\u002Dtype\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_YEAR_FILTER_TYPE\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022INVOICE_SHEET_FILTER_TYPE\u0022:\u0022invoice\u002Dsheet\u0022,\u0022USER_FILTER_TYPE\u0022:\u0022user\u0022,\u0022BOOKING_CREATED_AT_WEEK_FILTER_TYPE\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022AVAILABILITY_START_AT_YEAR_FILTER_TYPE\u0022:\u0022availability\u002Dstart\u002Dat\u002Dyear\u0022,\u0022STORED_VALUE_TYPE_FILTER_TYPE\u0022:\u0022stored\u002Dvalue\u002Dtype\u0022,\u0022CHECKIN_STATUS_FILTER_TYPE\u0022:\u0022checkin\u002Dstatus\u0022,\u0022AVAILABILITY_START_AT_DAY_FILTER_TYPE\u0022:\u0022availability\u002Dstart\u002Dat\u002Dday\u0022,\u0022CANCELLED_STATUS_FILTER_TYPE\u0022:\u0022cancelled\u002Dstatus\u0022,\u0022PAYMENT_ACCRUAL_STATUS_FILTER_TYPE\u0022:\u0022accrual\u002Dstatus\u0022,\u0022AVAILABILITY_START_AT_WEEK_FILTER_TYPE\u0022:\u0022availability\u002Dstart\u002Dat\u002Dweek\u0022,\u0022CUSTOM_FIELDS_FILTER_TYPE\u0022:\u0022custom\u002Dfields\u0022,\u0022CUSTOMER_PROTOTYPE_FILTER_TYPE\u0022:\u0022customer\u002Dprototype\u0022,\u0022ROUTE_FILTER_TYPE\u0022:\u0022route\u0022,\u0022BOOKING_NOTE_FILTER_TYPE\u0022:\u0022booking\u002Dnote\u0022,\u0022AVAILABILITY_FILTER_TYPE\u0022:\u0022availability\u0022,\u0022DESK_FILTER_TYPE\u0022:\u0022desk\u0022,\u0022VOUCHER_NUMBER_FILTER_TYPE\u0022:\u0022voucher\u002Dnumber\u0022,\u0022CUSTOMER_RESOURCE_USE_FILTER_TYPE\u0022:\u0022customer\u002Dresource\u002Duse\u0022,\u0022DISPUTE_STATUS_FILTER_TYPE\u0022:\u0022dispute\u002Dstatus\u0022,\u0022CUSTOM_FIELD_VALUE_FILTER_TYPE\u0022:\u0022custom\u002Dfield\u002Dvalue\u0022,\u0022BOOKING_CREATED_AT_HOUR_FILTER_TYPE\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022BOOKING_CREATED_AT_YEAR_FILTER_TYPE\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022CHARTER_FILTER_TYPE\u0022:\u0022company\u0022,\u0022BOOKING_CREATED_AT_MONTH_FILTER_TYPE\u0022:\u0022booking\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022BOOKING_TYPE_FILTER_TYPE\u0022:\u0022booking\u002Dtype\u0022,\u0022BOOKING_FILTER_TYPE\u0022:\u0022booking\u0022,\u0022CREW_MEMBER_ROLE_FILTER_TYPE\u0022:\u0022crew\u002Dmember\u002Drole\u0022,\u0022LINE_ITEM_CREATED_AT_DAY_FILTER_TYPE\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dday\u0022,\u0022SOURCE_FILTER_TYPE\u0022:\u0022source\u0022,\u0022PICKUP_FILTER_TYPE\u0022:\u0022pickup\u0022,\u0022PAYMENT_COLLECTED_FILTER_TYPE\u0022:\u0022payment\u002Dcollected\u0022,\u0022ORIGINAL_USER_FILTER_TYPE\u0022:\u0022original\u002Duser\u0022,\u0022LINE_ITEM_CREATED_AT_MONTH_FILTER_TYPE\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022AVAILABILITY_NOTE_FILTER_TYPE\u0022:\u0022note\u0022,\u0022AVAILABILITY_START_AT_MONTH_FILTER_TYPE\u0022:\u0022availability\u002Dstart\u002Dat\u002Dmonth\u0022,\u0022CONTACT_LANGUAGE_FILTER_TYPE\u0022:\u0022contact\u002Dlanguage\u0022,\u0022LODGING_FILTER_TYPE\u0022:\u0022lodging\u0022,\u0022BOOKING_ORIGINAL_CREATED_AT_WEEKDAY_FILTER_TYPE\u0022:\u0022booking\u002Doriginal\u002Dcreated\u002Dat\u002Dweek\u002Dday\u0022,\u0022CREW_MEMBER_USER_FILTER_TYPE\u0022:\u0022crew\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_MONTH_FILTER_TYPE\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022CUSTOM_FIELD_FILTER_TYPE\u0022:\u0022custom\u002Dfield\u0022,\u0022PAYMENT_USER_FILTER_TYPE\u0022:\u0022payment\u002Duser\u0022,\u0022AFFILIATE_PAYMENT_TYPE_FILTER_TYPE\u0022:\u0022affiliate\u002Dpayment\u002Dtype\u0022,\u0022AVAILABILITY_START_AT_WEEKDAY_FILTER_TYPE\u0022:\u0022availability\u002Dstart\u002Dat\u002Dweek\u002Dday\u0022,\u0022BLOCKABLE_FILTER_TYPE\u0022:\u0022blockable\u0022,\u0022PAYMENT_RECOGNIZED_FILTER_TYPE\u0022:\u0022payment\u002Drecognized\u0022,\u0022PAID_STATUS_FILTER_TYPE\u0022:\u0022paid\u002Dstatus\u0022,\u0022BOOKING_RESOURCE_USE_FILTER_TYPE\u0022:\u0022resource\u002Duse\u0022,\u0022LINE_ITEM_CREATED_AT_WEEK_FILTER_TYPE\u0022:\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022INVOICE_SHEET_RELATIONSHIP_FILTER_TYPE\u0022:\u0022invoice\u002Dsheet\u002Drelationship\u0022,\u0022CAMPAIGN_FILTER_TYPE\u0022:\u0022campaign\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_DAY_FILTER_TYPE\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dday\u0022,\u0022CUSTOM_FIELD_VALUE_MODEL_FILTER_TYPE\u0022:\u0022custom\u002Dfield\u002Dvalue\u002Dmodel\u0022,\u0022PRIVATE_HEADLINE_FILTER_TYPE\u0022:\u0022headline\u002Dprivate\u0022,\u0022REBOOKED_FILTER_TYPE\u0022:\u0022rebooked\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_WEEKDAY_FILTER_TYPE\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dweek\u002Dday\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_WEEK_FILTER_TYPE\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022LINE_ITEM_DESCRIPTION_FILTER_TYPE\u0022:\u0022line\u002Ditem\u002Ddescription\u0022,\u0022COMPANY_CURRENCY_FILTER_TYPE\u0022:\u0022company\u002Dcurrency\u0022,\u0022PAYMENT_OR_REFUND_CREATED_AT_HOUR_FILTER_TYPE\u0022:\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022AVAILABILITY_START_AT_HOUR_FILTER_TYPE\u0022:\u0022availability\u002Dstart\u002Dat\u002Dhour\u0022}");
      window.slipstream['reports.allDateRanges'] = JSON.parse("{\u0022REMAINING_THIS_YEAR_DATE_RANGE\u0022:\u0022remaining\u002Dthis\u002Dyear\u0022,\u0022THIS_QUARTER_TO_DATE_DATE_RANGE\u0022:\u0022quarter\u002Dto\u002Ddate\u0022,\u0022THIS_WEEK_TO_DATE_DATE_RANGE\u0022:\u0022week\u002Dto\u002Ddate\u0022,\u0022LAST_MONTH_DATE_RANGE\u0022:\u0022last\u002Dmonth\u0022,\u0022NEXT_THIRTY_DAYS_DATE_RANGE\u0022:\u0022next\u002D30\u002Ddays\u0022,\u0022LAST_QUARTER_TO_DATE_DATE_RANGE\u0022:\u0022last\u002Dquarter\u002Dto\u002Ddate\u0022,\u0022THIS_QUARTER_DATE_RANGE\u0022:\u0022this\u002Dquarter\u0022,\u0022THIS_WEEK_DATE_RANGE\u0022:\u0022this\u002Dweek\u0022,\u0022LAST_WEEK_TO_DATE_DATE_RANGE\u0022:\u0022last\u002Dweek\u002Dto\u002Ddate\u0022,\u0022THIS_YEAR_DATE_RANGE\u0022:\u0022this\u002Dyear\u0022,\u0022LAST_QUARTER_DATE_RANGE\u0022:\u0022last\u002Dquarter\u0022,\u0022NEXT_SEVEN_DAYS_DATE_RANGE\u0022:\u0022next\u002D7\u002Ddays\u0022,\u0022NEXT_YEAR_DATE_RANGE\u0022:\u0022next\u002Dyear\u0022,\u0022LAST_YEAR_TO_DATE_DATE_RANGE\u0022:\u0022last\u002Dyear\u002Dto\u002Ddate\u0022,\u0022NEXT_MONTH_DATE_RANGE\u0022:\u0022next\u002Dmonth\u0022,\u0022YESTERDAY_DATE_RANGE\u0022:\u0022yesterday\u0022,\u0022THIS_YEAR_TO_DATE_DATE_RANGE\u0022:\u0022year\u002Dto\u002Ddate\u0022,\u0022THIS_MONTH_DATE_RANGE\u0022:\u0022this\u002Dmonth\u0022,\u0022LAST_THIRTY_DAYS_DATE_RANGE\u0022:\u0022last\u002D30\u002Ddays\u0022,\u0022TOMORROW_DATE_RANGE\u0022:\u0022tomorrow\u0022,\u0022LAST_WEEK_DATE_RANGE\u0022:\u0022last\u002Dweek\u0022,\u0022LAST_SEVEN_DAYS_DATE_RANGE\u0022:\u0022last\u002D7\u002Ddays\u0022,\u0022NEXT_WEEK_DATE_RANGE\u0022:\u0022next\u002Dweek\u0022,\u0022TODAY_DATE_RANGE\u0022:\u0022today\u0022,\u0022THIS_MONTH_TO_DATE_DATE_RANGE\u0022:\u0022month\u002Dto\u002Ddate\u0022,\u0022LAST_YEAR_DATE_RANGE\u0022:\u0022last\u002Dyear\u0022,\u0022LAST_MONTH_TO_DATE_DATE_RANGE\u0022:\u0022last\u002Dmonth\u002Dto\u002Ddate\u0022}");

      window.slipstream['reports.validColumns'] = JSON.parse("{\u0022Customer\u0022:[[\u0022customer\u002Dtype\u0022,false,true],[\u0022customer\u002Dprototype\u0022,false,true],[\u0022checkin\u002Dstatus\u0022,false,true],[\u0022customer\u002Dcount\u0022,true,true],[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,false,true],[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true]],\u0022LineItem\u0022:[[\u0022created\u002Dat\u0022,false,true],[\u0022created\u002Dat\u002Dtime\u0022,false,true],[\u0022created\u002Dat\u002Ddate\u0022,false,true],[\u0022line\u002Ditem\u002Ddescription\u0022,false,true],[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,false,true],[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true]],\u0022Booking\u0022:[[\u0022booking\u002Did\u0022,false,true],[\u0022booking\u002Dcount\u0022,true,false],[\u0022is\u002Dcancelled\u0022,false,true],[\u0022cancelled\u002Dcount\u0022,true,false],[\u0022created\u002Dat\u0022,false,true],[\u0022created\u002Dat\u002Dtime\u0022,false,true],[\u0022created\u002Dat\u002Ddate\u0022,false,true],[\u0022originally\u002Dbooked\u002Dby\u0022,false,true],[\u0022last\u002Drebooked\u002Dat\u0022,false,true],[\u0022last\u002Drebooked\u002Dat\u002Ddate\u0022,false,true],[\u0022last\u002Drebooked\u002Dat\u002Dtime\u0022,false,true],[\u0022booked\u002Dby\u0022,false,true],[\u0022item\u002Did\u0022,false,true],[\u0022company\u0022,false,true],[\u0022item\u002Dname\u0022,false,true],[\u0022availability\u002Ddatetime\u0022,false,true],[\u0022availability\u002Dstart\u002Dtime\u0022,false,true],[\u0022availability\u002Dstart\u002Ddate\u0022,false,true],[\u0022availability\u002Dend\u002Dtime\u0022,false,true],[\u0022availability\u002Dend\u002Ddate\u0022,false,true],[\u0022availability\u002Did\u0022,false,true],[\u0022day\u002Dof\u002Dweek\u0022,false,true],[\u0022availability\u002Dpublic\u002Dheadline\u0022,false,true],[\u0022availability\u002Dprivate\u002Dheadline\u0022,false,true],[\u0022contact\u002Dname\u0022,false,true],[\u0022contact\u002Dphone\u0022,false,true],[\u0022contact\u002Dlanguage\u0022,false,true],[\u0022sms\u002Dsubscribed\u002Dcount\u0022,true,false],[\u0022is\u002Dsubscribed\u002Dto\u002Dsms\u0022,false,true],[\u0022contact\u002Demail\u0022,false,true],[\u0022email\u002Dsubscribed\u002Dcount\u0022,true,false],[\u0022is\u002Dsubscribed\u002Dto\u002Demail\u0022,false,true],[\u0022booking\u002Dnotes\u0022,false,true],[\u0022customer\u002Dcount\u0022,true,true],[\u0022online\u002Dbooking\u002Dreference\u0022,false,true],[\u0022lodging\u0022,false,true],[\u0022room\u002Dnumber\u0022,false,true],[\u0022pickup\u0022,false,true],[\u0022stop\u002Dtime\u0022,false,true],[\u0022route\u0022,false,true],[\u0022total\u002Dsheet\u0022,false,true],[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022net\u002Dcharter\u002Drevenue\u0022,true,true],[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,true,true],[\u0022receipt\u002Dbooking\u002Dfee\u0022,true,true],[\u0022amount\u002Ddue\u0022,true,true],[\u0022paid\u002Dstatus\u0022,false,true],[\u0022affiliate\u0022,false,true],[\u0022voucher\u002Dnumber\u0022,false,true],[\u0022agent\u0022,false,true],[\u0022desk\u0022,false,true],[\u0022invoice\u002Dsheet\u0022,false,true],[\u0022invoice\u002Dsheet\u002Ddescription\u0022,false,true],[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true],[\u0022is\u002Dinvoiced\u0022,false,true],[\u0022invoiced\u002Dcount\u0022,true,false],[\u0022invoiceable\u002Dto\u002Daffiliate\u0022,true,true],[\u0022invoiced\u002Dto\u002Daffiliate\u0022,true,true],[\u0022invoiceable\u002Dto\u002Dcharter\u0022,true,true],[\u0022invoiced\u002Dto\u002Dcharter\u0022,true,true]],\u0022CustomFieldValue\u0022:[[\u0022custom\u002Dfield\u002Dvalue\u0022,false,true],[\u0022use\u002Dcount\u0022,true,true],[\u0022display\u002Dcount\u0022,true,false],[\u0022total\u002Dcost\u002Dprice\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022total\u002Dcost\u002Dtax\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u0022,true,true],[\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022,true,false],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022,true,true],[\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022,true,true],[\u0022receipt\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022,false,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022receipt\u002Dcollected\u002Dby\u002Daffiliate\u002Dnet\u0022,false,true],[\u0022invoice\u002Dcost\u002Dprice\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtax\u0022,true,true],[\u0022invoice\u002Dcost\u002Dtotal\u0022,true,true]],\u0022Payment\u0022:[[\u0022payment\u002Dor\u002Drefund\u0022,false,true],[\u0022payment\u002Dor\u002Drefund\u002Did\u0022,false,true],[\u0022created\u002Dat\u0022,false,true],[\u0022created\u002Dat\u002Dtime\u0022,false,true],[\u0022created\u002Dat\u002Ddate\u0022,false,true],[\u0022payment\u002Duser\u0022,false,true],[\u0022payment\u002Dnote\u002Dlabel\u0022,false,true],[\u0022payment\u002Dnote\u0022,false,true],[\u0022payment\u002Dtype\u0022,false,true],[\u0022affiliate\u002Dpayment\u002Dtype\u0022,false,true],[\u0022credit\u002Dcard\u002Dtype\u0022,false,true],[\u0022credit\u002Dcard\u002Dlast\u002Dfour\u0022,false,true],[\u0022credit\u002Dcard\u002Dpostal\u002Dcode\u0022,false,true],[\u0022stored\u002Dvalue\u002Dcard\u002Dtype\u0022,false,true],[\u0022stored\u002Dvalue\u002Dcard\u002Dnumber\u0022,false,true],[\u0022dispute\u002Dstatus\u0022,false,true],[\u0022payment\u002Dand\u002Drefund\u002Dgross\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dnet\u0022,true,true],[\u0022payment\u002Dinitial\u002Dgross\u0022,true,true],[\u0022payment\u002Dinitial\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022payment\u002Dinitial\u002Dnet\u0022,true,true],[\u0022refund\u002Dgross\u0022,true,true],[\u0022refund\u002Dprocessing\u002Dfee\u0022,true,true],[\u0022refund\u002Dnet\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dprice\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dtax\u002Dby\u002Dtype\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dtotal\u002Dtax\u0022,true,true],[\u0022payment\u002Dand\u002Drefund\u002Dcount\u0022,true,false],[\u0022payment\u002Dcount\u0022,true,false],[\u0022refund\u002Dcount\u0022,true,false]]}");
      window.slipstream['reports.validFilters'] = JSON.parse("{\u0022all_partners\u0022:{\u0022Customer\u0022:[],\u0022LineItem\u0022:[],\u0022Booking\u0022:[\u0022agent\u0022,\u0022desk\u0022,\u0022original\u002Duser\u0022],\u0022CustomFieldValue\u0022:[],\u0022Payment\u0022:[]},\u0022universal\u0022:{\u0022Customer\u0022:[],\u0022LineItem\u0022:[],\u0022Booking\u0022:[\u0022cancelled\u002Dstatus\u0022,\u0022paid\u002Dstatus\u0022,\u0022source\u0022,\u0022availability\u002Dstart\u002Dat\u002Dweek\u002Dday\u0022,\u0022booking\u002Dcreated\u002Dat\u002Dweek\u002Dday\u0022,\u0022booking\u002Doriginal\u002Dcreated\u002Dat\u002Dweek\u002Dday\u0022,\u0022company\u0022,\u0022invoice\u002Dsheet\u002Drelationship\u0022],\u0022CustomFieldValue\u0022:[],\u0022Payment\u0022:[\u0022credit\u002Dcard\u002Dtype\u0022,\u0022dispute\u002Dstatus\u0022,\u0022payment\u002Dcollected\u0022,\u0022payment\u002Drecognized\u0022,\u0022accrual\u002Dstatus\u0022,\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dweek\u002Dday\u0022]},\u0022company\u0022:{\u0022Customer\u0022:[\u0022checkin\u002Dstatus\u0022,\u0022custom\u002Dfields\u0022,\u0022customer\u002Dtype\u0022],\u0022LineItem\u0022:[\u0022line\u002Ditem\u002Ddescription\u0022],\u0022Booking\u0022:[\u0022headline\u0022,\u0022headline\u002Dprivate\u0022,\u0022item\u0022,\u0022affiliate\u0022,\u0022total\u002Dsheet\u0022,\u0022invoice\u002Dsheet\u0022,\u0022resource\u002Duse\u0022,\u0022customer\u002Dresource\u002Duse\u0022,\u0022checkin\u002Dstatus\u0022,\u0022custom\u002Dfields\u0022,\u0022customer\u002Dtype\u0022,\u0022crew\u0022,\u0022crew\u002Dmember\u002Drole\u0022,\u0022lodging\u0022,\u0022route\u0022,\u0022pickup\u0022,\u0022line\u002Ditem\u002Ddescription\u0022,\u0022user\u0022,\u0022original\u002Duser\u0022,\u0022online\u002Dbooking\u002Dreference\u0022,\u0022booking\u002Dnote\u0022,\u0022note\u0022,\u0022contact\u002Dlanguage\u0022],\u0022CustomFieldValue\u0022:[\u0022custom\u002Dfields\u0022],\u0022Payment\u0022:[\u0022payment\u002Duser\u0022,\u0022payment\u002Dtype\u0022]},\u0022partner\u0022:{\u0022Customer\u0022:[\u0022custom\u002Dfields\u0022],\u0022LineItem\u0022:[],\u0022Booking\u0022:[\u0022item\u0022,\u0022custom\u002Dfields\u0022],\u0022CustomFieldValue\u0022:[\u0022custom\u002Dfields\u0022],\u0022Payment\u0022:[\u0022payment\u002Dtype\u0022]}}");
      window.slipstream['reports.validGroups'] = JSON.parse("{\u0022Customer\u0022:[\u0022booking\u0022,\u0022customer\u002Dtype\u0022,\u0022customer\u002Dprototype\u0022,\u0022checkin\u002Dstatus\u0022],\u0022LineItem\u0022:[\u0022booking\u0022,\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dday\u0022,\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022line\u002Ditem\u002Dcreated\u002Dat\u002Dweekday\u0022],\u0022Booking\u0022:[\u0022company\u0022,\u0022affiliate\u0022,\u0022availability\u0022,\u0022agent\u0022,\u0022desk\u0022,\u0022item\u0022,\u0022lodging\u0022,\u0022pickup\u0022,\u0022user\u0022,\u0022original\u002Duser\u0022,\u0022source\u0022,\u0022paid\u002Dstatus\u0022,\u0022invoice\u002Dsheet\u002Drelationship\u0022,\u0022crew\u002Dmember\u0022,\u0022crew\u002Dmember\u002Drole\u0022,\u0022booking\u002Dresource\u0022,\u0022customer\u002Dresource\u0022,\u0022company\u002Dcurrency\u0022,\u0022booking\u002Dcheckin\u002Dstatus\u0022,\u0022booking\u002Dcreated\u002Dat\u002Dday\u0022,\u0022booking\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022booking\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022booking\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022booking\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022booking\u002Dcreated\u002Dat\u002Dweekday\u0022,\u0022availability\u002Dstart\u002Dat\u002Dday\u0022,\u0022availability\u002Dstart\u002Dat\u002Dweek\u0022,\u0022availability\u002Dstart\u002Dat\u002Dmonth\u0022,\u0022availability\u002Dstart\u002Dat\u002Dyear\u0022,\u0022availability\u002Dstart\u002Dat\u002Dhour\u0022,\u0022availability\u002Dstart\u002Dat\u002Dweekday\u0022,\u0022invoice\u002Dsheet\u0022,\u0022total\u002Dsheet\u0022,\u0022contact\u002Dlanguage\u0022],\u0022CustomFieldValue\u0022:[\u0022booking\u0022,\u0022custom\u002Dfield\u0022,\u0022custom\u002Dfield\u002Dvalue\u0022,\u0022campaign\u0022],\u0022Payment\u0022:[\u0022payment\u002Dtype\u0022,\u0022credit\u002Dcard\u002Dtype\u0022,\u0022payment\u002Duser\u0022,\u0022booking\u0022,\u0022dispute\u002Dstatus\u0022,\u0022accrual\u002Dstatus\u0022,\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dday\u0022,\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dweek\u0022,\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dmonth\u0022,\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dyear\u0022,\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dhour\u0022,\u0022payment\u002Dor\u002Drefund\u002Dcreated\u002Dat\u002Dweekday\u0022]}");
      window.slipstream['reports.prohibitedGroups'] = JSON.parse("{\u0022Customer\u0022:[\u0022booking\u002Dcheckin\u002Dstatus\u0022],\u0022LineItem\u0022:[],\u0022Booking\u0022:[],\u0022CustomFieldValue\u0022:[\u0022booking\u002Dcheckin\u002Dstatus\u0022],\u0022Payment\u0022:[\u0022user\u0022,\u0022original\u002Duser\u0022]}");
      window.slipstream['reports.prohibitedHigherGroups'] = JSON.parse("{\u0022Customer\u0022:{\u0022CustomFieldValue\u0022:[]},\u0022Booking\u0022:{\u0022Customer\u0022:[],\u0022CustomFieldValue\u0022:[]}}");
      window.slipstream['reports.alwaysUnsoundGroupings'] = JSON.parse("[\u0022booking\u002Dresource\u0022,\u0022crew\u002Dmember\u0022,\u0022crew\u002Dmember\u002Drole\u0022,\u0022booking\u002Dcheckin\u002Dstatus\u0022,\u0022customer\u002Dresource\u0022]");

      window.slipstream['reports.groupPermissions'] = JSON.parse("{\u0022custom\u002Dfield\u002Dvalue\u0022:\u0022can\u002Dview\u002Dprivate\u002Dcustom\u002Dfields\u0022,\u0022paid\u002Dstatus\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022custom\u002Dfield\u0022:\u0022can\u002Dview\u002Dprivate\u002Dcustom\u002Dfields\u0022,\u0022checkin\u002Dstatus\u0022:\u0022can\u002Dlist\u002Dcheckin\u002Dstatuses\u0022}");
      window.slipstream['reports.columnPermissions'] = JSON.parse("{\u0022availability\u002Dprivate\u002Dheadline\u0022:\u0022can\u002Dview\u002Davailability\u002Dprivate\u002Dheadline\u0022,\u0022line\u002Ditem\u002Ddescription\u0022:\u0022can\u002Dlist\u002Dline\u002Ditems\u0022,\u0022total\u002Dcost\u002Dtax\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022total\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dprice\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtax\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022amount\u002Ddue\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022booking\u002Dnotes\u0022:\u0022can\u002Dview\u002Dbooking\u002Dnote\u0022,\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtotal\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dnet\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022invoice\u002Dsheet\u0022:\u0022can\u002Dlist\u002Dinvoice\u002Dsheets\u0022,\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022total\u002Dcost\u002Dprice\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022total\u002Dcost\u002Dtotal\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022total\u002Dcost\u002Dtotal\u002Dpercentage\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022receipt\u002Dbooking\u002Dfee\u0022:\u0022can\u002Dadmin\u0022,\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dprice\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022custom\u002Dfield\u0022:\u0022can\u002Dview\u002Dprivate\u002Dcustom\u002Dfields\u0022,\u0022collected\u002Dtotal\u002Dcost\u002Dtotal\u002Dpercentage\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022receipt\u002Dcollected\u002Dby\u002Dcharter\u002Dprocessing\u002Dfee\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022receipt\u002Dnet\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022collected\u002Dby\u002Dcharter\u002Dtotal\u002Dcost\u002Dtotal\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022checkin\u002Dstatus\u0022:\u0022can\u002Dlist\u002Dcheckin\u002Dstatuses\u0022,\u0022total\u002Dsheet\u0022:\u0022can\u002Dlist\u002Dtotal\u002Dsheets\u0022,\u0022collected\u002Dtotal\u002Dcost\u002Dtax\u002Dby\u002Dtype\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022collected\u002Dtotal\u002Dcost\u002Dprice\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022collected\u002Dby\u002Daffiliate\u002Dtotal\u002Dcost\u002Dtax\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022net\u002Dcharter\u002Drevenue\u0022:\u0022can\u002Dview\u002Damounts\u0022,\u0022custom\u002Dfield\u002Dvalue\u0022:\u0022can\u002Dview\u002Dprivate\u002Dcustom\u002Dfields\u0022,\u0022receipt\u002Dprocessing\u002Dfee\u0022:\u0022can\u002Dview\u002Damounts\u0022}");
      window.slipstream['reports.filterPermissions'] = JSON.parse("{\u0022paid\u002Dstatus\u0022:\u0022can\u002Dview\u002Damounts\u0022}");

      window.slipstream['resourceUse.options'] = JSON.parse("[{\u0022display_text\u0022:\u0022Create uses, check overuse (default)\u0022,\u0022key\u0022:\u0022create\u002Dobserve\u0022,\u0022value\u0022:\u0022false\u002Dfalse\u0022},{\u0022display_text\u0022:\u0022Create uses, don\u0027t check overuse\u0022,\u0022key\u0022:\u0022create\u002Dignore\u0022,\u0022value\u0022:\u0022false\u002Dtrue\u0022},{\u0022display_text\u0022:\u0022Don\u0027t create uses, check overuse\u0022,\u0022key\u0022:\u0022skip\u002Dobserve\u0022,\u0022value\u0022:\u0022true\u002Dfalse\u0022}]");
      window.slipstream['scheduleEntryRule.typeChoices'] = JSON.parse("[[\u0022booking\u0022,\u0022Booking date\u0022],[\u0022availability\u0022,\u0022Availability date\u0022],[\u0022dow\u002Dbooking\u0022,\u0022Booking day of week\u0022],[\u0022dow\u002Davailability\u0022,\u0022Availability day of week\u0022]]");
      window.slipstream['campaignValidityRules.allTypes'] = JSON.parse("{\u0022DAYS_BEFORE_AVAILABILITY_MIDNIGHT_TYPE\u0022:\u0022before\u002Dava\u002Dmidnight\u0022,\u0022DATE_RANGE_FOR_AVAILABILITY_TYPE\u0022:\u0022range\u002Dfor\u002Davailability\u0022,\u0022DAYS_AFTER_CODE_CREATION_FOR_BOOKING_TYPE\u0022:\u0022code\u002Dexp\u002Dbooking\u0022,\u0022DAYS_AFTER_CODE_CREATION_FOR_AVAILABILITY_TYPE\u0022:\u0022code\u002Dexp\u002Davailability\u0022,\u0022DATE_RANGE_FOR_BOOKING_TYPE\u0022:\u0022range\u002Dfor\u002Dbooking\u0022}");

      window.slipstream.processorVerificationRequirements = JSON.parse("{\u0022stripe\u0022:{\u0022BE\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022FR\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022DK\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022DE\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022HK\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.verification.document\u0022]}},\u0022FI\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022NL\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022PT\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022NO\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022NZ\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022LU\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022CH\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022CA\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.verification.document\u0022]}},\u0022IT\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022AU\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022AT\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022IE\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.state\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022ES\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022US\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.ssn_last_4\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.ssn_last_4\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.verification.document\u0022]}},\u0022SG\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.verification.document\u0022]}},\u0022MX\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.personal_address.state\u0022,\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.address.state\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_id_number\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022SE\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}},\u0022GB\u0022:{\u0022company\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.additional_owners\u0022,\u0022legal_entity.address.city\u0022,\u0022legal_entity.address.line1\u0022,\u0022legal_entity.address.postal_code\u0022,\u0022legal_entity.business_name\u0022,\u0022legal_entity.business_tax_id\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.personal_address.city\u0022,\u0022legal_entity.personal_address.line1\u0022,\u0022legal_entity.personal_address.postal_code\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]},\u0022individual\u0022:{\u0022minimum\u0022:[\u0022external_account\u0022,\u0022legal_entity.dob.day\u0022,\u0022legal_entity.dob.month\u0022,\u0022legal_entity.dob.year\u0022,\u0022legal_entity.first_name\u0022,\u0022legal_entity.last_name\u0022,\u0022legal_entity.type\u0022,\u0022tos_acceptance.date\u0022,\u0022tos_acceptance.ip\u0022],\u0022additional\u0022:[\u0022legal_entity.verification.document\u0022]}}}}");
      window.slipstream.processorVerificationRequirementToCompanyTaxInformationFormField =
        JSON.parse("{\u0022stripe\u0022:{\u0022tos_acceptance.ip\u0022:null,\u0022legal_entity.personal_id_number\u0022:\u0022personal_id_number\u0022,\u0022legal_entity.first_name\u0022:\u0022first_name\u0022,\u0022legal_entity.additional_owners\u0022:\u0022additional_owners_count\u0022,\u0022legal_entity.verification.document\u0022:null,\u0022legal_entity.dob.year\u0022:\u0022birth_date\u0022,\u0022tos_acceptance.date\u0022:null,\u0022legal_entity.dob.day\u0022:\u0022birth_date\u0022,\u0022legal_entity.ssn_last_4\u0022:\u0022ssn_last_4\u0022,\u0022legal_entity.business_name\u0022:\u0022business_name\u0022,\u0022legal_entity.dob.month\u0022:\u0022birth_date\u0022,\u0022legal_entity.personal_address.state\u0022:\u0022personal_province\u0022,\u0022legal_entity.last_name\u0022:\u0022last_name\u0022,\u0022legal_entity.personal_address.postal_code\u0022:\u0022personal_postal_code\u0022,\u0022external_account\u0022:null,\u0022legal_entity.type\u0022:\u0022entity_type\u0022,\u0022legal_entity.personal_address.line1\u0022:\u0022personal_street\u0022,\u0022legal_entity.address.state\u0022:\u0022billing_province\u0022,\u0022legal_entity.address.postal_code\u0022:\u0022billing_postal_code\u0022,\u0022legal_entity.address.city\u0022:\u0022billing_city\u0022,\u0022legal_entity.personal_address.city\u0022:\u0022personal_city\u0022,\u0022legal_entity.business_tax_id\u0022:\u0022tax_identifier\u0022,\u0022legal_entity.address.line1\u0022:\u0022billing_street\u0022}}");
      window.slipstream.processorSupportedBankAccountCountries =
        JSON.parse("{\u0022stripe\u0022:{\u0022BE\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022FR\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022DK\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022DE\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022HK\u0022:{\u0022hkd\u0022:[\u0022HK\u0022]},\u0022FI\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022NL\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022PT\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022NO\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022NZ\u0022:{\u0022nzd\u0022:[\u0022NZ\u0022]},\u0022LU\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022CH\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022CA\u0022:{\u0022usd\u0022:[\u0022US\u0022,\u0022CA\u0022],\u0022cad\u0022:[\u0022CA\u0022]},\u0022IT\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022AU\u0022:{\u0022aud\u0022:[\u0022AU\u0022]},\u0022AT\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022IE\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022ES\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022US\u0022:{\u0022usd\u0022:[\u0022US\u0022]},\u0022SG\u0022:{\u0022sgd\u0022:[\u0022SG\u0022]},\u0022MX\u0022:{\u0022mxn\u0022:[\u0022MX\u0022]},\u0022SE\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]},\u0022GB\u0022:{\u0022usd\u0022:[\u0022US\u0022],\u0022chf\u0022:[\u0022CH\u0022],\u0022nok\u0022:[\u0022NO\u0022],\u0022gbp\u0022:[\u0022GB\u0022],\u0022sek\u0022:[\u0022SE\u0022],\u0022dkk\u0022:[\u0022DK\u0022],\u0022eur\u0022:[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022GB\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022]}}}");
      window.slipstream.processorBankAccountVerificationEnabledCountries =
        JSON.parse("{\u0022stripe\u0022:{\u0022BE\u0022:[],\u0022FR\u0022:[],\u0022DK\u0022:[],\u0022DE\u0022:[],\u0022HK\u0022:[],\u0022FI\u0022:[],\u0022NL\u0022:[],\u0022PT\u0022:[],\u0022NO\u0022:[],\u0022NZ\u0022:[],\u0022LU\u0022:[],\u0022CH\u0022:[],\u0022CA\u0022:[\u0022US\u0022],\u0022IT\u0022:[],\u0022AU\u0022:[],\u0022AT\u0022:[],\u0022IE\u0022:[],\u0022ES\u0022:[],\u0022US\u0022:[\u0022US\u0022],\u0022SG\u0022:[],\u0022MX\u0022:[],\u0022SE\u0022:[],\u0022GB\u0022:[]}}");

      window.slipstream.processorSupportedCurrencies = JSON.parse("{\u0022stripe\u0022:{\u0022BE\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022FR\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022DK\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022DE\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022HK\u0022:[\u0022hkd\u0022],\u0022FI\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022NL\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022PT\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022NO\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022NZ\u0022:[\u0022nzd\u0022],\u0022LU\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022CH\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022CA\u0022:[\u0022usd\u0022,\u0022cad\u0022],\u0022IT\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022AU\u0022:[\u0022aud\u0022],\u0022AT\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022IE\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022ES\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022US\u0022:[\u0022usd\u0022],\u0022SG\u0022:[\u0022sgd\u0022],\u0022MX\u0022:[\u0022mxn\u0022],\u0022SE\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022],\u0022GB\u0022:[\u0022usd\u0022,\u0022chf\u0022,\u0022nok\u0022,\u0022gbp\u0022,\u0022sek\u0022,\u0022dkk\u0022,\u0022eur\u0022]}}");
      window.slipstream.processorMinimumChargeAmounts = JSON.parse("{\u0022stripe\u0022:{\u0022usd\u0022:50,\u0022aud\u0022:50,\u0022chf\u0022:50,\u0022nok\u0022:300,\u0022dkk\u0022:250,\u0022mxn\u0022:1000,\u0022gbp\u0022:30,\u0022nzd\u0022:50,\u0022eur\u0022:50,\u0022sek\u0022:300,\u0022sgd\u0022:50,\u0022hkd\u0022:400,\u0022cad\u0022:50}}");

      window.slipstream.ignoreRoutingNumberCountries = JSON.parse("[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022,\u0022GB\u0022,\u0022MX\u0022]");
      window.slipstream.ibanBankAccountCountries = JSON.parse("[\u0022AT\u0022,\u0022BE\u0022,\u0022CH\u0022,\u0022DE\u0022,\u0022DK\u0022,\u0022ES\u0022,\u0022FI\u0022,\u0022FR\u0022,\u0022IE\u0022,\u0022IT\u0022,\u0022LU\u0022,\u0022NL\u0022,\u0022NO\u0022,\u0022PT\u0022,\u0022SE\u0022,\u0022GB\u0022]");
    })();
  </script>


    

  <style type="text/css">.fp__btn{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:inline-block;height:34px;padding:4px 30px 5px 40px;position:relative;margin-bottom:0;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-family:"Open Sans", sans-serif;font-size:12px;font-weight:600;line-height:1.42857143;color:#fff;text-align:center;white-space:nowrap;background:#ef4925;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAVCAYAAABLy77vAAAABGdBTUEAALGPC/xhBQAAAJRJREFUOBHNUcEWgCAIy14fbl9egK5MRarHQS7ocANmOCgWh1gdNERig1CgwPlLxkZuE80ndHlU+4Lda1zz0m01dSKtcz0h7qpQb7WR+HyrqRPxahzwwMqqkEVs6qnv+86NQAbcJlK/X+vMeMe7XcBOYaRzcbItUR7/8QgcykmElQrQPErnmxNxl2yyiwcgEvQUocIJaE6yERwqXDIAAAAASUVORK5CYII=");background-repeat:no-repeat;background-position:15px 6px;border:1px solid transparent;border-radius:17px}.fp__btn:hover{background-color:#d64533}.fp__btn::after{position:absolute;content:"";top:15px;right:14px;width:7px;height:4px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAICAYAAAA1BOUGAAAABGdBTUEAALGPC/xhBQAAAGlJREFUCB1j/P//vw4DA4MiEKOD+0xAkatA/AJNBsS/ysTIyPgfyDgHxO+hCkD0Oag4RAhoPDsQm4NoqCIGBiBnAhBjAxNAkkxAvBZNFsQHuQesmxPIOQZVAKI54UZDFYgABbcBsQhMAgDIVGYSqZsn6wAAAABJRU5ErkJggg==");}.fp__btn:hover::after{background-position:0 -4px;}.fp__btn:active,.fp__btn:focus{outline:none}@media only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2 / 1), only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2){.fp__btn{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAqCAYAAADbCvnoAAAABGdBTUEAALGPC/xhBQAAAQFJREFUWAntWEESwjAIbBwfHl+upNoRNjKUJhk5kIvZQGG7bHOwPGltgdYtEJedShKyJnLHhEILz1Zi9HCOzFI7FUqFLAWseDgPdfeQ9QZ4b1j53nstnEJJyBqx20NeT1gEMB5uZG6Fzn5lV5UMp1ASQhMjdnvoqjewsYbDjcytEH5lsxULp1AS0sx8nJfVnjganf3NkVlKhVPIfQ9Zb6jF0atK3mNriXwpicPHvIeyr3sTDA53VgpgH8BvMu1ZCCz7ew/7MPwlE4CQJPNnQj2ZX4SYlEPbVpsvKFZ5TOwhcRoUTQiwwhVjArPEqVvRhMCneMXzDk9lwYphIwrZZOihF32oehMAa1qSAAAAAElFTkSuQmCC");background-size:18px 21px}.fp__btn::after{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAABGdBTUEAALGPC/xhBQAAANpJREFUKBWVkU8KglAYxJ/u3HuBwmUX8BqepKN4ka4RguDOVYu2QVCrhIJ6/caekqLiGxi+PzPD58PAWrszxmygD84h7hpePFLy1mEQBJamgvcVYXkqZXTR0LwpJWw0z0Ba6bymDcrI4kkp4EvzCNoVztNKfVATwoOiyx/NDup1SVqPQVBbDDeK3txBb9JuHfhNW3HWjZhDX+SGRAgPHkl5f0+kieBxRVieaPD5LGJ4WghLiwehbkBI4HUirF3S+SYrhhQ2f2H16aR5vMSYwbdjNtYXZ0J7cc70BXnFMHIGznzEAAAAAElFTkSuQmCC");background-size:7px 8px;}}</style></head>

  <body class="dashboard-reports-section dashboard-reports-section-bg dashboard-section">

    
      

      <link rel="stylesheet" href="./Sales _ Screaming Eagle Sports_files/a343d529f57f.css" type="text/css">
    

    
      <div style="display: none;">
          <svg id="svg-clock" class="svg-icon" viewBox="0 0 13 13" width="13" height="13">
  <path d="M6.47,0a6.47,6.47,0,1,0,6.47,6.47h0A6.47,6.47,0,0,0,6.47,0m0,11.5a5,5,0,1,1,5-5,5,5,0,0,1-5,5m2.16-5H7.19V3.59a.72.72,0,1,0-1.44,0v3.6a.72.72,0,0,0,.72.72H8.63a.72.72,0,0,0,0-1.44"></path>
</svg>
<svg id="svg-curved-arrow" class="svg-icon" width="15" height="32" viewBox="0 0 15 32"><path d="M6.41,29.79a68.68,68.68,0,0,0,7-5.09C14,24,15,25,15,25.38s-7.83,6.05-7.83,6.05-1.76,1.28-2.89,0C3.63,30.69-.16,21.14,0,20.63s1.44-.56,1.62,0,2,5.56,3.08,8A24.81,24.81,0,0,0,7.82,15.72c0-7.5-1-8.84-5.08-14.88C4.11,0,3,.5,4,0,8.73,5.11,9.76,10.63,9.8,15.78A31.76,31.76,0,0,1,6.41,29.79Z"></path></svg>
<svg id="svg-fh-logo" class="svg-icon fh-logo" width="155.42" height="104.44" viewBox="0 0 155.42 104.44">
  <path class="svg-ticket-bg" d="M148.69,58.72a4.14,4.14,0,0,1,0-8.29h.12v-7.5h-.12a4.14,4.14,0,0,1,0-8.29h.12v-7.5h-.12a4.14,4.14,0,0,1,0-8.29h.12V9.4h-.12A9.15,9.15,0,0,1,139.55.26c0-.09,0-.17,0-.26H15.93c0,.09,0,.17,0,.26A9.15,9.15,0,0,1,6.79,9.41l-.38,0v9.55c.13,0,.25,0,.38,0a4.14,4.14,0,1,1,0,8.29c-.13,0-.25,0-.38,0v7.56c.13,0,.25,0,.38,0a4.14,4.14,0,1,1,0,8.29c-.13,0-.25,0-.38,0v7.56c.13,0,.25,0,.38,0a4.14,4.14,0,1,1,0,8.29c-.13,0-.25,0-.38,0V68l.38,0a9.15,9.15,0,0,1,9.15,9.15s0,.06,0,.09H139.55s0-.06,0-.09a9.15,9.15,0,0,1,9.15-9.15h.12V58.71Z"></path>

  <path class="svg-ticket-stroke" d="M148.69,18.9h.12V9.4h-.12A9.15,9.15,0,0,1,139.55.26c0-.09,0-.17,0-.26H15.93c0,.09,0,.17,0,.26A9.15,9.15,0,0,1,6.79,9.41l-.38,0v9.55c.13,0,.25,0,.38,0a4.14,4.14,0,1,1,0,8.29c-.13,0-.25,0-.38,0v7.56c.13,0,.25,0,.38,0a4.14,4.14,0,1,1,0,8.29c-.13,0-.25,0-.38,0v7.56c.13,0,.25,0,.38,0a4.14,4.14,0,0,1,0,8.29c-.13,0-.25,0-.38,0v9.26l.38,0a9.15,9.15,0,0,1,9.15,9.15s0,.06,0,.09H139.55s0-.06,0-.09a9.15,9.15,0,0,1,9.15-9.15h.12V58.71h-.12a4.14,4.14,0,0,1,0-8.29h.12v-7.5h-.12a4.14,4.14,0,0,1,0-8.29h.12v-7.5h-.12a4.14,4.14,0,0,1,0-8.29Zm-2.48,10.41v3.23a6.74,6.74,0,0,0,0,12.54v3.23a6.74,6.74,0,0,0,0,12.54v4.74a11.79,11.79,0,0,0-9,9H18.27a11.79,11.79,0,0,0-9.26-9V60.95A6.74,6.74,0,0,0,9,48.21v-3A6.74,6.74,0,0,0,9,32.45v-3A6.74,6.74,0,0,0,9,16.68V11.8a11.79,11.79,0,0,0,9.29-9.2H137.18a11.79,11.79,0,0,0,9,9.15v5a6.74,6.74,0,0,0,0,12.54Z"></path>

  <g class="svg-ticket-detail">
    <path d="M131.57,8.49h-31v2.6h31a2.38,2.38,0,0,1,2.19,2.52V64.26a2.38,2.38,0,0,1-2.19,2.52H96.79V55.15l4.15-3.89V44.42h-6.6V21h5.32a1.3,1.3,0,0,0,.51-2.49l-22-13a1.3,1.3,0,0,0-1.32,0L54.81,18.62A1.3,1.3,0,0,0,55.47,21h5.3V44.42h-6.6v6.84l4.09,3.83V66.78H23.75a2.38,2.38,0,0,1-2.19-2.52V13.62a2.38,2.38,0,0,1,2.19-2.52H54.31V8.49H23.75A5,5,0,0,0,19,13.62V64.26a5,5,0,0,0,4.79,5.12H131.57a5,5,0,0,0,4.79-5.12V13.62A5,5,0,0,0,131.57,8.49ZM94.19,66.78H83.77l10.42-4.35ZM91.75,44.42H78.9v-4a7.89,7.89,0,0,0,0-15.55V21H91.75Zm-14.19-17a5.3,5.3,0,1,1-5.3,5.3A5.3,5.3,0,0,1,77.56,27.38ZM60.23,18.44,77.56,8.2,94.89,18.44h-.54v0H60.77v0ZM63.37,21H76.3v3.85a7.89,7.89,0,0,0,0,15.57v4H63.37Zm35,26v3.12L95,53.26H60.11l-3.33-3.12V47m4.09,8.84H80.31L60.86,63.34ZM77.27,66.78H60.86v-.68a1.23,1.23,0,0,0,.18,0l26.51-10.2h6.64v3.75"></path>
    <path d="M104.1,32.77a1.3,1.3,0,0,0,1.3,1.3h22.21a1.3,1.3,0,0,0,0-2.6H105.4A1.3,1.3,0,0,0,104.1,32.77Z"></path>
    <path d="M123.31,19,102.4,24.68a1.3,1.3,0,1,0,.68,2.51L124,21.5a1.3,1.3,0,0,0-.68-2.51Z"></path>
    <path d="M102.36,39.85l19.92,6a1.3,1.3,0,0,0,.75-2.49l-19.92-6a1.3,1.3,0,0,0-.75,2.49Z"></path>
    <path d="M25.44,32.77a1.3,1.3,0,0,0,1.3,1.3H48.95a1.3,1.3,0,0,0,0-2.6H26.74A1.3,1.3,0,0,0,25.44,32.77Z"></path>
    <path d="M51.26,27.19a1.29,1.29,0,0,0,.35,0A1.3,1.3,0,0,0,52,24.68L33,19.33a1.3,1.3,0,0,0-.71,2.5Z"></path>
    <path d="M34,45.22a1.31,1.31,0,0,0,.38-.06L52,39.85a1.3,1.3,0,0,0-.75-2.49L33.61,42.67A1.3,1.3,0,0,0,34,45.22Z"></path>
  </g>

  <g class="svg-text">
    <path d="M3.29,91.71V95h7.62v3.12H3.29v6H0V88.59H11.94v3.12Z"></path>
    <path d="M24.16,104.21l-1.23-2.95H17.25L16,104.21H13L18.77,91h2.73l5.76,13.23Zm-4.07-9.76L18.3,98.71h3.57Z"></path>
    <path d="M38.64,104.21,35.76,100H33.44v4.2h-3V91.08h6.15c3.17,0,5.07,1.63,5.07,4.33v0a4.08,4.08,0,0,1-2.88,4.07l3.28,4.69Zm.06-8.65c0-1.24-.88-1.88-2.32-1.88H33.44v3.77h3c1.44,0,2.27-.75,2.27-1.86Z"></path>
    <path d="M46.28,104.21V91.08H56.43v2.57h-7.2v2.66h6.34v2.57H49.22v2.76h7.3v2.57Z"></path>
    <path d="M71.27,104.21V97.66H64.79v6.55H61.65V88.59h3.14V94.7h6.48V88.59h3.28v15.62Z"></path>
    <path d="M88.8,104.21l-1.23-2.95H81.89l-1.23,2.95h-3L83.41,91h2.73l5.76,13.23Zm-4.07-9.76-1.79,4.26h3.57Z"></path>
    <path d="M103.28,104.21,100.4,100H98.08v4.2h-3V91.08h6.15c3.17,0,5.07,1.63,5.07,4.33v0a4.08,4.08,0,0,1-2.88,4.07l3.28,4.69Zm.06-8.65c0-1.24-.88-1.88-2.32-1.88H98.08v3.77h3c1.44,0,2.27-.75,2.27-1.86Z"></path>
    <path d="M116.93,104.21h-6.4V91.08h6.24c2.75,0,4.44,1.33,4.44,3.4v0a3,3,0,0,1-1.77,2.83c1.56.58,2.52,1.46,2.52,3.23v0C122,103,120,104.21,116.93,104.21ZM118.28,95c0-.86-.69-1.35-1.94-1.35h-2.92v2.78h2.73c1.31,0,2.13-.41,2.13-1.39Zm.75,5.25c0-.88-.67-1.43-2.19-1.43h-3.42v2.89h3.51c1.31,0,2.09-.45,2.09-1.43Z"></path>
    <path d="M132.47,104.44a6.81,6.81,0,0,1-7.12-6.76v0a7.15,7.15,0,0,1,14.29,0v0A6.88,6.88,0,0,1,132.47,104.44Zm4.07-6.79a4,4,0,0,0-4.07-4.13,4,4,0,0,0-4,4.09v0a4,4,0,0,0,4.07,4.13,4,4,0,0,0,4-4.09Z"></path>
    <path d="M152,104.21l-2.88-4.2h-2.32v4.2h-3V91.08h6.15c3.17,0,5.07,1.63,5.07,4.33v0a4.08,4.08,0,0,1-2.88,4.07l3.28,4.69Zm.06-8.65c0-1.24-.88-1.88-2.32-1.88h-2.94v3.77h3c1.44,0,2.27-.75,2.27-1.86Z"></path>
  </g>
</svg>

<svg class="svg-icon icon-help" id="svg-help" viewBox="0 0 15 15" width="15" height="15">
  <path d="M7.54,0A7.56,7.56,0,0,0,0,7.54,7.42,7.42,0,0,0,7.46,15,7.5,7.5,0,0,0,7.54,0Zm0,13.13a1.27,1.27,0,1,1,1.27-1.27A1.28,1.28,0,0,1,7.58,13.13Zm.67-4.38a1,1,0,0,0,.28.66l-1.71.5a2,2,0,0,1-.52-1.38c0-1.87,2.29-2.09,2.29-3.17,0-.49-.36-.89-1.22-.89a2.51,2.51,0,0,0-1.93,1L4.18,4A4.49,4.49,0,0,1,7.61,2.5c2,0,3.26,1,3.26,2.48C10.87,7.26,8.25,7.44,8.25,8.75Z"></path>
</svg>

<svg class="svg-icon icon-ideal" id="svg-ideal" viewBox="0 0 892 770.42"><path d="M.13,385.09q0-190-.06-380C.06,1.61.4,0,4.74,0c157.49.17,315-.23,472.45.43C543,.7,607.58,10.05,669.59,33.27c54.57,20.44,102.17,51.19,140,96.06,35.68,42.33,57.9,91.29,70.24,144.89,13.22,57.39,15.12,115.4,8.36,173.8-5.57,48.16-18.1,94.26-41,137.25-34,64-85.2,109.51-150.43,139.88-38.53,18-79.08,29.2-120.92,36.18-40.21,6.7-80.71,9-121.43,9q-224.22-.12-448.45.08c-4.71,0-6-.94-6-5.86Q.24,574.83.13,385.09Z" style="fill:#020202"></path><path d="M36.59,384.88q0-171.48-.1-342.95c0-4.42.93-5.74,5.61-5.74,142.65.16,285.29-.16,427.94.31,62.08.21,123.14,8.24,181.86,29.71,50.74,18.55,95.24,46.44,130.5,88,31,36.49,50.48,78.68,61.55,125,11.21,46.9,13.57,94.46,10.3,142.42-2.72,39.74-10.13,78.48-24.83,115.61-31.58,79.75-89.36,132.72-168.25,163.87C623.36,716,584,724.52,543.68,729.32c-33.15,3.95-66.43,4.84-99.77,4.82q-200.71-.1-401.44.09c-4.74,0-6-1-6-5.91Q36.69,556.6,36.59,384.88Z" style="fill:#fefefe"></path><path d="M794.09,392.34q-43.24,0-86.5,0c-7,0-7,0-7-7.22v-33c0-37.17.06-74.34-.1-111.5,0-4.15,1.07-5.41,5.26-5.26,9.32.32,18.68.39,28,0,4.88-.22,6.06,1.22,6,6-.21,35.83-.1,71.67-.14,107.5,0,2.68-.17,4.63,3.76,4.57,16.83-.24,33.66-.17,50.5,0,3,0,3.69-1,3.27-3.77-2.47-16.28-3.88-32.78-7.4-48.82C772.27,221,727.35,162.66,652.52,128.38c-48.09-22-99.2-32.19-151.58-33.68-66.61-1.9-133.3-1.09-200-1.51-2.67,0-3.8.5-3.79,3.52q.13,67.5,0,135c0,3.2,1.12,3.95,4.07,3.87,6.83-.18,13.67-.15,20.5,0,35.08.59,59.15,18.53,67.7,51A105.08,105.08,0,0,1,388,346.15c-7.71,24.25-24,39.46-49.13,44.52-6.31,1.28-12.89,1.3-19.36,1.64-7.26.37-14.54.44-21.8.65-.16,7.29-.44,14.59-.45,21.88q-.07,60,0,120c0,45.67.06,91.33-.1,137,0,4.29.86,5.56,5.39,5.54,47.84-.18,95.68.35,143.5-.28,29.62-.4,59.29-1.57,88.81-4a371.4,371.4,0,0,0,104.23-24c65.42-25.37,113-69,138.41-135.34C792,475.87,797.33,436.27,798.75,396,798.9,391.78,796.59,392.34,794.09,392.34ZM511.94,358c-.27,10.15-.2,20.32,0,30.49.05,3-.72,4-3.87,4q-44.48-.17-89,0c-3.44,0-4.07-1.17-4.06-4.28.11-24.83.06-49.65.06-74.48,0-24.49.08-49-.09-73.47,0-3.73.92-4.78,4.7-4.75q42.24.24,84.47,0c3.87,0,4.76,1.2,4.67,4.85-.24,9.82-.32,19.66,0,29.48.15,4.23-1.47,4.87-5.15,4.83-15-.18-30,.05-45-.16-3.76-.05-5.11,1-4.71,4.75a39.75,39.75,0,0,1,0,9c-.53,4.22,1.38,4.91,5.09,4.86,14.16-.19,28.32,0,42.48-.14,3.17,0,4.38.7,4.3,4.12q-.33,15.24,0,30.49c.07,3.44-.85,4.58-4.42,4.53-14.33-.2-28.66,0-43-.16-3.46,0-4.71.89-4.46,4.44a98.63,98.63,0,0,1,0,13c-.23,3.38,1,4.16,4.22,4.13,16.33-.15,32.66.05,49-.16C510.93,353.21,512.05,354.16,511.94,358Z" style="fill:#cb0166"></path><path d="M93.26,556.74c0-38.81.06-77.62-.1-116.44,0-4,1.07-4.95,5-4.94q63.22.22,126.44,0c3.94,0,4.54,1.21,4.54,4.77q-.15,116.45,0,232.88c0,3.54-.9,4.33-4.37,4.32q-63.46-.2-126.93,0c-3.75,0-4.68-.89-4.67-4.65C93.32,634,93.26,595.39,93.26,556.74Z" style="fill:#020202"></path><path d="M76.89,314a84.35,84.35,0,1,1,84.47,84.31A84.4,84.4,0,0,1,76.89,314Z" style="fill:#020202"></path><path d="M297.25,314.25c0-11.82.09-23.64-.06-35.46,0-3.15.7-4.47,4.13-4.34,8.31.32,16.67-.18,24.94.52,15.26,1.3,22.67,8,25.94,23A72.12,72.12,0,0,1,351,334.51c-3.5,11.66-11.14,17.89-23.21,18.57-9.13.51-18.3.11-27.45.32-3,.07-3.14-1.43-3.13-3.7C297.28,337.88,297.25,326.06,297.25,314.25Z" style="fill:#cb0166"></path><path d="M605.56,235.46c8.16,0,16.33.1,24.48-.06,2.66-.06,3.76.91,4.5,3.38q22.5,75,45.17,149.85c.8,2.65.58,3.87-2.71,3.82q-16.72-.24-33.47,0c-2.73.05-3.76-1-4.43-3.42-2.12-7.69-4.54-15.3-6.55-23-.75-2.9-1.91-4-5-3.95-14.66.18-29.31.15-44,0-2.64,0-3.79.83-4.48,3.32-2.15,7.85-4.69,15.6-6.73,23.48-.75,2.87-2.05,3.59-4.83,3.55-10.66-.15-21.32-.27-32,0-4.5.13-4.66-1.2-3.51-5q21.33-70.1,42.4-140.27c3.55-11.77,3.57-11.76,15.65-11.76Z" style="fill:#fefefe"></path><path d="M619.89,323.16c-8.89,0-17.18-.06-25.48,0-2.5,0-2.69-1-2.08-3,3.84-12.86,7.6-25.75,11.48-38.6.33-1.06,1.4-1.9,2.13-2.85a10.78,10.78,0,0,1,1.83,2.69C611.79,295.08,615.73,308.77,619.89,323.16Z" style="fill:#cb0166"></path></svg>

<svg id="svg-lightbulb" class="svg-icon icon-lightbulb" xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80"><path d="M31.83,72H47.75c.36,2.28-1,3.85-3.68,4.65-.73,1.2-1.12,2.71-1.87,2.91a13.92,13.92,0,0,1-5,.08c-.47,0-1.17-.94-1.22-1.49a2.06,2.06,0,0,0-1.53-2A4.39,4.39,0,0,1,31.83,72Z"></path><path d="M39.89,68.93c-2.46,0-4.91,0-7.37,0a2,2,0,0,1-2.29-1.85c-.12-1.1.76-2,2.13-2,5.06,0,10.13,0,15.19,0A1.9,1.9,0,0,1,49.62,67c.06,1.12-.83,1.89-2.21,1.91C44.9,69,42.4,68.93,39.89,68.93Z"></path><path d="M25.87,16.63c-.39.39-.82,1.15-1.39,1.29a2.53,2.53,0,0,1-2.12-.46c-1.88-2.51-3.68-5.1-5.31-7.78a2.62,2.62,0,0,1,.46-2.35A1.58,1.58,0,0,1,20,7.45c1.92,2.61,3.71,5.31,5.53,8A4.64,4.64,0,0,1,25.87,16.63Z"></path><path d="M75.52,23.42c-.22.31-.5,1-1,1.35q-3.83,2.34-7.78,4.49A1.85,1.85,0,0,1,64,28.54,1.77,1.77,0,0,1,64.75,26c2.57-1.54,5.15-3.06,7.78-4.48C73.93,20.73,75.44,21.61,75.52,23.42Z"></path><path d="M41.86,6.63c0,1.45,0,2.9,0,4.34a1.82,1.82,0,0,1-2,2A1.85,1.85,0,0,1,38,11c0-2.89,0-5.78,0-8.67A1.88,1.88,0,0,1,40,.21,1.85,1.85,0,0,1,41.86,2.3C41.87,3.74,41.86,5.19,41.86,6.63Z"></path><path d="M6.1,61.74c-.44-.36-1.29-.71-1.46-1.27a2.33,2.33,0,0,1,.43-2.09c2.73-1.74,5.56-3.34,8.4-4.88a1.73,1.73,0,0,1,2.41.88A1.78,1.78,0,0,1,15,56.93c-2.53,1.51-5.1,3-7.66,4.39A8.24,8.24,0,0,1,6.1,61.74Z"></path><path d="M56.55,18.26c-1.91,0-2.92-1.49-2.08-2.8,1.68-2.65,3.48-5.23,5.31-7.79a1.74,1.74,0,0,1,2.55-.36,1.77,1.77,0,0,1,.51,2.62c-1.68,2.48-3.33,5-5.07,7.42A4.29,4.29,0,0,1,56.55,18.26Z"></path><path d="M65.42,53.05a18.47,18.47,0,0,1,1.8.76q3.33,1.89,6.63,3.82c1.43.84,1.89,1.88,1.34,2.91s-1.85,1.29-3.27.48c-2.35-1.33-4.68-2.69-7-4a1.8,1.8,0,0,1-1-2.38C64.19,54,64.92,53.54,65.42,53.05Z"></path><path d="M73.25,43.53c-1.35,0-2.7,0-4,0-1.5-.05-2.41-.82-2.32-2,.11-1.34,1-1.88,2.26-1.88,2.8,0,5.6,0,8.41,0,1.25,0,2.19.53,2.21,1.89s-.9,1.92-2.15,2C76.15,43.56,74.7,43.53,73.25,43.53Z"></path><path d="M4.48,23.26A1.88,1.88,0,0,1,7.06,21.4c2.87,1.51,5.67,3.15,8.44,4.84a1.55,1.55,0,0,1,.41,2.37,1.93,1.93,0,0,1-2.76.61c-2.54-1.41-5-2.87-7.54-4.34A2.74,2.74,0,0,1,4.79,24,3.17,3.17,0,0,1,4.48,23.26Z"></path><path d="M6.72,39.68c1.45,0,2.9,0,4.35,0a1.81,1.81,0,0,1,2,1.93,1.78,1.78,0,0,1-1.92,1.87c-3,0-6,0-9,0A1.76,1.76,0,0,1,.24,41.64a1.8,1.8,0,0,1,2-2C3.72,39.64,5.22,39.68,6.72,39.68Z"></path><path d="M59.33,38.14C58,27.28,47.25,19.35,36.59,21.36A20.11,20.11,0,0,0,23.9,52.61c2,2.87,4,5.75,5.91,8.67a2,2,0,0,0,2,1c2.71-.06,5.42,0,8.13,0s5.13-.09,7.68,0a2.81,2.81,0,0,0,2.85-1.59,64.66,64.66,0,0,1,4.33-6.48A20.77,20.77,0,0,0,59.33,38.14ZM39,28.42a13.27,13.27,0,0,0-6.46,2.19c-3.86,2.71-4.95,6.7-5.17,11.09-.07,1.34-.85,2.21-2,2.11a1.92,1.92,0,0,1-1.87-2.12v-.34c.42-6,2.19-11,7.36-14.25a16.56,16.56,0,0,1,7.77-2.48A1.88,1.88,0,0,1,41,26.27C41.14,27.42,40.39,28.27,39,28.42Z"></path></svg>

<svg id="svg-phone" class="svg-icon" width="11" height="13" viewBox="0 0 11 13"><path d="M4.23,3.45l-1,1.1c-.45.39-.1,1,.3,1.65A14.65,14.65,0,0,0,5.34,8.47c.9.9,1.38,1.31,1.81.95L8.28,8.14c.19-.16.35-.12.51.08l2.1,2.4a.6.6,0,0,1-.06.65c-.3.38-1.19,1.4-1.19,1.4-.51.46-3.28,1.11-7.08-3.77C-1,4.29.08,1.81.55,1.31l1-1.1a.44.44,0,0,1,.63.06L4.28,2.8h0a.47.47,0,0,1-.06.65h0"></path></svg>

<svg id="svg-plus" class="svg-icon icon-plus" width="16" height="16" viewBox="0 0 16 16"><polygon points="16 6 10 6 10 0 6 0 6 6 0 6 0 10 6 10 6 16 10 16 10 10 16 10 16 6"></polygon></svg>

<svg class="svg-icon icon-shield" id="svg-shield" xmlns="http://www.w3.org/2000/svg" width="34" height="41" viewBox="0 0 34 41"><path d="M21.22,17.64V16s0-3.95-3.84-3.95S13.54,16,13.54,16v1.69H11.89V26h11V17.64Zm-1.65,0H15.19V16a2,2,0,0,1,2.19-2.26A2,2,0,0,1,19.57,16Z"></path><path d="M26.62,29.6l2.53,1.74,1.75-3-2.73-1.42C27.64,27.84,27.14,28.69,26.62,29.6ZM33.88,6.14c-.37-.08-.63-.16-.89-.21C27.65,5,22.91,2.38,18,.15a1.63,1.63,0,0,0-1.21,0c-3.74,1.65-8,4-11.94,4.92C3.27,5.48,1.71,5.8,0,6.18c.13,4.43-.09,8.87.46,13.2C1.7,29,6.86,36.05,15.39,40.55a3.36,3.36,0,0,0,3.4-.13c.69-.46,1.47-.76,2.17-1.2a27,27,0,0,0,6-5.13l-2.2-2c-1.2,1.07-2.26,2.14-3.45,3a35.88,35.88,0,0,1-3.78,2.38,1.2,1.2,0,0,1-1.06,0A23.75,23.75,0,0,1,4.34,23.13C2.8,18.44,3.27,13.6,3.25,8.79c0,0,.06-.08.12-.16,4-.81,7.89-3,11.64-4.59a5,5,0,0,1,4,0c3.54,1.57,7.24,3.65,11,4.47.33.07.79,0,.78.62,0,2.75.09,5.51-.12,8.24-.17,2.24-.72,4.45-1.11,6.75l1.23.46,1.4.5C34.65,18.89,33.6,12.48,33.88,6.14Z"></path></svg>

<svg class="svg-icon icon-sofort" id="svg-sofort" width="40" height="27" viewBox="0 0 40 27" xmlns="http://www.w3.org/2000/svg">
  <g fill-rule="nonzero" fill="none">
    <path d="M3 0h34a3 3 0 0 1 3 3v20.667a3 3 0 0 1-3 3H3a3 3 0 0 1-3-3V3a3 3 0 0 1 3-3z" fill="#EB6F93"></path>
    <path d="M12.585 18.333h-1.19c0 .972-.447 1.859-1.226 2.443l-.47.35 1.825 2.475h1.499l-1.68-2.278a4.178 4.178 0 0 0 1.242-2.99zm-4.252 0H9.55v5.268H8.333v-5.268zm5.042 0h1.147v5.268h-1.147v-5.268zm11.208 1.525c-.437 0-.853.132-1.13.51v-.41h-1.09v3.643h1.105V21.69c0-.553.374-.824.822-.824.48 0 .757.287.757.818v1.923h1.094v-2.321c0-.85-.678-1.428-1.558-1.428zm-6.594.1v.234c-.32-.22-.7-.336-1.088-.335-1.067 0-1.931.86-1.931 1.923 0 1.062.864 1.922 1.93 1.922.407 0 .78-.122 1.09-.335v.234h1.093v-3.643H17.99zm-.997 2.757c-.55 0-.992-.42-.992-.935 0-.515.442-.935.992-.935s.992.42.992.935c0 .515-.443.935-.992.935zm3.787-2.284v-.473h-1.12v3.643h1.126v-1.699c0-.574.624-.882 1.056-.882h.01v-1.062c-.442 0-.853.192-1.071.473zm8.766-.473v.234c-.32-.22-.7-.336-1.089-.335-1.066 0-1.931.86-1.931 1.923 0 1.062.864 1.922 1.931 1.922.406 0 .78-.122 1.089-.335v.234h1.093v-3.643h-1.093zm-.998 2.757c-.55 0-.992-.42-.992-.935 0-.515.442-.935.992-.935s.992.42.992.935c.006.515-.443.935-.992.935zm3.26-.404a.688.688 0 0 0-.689.685.688.688 0 0 0 1.377 0 .685.685 0 0 0-.688-.685zM20.276 16.92c-2.279-.04-4.192-1.717-4.254-4.099l-.523-.518c-.647-.65-.751-1.548-.232-2.081l.056-.06c.223-.229.516-.354.815-.37-.361-.712-.249-1.492.313-1.877l.08-.053c.61-.354 1.143-.217 1.597.233l-.523-4.294c-.175-.746.283-1.564.981-1.713a1.37 1.37 0 0 1 1.627 1.064l.89 3.801L22.23 3.09c.203-.758.98-1.21 1.738-1.012.685.202 1.099.898.95 1.596l-1.242 6.189.533.124c.155.023.357.114.549.318.347.371.515.985.44 1.881-.242 2.877-1.659 4.764-4.903 4.736l-.02-.001zm.1-.573c2.832-.003 4.03-1.62 4.248-4.21.063-.744-.061-1.198-.287-1.438a.548.548 0 0 0-.17-.127.244.244 0 0 0-.065-.02l-3.36-.784a1.42 1.42 0 0 0-.646-.021.633.633 0 0 0-.51.478c-.113.377-.105.665.134.896a.288.288 0 0 1 .147.116c.167.11.402.206.72.293l2.213.495c.368.082.256.632-.115.563a1.952 1.952 0 0 0-.955.092c-.541.203-.877.668-.918 1.53a.288.288 0 0 1-.575-.028c.046-.951.418-1.58 1.016-1.914l-.805-.18a3.535 3.535 0 0 1-.705-.266 1.29 1.29 0 0 1-.356.366l-.064.042c-.039.026-.079.05-.119.071a1.297 1.297 0 0 1-.212 1.507l-.057.06a1.3 1.3 0 0 1-1.832.024l-.431-.427c.353 1.726 1.892 2.882 3.69 2.882h.013zm-1.1-4.864c-.313-.325-.39-.727-.3-1.185l-.636-.946a.287.287 0 0 1-.058-.087l-.292-.435c-.37-.539-.73-.725-1.155-.48l-.061.041c-.33.227-.376.775-.032 1.296L18 11.56a.724.724 0 0 0 1.003.193l.06-.042a.712.712 0 0 0 .213-.228zm-.042-1.833c.177-.244.432-.397.737-.465a1.97 1.97 0 0 1 .916.026l2.228.52 1.239-6.174a.79.79 0 0 0-.538-.925.852.852 0 0 0-1.031.612l-1.436 4.918a.288.288 0 0 1-.48.122.286.286 0 0 1-.079-.14l-1.14-4.871a.794.794 0 0 0-.944-.622c-.371.079-.65.581-.538 1.029l.007.035.647 5.322.412.613zm-.619 2.801a1.299 1.299 0 0 1-1.092-.569l-.935-1.391a.653.653 0 0 0-.85.07l-.056.06c-.28.287-.217.832.223 1.275l1.6 1.584a.723.723 0 0 0 1.016-.012l.056-.058a.722.722 0 0 0 .038-.959z" fill="#FFF"></path>
  </g>
</svg>
<svg id="svg-star" version="1.1" class="svg-icon" viewBox="0 0 30 30" width="30" height="30">
  <polygon points="15,22.9 6,28.9 8.9,18.5 0.4,11.7 11.2,11.3 15,1.1 18.8,11.3 29.6,11.7 21.1,18.5 24,28.9 "></polygon>
</svg>

<svg class="svg-icon" id="svg-trending" viewBox="0 0 30 30" width="30" height="30">
  <polygon points="29.9 11.8 26.1 10.4 21.2 23.4 8.7 15.1 3.8 30.8 0 29.6 6.4 8.8 19.2 17.3 22.4 9 18.7 7.6 27.9 0 29.9 11.8"></polygon>
</svg>
<svg id="svg-user-outline" class="svg-icon user-outline" width="15" height="13" viewBox="0 0 15 13"><path d="M7.51,0,8,.09a3.29,3.29,0,0,1,2.19,1.32,2.59,2.59,0,0,1,.34,1.9,3,3,0,0,0,0,.95,2,2,0,0,0,0,.34,1.52,1.52,0,0,1,0,.77,2.48,2.48,0,0,1-.37.73,2.34,2.34,0,0,0-.23.4C9.58,7.34,9.54,7.57,10,8a4.73,4.73,0,0,0,2,.83,5.45,5.45,0,0,1,2.3,1h0A3.44,3.44,0,0,1,15,12.35L15,13H0l0-.53c0-1,.07-2.27,1.22-3a6.16,6.16,0,0,1,1.83-.69,6.14,6.14,0,0,0,1.46-.5c.28-.16.75-.41.84-.63s0-.37-.14-.69l-.12-.28a2.29,2.29,0,0,0-.24-.43,3.3,3.3,0,0,1-.29-.5A1.76,1.76,0,0,1,4.5,4.7a2.17,2.17,0,0,0,0-.34,3.31,3.31,0,0,0,0-1.06,2.5,2.5,0,0,1,.43-2A2.1,2.1,0,0,1,6.2.65a1.25,1.25,0,0,0,.35-.2A2.63,2.63,0,0,1,7.07.14M.88,12.2H14.13c0-.62-.06-1.44-.42-1.75h0a4.75,4.75,0,0,0-2-.83,5.43,5.43,0,0,1-2.3-1c-1-.83-.61-1.67-.3-2.42a3.07,3.07,0,0,1,.31-.55,1.73,1.73,0,0,0,.26-.49.72.72,0,0,0,0-.37,1.93,1.93,0,0,1-.05-.42,3.4,3.4,0,0,1,0-1.13,1.8,1.8,0,0,0-.2-1.34,2.53,2.53,0,0,0-1.87-1H7.48A1.29,1.29,0,0,0,7,1.14a1.78,1.78,0,0,1-.68.35,1.32,1.32,0,0,0-.72.32,1.69,1.69,0,0,0-.26,1.4,3.78,3.78,0,0,1,0,1.24,1.87,1.87,0,0,1,0,.39,1,1,0,0,0,0,.58,2.46,2.46,0,0,0,.22.37,3,3,0,0,1,.33.59l.1.24A1.59,1.59,0,0,1,6.15,8,2.63,2.63,0,0,1,5,9a6.83,6.83,0,0,1-1.69.6,5.45,5.45,0,0,0-1.59.58A2.23,2.23,0,0,0,.88,12.2Z"></path></svg>

<svg id="svg-user" class="svg-icon user" width="15" height="13" viewBox="0 0 15 13"><path d="M14.38,10.35c-1.28-1.1-3.25-.85-4.53-2-.75-.65-.55-1.22-.2-2.06a10.34,10.34,0,0,0,.62-1.15c.11-.38-.06-.63-.06-1-.22-1,.38-1.88-.29-2.87A3.15,3.15,0,0,0,7.53.09h0c-.5,0-.87.56-1.28.64a1.81,1.81,0,0,0-1,.51c-.79,1-.14,1.9-.37,3,0,.45-.2.84,0,1.3s.43.62.58,1,.48.89.27,1.37a2.56,2.56,0,0,1-1.09.88c-1.08.6-2.43.59-3.47,1.25S0,11.91,0,13H15C15,12.24,15,10.9,14.38,10.35Z"></path></svg>


      </div>
    

    
    
      <div style="height: 100vh;" class="no-assets-message">
        <h2 style="font-size: 30px;">FareHarbor did not load properly.</h2>

        <p>
          
Please try refreshing the page. If you continue to see this message, please <a href="https://fareharbor.com/help/submit/">contact us</a>.
        </p>

        <p style="color: #767e84;">
          Error code: <b>no-assets</b>.
        </p>

        <hr>
      </div>
    

    
      <div class="preload ">
        <div class="spinner-ticker-wrap">
          <i class="spinner-ticker-css"><span></span></i>
          
            

              
               Loading The Lone Star Carriage Company...
            
          
        </div>
      </div>
    

    
  
  
  <div id="ng-app" class="application" ng-app="site" ng-controller="site.IndexCtrl" ng-support-hacks="" ng-blur-escape="" ng-dimensions="" ng-dimensions-viewport="" ng-load-time="">
<script type="text/ng-template" id="404">
<div class="error-error">
<h2>[[ errorTitle ? errorTitle : T('Not found') ]]</h2>
<div>
Sorry about that. You may have followed a bad or outdated link. If you need help, please <a ng-href="https://fareharbor.com/help/submit/" ng-outbound-link="_blank">contact Support</a>.
</div>
</div>
</script>
<script type="text/ng-template" id="booking-receipt-physical-locations">
<div ng-init="item = booking.availability.item; primaryLocation = Booking.effectivePrimaryLocation(booking)">
<div class="receipt-ticket-row test-pre-location-indicator receipt-ticket-physical-location"
ng-if-once="item.preLocation && item.preLocation.isOnline"
ng-link="booking-receipt-physical-location"
ng-with="physicalLocation = item.preLocation; label = company.preLocationHeading || Company.DEFAULT_PRE_LOCATION_HEADING"
></div>
<div class="receipt-ticket-row test-start-location-indicator receipt-ticket-physical-location"
ng-if-once="item.startLocation && item.startLocation.isOnline"
ng-link="booking-receipt-physical-location"
ng-with="physicalLocation = item.startLocation; label = company.startLocationHeading || Company.DEFAULT_START_LOCATION_HEADING"
></div>
<div class="receipt-ticket-row test-primary-location-indicator receipt-ticket-physical-location"
ng-if-once="primaryLocation && primaryLocation.isOnline"
ng-link="booking-receipt-physical-location"
ng-with="
physicalLocation = primaryLocation;
label = company.primaryLocationHeading || ((item.startLocation && item.startLocation.isOnline) ? Company.DEFAULT_PRIMARY_LOCATION_HEADING : Company.DEFAULT_START_LOCATION_HEADING);
"
></div>
<div class="receipt-ticket-row test-end-location-indicator receipt-ticket-physical-location"
ng-if-once="item.endLocation && item.endLocation.isOnline"
ng-link="booking-receipt-physical-location"
ng-with="physicalLocation = item.endLocation; label = company.endLocationHeading || Company.DEFAULT_END_LOCATION_HEADING"
></div>
</div>
</script>
<script type="text/ng-template" id="booking-receipt-physical-location">
<div class="table valign-middle receipt-ticket-table">
<div class="tr">
<div class="td">
<h2 class="receipt-ticket-title">
<i class="icon-receipt-pin-location"></i>
[! label !]
</h2>
<div class="prose prose-section prose--large"
ng-link="physical-address"
ng-with="addressObject = physicalLocation"
></div>
<div class="prose prose-section"
ng-if-once="physicalLocation.note"
ng-bind-html="physicalLocation.noteSafeHtml"
></div>
</div>
<div class="td ticket-table-buttons">
<a class="btn btn-darkgrey nowrap"
ng-href="[! physicalLocation.googleDirectionsUrl !]"
ng-outbound-link="_blank"
>Get directions &rsaquo;</a>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="receipt-contact">
<ul>
<li ng-if="contact.name" class="receipt-overview-property">
<b>[! contact.name !]</b>
</li>
<li ng-if="contact.email" class="receipt-overview-property">
[! contact.email !]
</li>
<li ng-if="contact.phone" class="receipt-overview-property">
[! contact.phone !]
</li>
</ul>
</script>
<script type="text/ng-template" id="booking-receipt-generated-codes">
<div ng-repeat="generatedCustomField in generatedCustomFields" class="prose">
<div ng-if="generatedCustomField.customField.bookingNotes" class="receipt-ticket-generated-codes-header"
ng-bind-html-once="generatedCustomField.customField.bookingNotesSafeHtml"
></div>
<p ng-repeat="generatedCampaign in generatedCustomField.generatedCampaigns">
<span class="ticket-generated-codes">
<b>
[[ interpolate(nT('Your %(campaignName)s code:', 'Your %(campaignName)s codes:', generatedCampaign.generatedCodes.length), { campaignName: generatedCampaign.generatingCampaign.campaign.name }) ]]
</b>
<span ng-repeat="generatedCode in generatedCampaign.generatedCodes">
<code>[[ generatedCode.code ]]</code><span ng-if="!$last">,</span>
</span>
</span>
<span ng-if="generatedCampaign.generatingCampaign.instructions"
ng-bind-html-once="generatedCampaign.generatingCampaign.instructionsSafeHtml"
></span>
</p>
</div>
</script>
<script type="text/ng-template" id="booking-receipt-generated-cards">
<div class="table valign-middle receipt-ticket-table">
<div class="tr">
<div class="td">
<div class="table valign-middle receipt-card-overview">
<div class="tr">
<div class="td">
<i ng-background-color="company.features.storedValueCardBackground || Company.FH_BLUE"
class="tiny-svc"
></i>
</div>
<div class="td">
<h3 class="fh-grey">[! storedValueCard.storedValueType.name !]</h3>
<span class="monospace text-huge">[! storedValueCard.number || storedValueCard.obscuredNumber !]</span>
</div>
<div class="td">
<h3 class="fh-grey">Amount</h3>
<div class="text-huge">[! storedValueCard.balance|amount:storedValueCard !]</div>
</div>
<div class="td">
<div ng-if="storedValueCard.contact">
<h3 class="fh-grey">To</h3>
[! storedValueCard.contact.name !]
</div>
</div>
</div>
</div>
</div>
<div class="td ticket-table-buttons">
<a class="btn btn-grey nowrap"
ng-href="[! storedValueCard.$url(urls.company.storedValueCard.index) !]?edit=yes"
>
<i class="tb-icon email"></i>
Add message and send &rsaquo;
</a>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="booking-receipt-new-transportation">
<div ng-if="!!booking.stop" ng-then="hasStop">
<h3 class="new-pickup-time">
We'll pick you up at [! booking.stop.time|time !] from [! booking.stop.pickup.name !]
</h3>
<div class="transportation-note md-inline" ng-show="booking.stop.pickup.description"
ng-bind-html-once="booking.stop.pickup.descriptionSafeHtml"
></div>
<a ng-href="[! booking.stop.pickup.mapUrl !]"
ng-show="booking.stop.pickup.mapUrl"
ng-outbound-link="_blank"
class="pickup-map-link-confirmation"
>
See pickup location on a map
</a>
</div>
<div ng-else="hasStop">
<h3 class="new-pickup-time">
Please arrive by [! booking.availability.startAt|dateSubtract:booking.item.noTransportationMinutes:'minutes'|time !]
</h3>
<div class="md-inline"
ng-if="
booking.lodging.noTransportationNotesSafeHtml ||
booking.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
ng-bind-html-once="
booking.lodging.noTransportationNotesSafeHtml ||
booking.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
></div>
</div>
</script>
<script type="text/ng-template" id="receipt-payments">
<ul class="receipt-payments">
<li ng-repeat="payment in payments|orderBy:'createdAt'"
ng-if-once="!payment.isRefunded && !payment.isDeferred && payment.type !== Payment.AFFILIATE_TYPE && (payment.initialReceipt.gross || payment.initialReceipt.bookingFee)"
>
<div>
<b class="text-huge">
[! auth.currentUser.isAuthenticated ? (payment.receipt.gross|amount:currency) : (payment.receipt.total|amount:currency) !]
</b>
<span ng-if-once="auth.currentUser.isAuthenticated && payment.initialReceipt.bookingFee"
class="fh-grey"
>+ booking fee<br></span>
</div>
<div ng-if-once="payment.isProcessorBasedType" ng-then="ccPayment">
<span ng-if-once="payment.isCardOnFile">Paid with [! payment.cardName !]</span>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)">[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</span>
</div>
<div ng-else="ccPayment">
[! payment.displayType !]
</div>
<div class="fh-grey text-small">
[! payment.createdAt|datetime !]
</div>
<div ng-if-once="payment.isProcessorBasedType"
class="receipt-payment-clearing-text"
>
Will appear on your statement as [! Booking.statementText(company, payments) !].
</div>
</li>
<li ng-if-once="company.features.isAmountDueOnReceiptsEnabled && amountDue">
Amount due: <b ng-amount="amountDue"></b>
</li>
</ul>
</script>
<script type="text/ng-template" id="receipt-booking">
<div ng-if-once="auth.permissions.can('viewAmounts', booking.company) && booking.needsPricedConfirmations"
ng-then="canViewAmounts"
></div>
<div class="receipt-booking-header"
ng-init="
generatedCustomFields = Booking.generatedCustomFields(booking);
cancelFormToggle = 'isCancelling' + booking.pk;
"
>
<div class="receipt-ticket-row">
<div class="table valign-middle full-width ">
<div class="tr">
<div class="td">
<div class="receipt-ticket-pk">
<span class="badge badge-error" ng-if-once="booking.isCancelled">Cancelled</span>
<b>[! booking.availability.item.isRetail ? cT('"order" as in sales order', 'Order') : T('Booking') !] #[! booking.pk !]</b>
</div>
<div class="receipt-ticket-availability">
<div class="[! booking.availability.item.isRetail ? 'receipt-ava' : 'receipt-item' !]">
[! booking.item.name !]
<span ng-if="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</div>
<div class="receipt-ava" ng-if-once="!booking.availability.item.isRetail">
[! booking.availability.startAt|datetimeRange:(booking.availability.endAt):'long' !]
</div>
<div class="receipt-breakdown test-receipt-breakdown-indicator">[! booking.customerBreakdown !]</div>
</div>
<div ng-if="booking.company.features.isOnlineCancellationEnabled && !booking.isCancelled"
ng-hide="toggles.state(cancelFormToggle)"
class="receipt-cancel-link respond-print-hide"
>
<span class="fh-grey underline pointer" ng-toggle ng-toggle-value="cancelFormToggle">
[! booking.availability.item.isRetail ? cT('"order" as in sales order', 'Cancel order') : T('Cancel booking') !]
</span>
</div>
</div>
<div class="td respond-print-hide"
ng-if-once="!booking.isCancelled && !booking.availability.item.isRetail && !clientOptions.isKioskModeEnabled"
>
<div class="receipt-ticket-add-to-cal nowrap">
<div class="receipt-ticket-add-to-cal-header">
Add to your calendar:
</div>
<div class="table table-dont-respond">
<a ng-href="[! booking.googleCalendarEventTemplateUrl !]" ng-outbound-link="_blank"
class="tr"
>
<span class="td">
<i class="tb-icon google"></i>
</span>
<span class="td">
Google Calendar
</span>
</a>
<a ng-href="[! order.icsUrl || booking.icsUrl !]" ng-outbound-link="_blank"
class="tr"
>
<span class="td">
<i class="tb-icon ical"></i>
</span>
<span class="td">
Apple Calendar
</span>
</a>
<a ng-href="[! booking.yahooCalendarEventTemplateUrl !]" ng-outbound-link="_blank"
class="tr"
>
<span class="td">
<i class="tb-icon yahoo"></i>
</span>
<span class="td">
Yahoo Calendar
</span>
</a>
<a ng-href="[! order.icsUrl || booking.icsUrl !]" ng-outbound-link="_blank"
class="tr"
>
<span class="td">
<i class="tb-icon outlook"></i>
</span>
<span class="td">
Outlook Calendar
</span>
</a>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-toggled ng-toggled-value="cancelFormToggle">
<div ng-controller=
"company.item.CancelBookingCtrl"
class="[[ dataCtrl.status|css ]]
receipt-ticket-row self-cancel
"
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="!Booking.isEligibleForOnlineCancellation(booking)" ng-then="notEligible">
<div class="company-text-heading text-left">
<h2>[! booking.availability.item.isRetail ? T('Cancel Order') : T('Cancel Booking') !]</h2>
</div>
<ul class="self-cancel-options">
<li>Online cancellation is not available for this booking. Please contact us.</li>
</ul>
<div class="btns">
<button class="btn btn-grey" type="button"
ng-toggle ng-toggle-value="cancelFormToggle"
>
Close
</button>
</div>
</div>
<form class="test-cancel-booking-view-indicator"
name="cancelBookingForm"
ng-confirm-navigate-away
ng-else="notEligible"
>
<div ng-if="submitting" class="company-text-heading">
<div class="spinner
instant
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<h2>Cancelling...</h2>
<p>Please do not leave or refresh this page</p>
</div>
<div ng-if="!submitting">
<div class="company-text-heading text-left">
<h2>[! booking.availability.item.isRetail ? T('Cancel Order') : T('Cancel Booking') !]</h2>
<p ng-if="maximumCancellationCutoffAt">
You can cancel until [! maximumCancellationCutoffAt|datetime !].
</p>
</div>
<ul class="self-cancel-options">
<li>
<div class="field field-cb bold test-select-booking-action"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="confirmCancel"
>
</span>
<span class="label-text">
[! booking.availability.item.isRetail ? T('Yes, please cancel my order.') : T('Yes, please cancel my booking.') !]
</span>
</span>
</label>
</div>
<div class="fh-grey">Check this box to confirm you want to cancel.</div>
</li>
<li ng-if="booking.payments.length" ng-then="hasPayments">
<div ng-if="refundAmount === 0" ng-then="noRefund"
class="text-medium"
>
Based on our cancellation policy, you will not be refunded.
</div>
<div ng-else="noRefund">
<b>You'll be refunded [! refundAmount|amount:booking !] based on our cancellation policy.</b> It may take up to 30 days for your card issuer or bank to return your funds. Refunds will show on your statement as [! Booking.statementText(company, payments) !].
</div>
</li>
</ul>
<div class="fields "
>
</div>
<div class="hide">
<div class="cancelbookingform-refundgross "
ng-django-field="cancelBookingForm [&#39;refundGross&#39;]" ng-django-field-model="cancelBookingData [&#39;refundGross&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cancelBookingData [&#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cancelBookingForm [&#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cancelBookingForm [&#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cancelBookingForm [&#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelbookingform-iscanceleligible "
ng-django-field="cancelBookingForm [&#39;isCancelEligible&#39;]" ng-django-field-model="cancelBookingData [&#39;isCancelEligible&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_cancel_eligible" name="isCancelEligible" ng-model="cancelBookingData [&#39;isCancelEligible&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;isCancelEligible&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelbookingform-isonline "
ng-django-field="cancelBookingForm [&#39;isOnline&#39;]" ng-django-field-model="cancelBookingData [&#39;isOnline&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_online" name="isOnline" ng-model="cancelBookingData [&#39;isOnline&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;isOnline&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="cancelBookingForm.all.$error.refund_failure">unable to cancel due to refund failure</li>
<li ng-repeat="error in cancelBookingForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn btn-left btn-red" type="submit"
ng-disabled="!confirmCancel || cancelBookingForm.$invalid || cancelBookingForm.$submitting"
ng-click="submit(cancelBookingForm)"
>
Cancel now
</button>
<button class="btn btn-grey" type="button"
ng-toggle ng-toggle-value="cancelFormToggle"
>
Don&#039;t change
</button>
</div>
</div>
</form>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="!booking.isCancelled && !toggles.state(cancelFormToggle)">
<div ng-if="booking.item.isScanningEnabled"
class="receipt-ticket-row receipt-ticket-tickets"
ng-link="booking-receipt-tickets"
></div>
<div ng-repeat="customField in Booking.waiverCustomFields(booking)"
class="receipt-ticket-row receipt-ticket-waivers"
ng-link="booking-receipt-waiver"
></div>
<div ng-repeat="customFieldValue in booking.customFieldValues"
ng-if="customFieldValue.customFieldInstance.customField.type === CustomField.TRANSPORTATION_TYPE &&
customFieldValue.totalPricing.visibility.isVisible && !customFieldValue.totalPricing.visibility.isHiddenOnReceipts"
class="receipt-ticket-row receipt-ticket-transportation"
ng-inline="booking-receipt-transportation"
></div>
<div ng-with="customFieldValue = Booking.newTransportation(booking)"
ng-if="!!customFieldValue"
class="receipt-ticket-row receipt-ticket-transportation"
ng-link="booking-receipt-new-transportation"
></div>
<div ng-repeat="storedValueCard in booking.generatedStoredValueCards"
class="receipt-ticket-row receipt-ticket-cards"
ng-link="booking-receipt-generated-cards"
></div>
<div ng-if="generatedCustomFields.length"
class="receipt-ticket-row receipt-ticket-generated-codes"
ng-link="booking-receipt-generated-codes"
></div>
<div ng-if-once="!Booking.newTransportation(booking) && !booking.availability.item.isRetail"
ng-link="booking-receipt-physical-locations"
></div>
</div>
</div>
<div class="respond-print-hide" ng-if="booking.item.effectivePostCheckoutFlowNode"
ng-suggested-items="booking.item.effectivePostCheckoutFlowNode"
ng-suggested-items-booking="booking"
></div>
<div class="booking-receipt-details"
ng-if-once="!booking.isCancelled"
>
<div class="booking-receipt-notes"
ng-if="booking.item.cancellationNotes || booking.company.cancellationNotes ||
booking.item.bookingNotes || booking.company.bookingNotes || selectedCustomFields"
>
<div class="prose">
<div ng-repeat="selectedCustomField in selectedCustomFields" class="prose-section">
<div ng-bind-html-once="selectedCustomField.bookingNotesSafeHtml"></div>
</div>
<div ng-if="booking.item.bookingNotesSafeHtml"
ng-bind-html-once="booking.item.bookingNotesSafeHtml"
class="prose-section"
></div>
<div ng-if="booking.company.bookingNotesSafeHtml"
ng-bind-html-once="booking.company.bookingNotesSafeHtml"
class="prose-section"
></div>
</div>
<div class="booking-receipt-cancellation"
ng-if="booking.item.cancellationNotes || booking.company.cancellationNotes"
>
<h2 class="booking-sub-header">Cancellations</h2>
<div ng-bind-html-once="booking.item.cancellationNotesSafeHtml || booking.company.cancellationNotesSafeHtml"
class="prose"
></div>
</div>
</div>
<div class="booking-receipt-customers"
ng-with="includeAmounts = canViewAmounts; itableClasses = true;"
>
<h2 class="booking-sub-header">Details</h2>
<div ng-if="booking.customers.length >= booking.company.companyFeatures.summarizeBookingCustomersMinimum"
ng-then="summarizeCustomers"
ng-group="booking.customers"
>
<div ng-group-by="$row.customerTypeRate.customerPrototype.customerType.singular + '__' +
(canViewAmounts ? ($row.costs.totalCost.price || null) : '')"
ng-group-as="$row.customerTypeRate.customerPrototype.customerType.singular"
ng-group-default
></div>
<div class="customer-type-card"
ng-repeat="group in $groups"
>
<table class="invoice-table">
<tbody>
<tr class="invoice-table--row no-border is-flashy">
<td class="itable-content"
ng-with="showingPrice = group.rows[0].costs.totalCost.price && canViewAmounts;"
>
<b>[[ group.as ]]<span ng-if="showingPrice">:</span></b>
<span class="fh-grey"
ng-if="showingPrice"
>
<span ng-amount="group.rows[0].costs.totalCost.price"
ng-amount-company="booking.company"
></span>
</span>
<span class="fh-grey">x [[ group.rows.length ]]</span>
</td>
<td class="itable-amount"
ng-if="canViewAmounts"
>
<span ng-show="!!group.rows[0].costs.totalCost.price"
ng-amount="group.rows|summary:'costs.totalCost.price'"
ng-amount-company="booking.company"
></span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="customer-type-card"
ng-else="summarizeCustomers"
ng-repeat="customer in booking.customers"
>
<table class="invoice-table">
<tbody>
<tr class="invoice-table--row no-border is-flashy">
<td class="itable-content">[! customer.customerTypeRate.customerPrototype.customerType.singular !]</td>
<td class="itable-amount" ng-if="canViewAmounts">
<span ng-show="!!customer.costs.totalCost.price"
ng-costs="customer.costs"
ng-costs-company="booking.company"
></span>
</td>
</tr>
</tbody>
<tbody ng-repeat="customFieldValue in customer.customFieldValues"
ng-inline="receipt-custom-field-values"
></tbody>
</table>
</div>
<table class="invoice-table">
<tbody ng-repeat="customFieldValue in booking.customFieldValues"
ng-inline="receipt-custom-field-values"
></tbody>
<tbody ng-repeat="lineItem in booking.lineItems"
ng-if="!lineItem.isPrivate"
ng-inline="receipt-line-items"
></tbody>
</table>
<table class="spreadsheet"
ng-if-once="booking.company.features.isAmountDueOnReceiptsEnabled && booking.costs.totalCost.total && booking.needsPricedConfirmations"
>
<tbody ng-init="
hasExplicitGross = booking.explicitGross !== null;
costs = booking.costs;
fee = booking.receipt.bookingFee;
showTaxByType = Booking.showTaxByType(booking);
showZeroTax = !booking.item.isNoTax;
company = booking.company;
"
ng-inline="receipt-subtotal-total"
></tbody>
<tbody ng-if-once="booking.costs.totalCost.total && (booking.receiptCollectedByCharter.gross || booking.amountDue)">
<tr>
<td colspan="100">&nbsp;</td>
</tr>
</tbody>
<tbody ng-inline="receipt-amount-paid"></tbody>
<tbody ng-if-once="booking.amountDue"
ng-inline="receipt-amount-due"
></tbody>
</table>
</div>
</div>
</script>
<script type="text/ng-template" id="booking-receipt-tickets">
<div class="table valign-middle receipt-ticket-table">
<div class="tr">
<div class="td">
<h2 class="receipt-ticket-title">
<i class="icon-receipt-tickets"></i> [! nT('Important: Your Ticket', 'Important: Your Tickets', booking.customerCount) !]
</h2>
<div class="prose prose-section">
<div ng-if="booking.item.scanningInstructions" ng-then="scanningInstructions"
ng-bind-html="booking.item.scanningInstructionsSafeHtml"
></div>
<div ng-else="scanningInstructions">
<p class="respond-print-hide">
[! nT(
'Click the button to go to your ticket. Please bring a printed copy or have it ready on your phone so we can check you in.',
'Click the button to go to your tickets. Please bring a printed copy or have them ready on your phone so we can check you in.',
booking.customerCount
) !]
</p>
<p class="respond-print-show">
[! nT(
'Please bring a printed copy of your ticket or have it ready on your phone so we can check you in.',
'Please bring a printed copy of your tickets or have them ready on your phone so we can check you in.',
booking.customerCount
) !]
</p>
</div>
</div>
</div>
<div class="td ticket-table-buttons respond-print-hide">
<a class="btn btn-darkgrey nowrap"
ng-href="[! booking.$url(urls.embeds.checkin.company.booking.index) !]"
ng-outbound-link
>[! nT('Go to your ticket', 'Go to your tickets', booking.customerCount) !] &rsaquo;</a>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="booking-receipt-transportation">
<h3 class="pickup-time">
<span ng-if="customFieldValue.transportationOption.isSelfTransportation" ng-then="selfTransportation">
<span ng-if="booking.availability" ng-then="knownStart" class="notranslate">
Please arrive by [[ booking.availability.startAt|dateSubtract:customFieldValue.transportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
Please arrive [[ customFieldValue.transportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
<span ng-else="selfTransportation">
<span ng-if="booking.availability" ng-then="knownStart" class="notranslate">
We'll pick you up at [[ booking.availability.startAt|dateSubtract:customFieldValue.transportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
We'll pick you up [[ customFieldValue.transportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
</h3>
<div class="transportation-note md-inline" ng-if="customFieldValue.transportationOption.description"
ng-bind-html-once="customFieldValue.transportationOption.descriptionSafeHtml"
></div>
</script>
<script type="text/ng-template" id="booking-receipt-waiver">
<div class="table valign-middle receipt-ticket-table">
<div class="tr">
<div class="td">
<h2 class="receipt-ticket-title waiver"><i class="icon-receipt-waiver"></i> [! customField.title !]</h2>
<div ng-if="customField.description" class="prose prose-section"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div class="td ticket-table-buttons">
<ul>
<li ng-repeat="connectedWaiver in customField.connectedWaivers">
<a class="btn btn-darkgrey nowrap"
ng-href="[! connectedWaiver.waiver|waiverUrl:booking !]"
target="_blank"
>
Sign [! connectedWaiver.waiver.displayName || connectedWaiver.waiver.name !] &rsaquo;
</a>
</li>
</ul>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="cf-description">
<div class="cf-description md-inline"
ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</script>
<script type="text/ng-template" id="receipt-custom-field-values">
<tr ng-if-once="customFieldValue.isSelected && customFieldValue.totalPricing.visibility.isVisible &&
!customFieldValue.totalPricing.visibility.isHiddenOnReceipts &&
customFieldValue.customFieldInstance.customField.type !== CustomField.TRANSPORTATION_TYPE &&
customFieldValue.customFieldInstance.customField.type !== CustomField.WAIVER_TYPE &&
!(
customFieldValue.customFieldInstance.customField.type === CustomField.CODE_GENERATOR_TYPE &&
!hasPriceCell && !customFieldValue.customFieldInstance.customField.title &&
!customFieldValue.customFieldInstance.customField.hint
)"
ng-with="hasPriceCell = includeAmounts && customFieldValue.costs.totalCost.price && booking.needsPricedConfirmations"
class="[! itableClasses ? 'invoice-table--row no-border' : '' !]"
>
<td colspan="[! hasPriceCell ? 1 : 2 !]"
class="itable-content"
>
<b ng-show="customFieldValue.customFieldInstance.customField.title || customFieldValue.customFieldInstance.customField.hint">
[! (customFieldValue.customFieldInstance.customField.title || customFieldValue.customFieldInstance.customField.hint)|colonless !]:
</b>
[! customFieldValue.anonymousDisplayValue !]
</td>
<td ng-if-once="hasPriceCell"
class="[! itableClasses ? 'itable-amount' + (customFieldValue.customFieldInstance.customField.isAlwaysPerCustomer && !customFieldValue.customer ? ' long' : '') : '' !]"
>
<span ng-if-once="customFieldValue.customFieldInstance.customField.isAlwaysPerCustomer && !customFieldValue.customer"
ng-then="showAppliedPrice"
>
<span ng-if-once="customFieldValue.totalPricing.price.offset || customFieldValue.totalPricing.price.rate"
ng-then="hasPrice"
>
<span ng-if-once="customFieldValue.totalPricing.price.modifierKind === PriceLine.OFFSET_MODIFIER_KIND">
<span ng-amount="customFieldValue.totalPricing.price.offset" ng-amount-company="booking.company"></span> applied per customer
</span>
<span ng-if-once="customFieldValue.totalPricing.price.modifierKind === PriceLine.PERCENTAGE_MODIFIER_KIND">
[! customFieldValue.totalPricing.price.rate|percentage !] applied per customer
</span>
</span>
<span ng-else="hasPrice">Applied per customer</span>
</span>
<span ng-else="showAppliedPrice"
ng-costs="customFieldValue.costs"
ng-costs-company="booking.company"
></span>
</td>
</tr>
</script>
<script type="text/ng-template" id="receipt-customer-with-custom-field-values">
<tbody>
<tr>
<td>[! customer.name !]</td>
<td ng-if-once="includeAmounts">
<span ng-show="customer.costs.totalCost.price && booking.needsPricedConfirmations"
ng-costs="customer.costs"
ng-costs-company="booking.company"
></span>
</td>
</tr>
</tbody>
<tbody ng-repeat="customFieldValue in customer.customFieldValues"
ng-inline="receipt-custom-field-values"
></tbody>
</script>
<script type="text/ng-template" id="receipt-line-items">
<tr class="[! itableClasses ? 'invoice-table--row no-border' : '' !]">
<td class="itable-content">
<b>[! lineItem.description !]</b>
</td>
<td class="[! itableClasses ? 'itable-amount' : '' !]">
<span
ng-if="canViewAmounts && booking.needsPricedConfirmations"
ng-costs="lineItem.costs"
ng-costs-company="booking.company"
></span>
</td>
</tr>
</script>
<script type="text/ng-template" id="receipt-subtotal-total">
<tr ng-if="!hasExplicitGross">
<td class="text-right"><b>Subtotal</b></td>
<td ng-costs="costs" ng-costs-company="company"></td>
</tr>
<tr ng-repeat="taxType in (showTaxByType ? taxTypes : [])"
ng-if-once="(costs.totalCost.taxByType[taxType.pk]|isDefined) && (costs.totalCost.taxByType[taxType.pk] || showZeroTax)"
>
<td class="text-right"><b>[! taxType.name !]</b></td>
<td ng-amount="costs.totalCost.taxByType[taxType.pk]"
ng-amount-company="company"
></td>
</tr>
<tr ng-if="!hasExplicitGross && !showTaxByType && (costs.totalCost.tax || showZeroTax || fee)">
<td class="text-right">
<b ng-if="!fee" ng-then="onlyTax">[! Company.taxDisplayName(company) !]</b>
<b ng-if="!costs.totalCost.tax && !showZeroTax" ng-then="onlyFee">Fees</b>
<b ng-if="!onlyTax && !onlyFee">[! interpolate(T('%(taxes_name)s & Fees'), { 'taxes_name': Company.taxDisplayName(company) }) !]</b>
</td>
<td ng-amount="costs.totalCost.tax + fee"
ng-amount-company="company"
></td>
</tr>
<tr ng-if="(hasExplicitGross || showTaxByType) && fee">
<td class="text-right">
<b>Fees</b>
</td>
<td ng-amount="fee"
ng-amount-company="company"
></td>
</tr>
<tr class="spreadsheet-text-medium">
<td class="text-right"><b>Total</b></td>
<td ng-amount="costs.totalCost.total + fee"
ng-amount-company="company"
></td>
</tr>
</script>
<script type="text/ng-template" id="receipt-amount-paid">
<tr class="spreadsheet-text-medium" ng-show="booking.receiptCollectedByCharter.gross + booking.receipt.bookingFee">
<td class="text-right">
<b ng-if-once="booking.company" ng-then="paidToCharterCompany">
Paid to [! booking.company.name !]
</b>
<b ng-else="paidToCharterCompany">Paid</b>
</td>
<td ng-amount="booking.receiptCollectedByCharter.gross + booking.receipt.bookingFee"
ng-amount-company="booking.company"
></td>
</tr>
</script>
<script type="text/ng-template" id="receipt-amount-due">
<tr class="spreadsheet-text-medium">
<td class="text-right"><b>Amount Due</b></td>
<td ng-amount="booking.amountDue"
ng-amount-company="booking.company"
></td>
</tr>
</script>
<script type="text/ng-template" id="order-receipt-amount-due">
<tr class="spreadsheet-text-medium">
<td class="text-right"><b>Amount Due</b></td>
<td ng-amount="order.amountDue"
ng-amount-company="order.company"
></td>
</tr>
</script>
<script type="text/ng-template" id="ng-data">
<div ng-if="dataCtrl.type === 'manual'" ng-then="manual">
<div ng-transclude></div>
</div>
<div ng-else="manual">
<div ng-if="dataCtrl.status === 'loading'">
<div ng-if="dataCtrl.type === 'small'" ng-then="small"
class="ng-data-spinner"
>
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-else="small">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success' || (dataCtrl.status === 'error' && dataCtrl.transcludeOnError)">
<div ng-transclude></div>
</div>
</div>
</script>
<script type="text/ng-template" id="data-disconnect">
<div class="error-error">
<h2>Could not reach FareHarbor</h2>
Please check your internet connection.
<span ng-if="dataCtrl.retry">
(<a ng-click="dataCtrl.retry()">Or click here to retry.</a>)
</span>
<br>
If you need help, please <a ng-href="https://fareharbor.com/help/submit/" ng-outbound-link="_blank">contact Support</a>.
</div>
</script>
<script type="text/ng-template" id="data-error">
<div class="error-error">
<h2>Something went wrong.</h2>
Please try refreshing the page.
<span ng-if="dataCtrl.retry">
(<a ng-click="dataCtrl.retry()">Or click here to retry.</a>)
</span>
<br>
If you need help, please <a ng-href="https://fareharbor.com/help/submit/" ng-outbound-link="_blank">contact Support</a>.
</div>
</script>
<script type="text/ng-template" id="forbidden">
<div class="forbidden-message test-forbidden">
<span ng-if="!auth.currentUser.isAuthenticated" ng-then="anonymous"
ng-redirect="navigation.loginRedirectUrl()" ng-redirect-mode="'replace'"
></span>
<span ng-else="anonymous">
<span ng-if-once="isReadonlyEnabled" ng-then="readonlyEnabled">
<span class="badge badge-error">Read-Only</span><b> mode enabled</b><br>
This section is unavailable. <br>
<a class="fh-blue underline"
ng-href="https://fareharbor.com/help/more/read-only/"
ng-outbound-link="_blank"
>Learn more</a>
</span>
<span ng-else-once="readonlyEnabled">
<b>Not allowed.</b> Please <a ng-href="[! navigation.loginRedirectUrl(true) !]" class="test-forbidden-different-user-link fh-blue underline">log in as a different user</a> or request permission from your administrator to view this.
</span>
</span>
</div>
</script>
<script type="text/ng-template" id="mobile-flyout-close">
<div class="mobile-flyout-close respond-handhelds-show"
ng-toggled
ng-toggled-value="toggle"
>
<span class="btn btn-grey"
ng-toggle
ng-toggle-value="toggle"
ng-toggle-group="tb-flyouts"
ng-shortcut="'esc'"
ng-shortcut-click
>
Close
</span>
</div>
</script>
<script type="text/ng-template" id="slideshow-dots">
<ul class="slideshow-dots" ng-if="slideshow.slides.length > 1">
<li class="slideshow-dot [[ slideshow.currentSlide === slide ? 'active' : '' ]]"
ng-repeat="slide in slideshow.slides"
ng-click="slideshow.showSlide(slide)"
>
</li>
</ul>
</script>
<script type="text/ng-template" id="slideshow-arrows">
<div class="slideshow-arrows" ng-if="slideshow.slides.length > 1">
<div class="slideshow-arrow arrow prev" ng-click="slideshow.previous()">&larr;</div>
<div class="slideshow-arrow arrow next" ng-click="slideshow.next()">&rarr;</div>
</div>
</script>
<script type="text/ng-template" id="switch-devices-nag">
<div class="device-switch-nag respond-handhelds-show">
<div class="hint hint-alert">
<b>Full pricing options are available on bigger screens.</b> Please switch devices or make your browser window wider.
</div>
</div>
</script>
<script type="text/ng-template" id="f-req">
<i class="field-required-flag"
ng-tip="[[ label ? label : T('Answer is required') ]]"
ng-tip-location="i"
ng-tip-touch="true"
><i></i></i>
</script>
<script type="text/ng-template" id="ng-load-spinner">
<div class="ng-load-spinner">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
</script>
<script type="text/ng-template" id="ng-load-error">
<div class="error-error">
<h2>Could not reach FareHarbor</h2>
<div>
Our apologies. Please check your internet connection and <a ng-click="navigation.reload()">try refreshing the page</a>.
</div>
<div class="error-code">
If you continue to see this message, please <a ng-href="https://fareharbor.com/help/submit/" ng-outbound-link>contact Support</a>.
Error code: <b>module-load</b>.
</div>
</div>
</script>
<script type="text/ng-template" id="invoice-contact-info">
<div><b>[[ company.billingName ? company.billingName : company.name ]]</b></div>
<div ng-if="company.billingStreet" ng-then="hasBillingAddress">
[[ company.billingStreet ]]
<span ng-if="company.billingCity || company.billingProvince || company.billingPostalCode">
<br>
[[ company.billingCity ]]<span ng-if="company.billingProvince || company.billingPostalCode">,</span>
[[ company.billingProvince ]] [[ company.billingPostalCode ]]
</span>
</div>
<div ng-else="hasBillingAddress"
ng-with="addressObject = company.primaryLocation || company"
ng-link="physical-address"
></div>
<br>
<ul>
<li ng-if="company.phone">[[ company.phone|phone ]]</li>
<li ng-if="company.billingEmail || company.email">[[ company.billingEmail || company.email ]]</li>
<li ng-if="company.url">[[ company.url|hostname ]]</li>
</ul>
</script>
<script type="text/ng-template" id="invoice-grouping">
<tr>
<td colspan="100" class="td-no-padding">
<div class="tb tb--inset-mobile">
<div class="tb-right" ng-link="invoice-grouping-flyout"></div>
</div>
</td>
</tr>
</script>
<script type="text/ng-template" id="invoice-grouping-flyout">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="tableGrouping"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="tb-icon collection"></i> Group by
</div>
<div class="tb-flyout tb-flyout--left tb-flyout--auto-width-narrow"
ng-toggled-show="tableGrouping"
>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'tableGrouping'"></div>
<ul class="flyout-menu-items-lis"
ng-toggle="tableGrouping"
>
<li ng-group-by>None</li>
<li ng-group-by="$row.booking.item.pk"
ng-group-as="$row.booking.item.name"
ng-group-name="[! T('Item') !]"
ng-group-default
>
Item
</li>
<li ng-group-by="$row.booking.agent.pk"
ng-group-as="$row.booking.agent ? $row.booking.agent.name : T('None')"
ng-group-name="[! T('Agent') !]"
>
Agent
</li>
<li ng-group-by="$row.booking.desk.pk"
ng-group-as="$row.booking.desk ? $row.booking.desk.name : T('None')"
ng-group-name="[! T('Desk') !]"
>
Desk
</li>
<li ng-group-by="$row.booking.availability.pk"
ng-group-sort-by="$row.booking.availability.startAt"
ng-group-as="$row.booking.availability.startAt|datetime:'short':'absolute':(entry.booking.availability.endAt)"
ng-group-name="[! T('Availability') !]"
>
Availability
</li>
</ul>
</div>
</div>
</script>
<script type="text/ng-template" id="invoice-paid-status">
<span ng-show="invoice.status === Invoice.UNPAID_STATUS" class="badge">Unpaid</span>
<span ng-show="invoice.status === Invoice.PENDING_STATUS" class="badge">Pending</span>
<span ng-show="invoice.status === Invoice.PAID_STATUS" class="badge badge-paid">Paid</span>
</script>
<script type="text/ng-template" id="physical-address">
<span class="physical-address">
[! addressObject.street !]
<br ng-if-once="addressObject.street && (addressObject.city || addressObject.province || addressObject.postalCode)" />
<span ng-if-once="addressObject.city || addressObject.province || addressObject.postalCode">
[! addressObject.city !]<span ng-if-once="addressObject.province || addressObject.postalCode">,</span>
[! addressObject.province !] [! addressObject.postalCode !]
</span>
</span>
</script>
<script type="text/ng-template" id="
supported-languages-popover
">
<div class="popover "
ng-body-class="'hide-body-overflow--handhelds is-popover-open'"
>
<div class="triangle js-triangle"></div>
<div class="popover-content-wrap">
<div ng-can-list="SupportedLanguage on company"
ng-can-only-when="popoverCtrl.status === 'success'"
ng-then="loadedData"
>
<ul class="popover-menu supported-languages-menu">
<li ng-repeat="supportedLanguage in popoverCtrl.supportedLanguages">
<a class="popover-menu-action with-popup"
ng-href="[! popoverCtrl.translationOverlayUrl(supportedLanguage) !]"
>
<b>[! supportedLanguage.unicode !]</b>
<span class="fh-grey"
ng-if-once="!supportedLanguage.isLive"
>
(Not Active)
</span>
<span class="popover-language-translation fh-grey"
ng-if="popoverCtrl.fieldValueTranslation[supportedLanguage.pk].fieldValue !== null"
>
[! popoverCtrl.fetchTranslatedFieldValue(supportedLanguage.pk) !]
</span>
</a>
</li>
<li ng-if="!popoverCtrl.supportedLanguages.length">
<a class="popover-menu-action nowrap fh-grey" ng-href="[! company.$url(urls.dashboard.settings.translations.index) !]">
No languages added yet
</a>
</li>
</ul>
</div>
<div class="flyout-section" ng-if="popoverCtrl.status === 'error'" ng-then="error">
Sorry, there was an error loading translations
</div>
<div class="spinner-ticker-wrap popover-menu-spinner"
ng-else="loadedData || error"
>
<i class="spinner-ticker-css"><span></span></i> Loading languages...
</div>
<div class="flyout-section">
<div class="hint">
<a class="hint-help-link nowrap"
ng-href="https://fareharbor.com/help/dashboard/communication/language-translation/"
ng-outbound-link="_blank"
>
Learn about language translation
</a>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="translation-toggle-item">
<a ng-if="language === translationToggleCtrl.activeLanguage && (isPreviewLanguage || !translationToggleCtrl.previewLanguage)"
ng-then="isLanguageActive"
class="current"
ng-toggle="translateFlyout"
>
[! translationToggleCtrl.display(language) !]
<span ng-if-once="isPreviewLanguage">(Preview)</span>
</a>
<a ng-href="[! translationToggleCtrl.urlForLanguageCode(language) !]"
ng-outbound-link
ng-else="isLanguageActive"
ng-click="translationToggleCtrl.loadingIndicatorForLanguage(language)"
>
<i ng-if="translationToggleCtrl.newTargetLanguage == language" class="spinner-ticker-css fade-in-and-expand"><span></span></i>
[! translationToggleCtrl.display(language) !]
</a>
</script>
<script type="text/ng-template" id="ng-translation-toggle">
<div class="ben-flyout-wrap respond-print-hide">
<button class="btn-wide ben-item ben-item--icon-globe ben-item--toggle capitalize" type="button"
ng-toggle="translateFlyout"
ng-toggle-group="ben-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
[! translationToggleCtrl.display(translationToggleCtrl.activeLanguage) !]
<span class="fh-grey" ng-if-once="translationToggleCtrl.previewLanguage">(Preview)</span>
</button>
<div ng-toggled="translateFlyout"
class="ben-flyout ben-flyout--no-padding ben-flyout--left fade-in-up"
>
<div ng-if="translationToggleCtrl.state === translationToggleCtrl.STATE_COMPANY"
class="nowrap"
>
<ul ng-if="translationToggleCtrl.previewLanguage"
class="translation-language-list flyout-menu-items no-borders"
ng-init="language = translationToggleCtrl.activeLanguage; isPreviewLanguage = true"
>
<li ng-inline="translation-toggle-item"></li>
</ul>
<ul ng-if="translationToggleCtrl.fullLanguages.length"
class="translation-language-list flyout-menu-items no-borders"
>
<li ng-repeat="language in translationToggleCtrl.fullLanguages"
ng-inline="translation-toggle-item"
></li>
</ul>
<ul ng-if="translationToggleCtrl.partialLanguages.length"
class="translation-language-list flyout-menu-items no-borders text-medium"
>
<li ng-repeat="language in translationToggleCtrl.partialLanguages"
ng-inline="translation-toggle-item"
></li>
</ul>
<ul class="translation-language-list flyout-menu-items text-medium">
<li>
<button type="button" ng-click="translationToggleCtrl.setState(translationToggleCtrl.STATE_GOOGLE)"
class="fh-grey"
>
More options&nbsp;&rsaquo;
</button>
</li>
</ul>
</div>
<div ng-if="translationToggleCtrl.state === translationToggleCtrl.STATE_GOOGLE">
<button ng-if="translationToggleCtrl.showCompanyLanguages"
ng-click="translationToggleCtrl.setState(translationToggleCtrl.STATE_COMPANY)"
class="button-reset btn-wide flyout-back"
type="button"
>
Back
</button>
<div ng-if="translate.isReady"
class="flyout-section flyout-section--no-border flyout-section--no-top-padding"
ng-translate
></div>
</div>
<div ng-if="translationToggleCtrl.state === translationToggleCtrl.STATE_LOADING"
class="flyout-section flyout-section--no-border nowrap"
>
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="book.book">
<div ng-if="
(!!plusbook.currentContact && plusbook.currentContact.company !== availability.company) ||
(!!rebook.currentBooking && rebook.currentBooking.company !== availability.company)
" ng-then="bookingAcrossCompanies"
class="company-wrap-inner company-container unbookable-page"
>
<div class="company-text-heading">
<h2>Cannot book between companies</h2>
<p>Sorry, moving bookings between companies is not yet allowed.</p>
</div>
<div class="text-center">
<a class="btn-back" ng-back-button>Go back</a>
</div>
</div>
<div ng-else="bookingAcrossCompanies">
<div ng-if="!auth.permissions.canCreate(Booking, availability.company)" ng-then="notAllowed"
class="company-wrap-inner company-container unbookable-page"
>
<div class="company-text-heading">
<h2>You are not allowed to book for this company</h2>
<p>Sorry about that! If you continue to see this message, please contact your administrator.</p>
</div>
<div class="text-center">
<a class="btn-back" ng-back-button>Go back</a>
</div>
</div>
<div ng-else="notAllowed">
<div ng-if="availability.isBookable || auth.permissions.can('bookUnbookable', Availability, availability.company)"
ng-then="bookable"
ng-mx-view="view-book-form"
ng-mx-view-initial
ng-mx-data-availability="availability"
ng-mx-data="{ rebooking: rebook.currentBooking.uuid }"
class="
[[ auth.currentUser.isAuthenticated ? 'auth-book-wrap' : 'company-wrap anon-book-wrap' ]]
[[ addClassIf(!bookCtrl.bookCardsCtrl.hasAnyCustomFields() &&
!bookCtrl.bookBookingFieldsCtrl.hasAnyCustomFields() &&
bookCtrl.bookCountsCtrl.missingCount === 0 &&
auth.currentUser.isAuthenticated, 'book-form-no-fields') ]]
"
ng-body-class="'[[ auth.currentUser.isAuthenticated ? 'body-auth-booking' : '' ]]'"
ng-title="
[! availability.item.isRetail ?
interpolate(T('Buying %(itemName)s'), { itemName: availability.item.name }) :
interpolate(T('Booking %(itemName)s for %(date)s'), { itemName: availability.item.name, date: (availability.startAt|date) })
!]
- [! availability.company.name !]
"
>
<div class="auth-book-shim">
<div class="auth-book-shim-inner book-form-auth-width [! availability|colorClass:'-fill is-label':'no-color' !]"></div>
</div>
<div class="book-form-tb-wrap">
<div class="tb tb--inset-mobile book-form-tb book-form-auth-width"
ng-if="bookCtrl.currentUserCanCreateAsCompany || bookCtrl.currentUserCanCreateAsAffiliate"
>
<div class="tb-left">
<div class="tb-group">
<a class="tb-btn tb-btn--reports-overview" ng-back-button
ng-tip="[! T('Back') !]"
>
<i class="tb-icon back"></i>
<abbr>Back</abbr>
</a>
</div>
<div class="tb-group"
ng-hide="!bookCtrl.currentUserCanCreateAsCompany"
>
<div class="tb-flyout-wrap respond-print-hide"
ng-can-view="availability"
ng-with="statusToggle = 'status-' + $id"
>
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="statusToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<span ng-if="availability.isBookableOnlyByPhone" ng-then="callToBook">
<i class="tb-icon phone"></i> Call to book
</span>
<span ng-if="!callToBook && availability.unbookableReason" ng-then="closed">
<i class="tb-icon lock"></i> Online closed
</span>
<span ng-else="closed || callToBook" class="fh-blue">
<span ng-if="availability.isUnlisted">
<i class="tb-icon unlisted"></i> Unlisted
</span>
<span ng-else="availability.isUnlisted">
<i class="tb-icon online"></i> Bookable online
</span>
</span>
</div>
<div class="tb-flyout tb-flyout-availability-status tb-flyout--auto-width"
ng-toggled ng-toggled-value="statusToggle"
>
<div ng-controller=
"dashboard.shared.AvailabilityStatusEditable"
class="
availability-status-editable
" >
<div
ng-can-view="availability"
ng-then="allowed">
<form name="updateAvailabilityStatusForm"
ng-can-update="availability" ng-then="editing"
>
<div class="fields "
>
<div class="ava-status-header">
<div class="table table-dont-respond valign-middle ava-status-header-table">
<div class="tr">
<div class="td">
<div ng-if="Availability.isInPast(availability)" ng-then="noStatusPast">
This availability cannot be booked by or shown to online customers because it&#039;s in the past
</div>
<div ng-if="availability.item.isPrivate && !noStatusPast" ng-then="noStatusPrivate">
This availability cannot be booked by or shown to online customers because the item is set to private
</div>
<div ng-if="availability.unbookableReason && !noStatusPast && !noStatusPrivate" ng-then="unbookable">
Not bookable online: <b>[[ availability.unbookableReason ]]</b>
</div>
<div ng-if="!(unbookable || noStatusPast || noStatusPrivate)"
ng-then="bookableOnline"
>
<b class="ava-status-header-online">Currently bookable online</b>
</div>
</div>
</div>
</div>
</div>
<div class="flyout-section nowrap--desktop"
ng-else="noStatusPrivate || noStatusPast"
>
<ul class="list-filters">
<li ng-toggle="avaChangeStatus" ng-toggle-group="avaStatus" ng-toggle-default="true">
Change Status
</li>
<li ng-toggle="avaBookability" ng-toggle-group="avaStatus">
Bookability
</li>
</ul>
</div>
<div class="smush-fields" ng-toggled="avaChangeStatus">
<div class="updateavailabilitystatusform-status "
ng-django-field="updateAvailabilityStatusForm [&#39;status&#39;]" ng-django-field-model="editableAvailability [&#39;status&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<ul class="status-options">
<li ng-click="editableAvailability [&#39;status&#39;] = Availability.AUTO_STATUS; editCtrl.submit(updateAvailabilityStatusForm)"
class="availability-status [[ addClassIf(editableAvailability [&#39;status&#39;] === Availability.AUTO_STATUS, 'selected') ]]"
>
<h2>Auto close</h2>
<div class="status-hint">
&bull; When no space left<br>
<div ng-if="availability.customerCount > 0" ng-then="hasBookings">
<div ng-show="Availability.cutoffReachedKind(availability) === BookingRestriction.BEFORE_MIDNIGHT_CUTOFF_KIND">
&bull;
<span ng-show="Availability.cutoffReachedHours(availability)" ng-then="isNotMidnight">
[! Availability.cutoffReachedHours(availability) !] hours before midnight day of
</span>
<span ng-hide="isNotMidnight">At midnight day of</span>
</div>
<div ng-show="Availability.cutoffReachedKind(availability) === BookingRestriction.BEFORE_START_CUTOFF_KIND">
&bull;
<span ng-show="Availability.cutoffReachedHours(availability)" ng-then="isNotStart">
[! Availability.cutoffReachedHours(availability) !] hours before start
</span>
<span ng-hide="isNotStart">At start time</span>
</div>
</div>
<div ng-else="hasBookings">
<div ng-show="Availability.cutoffUnreachedKind(availability) === BookingRestriction.BEFORE_MIDNIGHT_CUTOFF_KIND">
&bull;
<span ng-show="Availability.cutoffUnreachedHours(availability)" ng-then="isNotMidnight">
[! Availability.cutoffUnreachedHours(availability) !] hours before midnight day of
</span>
<span ng-hide="isNotMidnight">At midnight day of</span>
</div>
<div ng-show="Availability.cutoffUnreachedKind(availability) === BookingRestriction.BEFORE_START_CUTOFF_KIND">
&bull;
<span ng-show="Availability.cutoffUnreachedHours(availability)" ng-then="isNotStart">
[! Availability.cutoffUnreachedHours(availability) !] hours before start
</span>
<span ng-hide="isNotStart">At start time</span>
</div>
</div>
</div>
</li>
<li ng-click="editableAvailability [&#39;status&#39;] = Availability.OPEN_STATUS; editCtrl.submit(updateAvailabilityStatusForm)"
class="availability-status [[ addClassIf(editableAvailability [&#39;status&#39;] === Availability.OPEN_STATUS, 'selected') ]]"
ng-else="availability.unbookableReason === 'Full'"
>
<h2><i class="tb-icon online"></i> Open override</h2>
<div class="status-hint">Ignore cutoff times when there is still space available</div>
</li>
<li ng-click="editableAvailability [&#39;status&#39;] = Availability.CALL_STATUS; editCtrl.submit(updateAvailabilityStatusForm)"
class="availability-status [[ addClassIf(editableAvailability [&#39;status&#39;] === Availability.CALL_STATUS, 'selected') ]]"
>
<h2><i class="tb-icon phone"></i> Closed & Call to book</h2>
<div class="status-hint">Don't allow online bookings, show "Call to Book" message</div>
</li>
<li ng-click="editableAvailability [&#39;status&#39;] = Availability.CLOSED_STATUS; editCtrl.submit(updateAvailabilityStatusForm)"
class="availability-status [[ addClassIf(editableAvailability [&#39;status&#39;] === Availability.CLOSED_STATUS, 'selected') ]]"
>
<h2><i class="tb-icon lock"></i> Closed & hidden</h2>
<div class="status-hint">
Only let [! company.name !] users see and book
</div>
</li>
</ul>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateAvailabilityStatusForm [&#39;status&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in updateAvailabilityStatusForm [&#39;status&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-toggled="avaBookability">
<div class="flyout-section">
<h2>Online booking link</h2>
<div ng-if="!Availability.isInPast(availability) && !availability.item.isPrivate && availability.status !== Availability.CLOSED_STATUS">
<ul class="giant-toggle field-margin-bottom">
<li ng-class="{ 'toggled': !editableAvailability.isUnlisted }"
ng-click="editableAvailability.isUnlisted = false; editCtrl.submit(updateAvailabilityStatusForm);"
>
Public
</li>
<li ng-class="{ 'toggled': editableAvailability.isUnlisted }"
ng-click="editableAvailability.isUnlisted = true; editCtrl.submit(updateAvailabilityStatusForm);"
>
<i class="ab-icon-unlisted icon-ava-unlisted"></i> Unlisted
</li>
</ul>
<div class="hint hint-alert" ng-if="availability.isUnlisted">
<span ng-if-once="availability.status !== Availability.CALL_STATUS">Only people with the link can see and book.</span>
<span ng-else-once="availability.status !== Availability.CALL_STATUS">Only people with the link can see.</span>
<a ng-href="https://fareharbor.com/help/dashboard/availabilities/unlisted/"
ng-outbound-link="_blank"
class="hint-help-link nowrap"
>How to use</a>
</div>
</div>
<textarea class="monospace url-copy-field" ng-autoselect readonly="readonly">https://fareharbor.com[[ availability.$url(urls.embeds.book.item.book) ]]?full-items=yes</textarea>
</div>
<div class="flyout-section"
ng-if="bookingRestrictions.length"
>
<h2>Restrictions</h2>
<ul class="flyout-presets">
<li class="flyout-preset-edit-wrap-clickable"
ng-else="editCtrl.editingBookingRestriction"
ng-click="editCtrl.editingBookingRestriction = true"
>
<span class="fh-blue" ng-if-once="availability.bookingRestriction">
Overridden: [[ availability.bookingRestriction.name ]]
</span>
<span class="fh-grey" ng-else-once="availability.bookingRestriction">
Use item settings ([[ availability.item.bookingRestriction ? availability.item.bookingRestriction.name : T('Custom restrictions') ]])
</span>
<a class="flyout-preset-edit-btn">
<span>Edit</span>
</a>
</li>
<li ng-if="editCtrl.editingBookingRestriction"
ng-init="editCtrl.isRestrictionsOverridden = !!availability.bookingRestriction"
>
<div class="field field-cb"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="editCtrl.isRestrictionsOverridden"
>
</span>
<span class="label-text">
Override restrictions
</span>
</span>
</label>
</div>
<div ng-if="editCtrl.isRestrictionsOverridden">
<div class="updateavailabilitystatusform-bookingrestriction "
ng-django-field="updateAvailabilityStatusForm [&#39;bookingRestriction&#39;]" ng-django-field-model="editableAvailability [&#39;bookingRestriction&#39;]"
>
<div ng-current-option="editableAvailability [&#39;bookingRestriction&#39;]"
ng-current-option-collection="bookingRestrictions"
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field">
<select name="booking_restriction"
ng-model="editableAvailability [&#39;bookingRestriction&#39;]"
ng-disabled=""
ng-options="bookingRestriction.pk as bookingRestriction.name for bookingRestriction in bookingRestrictions"
ng-dropdown
ng-placeholder="Choose restrictions"
ng-dropdown-allow-clear="false"
>
</select>
<i ng-link="f-req"></i>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="updateAvailabilityStatusForm [&#39;bookingRestriction&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in updateAvailabilityStatusForm [&#39;bookingRestriction&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div class="btns">
<button class="btn-tiny btn-green btn-left"
type="button"
ng-disabled="updateAvailabilityStatusForm.$invalid || updateAvailabilityStatusForm.$submitting || updateAvailabilityStatusForm.$pristine"
ng-click="editCtrl.submit(updateAvailabilityStatusForm)"
>Save</button>
<button class="btn-tiny btn-grey"
type="button"
ng-click="editCtrl.editingBookingRestriction = false"
>Cancel</button>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in updateAvailabilityStatusForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</form>
<div ng-else="editing"
class="ava-status-header"
>
<div ng-if="Availability.isInPast(availability)" ng-then="noStatusPast">
This availability cannot be booked by or shown to online customers because it&#039;s in the past
</div>
<div ng-if="availability.item.isPrivate && !noStatusPast" ng-then="noStatusPrivate">
This availability cannot be booked by or shown to online customers because the item is set to private
</div>
<div ng-if="availability.unbookableReason && !noStatusPast && !noStatusPrivate" ng-then="unbookable">
Not bookable online: <b>[[ availability.unbookableReason ]]</b>
</div>
<div ng-if="!(unbookable || noStatusPast || noStatusPrivate)"
ng-then="bookableOnline"
>
<b class="ava-status-header-online">Currently bookable online</b>
</div>
</div>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
<div class="flyout-section">
<div class="hint">
<a ng-href="https://fareharbor.com/help/dashboard/availabilities/updating/online-booking-status/"
ng-outbound-link="_blank"
class="hint-help-link"
>Get help with online booking statuses</a>
</div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = statusToggle"></div>
</div>
</div>
<div class="tb-flyout-wrap"
ng-can="viewCapacities on availability"
ng-with="capacityToggle = 'capacity-' + $id; isReady = bookCtrl.bookCountsCtrl && bookCtrl.bookCountsCtrl.liveCapacity && !bookCtrl.bookCountsCtrl.liveCapacity.$fresh;"
>
<div class="tb-btn tb-btn--flyout test-availability-capacity
[[ bookCtrl.bookCountsCtrl.liveCapacity|liveCapacityClass:bookCtrl ]]
"
ng-if-once="company.companyFeatures.isResourceBookableCapacityEnabled"
ng-then="resourceBookableCapacityEnabled"
ng-toggle ng-toggle-value="capacityToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="[! company|capacityIndicatorClass:'filled':'large' !]"></i>
<span>
[[ bookCtrl.bookCountsCtrl.availabilityCustomerCount || 0 ]] booked
</span>
<span ng-if="isReady && bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity !== null">
<i class="[! company|capacityIndicatorClass:'large' !]"></i>
[[
bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity < 0 ?
interpolate(T('Overbooked by %(count)s'), { count: -bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity }) :
''
]]
[[
!(bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity < 0) && bookCtrl.bookCountsCtrl.liveCapacity.isOverusingResources ?
' ' + T('Overusing resources') :
''
]]
[[
!availability.blocks.length && !(bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity < 0) && !(bookCtrl.bookCountsCtrl.liveCapacity.isOverusingResources) ?
interpolate(T('%(count)s available'), { count: bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity }) :
''
]]
[[
availability.blocks.length && !(bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity < 0) && !(bookCtrl.bookCountsCtrl.liveCapacity.isOverusingResources) ?
interpolate(T('%(count)s unreserved available'), { count: bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity }) :
''
]]
</span>
<div class="tb-progress"
ng-if="isReady && bookCtrl.bookCountsCtrl.availabilityCustomerCount && bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity !== null"
>
<div class="tb-progress-gutter"></div>
<div class="cb-progress"
ng-style="{ 'width': ((bookCtrl.bookCountsCtrl.availabilityCustomerCount / (bookCtrl.bookCountsCtrl.availabilityCustomerCount + bookCtrl.bookCountsCtrl.liveCapacity.availabilityLiveBookableCapacity))|cssPercentage) }"
></div>
</div>
</div>
<div class="tb-btn tb-btn--flyout test-availability-capacity
[[ (availability|capacityClass:(bookCtrl.bookCountsCtrl.availabilityCustomerCount)) ]]
"
ng-else-once="resourceBookableCapacityEnabled"
ng-toggle ng-toggle-value="capacityToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="[! company|capacityIndicatorClass:'large' !]"></i>
<span ng-if="bookCtrl.bookCountsCtrl.customerCount > 0" ng-then="hasCustomers">
<span ng-if="bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity < 0" ng-then="overbooked">
<b>Overbooking</b> by [[ -bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity ]]
</span>
<span ng-if="!alreadyOverbooked && !overbooked && availability.capacity !== null">
<span ng-if="availability.blocks.length" ng-then="hasUnreserved">
<span ng-if="bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity > 0" ng-then="capacityAboveZero">
[[ bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity ]] of [[ availability.customerCount + availability.bookableCapacity ]] unreserved available
</span>
<span ng-else="capacityAboveZero">
0 of [[ availability.customerCount + availability.bookableCapacity ]] unreserved available
</span>
</span>
<span ng-else="hasUnreserved">
<span ng-if="bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity > 0" ng-then="capacityAboveZero">
[[ bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity ]] of [[ availability.customerCount + availability.bookableCapacity ]] available
</span>
<span ng-else="capacityAboveZero">
0 of [[ availability.customerCount + availability.bookableCapacity ]] available
</span>
</span>
</span>
[[ availability.capacity === null ? interpolate(nT('%(count)s booked', '%(count)s booked', bookCtrl.bookCountsCtrl.availabilityCustomerCount), { count: bookCtrl.bookCountsCtrl.availabilityCustomerCount }) : '' ]]
</span>
<div class="tb-progress" ng-show="bookCtrl.bookCountsCtrl.availabilityCustomerCount && availability.capacity !== null">
<div class="tb-progress-gutter"></div>
<div class="cb-progress"
ng-style="{ 'width': bookCtrl.bookCountsCtrl ? (((availability.capacity - bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity) / availability.capacity)|cssPercentage) : 0 }"
></div>
</div>
<span ng-else="hasCustomers">
<span ng-if-once="availability.bookableCapacity === null" ng-then="nullCapacity">
[[ availability.customerCount ]] booked
</span>
<span ng-if-once="availability.customerCount > 0 && availability.nonResourceBookableCapacity < 0" ng-then="isOverbooking">
<b>Overbooked</b> by [[ -availability.nonResourceBookableCapacity ]]
<span class="icon-hint"
ng-tip="[! T('You can change this availability\'s capacity in Settings if it is not actually overbooked') !]"
ng-can-update="availability"
></span>
</span>
<span ng-if-once="!nullCapacity && !isOverbooking && availability.blocksIncludedNonResourceBookableCapacity === 0 && availability.customerCount > 0"
ng-then="isFullIncludingBlocks"
>
All [[ availability.customerCount ]] full
</span>
<span ng-else-once="nullCapacity || isOverbooking || isFullIncludingBlocks">
<span ng-if-once="availability.blocks.length">
[[ availability.bookableCapacity ]] of [[ availability.customerCount + availability.bookableCapacity ]] unreserved available
</span>
<span ng-else-once="availability.blocks.length">
[[ availability.bookableCapacity ]] of [[ availability.customerCount + availability.bookableCapacity ]] available
</span>
</span>
<div class="tb-progress" ng-show="availability.customerCount && availability.capacity !== null">
<div class="tb-progress-gutter"></div>
<div class="cb-progress"
ng-style-once="{ 'width': (((availability.customerCount || 0) / (availability.customerCount + availability.bookableCapacity))|cssPercentage)}"
></div>
</div>
</span>
</div>
<div class="tb-flyout tb-flyout--auto-width nowrap--desktop"
ng-toggled ng-toggled-value="capacityToggle"
>
<div ng-link="capacity-flyout"></div>
<div ng-link="mobile-flyout-close" ng-with="toggle = capacityToggle"></div>
</div>
</div>
</div>
<div class="tb-group"
ng-hide="!bookCtrl.currentUserCanCreateAsCompany"
>
<div class="tb-flyout-wrap">
<div class="[! auth.permissions.can('changePriceSheets', Booking, bookCtrl.availability.company) ? 'tb-btn tb-btn--flyout' : 'tb-text' !]"
ng-toggle="bookFormPricing"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-toggle-when="auth.permissions.can('changePriceSheets', Booking, bookCtrl.availability.company) && bookCtrl.isAutofillingComplete"
>
<span class="fh-grey">Pricing:</span>
<span ng-if="pricesCtrl.status !== 'success' || !bookCtrl.isAutofillingComplete" ng-then="loadingPricing">
Loading...
</span>
<span ng-else="loadingPricing"
ng-class="{ 'tb-two-lines': !!pricesCtrl.sheets.invoiceSheet }"
>
<span class="test-total-sheet-indicator">
[[ pricesCtrl.sheets.totalSheet.displayName ]]
</span>
<span class="test-invoice-sheet-indicator"
ng-if="pricesCtrl.sheets.invoiceSheet"
>
<br>[[ pricesCtrl.sheets.invoiceSheet.displayName ]]
</span>
</span>
</div>
<div class="tb-flyout tb-flyout--auto-width" ng-toggled="bookFormPricing">
<div class="flyout-section flyout-section--no-border"
ng-prices-navigation
></div>
<ul class="flyout-checklist"
ng-can="bookHiddenFields on Booking with company"
>
<li>
<label>
<input ng-model="bookCtrl.isShowingHiddenCustomFields" type="checkbox">
Show hidden when booking custom fields
</label>
</li>
</ul>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'bookFormPricing'"></div>
</div>
</div>
</div>
</div>
<div class="tb-right">
<div class="tb-group">
<div ng-presence="[! availability.uri !]:book"
ng-presence-tip="[! T('Also booking') !]"
ng-presence-icon="pencil-writing"
ng-presence-company="availability.company"
></div>
</div>
</div>
</div>
</div>
<div ng-if-in-labs="isTwoColumnBookFormEnabled" ng-then="twoColumnSplitTestRunning"></div>
<div class="create-booking test-book-view-indicator book-form-auth-width
[[ auth.currentUser.isAuthenticated ? 'book-auth' :
bookAnonColumns ? 'company-container book-anon-columns' : 'company-container book-anon'
]]
[[ addClassIf(bookForm.$submitting, 'form-loading') ]]
"
ng-with="bookAnonColumns = (twoColumnSplitTestRunning || bookCtrl.availability.company.features.isAlternateAnonBookFormEnabled) && !auth.currentUser.isAuthenticated"
>
<form
name="bookForm"
ng-submit="bookCtrl.submit(bookForm)"
ng-confirm-navigate-away
ng-confirm-navigate-away-when="!bookCtrl.isNavigateAwayAllowed(bookForm)"
>
<fieldset ng-disabled="bookForm.$submitting">
<div ng-if="bookCtrl.currentUserCanCreateAsCompany || bookCtrl.currentUserCanCreateAsAffiliate" ng-then="companyCreate"
ng-link="book.bookAuthenticated"
></div>
<div ng-else="companyCreate"
ng-link="book.bookAnonymous"
></div>
</fieldset>
<div class="form-loading-overlay"
ng-scroll-to="[[ auth.currentUser.isAuthenticated ? 'top' : '' ]]"
ng-scroll-on-click
ng-scroll-smooth
ng-if="bookForm.$submitting"
>
<div class="spinner-booking"></div>
<div class="processing-note">
<span ng-if="tokenizingCard">
Processing payment...
</span>
<span ng-if="!tokenizingCard">
[! availability.item.isRetail ? cT('"order" as in sales order', 'Finishing order...') : T('Finishing reservation...') !]
</span>
</div>
<div class="processing-refresh-note">Please do not leave or refresh this page.</div>
</div>
</form>
</div>
</div>
<div class="company-wrap-inner company-container unbookable-page"
ng-if="!bookable && bookCtrl.availability.isBookableOnlyByPhone" ng-then="callToBook"
ng-mx-view="view-unavailable-book-form"
ng-mx-view-initial
ng-mx-data-availability="bookCtrl.availability"
>
<div ng-book-call-to-book></div>
</div>
<div ng-else="bookable || callToBook"
class="company-wrap-inner company-container unbookable-page"
ng-inline="404"
></div>
</div>
</div>
</script>
<script type="text/ng-template" id="book.bookAnonymous">
<div ng-if-in-labs="bookingFlash">
<div ng-init="bookingFlash = labs.data('bookingFlash')"
ng-if-once="!item.isRetail"
ng-flash-message="[[ bookingFlash.message ]]"
ng-flash-delay="2000"
ng-flash-duration="[[ bookingFlash.duration ? bookingFlash.duration : 7000 ]]"
ng-flash-type="[[ bookingFlash.type ? bookingFlash.type : 'warn' ]]"
></div>
</div>
<div class="form-errors">
<ul class="errors test-server-error-indicator">
<li ng-if="bookForm.all.$error.explicit-invoice-price-permissions">There was an error processing this request. Please refresh the page and try again. (U-INVP)</li>
<li ng-if="bookForm.all.$error.explicit-gross-permissions">There was an error processing this request. Please refresh the page and try again. (U-EXP)</li>
<li ng-if="bookForm.all.$error.demo_mismatch">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.archived_item">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.no_total_sheet">There was an error calculating prices for this booking. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.availability_overbooked">Sorry, there is not enough room for this many customers. Please go back and choose a different option.</li>
<li ng-if="bookForm.all.$error.rebook_rebooked_booking">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.availability_not_bookable">Some options you selected are no longer available. Please update your booking and try again.</li>
<li ng-if="bookForm.all.$error.not_visible">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.invalid_order">There was an error processing this request. Please refresh the page and try again. (O-INVALID)</li>
<li ng-if="bookForm.all.$error.show_hidden_permissions">There was an error processing this request. Please refresh the page and try again. (U-FIELDS)</li>
<li ng-if="bookForm.all.$error.booking-cancelled">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.price_sheet_permissions">There was an error processing this request. Please refresh the page and try again. (U-SHEET)</li>
<li ng-if="bookForm.all.$error.booking-rebooked">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.unsatisfiable-resources">Sorry, we were unable to create your booking with the current selections. Please refresh the page and try again. (R-UNSAT)</li>
<li ng-if="bookForm.all.$error.unknown_error">There was an error processing this request. Please refresh the page and try again. (U-BOOK)</li>
<li ng-repeat="error in bookForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="bookForm.all.$error.$tokenization">
<li ng-repeat="error in bookForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
</div>
<div class="fields
book-form-fields
"
>
<div class="company-wrap-inner"
ng-if="
bookCtrl.availability.nonResourceBookableCapacity !== null &&
bookCtrl.availability.nonResourceBookableCapacity <= 0 &&
!bookCtrl.isAvailabilityInCart
"
ng-then="notLiveBookable"
>
<div ng-book-call-to-book></div>
</div>
<div ng-else="notLiveBookable">
<div class="company-container-back">
<a class="btn-back"
ng-if="bookCtrl.isAvailabilityInCart"
ng-then="inCart"
ng-href="[! bookCtrl.availability.company.$url(urls.company.cart.index) !]"
ng-mx-click="goto-cart--from-book-form"
>Return to cart</a>
<span ng-else="inCart">
<span ng-if="availability.item.isRetail" ng-then="retail">
<a class="btn-back test-button-back-from-ava"
ng-if-once="skipSingleItemView && !flows.isNoFlow()"
ng-href="[! flows.currentFlowNodeUrl(company) !]"
ng-mx-click="goto-item-grid--from-book-form"
>Back</a>
<a class="btn-back test-button-back-from-ava"
ng-else-once="skipSingleItemView"
ng-href="[! availability.item.$url(urls.company.item.index); !]"
ng-mx-click="goto-item--from-book-form"
>Back</a>
</span>
<span ng-else="retail">
<a class="btn-back test-button-back-from-ava"
ng-if="availability.item.isGroupedCalendar" ng-then="backToDay"
ng-href="[! availability.$url(urls.company.item.date) !]"
ng-mx-click="goto-item--from-book-form"
>Choose a different time</a>
<a class="btn-back test-button-back-from-ava"
ng-else="backToDay || backToFlowNode"
ng-href="[! availability.item.$url(urls.company.item.calendar) !]"
ng-mx-click="goto-item--from-book-form"
>Choose a different date or time</a>
</span>
</span>
<div class="required-fields-note respond-handhelds-hide">
Fields marked with <span class="required-flag-icon">*</span> are required
</div>
</div>
<a class="book-form-ssl" ng-if-once="lightframe.isParentInsecure()"
ng-href="[! navigation.compose(availability.$url(urls.embeds.book.item.book), { referrer: lightframe.parentUrl() }) !]"
ng-outbound-link="_top"
ng-mx-click="lightframe-insecure-parent"
ng-mx-availability="availability"
>
<i class="icon-lock-green"></i>
<b>This form was loaded through a secure iframe.</b> If you'd prefer to be able to see the lock icon at the top of your browser, <span class="book-form-ssl-link">click here</span>.
</a>
<div class="book-form-header test-anonymous-book-form-indicator">
<div class="company-wrap-inner table full-width">
<div class="tr">
<div class="book-form-header-availability td">
<h2 class="booking-sub-header">[! availability.item.isRetail ? T("You're Buying") : T("You're Booking") !]</h2>
<h1 class="booking-item test-availability-info-indicator">
[! availability.item.name !]
<span ng-if-once="availability.headline">
&mdash;<br>
<span ng-bind="availability.headline"></span>
</span>
</h1>
<div ng-if="!availability.item.isRetail" class="notranslate">
<span class="booking-availability respond-handhelds-hide"
ng-bind-html-once="availability.startAt|datetimeRange:(availability.endAt):'long'"
></span>
<span class="booking-availability respond-handhelds-show"
ng-bind-html-once="availability.startAt|datetimeRange:(availability.endAt):'long':'html'"
></span>
</div>
<div ng-if="!bookAnonColumns"
ng-item-ratings class="book-form-header-ratings"
></div>
</div>
<div class="book-form-header-for td">
<div ng-if="!bookAnonColumns"
ng-book-counts
></div>
<div ng-if="bookAnonColumns"
ng-item-ratings class="book-form-header-ratings"
></div>
</div>
</div>
</div>
<div class="book-form-header-shadow"></div>
</div>
<div ng-hide="bookCtrl.pricesCtrl.status === 'initializing'"
class="book-anon-columns-wrap"
ng-book-totals
>
<div class="book-anon-columns-left">
<div ng-if="bookAnonColumns">
<div class="book-anon-columns-section is-header">
Choose Options
</div>
<div ng-book-counts
class="book-anon-columns-section with-bottom-border book-anon"
></div>
</div>
<div ng-book-cards></div>
<div ng-book-booking-fields></div>
<div ng-if="bookCtrl.bookCountsCtrl.customerCount && !bookCtrl.bookCountsCtrl.missingCount" ng-then="showCompleteFields">
<div class="book-anon-columns-section is-header"
ng-if="bookAnonColumns && !bookCtrl.availability.company.features.isCartEnabled"
>
[[ paymentCtrl.kind() !== paymentCtrl.SKIP_KIND ? T('Contact & Payment') : T('Contact') ]]
</div>
<div ng-link="book.totals"
class="[[ addClassIf(bookAnonColumns, 'respond-desktop-hide book-anon-columns-section') ]]"
></div>
<div ng-if="bookCtrl.availability.company.features.isCartEnabled" ng-then="addToCart"
class="company-wrap-inner"
>
<div class="table full-width valign-middle cart-submit">
<div class="tr">
<div class="td cart-submit-cancellation respond-handhelds-hide"
ng-if="availability.item.cancellationNotes || availability.company.cancellationNotes"
>
<div ng-if="!rebook.currentBooking && (availability.item.cancellationNotes || availability.company.cancellationNotes)">
<h2 class="booking-sub-header">
Cancellations
</h2>
<div class="booking-cancellation-policy prose"
ng-bind-html-once="availability.item.cancellationNotesSafeHtml || availability.company.cancellationNotesSafeHtml"
></div>
</div>
</div>
<div ng-cart-add class="td"
ng-if="!bookAnonColumns"
></div>
</div>
</div>
<div class="respond-handhelds-show">
<div ng-if="!rebook.currentBooking && (availability.item.cancellationNotes || availability.company.cancellationNotes)">
<h2 class="booking-sub-header">
Cancellations
</h2>
<div class="booking-cancellation-policy prose"
ng-bind-html-once="availability.item.cancellationNotesSafeHtml || availability.company.cancellationNotesSafeHtml"
></div>
</div>
</div>
</div>
<div ng-else="addToCart">
<div class="form-errors--middle">
<div ng-book-errors></div>
<div class="form-errors">
<ul class="errors test-server-error-indicator">
<li ng-if="bookForm.all.$error.explicit-invoice-price-permissions">There was an error processing this request. Please refresh the page and try again. (U-INVP)</li>
<li ng-if="bookForm.all.$error.explicit-gross-permissions">There was an error processing this request. Please refresh the page and try again. (U-EXP)</li>
<li ng-if="bookForm.all.$error.demo_mismatch">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.archived_item">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.no_total_sheet">There was an error calculating prices for this booking. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.availability_overbooked">Sorry, there is not enough room for this many customers. Please go back and choose a different option.</li>
<li ng-if="bookForm.all.$error.rebook_rebooked_booking">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.availability_not_bookable">Some options you selected are no longer available. Please update your booking and try again.</li>
<li ng-if="bookForm.all.$error.not_visible">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.invalid_order">There was an error processing this request. Please refresh the page and try again. (O-INVALID)</li>
<li ng-if="bookForm.all.$error.show_hidden_permissions">There was an error processing this request. Please refresh the page and try again. (U-FIELDS)</li>
<li ng-if="bookForm.all.$error.booking-cancelled">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.price_sheet_permissions">There was an error processing this request. Please refresh the page and try again. (U-SHEET)</li>
<li ng-if="bookForm.all.$error.booking-rebooked">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.unsatisfiable-resources">Sorry, we were unable to create your booking with the current selections. Please refresh the page and try again. (R-UNSAT)</li>
<li ng-if="bookForm.all.$error.unknown_error">There was an error processing this request. Please refresh the page and try again. (U-BOOK)</li>
<li ng-repeat="error in bookForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="bookForm.all.$error.$tokenization">
<li ng-repeat="error in bookForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
</div>
</div>
<div class="secure-badge respond-handhelds-show" ng-if="!lightframe.isParentInsecure()">
<i class="icon-lock-white"></i> Secured with 2048-bit encryption
</div>
<div class="[[ bookAnonColumns ? 'book-anon-columns-section' : 'company-wrap-inner' ]]">
<div ng-link="anon-gift-card-button" ng-if="bookAnonColumns"></div>
<div class="book-form-complete-left book-anon-columns-section-narrow"
ng-mx-form-valid="complete-contact-form"
>
<fieldset ng-book-notification="bookCtrl.newBooking" ng-book-notification-anonymous >
<legend class="booking-sub-header">
Contact
</legend>
<div class="fields "
>
<div class="bookform-contact-name field-person-icon hide-label-text "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]" ng-placeholder="Full name" ng-prefix="'contact'" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if-once="contact ? contact.company.companyFeatures.isContentTranslationEnabled : company.companyFeatures.isContentTranslationEnabled">
<a ng-toggle="contactLanguageDropdown" class="form-link-subtle hide-when-toggled contact-language-toggle"
ng-toggle-default="contact.language"
>
Change contact language
</a>
<div ng-toggled="contactLanguageDropdown">
<div class="bookform-contact-language
field-globe-icon
"
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-language-dropdown
>
<div ng-current-option="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-current-option-collection=""
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="language"
ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-disabled="languageDropdownCtrl.isLoading"
ng-options="lang.code as lang.display group by lang.group for lang in languageDropdownCtrl.languageChoices"
ng-dropdown
ng-placeholder="[! T('Select a language') !]"
ng-dropdown-allow-clear="false"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="bookform-contact-phone field-phone-icon hide-label-text
international-phone-field
"
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Phone number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone" maxlength="32" name="phone" ng-international-phone-field="true" ng-international-phone-field-countries="Contact.COUNTRIES" ng-international-phone-field-phone-country-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]" ng-pattern="/^[^a-zA-Z]{5,32}$/" ng-placeholder="Phone number" ng-prefix="'contact'" ng-required="!auth.currentUser.isAuthenticated" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="
company.isSmsEnabled &&
SmsNotification.isEligiblePhoneNumber(
bookCtrl.newBooking['contact' + '-phone'],
bookCtrl.newBooking['contact' + '-phoneCountry'],
company
)
">
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value="false"
class="ng-pristine"
ng-model="bookCtrl.newBooking.isSmsEnabled"
>
</span>
<span class="label-text">
Opt-in to text messages
<span class="icon-hint" ng-tip="[[ company.features.isInternationalSmsEnabled ? T('Customer may pay fees to their carrier') : T('Customer may pay fees to their carrier, US numbers only') ]]"></span>
</span>
</span>
</label>
</div>
</div>
<div class="bookform-contact-email field-email-icon hide-label-text "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-prefix="'contact'" ng-required="!auth.currentUser.isAuthenticated" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<span ng-mailcheck="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]"
class="mailcheck-suggestion"
></span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-show="(auth.currentUser.isAuthenticated && (newBooking['contact-email'] || bookCtrl.newBooking.email)) || !auth.currentUser.isAuthenticated">
<div ng-if="auth.currentUser.isAuthenticated" ng-then="internalSubscribe">
<div class="bookform-contact-issubscribed field-cb-light "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-prefix="'contact'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Subscribe to company email list
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-else="internalSubscribe">
<div class="bookform-contact-issubscribed field-cb-light "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-prefix="'contact'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Get future email updates from [[ company.name ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="bookform-contact-phonecountry "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]"
>
<label >
<span class="label-text">
Phone country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone_country" name="phoneCountry" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-prefix="'contact'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</fieldset>
</div>
<div class="book-form-complete-middle book-anon-columns-section-narrow book-form-payment"
ng-mx-form-valid="complete-payment-form"
>
<fieldset ng-if="paymentCtrl.kind() !== paymentCtrl.SKIP_KIND">
<legend class="booking-sub-header">
Payment
</legend>
<div class="fields
respond-print-hide
"
>
<div ng-if="!paymentCtrl.isAnonymous">
<div class="bookform-payments-payment-kind "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]"
ng-django-field-required=""
>
<ul ng-radio-flyer
class="field-radio-group "
>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.SKIP_KIND)"
class="test-payment-kind-skip-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.SKIP_KIND"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
Don&#039;t add payment now
</label>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.DEFER_KIND)"
class="test-payment-kind-defer-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.DEFER_KIND"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
Save card to charge later
</label>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.PARTIAL_KIND)"
class="test-payment-kind-partial-action"
>
<label class="has-child">
<input type="radio" name="kind"
ng-value="paymentCtrl.PARTIAL_KIND"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
[[ paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND ? T('Partial payment:') : T('Partial payment') ]]
</label>
</li>
<li ng-if="paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND">
<div class="radio-content">
<div class="bookform-payments-payment-gross field-partial-payment-gross
field-amount
"
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-default="paymentCtrl.defaultGross()" ng-amount-input-max="paymentCtrl.amountMax()" ng-amount-input-min="paymentCtrl.amountMin()" ng-amount-input-positive="true" ng-autofocus="true" ng-autofocus-select="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'payments-payment'" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="tb tb--inset-mobile" ng-if="!!splitPaymentCtrl">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="splitPaymentCalc"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate split payment') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate split payment</abbr>
</div>
<div ng-toggled="splitPaymentCalc"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-section flyout-section--no-border">
<h2>Calculate split payment</h2>
<div class="hint">
Divide the booking total after taxes ([[ splitPaymentCtrl.amount|amount:company ]]) into equal amounts.
</div>
<table class="split-payment-table">
<tr>
<td class="text-right">
Split into:
</td>
<td>
<div class="field people-field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
ng-model="splitPaymentCtrl.divideByPeople"
ng-pattern="/^\d+$/"
ng-int-input
ng-int-input-min="1"
>
</span>
<div class="people-label">[[ nT('payment', 'payments', splitPaymentCtrl.divideByPeople) ]]</div>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td class="text-right">
Apply:
</td>
<td ng-autofocus>
<div class="field people-field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
ng-model="splitPaymentCtrl.payForPeople"
ng-pattern="/^\d+$/"
ng-int-input
ng-int-input-min="1"
ng-int-input-max="splitPaymentCtrl.divideByPeople"
>
</span>
<div class="people-label">[[ nT('payment', 'payments', splitPaymentCtrl.payForPeople) ]]</div>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td class="text-right">
Cost:
</td>
<td>
[[ splitPaymentCtrl.splitAmount|amount:company ]]
</td>
</tr>
<tr class="split-payment-set">
<td></td>
<td>
<button type="submit"
ng-click="splitPaymentCtrl.useSplitAmount()"
class="btn-tiny btn-green"
ng-disabled="splitPaymentCtrl.splitAmount <= 0"
>Set</button>
</td>
</tr>
</table>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'splitPaymentCalc'"></div>
</div>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.FULL_KIND)"
class="test-payment-kind-full-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.FULL_KIND"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
[[ paymentCtrl.isDefaultAmountInvoicePrice() ? T('Invoice amount') : T('Pay in full') ]]
</label>
</li>
<li ng-if="!paymentCtrl.isAnyKindValid()"
class="form-error"
>
<b>No available payment options.</b> Please contact your administrator.
</li>
</ul>
</div>
<div ng-if="paymentCtrl.affiliation() && paymentCtrl.needsPayment()">
<div class="bookform-payments-payment-iscollectedbyaffiliate "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]"
>
<div class="affiliate-form-header">Collected By</div>
<ul ng-radio-flyer
class="test-payment-collected-by-field-indicator field field-radio-group "
>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(false)"
class="test-collected-by-affiliate-false-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="false"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>[[ paymentCtrl.company|name ]]</b>
</span>
</label>
</li>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(true)"
class="test-collected-by-affiliate-true-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="true"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>[[ paymentCtrl.affiliation().affiliateCompany|name ]]</b>
</span>
</label>
</li>
</ul>
</div>
</div>
</div>
<div ng-if="paymentCtrl.needsPayment() && paymentCtrl.needsOption()">
<div class="bookform-optionandextras "
ng-django-field="bookForm [&#39;optionAndExtras&#39;]" ng-django-field-model="paymentCtrl [&#39;optionAndExtras&#39;]"
>
<div class="affiliate-form-header">Payment Type</div>
<ul ng-radio-flyer
class="field-radio-group
"
>
<li class="field-radio-inline-header fh-green">
Pay [[ paymentCtrl.amount()|amount:company ]] with:
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IN_STORE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.inStorePaymentTypes"
class="test-payment-action-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="bookform-payments-payment-instorepaymentnote "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payments-payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.AFFILIATE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.affiliateInStorePaymentTypes"
class="test-payment-action-affiliate-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="bookform-payments-payment-instorepaymentnote "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payments-payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.FILE_OPTION)" ng-repeat="payment in paymentCtrl.cardPayments"
class="test-payment-action-file field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="payment"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge <b>[[ payment.displayProcessorBasedType ]]</b> <b>[[ payment.processorBasedIdentifier ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CARD_ON_FILE_OPTION)" ng-repeat="cardOnFile in paymentCtrl.cardsOnFile"
class="test-payment-action-card-on-file field-radio-icon--cc"
>
<label class="[! addClassIf(paymentCtrl.company.isDemoModeEnabled, 'is-disabled') !]">
<input type="radio" name=""
ng-value="cardOnFile"
ng-disabled="paymentCtrl.company.isDemoModeEnabled"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge company card <b>[[ cardOnFile.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CHARGE_OPTION)"
class="test-payment-action-charge field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.CHARGE_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge card
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.EMV_OPTION)"
class="test-payment-action-emv field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.EMV_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge with <b>[[ emv.currentDevice.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IDEAL_OPTION)"
class="test-payment-action-ideal"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.IDEAL_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
iDEAL
<i ng-svg="svg-ideal"></i>
</label>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.SOFORT_OPTION)"
class="test-payment-action-sofort"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.SOFORT_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Sofort
<i ng-svg="svg-sofort"></i>
</label>
</li>
<li ng-if="!paymentCtrl.isAnyOptionValid()">
No valid payment options
</li>
</ul>
</div>
</div>
<div ng-if="paymentCtrl.option() === paymentCtrl.IDEAL_OPTION"
class="labels-above"
>
<div class="bookform-payments-payment-stripeidealbanktype "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Please select your bank
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_stripe_ideal_bank_type" name="stripeIdealBankType" ng-dropdown="true" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]" ng-options="choice[0] as choice[1] for choice in Payment.IDEAL_BANK_TYPE_CHOICES" ng-placeholder="Bank name" ng-prefix="'payments-payment'" ng-required="true">
<option value="abn_amro">ABN AMRO</option>
<option value="asn_bank">ASN Bank</option>
<option value="bunq">bunq</option>
<option value="handelsbanken">Handelsbanken</option>
<option value="ing">ING</option>
<option value="knab">Knab</option>
<option value="moneyou">Moneyou</option>
<option value="rabobank">Rabobank</option>
<option value="regiobank">RegioBank</option>
<option value="sns_bank">De Volksbank (SNS Bank)</option>
<option value="triodos_bank">Triodos Bank</option>
<option value="van_lanschot">Van Lanschot</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="paymentCtrl.option() === paymentCtrl.SOFORT_OPTION"
class="labels-above"
>
<div class="bookform-payments-payment-stripesofortcountry "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Please select your country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_stripe_sofort_country" name="stripeSofortCountry" ng-dropdown="true" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]" ng-options="choice[0] as choice[1] for choice in Payment.SOFORT_COUNTRY_CHOICES" ng-placeholder="Country name" ng-prefix="'payments-payment'" ng-required="true">
<option value="AT">Austria</option>
<option value="BE">Belgium</option>
<option value="DE">Germany</option>
<option value="IT">Italy</option>
<option value="NL">Netherlands</option>
<option value="ES">Spain</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="paymentCtrl.needsCharge()">
<div class="form-error" ng-if="paymentCtrl.isAmountTooLow()">
<span ng-if="!auth.currentUser.isAuthenticated" ng-then="isAnonUser">
Sorry, payment cannot be taken at this time.
<a href="https://fareharbor.com/help/submit/">Please contact FareHarbor.</a>
(Error code LH-[! Payment.MIN_CHARGE_AMOUNT !].)
</span>
<span ng-else="isAnonUser">
<span ng-if="paymentCtrl.needsCharge()" ng-then="chargeTooLow">
Sorry, cards cannot be charged for amounts less than [! Payment.MIN_CHARGE_AMOUNT|amount:company !].
</span>
<span ng-else="chargeTooLow">
Sorry, payments cannot be created for [! 0|amount:company !].
</span>
</span>
</div>
</div>
<div ng-if="paymentCtrl.needsCardFields() && !paymentCtrl.isAmountTooLow()">
<div class="card-fields card-type-[[ paymentCtrl.cardTypeAbbreviation() ]]"
ng-class="{ 'test-cards-only': paymentCtrl.company.isDemoModeEnabled }"
>
<div class="card-fields-inner">
<div ng-if="paymentCtrl.company.isDemoModeEnabled" ng-then="demoCardForm"
class="card-fields-demo"
>
Demo mode
<i class="help-icon"
ng-tip="[! T('You can only use test credit card numbers while demo mode is on') !]"
></i>
</div>
<div ng-else="demoCardForm"
class="card-fields-secure"
>
<i class="icon-lock-green"></i> Secure and encrypted
<i class="icon-hint"
ng-hide="auth.currentUser.isAuthenticated"
ng-tip="[! interpolate(T('%(companyName)s will only be able to see the last 4 digits of your card number'), { companyName: paymentCtrl.company.name }) !]"
ng-tip-classes="tip-indent"
ng-tip-touch="true"
></i>
</div>
<div class="native-swiped-container"
ng-if="paymentCtrl.swiped && native.isNative"
ng-then="nativeSwiped"
>
<div>
<span class="badge badge-green">Swiped successfully</span>
</div>
<span class="card-number">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardLast4() ]]"
ng-model="bookCtrl.newBooking"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</span>
<div class="card-name">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardholdersName() ]]"
ng-model="bookCtrl.newBooking"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<a ng-click="paymentCtrl.stopSwiping()" class="btn btn-grey">
Enter different card
</a>
</div>
<div ng-else="nativeSwiped">
<span class="card-type-logo"></span>
<span class="card-number" ng-if-once="clientOptions.isKioskModeEnabled" ng-then="kioskMode">
<div class="bookform-payments-payment-cardnumber hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payments-payment'" ng-required="true" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span class="card-number" ng-else-once="kioskMode">
<div class="bookform-payments-payment-cardnumber hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payments-payment'" ng-required="true" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="card-name">
<span ng-if-once="kioskMode">
<div class="bookform-payments-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payments-payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="bookform-payments-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payments-payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Cardholder\'s name must match the name printed on the card') !]"
ng-tip-touch="true"
></div>
</div>
<div class="card-expiry">
<div class="card-form-header">Expiration date</div>
<div class="exp-month">
<div class="bookform-payments-payment-cardexpirymonth
pseudo-select
"
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName()" ng-then="hasValuecardMonth">
[[ KioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName() ]]
</span>
<span ng-else="hasValuecardMonth" class="exp-placeholder">
Month
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_month" name="cardExpiryMonth" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-prefix="'payments-payment'" required="required">
<option value="1">01 - January</option>
<option value="2">02 - February</option>
<option value="3">03 - March</option>
<option value="4">04 - April</option>
<option value="5">05 - May</option>
<option value="6">06 - June</option>
<option value="7">07 - July</option>
<option value="8">08 - August</option>
<option value="9">09 - September</option>
<option value="10">10 - October</option>
<option value="11">11 - November</option>
<option value="12">12 - December</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="exp-year">
<div class="bookform-payments-payment-cardexpiryyear
pseudo-select
"
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year()" ng-then="hasValuecardYear">
[[ KioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year() ]]
</span>
<span ng-else="hasValuecardYear" class="exp-placeholder">
Year
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_year" name="cardExpiryYear" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-prefix="'payments-payment'" required="required">
<option value="2019">2019</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
<option value="2028">2028</option>
<option value="2029">2029</option>
<option value="2030">2030</option>
<option value="2031">2031</option>
<option value="2032">2032</option>
<option value="2033">2033</option>
<option value="2034">2034</option>
<option value="2035">2035</option>
<option value="2036">2036</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="card-country-code">
<div class="bookform-payments-payment-countrycode field-select-full "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
>
<label >
<span class="label-text">
Country/Region
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_country_code" name="countryCode" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]">
<option value="" selected="selected"></option>
<option value="US">USA</option>
<option value="AF">Afghanistan</option>
<option value="AL">Albania</option>
<option value="DZ">Algeria</option>
<option value="AS">American Samoa</option>
<option value="AD">Andorra</option>
<option value="AO">Angola</option>
<option value="AI">Anguilla</option>
<option value="AQ">Antarctica</option>
<option value="AG">Antigua & Barbuda</option>
<option value="AR">Argentina</option>
<option value="AM">Armenia</option>
<option value="AW">Aruba</option>
<option value="AU">Australia</option>
<option value="AT">Austria</option>
<option value="AZ">Azerbaijan</option>
<option value="BS">Bahama</option>
<option value="BH">Bahrain</option>
<option value="BD">Bangladesh</option>
<option value="BB">Barbados</option>
<option value="BY">Belarus</option>
<option value="BE">Belgium</option>
<option value="BZ">Belize</option>
<option value="BJ">Benin</option>
<option value="BM">Bermuda</option>
<option value="BT">Bhutan</option>
<option value="BO">Bolivia</option>
<option value="BA">Bosnia and Herzegovina</option>
<option value="BW">Botswana</option>
<option value="BV">Bouvet Island</option>
<option value="BR">Brazil</option>
<option value="IO">British Indian Ocean Territory</option>
<option value="VG">British Virgin Islands</option>
<option value="BN">Brunei Darussalam</option>
<option value="BG">Bulgaria</option>
<option value="BF">Burkina Faso</option>
<option value="BI">Burundi</option>
<option value="KH">Cambodia</option>
<option value="CM">Cameroon</option>
<option value="CA">Canada</option>
<option value="CV">Cape Verde</option>
<option value="KY">Cayman Islands</option>
<option value="CF">Central African Republic</option>
<option value="TD">Chad</option>
<option value="CL">Chile</option>
<option value="CN">China</option>
<option value="CX">Christmas Island</option>
<option value="CC">Cocos (Keeling) Islands</option>
<option value="CO">Colombia</option>
<option value="KM">Comoros</option>
<option value="CG">Congo</option>
<option value="CK">Cook Iislands</option>
<option value="CR">Costa Rica</option>
<option value="HR">Croatia</option>
<option value="CU">Cuba</option>
<option value="CY">Cyprus</option>
<option value="CZ">Czech Republic</option>
<option value="DK">Denmark</option>
<option value="DJ">Djibouti</option>
<option value="DM">Dominica</option>
<option value="DO">Dominican Republic</option>
<option value="TP">East Timor</option>
<option value="EC">Ecuador</option>
<option value="EG">Egypt</option>
<option value="SV">El Salvador</option>
<option value="GQ">Equatorial Guinea</option>
<option value="ER">Eritrea</option>
<option value="EE">Estonia</option>
<option value="ET">Ethiopia</option>
<option value="FK">Falkland Islands (Malvinas)</option>
<option value="FO">Faroe Islands</option>
<option value="FJ">Fiji</option>
<option value="FI">Finland</option>
<option value="FR">France</option>
<option value="FX">France, Metropolitan</option>
<option value="GF">French Guiana</option>
<option value="PF">French Polynesia</option>
<option value="TF">French Southern Territories</option>
<option value="GA">Gabon</option>
<option value="GM">Gambia</option>
<option value="GE">Georgia</option>
<option value="DE">Germany</option>
<option value="GH">Ghana</option>
<option value="GI">Gibraltar</option>
<option value="GR">Greece</option>
<option value="GL">Greenland</option>
<option value="GD">Grenada</option>
<option value="GP">Guadeloupe</option>
<option value="GU">Guam</option>
<option value="GT">Guatemala</option>
<option value="GN">Guinea</option>
<option value="GW">Guinea-Bissau</option>
<option value="GY">Guyana</option>
<option value="HT">Haiti</option>
<option value="HM">Heard & McDonald Islands</option>
<option value="HN">Honduras</option>
<option value="HK">Hong Kong</option>
<option value="HU">Hungary</option>
<option value="IS">Iceland</option>
<option value="IN">India</option>
<option value="ID">Indonesia</option>
<option value="IQ">Iraq</option>
<option value="IE">Ireland</option>
<option value="IR">Islamic Republic of Iran</option>
<option value="IL">Israel</option>
<option value="IT">Italy</option>
<option value="CI">Ivory Coast</option>
<option value="JM">Jamaica</option>
<option value="JP">Japan</option>
<option value="JO">Jordan</option>
<option value="KZ">Kazakhstan</option>
<option value="KE">Kenya</option>
<option value="KI">Kiribati</option>
<option value="KP">Korea, Democratic People's Republic of</option>
<option value="KR">Korea, Republic of</option>
<option value="KW">Kuwait</option>
<option value="KG">Kyrgyzstan</option>
<option value="LA">Lao People's Democratic Republic</option>
<option value="LV">Latvia</option>
<option value="LB">Lebanon</option>
<option value="LS">Lesotho</option>
<option value="LR">Liberia</option>
<option value="LY">Libyan Arab Jamahiriya</option>
<option value="LI">Liechtenstein</option>
<option value="LT">Lithuania</option>
<option value="LU">Luxembourg</option>
<option value="MO">Macau</option>
<option value="MG">Madagascar</option>
<option value="MW">Malawi</option>
<option value="MY">Malaysia</option>
<option value="MV">Maldives</option>
<option value="ML">Mali</option>
<option value="MT">Malta</option>
<option value="MH">Marshall Islands</option>
<option value="MQ">Martinique</option>
<option value="MR">Mauritania</option>
<option value="MU">Mauritius</option>
<option value="YT">Mayotte</option>
<option value="MX">Mexico</option>
<option value="FM">Micronesia</option>
<option value="MD">Moldova, Republic of</option>
<option value="MC">Monaco</option>
<option value="MN">Mongolia</option>
<option value="MS">Monserrat</option>
<option value="MA">Morocco</option>
<option value="MZ">Mozambique</option>
<option value="MM">Myanmar</option>
<option value="NA">Namibia</option>
<option value="NR">Nauru</option>
<option value="NP">Nepal</option>
<option value="NL">Netherlands</option>
<option value="AN">Netherlands Antilles</option>
<option value="NC">New Caledonia</option>
<option value="NZ">New Zealand</option>
<option value="NI">Nicaragua</option>
<option value="NE">Niger</option>
<option value="NG">Nigeria</option>
<option value="NU">Niue</option>
<option value="NF">Norfolk Island</option>
<option value="MP">Northern Mariana Islands</option>
<option value="NO">Norway</option>
<option value="OM">Oman</option>
<option value="PK">Pakistan</option>
<option value="PW">Palau</option>
<option value="PA">Panama</option>
<option value="PG">Papua New Guinea</option>
<option value="PY">Paraguay</option>
<option value="PE">Peru</option>
<option value="PH">Philippines</option>
<option value="PN">Pitcairn</option>
<option value="PL">Poland</option>
<option value="PT">Portugal</option>
<option value="PR">Puerto Rico</option>
<option value="QA">Qatar</option>
<option value="RE">Reunion</option>
<option value="RO">Romania</option>
<option value="RU">Russian Federation</option>
<option value="RW">Rwanda</option>
<option value="LC">Saint Lucia</option>
<option value="WS">Samoa</option>
<option value="SM">San Marino</option>
<option value="ST">Sao Tome & Principe</option>
<option value="SA">Saudi Arabia</option>
<option value="SN">Senegal</option>
<option value="RS">Serbia</option>
<option value="SC">Seychelles</option>
<option value="SL">Sierra Leone</option>
<option value="SG">Singapore</option>
<option value="SK">Slovakia</option>
<option value="SI">Slovenia</option>
<option value="SB">Solomon Islands</option>
<option value="SO">Somalia</option>
<option value="ZA">South Africa</option>
<option value="GS">South Georgia and the South Sandwich Islands</option>
<option value="ES">Spain</option>
<option value="LK">Sri Lanka</option>
<option value="SH">St. Helena</option>
<option value="KN">St. Kitts and Nevis</option>
<option value="PM">St. Pierre & Miquelon</option>
<option value="VC">St. Vincent & the Grenadines</option>
<option value="SD">Sudan</option>
<option value="SR">Suriname</option>
<option value="SJ">Svalbard & Jan Mayen Islands</option>
<option value="SZ">Swaziland</option>
<option value="SE">Sweden</option>
<option value="CH">Switzerland</option>
<option value="SY">Syrian Arab Republic</option>
<option value="TW">Taiwan</option>
<option value="TJ">Tajikistan</option>
<option value="TZ">Tanzania, United Republic of</option>
<option value="TH">Thailand</option>
<option value="TG">Togo</option>
<option value="TK">Tokelau</option>
<option value="TO">Tonga</option>
<option value="TT">Trinidad & Tobago</option>
<option value="TN">Tunisia</option>
<option value="TR">Turkey</option>
<option value="TM">Turkmenistan</option>
<option value="TC">Turks & Caicos Islands</option>
<option value="TV">Tuvalu</option>
<option value="UG">Uganda</option>
<option value="UA">Ukraine</option>
<option value="AE">United Arab Emirates</option>
<option value="GB">United Kingdom (Great Britain)</option>
<option value="UM">United States Minor Outlying Islands</option>
<option value="VI">United States Virgin Islands</option>
<option value="US">USA</option>
<option value="ZZ">Unknown or unspecified country</option>
<option value="UY">Uruguay</option>
<option value="UZ">Uzbekistan</option>
<option value="VU">Vanuatu</option>
<option value="VA">Vatican City State (Holy See)</option>
<option value="VE">Venezuela</option>
<option value="VN">Viet Nam</option>
<option value="WF">Wallis & Futuna Islands</option>
<option value="EH">Western Sahara</option>
<option value="YE">Yemen</option>
<option value="YU">Yugoslavia</option>
<option value="ZR">Zaire</option>
<option value="ZM">Zambia</option>
<option value="ZW">Zimbabwe</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="card-cvc-postal">
<div class="card-cvc"
ng-shortcut="'shift+alt+c'"
ng-shortcut-action="auth.permissions.can('createWithoutCVC', Payment, paymentCtrl.company) && paymentCtrl.overrideCvc()"
>
<span ng-if-once="kioskMode">
<div class="bookform-payments-payment-cardcvc hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payments-payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="bookform-payments-payment-cardcvc hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payments-payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="<span class='cvc-icon'></span> [! T('Your card\'s three or four digit verification number, usually on the back') !]"
ng-tip-classes="tip-text-left"
ng-tip-touch="true"
></div>
</div>
<div class="card-postal"
ng-if="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;] && Payment.needsPostalCode(bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;])"
>
<span ng-if-once="kioskMode">
<div class="bookform-payments-payment-postalcode field-location-icon hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="bookform-payments-payment-postalcode field-location-icon hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Please enter your billing postal code (zip code) for verification') !]"
ng-tip-touch="true"
></div>
</div>
</div>
</div>
<a class="card-swipe"
ng-click="paymentCtrl.startSwiping()"
ng-if="paymentCtrl.showingSwipe && !paymentCtrl.cardTypeAbbreviation()"
ng-tip="[! T('Swipe card') !]"
ng-tip-classes="tip-indent"
>
Swipe card
</a>
<div class="swiping" ng-if="paymentCtrl.swiping">
<input class="swipe-input" type="text" ng-swipe="paymentCtrl.swipeComplete" />
<div class="swiping-inner">
<div><img ng-src="//dp58aslhmbcib.cloudfront.net/static/images/card-swipe.gif?99774cb15b0528a7a2caeeb2a01921cc3e14532e" /></div>
Ready to swipe card...
</div>
</div>
</div>
<div class="amex-note"
ng-if="auth.currentUser.isAuthenticated && !bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
>
<b>Note:</b> It is strongly recommended that you enter the country for American Express cards, or the charge will fail.
</div>
<div ng-if="!company.isDemoModeEnabled"
ng-link="payment-setup-nag"
ng-init="isShort = true"
></div>
</div>
</div>
<div ng-if="!paymentCtrl.isAnonymous && paymentCtrl.isAnyKindValid() && paymentCtrl.kind() !== paymentCtrl.SKIP_KIND"
class="payment-comment"
>
<a ng-toggle="paymentComment" class="form-link-subtle hide-when-toggled">Add comment to payment</a>
<div ng-toggled="paymentComment">
<div class="bookform-payments-payment-note "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Payment comment (not visible to customer)" ng-prefix="'payments-payment'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="hide">
<div ng-if="paymentCtrl.needsCardFields()">
<div class="bookform-payments-payment-stripetoken "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-payments-payment-cardlast4 "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-payments-payment-cardtype "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</fieldset>
</div>
<div class="book-form-complete-right book-form-cancellation">
<div ng-if="!rebook.currentBooking && (availability.item.cancellationNotes || availability.company.cancellationNotes)">
<h2 class="booking-sub-header">
Cancellations
</h2>
<div class="booking-cancellation-policy prose"
ng-bind-html-once="availability.item.cancellationNotesSafeHtml || availability.company.cancellationNotesSafeHtml"
></div>
</div>
</div>
</div>
<div class="book-anon-columns-section"
ng-if="!bookAnonColumns"
>
<div class="book-form-submit" ng-noisy-invalid-fields>
<div class="book-form-submit-button">
<button class="btn-huge btn-wide btn-green test-book-action-enabled" type="submit"
ng-if="bookCtrl.showBookButton(bookForm)" ng-then="buttonEnabled"
ng-shortcut="'shift+enter'"
ng-shortcut-click
ng-scroll-to="[[ auth.currentUser.isAuthenticated ? (isMobileBookForm ? '.form-loading-overlay' : 'top') : '' ]]"
ng-scroll-on-click
ng-scroll-smooth
title="[! auth.currentUser.isAuthenticated ? T('Shortcut: shift+enter') : '' !]"
>
<span ng-if="!rebook.currentBooking">
<span ng-if-once="auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? cT('"order" as in sales order', 'Complete order') : T('Complete booking') !]
</span>
<span ng-if-once="!auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? T('Buy now') : T('Complete your booking') !]
</span>
</span>
<span ng-if="rebook.currentBooking" class="test-rebook-button-indicator">Rebook now</span>
</button>
<button class="btn-huge btn-wide btn-grey test-book-action-disabled" type="button"
ng-else="buttonEnabled"
ng-mx-click="click-disabled-book-button"
ng-mx-availability="availability"
ng-click="noisyInvalidFieldsCtrl.show()"
>
<span ng-if="!bookForm.$submitting && !rebook.currentBooking">
<span ng-if="auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? cT('"order" as in sales order', 'Complete order') : T('Complete booking') !]
</span>
<span ng-if="!auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? T('Buy now') : T('Complete your booking') !]
</span>
</span>
<span ng-if="!bookForm.$submitting && rebook.currentBooking" class="test-rebook-button-indicator">Rebook now</span>
<span ng-if="bookForm.$submitting">
[! availability.item.isRetail ? T('Processing...') : T('Booking...') !]
</span>
</button>
</div>
<div ng-book-noisy-invalid-fields="!buttonEnabled && !bookForm.$submitting"></div>
<div class="book-final-note">
<p class="required-fields-note" ng-if="bookForm.$invalid">
<b ng-if-once="availability.item.isRetail" ng-then="notRetail">
Please answer all fields marked with <span class="required-flag-icon">*</span> to complete your order
</b>
<b ng-else="notRetail">
Please answer all fields marked with <span class="required-flag-icon">*</span> to complete your booking
</b>
</p>
<p ng-if="!bookForm.$invalid && !rebook.currentBooking">
<b ng-if="bookCtrl.paymentCtrl.option() === bookCtrl.paymentCtrl.CHARGE_OPTION || bookCtrl.paymentCtrl.option() === bookCtrl.paymentCtrl.FILE_OPTION">
Card will be charged for [[ bookCtrl.paymentCtrl.amount()|amount:availability ]].
</b>
<b ng-if="bookCtrl.paymentCtrl.kind() === bookCtrl.paymentCtrl.DEFER_KIND">
Card will be verified and kept on file, but not charged.
</b>
</p>
</div>
<div ng-book-policies="bookCtrl.availability.company"></div>
</div>
</div>
</div>
</div>
</div>
<div class="book-anon-columns-right-shim"></div>
<div class="book-anon-columns-right-wrap"
ng-if="bookAnonColumns && showCompleteFields"
ng-dimensions="bookAnonSidebarDimensions"
>
<div class="book-anon-columns-right"
ng-style="{ 'width': bookAnonSidebarDimensions.width }"
ng-sticky
ng-sticky-content=".book-anon-columns-wrap"
ng-sticky-edge-top-margin="0"
ng-sticky-top-margin="0"
ng-sticky-bottom-margin="0"
ng-sticky-allow-touch
>
<div class="book-anon-columns-section with-bottom-border respond-handhelds-hide"
ng-else="addToCart"
>
<div class="secure-badge">
<i class="icon-lock-white"></i> Secured with 2048-bit encryption
</div>
</div>
<div ng-link="book.totals" class="book-anon-columns-section with-bottom-border respond-handhelds-hide"></div>
<div ng-book-errors></div>
<div class="form-errors">
<ul class="errors test-server-error-indicator">
<li ng-if="bookForm.all.$error.explicit-invoice-price-permissions">There was an error processing this request. Please refresh the page and try again. (U-INVP)</li>
<li ng-if="bookForm.all.$error.explicit-gross-permissions">There was an error processing this request. Please refresh the page and try again. (U-EXP)</li>
<li ng-if="bookForm.all.$error.demo_mismatch">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.archived_item">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.no_total_sheet">There was an error calculating prices for this booking. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.availability_overbooked">Sorry, there is not enough room for this many customers. Please go back and choose a different option.</li>
<li ng-if="bookForm.all.$error.rebook_rebooked_booking">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.availability_not_bookable">Some options you selected are no longer available. Please update your booking and try again.</li>
<li ng-if="bookForm.all.$error.not_visible">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.invalid_order">There was an error processing this request. Please refresh the page and try again. (O-INVALID)</li>
<li ng-if="bookForm.all.$error.show_hidden_permissions">There was an error processing this request. Please refresh the page and try again. (U-FIELDS)</li>
<li ng-if="bookForm.all.$error.booking-cancelled">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.price_sheet_permissions">There was an error processing this request. Please refresh the page and try again. (U-SHEET)</li>
<li ng-if="bookForm.all.$error.booking-rebooked">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.unsatisfiable-resources">Sorry, we were unable to create your booking with the current selections. Please refresh the page and try again. (R-UNSAT)</li>
<li ng-if="bookForm.all.$error.unknown_error">There was an error processing this request. Please refresh the page and try again. (U-BOOK)</li>
<li ng-repeat="error in bookForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="bookForm.all.$error.$tokenization">
<li ng-repeat="error in bookForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
</div>
<div ng-if="bookCtrl.availability.company.features.isCartEnabled" ng-then="addToCart"
class="book-anon-columns-section"
ng-cart-add
></div>
<div class="book-anon-columns-section"
ng-else="addToCart"
>
<div class="book-form-submit" ng-noisy-invalid-fields>
<div class="book-form-submit-button">
<button class="btn-huge btn-wide btn-green test-book-action-enabled" type="submit"
ng-if="bookCtrl.showBookButton(bookForm)" ng-then="buttonEnabled"
ng-shortcut="'shift+enter'"
ng-shortcut-click
ng-scroll-to="[[ auth.currentUser.isAuthenticated ? (isMobileBookForm ? '.form-loading-overlay' : 'top') : '' ]]"
ng-scroll-on-click
ng-scroll-smooth
title="[! auth.currentUser.isAuthenticated ? T('Shortcut: shift+enter') : '' !]"
>
<span ng-if="!rebook.currentBooking">
<span ng-if-once="auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? cT('"order" as in sales order', 'Complete order') : T('Complete booking') !]
</span>
<span ng-if-once="!auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? T('Buy now') : T('Complete your booking') !]
</span>
</span>
<span ng-if="rebook.currentBooking" class="test-rebook-button-indicator">Rebook now</span>
</button>
<button class="btn-huge btn-wide btn-grey test-book-action-disabled" type="button"
ng-else="buttonEnabled"
ng-mx-click="click-disabled-book-button"
ng-mx-availability="availability"
ng-click="noisyInvalidFieldsCtrl.show()"
>
<span ng-if="!bookForm.$submitting && !rebook.currentBooking">
<span ng-if="auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? cT('"order" as in sales order', 'Complete order') : T('Complete booking') !]
</span>
<span ng-if="!auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? T('Buy now') : T('Complete your booking') !]
</span>
</span>
<span ng-if="!bookForm.$submitting && rebook.currentBooking" class="test-rebook-button-indicator">Rebook now</span>
<span ng-if="bookForm.$submitting">
[! availability.item.isRetail ? T('Processing...') : T('Booking...') !]
</span>
</button>
</div>
<div ng-book-noisy-invalid-fields="!buttonEnabled && !bookForm.$submitting"></div>
<div class="book-final-note">
<p class="required-fields-note" ng-if="bookForm.$invalid">
<b ng-if-once="availability.item.isRetail" ng-then="notRetail">
Please answer all fields marked with <span class="required-flag-icon">*</span> to complete your order
</b>
<b ng-else="notRetail">
Please answer all fields marked with <span class="required-flag-icon">*</span> to complete your booking
</b>
</p>
<p ng-if="!bookForm.$invalid && !rebook.currentBooking">
<b ng-if="bookCtrl.paymentCtrl.option() === bookCtrl.paymentCtrl.CHARGE_OPTION || bookCtrl.paymentCtrl.option() === bookCtrl.paymentCtrl.FILE_OPTION">
Card will be charged for [[ bookCtrl.paymentCtrl.amount()|amount:availability ]].
</b>
<b ng-if="bookCtrl.paymentCtrl.kind() === bookCtrl.paymentCtrl.DEFER_KIND">
Card will be verified and kept on file, but not charged.
</b>
</p>
</div>
<div ng-book-policies="bookCtrl.availability.company"></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="bookform-onlinebookingreference "
ng-django-field="bookForm [&#39;onlineBookingReference&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;onlineBookingReference&#39;]"
>
<label >
<span class="label-text">
Online booking reference
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_online_booking_reference" name="onlineBookingReference" ng-model="bookCtrl.newBooking [&#39;onlineBookingReference&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;onlineBookingReference&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-clientuuid "
ng-django-field="bookForm [&#39;clientUuid&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;clientUuid&#39;]"
>
<label >
<span class="label-text">
Client ID
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_client_uuid" name="clientUuid" ng-model="bookCtrl.newBooking [&#39;clientUuid&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;clientUuid&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-totalsheet "
ng-django-field="bookForm [&#39;totalSheet&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;totalSheet&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Total sheet
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_total_sheet" name="totalSheet" ng-model="bookCtrl.newBooking [&#39;totalSheet&#39;]" required="required" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;totalSheet&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;totalSheet&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-invoicesheet "
ng-django-field="bookForm [&#39;invoiceSheet&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;invoiceSheet&#39;]"
>
<label >
<span class="label-text">
Invoice sheet
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_invoice_sheet" name="invoiceSheet" ng-model="bookCtrl.newBooking [&#39;invoiceSheet&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;invoiceSheet&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;invoiceSheet&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-type "
ng-django-field="bookForm [&#39;type&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;type&#39;]"
>
<label >
<span class="label-text">
Type
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_type" name="type" ng-model="bookCtrl.newBooking [&#39;type&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;type&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;type&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-isdemo "
ng-django-field="bookForm [&#39;isDemo&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;isDemo&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_demo" name="isDemo" ng-model="bookCtrl.newBooking [&#39;isDemo&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;isDemo&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-isshowinghiddencustomfields "
ng-django-field="bookForm [&#39;isShowingHiddenCustomFields&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;isShowingHiddenCustomFields&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_showing_hidden_custom_fields" name="isShowingHiddenCustomFields" ng-model="bookCtrl.newBooking [&#39;isShowingHiddenCustomFields&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;isShowingHiddenCustomFields&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-rebook "
ng-django-field="bookForm [&#39;rebook&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;rebook&#39;]"
>
<label >
<span class="label-text">
Rebook
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_rebook" name="rebook" ng-model="bookCtrl.newBooking [&#39;rebook&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;rebook&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;rebook&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-iscanceleligible "
ng-django-field="bookForm [&#39;isCancelEligible&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;isCancelEligible&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_cancel_eligible" name="isCancelEligible" ng-model="bookCtrl.newBooking [&#39;isCancelEligible&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;isCancelEligible&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-plusbook "
ng-django-field="bookForm [&#39;plusbook&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;plusbook&#39;]"
>
<label >
<span class="label-text">
Plusbook
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_plusbook" name="plusbook" ng-model="bookCtrl.newBooking [&#39;plusbook&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;plusbook&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;plusbook&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-orderizeorder "
ng-django-field="bookForm [&#39;orderizeOrder&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;orderizeOrder&#39;]"
>
<label >
<span class="label-text">
Orderize order
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_orderize_order" name="orderizeOrder" ng-model="bookCtrl.newBooking [&#39;orderizeOrder&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;orderizeOrder&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;orderizeOrder&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-orderizebooking "
ng-django-field="bookForm [&#39;orderizeBooking&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;orderizeBooking&#39;]"
>
<label >
<span class="label-text">
Orderize booking
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_orderize_booking" name="orderizeBooking" ng-model="bookCtrl.newBooking [&#39;orderizeBooking&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;orderizeBooking&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;orderizeBooking&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="bookForm.all.$error.explicit-invoice-price-permissions">There was an error processing this request. Please refresh the page and try again. (U-INVP)</li>
<li ng-if="bookForm.all.$error.explicit-gross-permissions">There was an error processing this request. Please refresh the page and try again. (U-EXP)</li>
<li ng-if="bookForm.all.$error.demo_mismatch">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.archived_item">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.no_total_sheet">There was an error calculating prices for this booking. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.availability_overbooked">Sorry, there is not enough room for this many customers. Please go back and choose a different option.</li>
<li ng-if="bookForm.all.$error.rebook_rebooked_booking">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.availability_not_bookable">Some options you selected are no longer available. Please update your booking and try again.</li>
<li ng-if="bookForm.all.$error.not_visible">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.invalid_order">There was an error processing this request. Please refresh the page and try again. (O-INVALID)</li>
<li ng-if="bookForm.all.$error.show_hidden_permissions">There was an error processing this request. Please refresh the page and try again. (U-FIELDS)</li>
<li ng-if="bookForm.all.$error.booking-cancelled">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.price_sheet_permissions">There was an error processing this request. Please refresh the page and try again. (U-SHEET)</li>
<li ng-if="bookForm.all.$error.booking-rebooked">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.unsatisfiable-resources">Sorry, we were unable to create your booking with the current selections. Please refresh the page and try again. (R-UNSAT)</li>
<li ng-if="bookForm.all.$error.unknown_error">There was an error processing this request. Please refresh the page and try again. (U-BOOK)</li>
<li ng-repeat="error in bookForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="bookForm.all.$error.$tokenization">
<li ng-repeat="error in bookForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
</div>
</script>
<script type="text/ng-template" id="book.bookAuthenticated">
<div class="form-errors">
<ul class="errors test-server-error-indicator">
<li ng-if="bookForm.all.$error.explicit-invoice-price-permissions">There was an error processing this request. Please refresh the page and try again. (U-INVP)</li>
<li ng-if="bookForm.all.$error.explicit-gross-permissions">There was an error processing this request. Please refresh the page and try again. (U-EXP)</li>
<li ng-if="bookForm.all.$error.demo_mismatch">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.archived_item">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.no_total_sheet">There was an error calculating prices for this booking. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.availability_overbooked">Sorry, there is not enough room for this many customers. Please go back and choose a different option.</li>
<li ng-if="bookForm.all.$error.rebook_rebooked_booking">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.availability_not_bookable">Some options you selected are no longer available. Please update your booking and try again.</li>
<li ng-if="bookForm.all.$error.not_visible">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.invalid_order">There was an error processing this request. Please refresh the page and try again. (O-INVALID)</li>
<li ng-if="bookForm.all.$error.show_hidden_permissions">There was an error processing this request. Please refresh the page and try again. (U-FIELDS)</li>
<li ng-if="bookForm.all.$error.booking-cancelled">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.price_sheet_permissions">There was an error processing this request. Please refresh the page and try again. (U-SHEET)</li>
<li ng-if="bookForm.all.$error.booking-rebooked">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.unsatisfiable-resources">Sorry, we were unable to create your booking with the current selections. Please refresh the page and try again. (R-UNSAT)</li>
<li ng-if="bookForm.all.$error.unknown_error">There was an error processing this request. Please refresh the page and try again. (U-BOOK)</li>
<li ng-repeat="error in bookForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="bookForm.all.$error.$tokenization">
<li ng-repeat="error in bookForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
</div>
<div class="fields
book-form-fields
"
ng-init="authDimensions = {};"
ng-style="{ 'min-height': max(authDimensions.left.height, authDimensions.right.height, 300) + 43 }"
ng-with="isMobileBookForm = dimensions.width < 680"
ng-book-totals
ng-book-totals-card-payments="relatedCardPayments"
ng-book-totals-in-store-payment-types="inStorePaymentTypes"
>
<div class="auth-book-sidebar shim-left"></div>
<div class="auth-book-sidebar left"
ng-dimensions="authDimensions.left"
ng-sticky
ng-sticky-content=".book-form-fields"
ng-sticky-edge-top-margin="0"
ng-sticky-top-margin="0"
ng-sticky-bottom-margin="0"
>
<div class="auth-book-sidebar-section with-border test-auth-book-form-indicator auth-book-availability-section [! availability|colorClass:'-fill is-label' !]">
<div class="auth-booking-item test-availability-info-indicator">
<a ng-href="[[ availability.item.$url(urls.dashboard.items.item.prices.index) ]]"
ng-can-update="availability.item" ng-then="linkItemName"
>[! availability.item|name !]</a>
<span ng-else="linkItemName">[! availability.item.name !]</span>
<span ng-if="!!availability.headline">
&mdash; [! availability.headline !]
</span>
</div>
<a ng-href="[! availability.$url(urls.dashboard.overlay.availability.index) !]"
class="auth-booking-availability"
ng-bind-html-once="availability.startAt|datetimeRange:(availability.endAt):'long':'html'"
></a>
<div class="auth-booking-private-headline"
ng-can-view="availability"
ng-can-only-when="availability.headlinePrivate"
>
[! availability.headlinePrivate !]
</div>
</div>
<div ng-link="book.errors"></div>
<div ng-hide="(!availability.company.affiliatesCount && bookCtrl.currentUserCanCreateAsCompany) || !bookCtrl.isAutofillingComplete"
class="auth-book-sidebar-section with-border ava-section"
>
<div class="book-form-affiliate"
ng-shortcut="'shift+a'"
ng-shortcut-focus
>
<div class="fields "
>
<div ng-current-block
ng-current-block-affiliation="bookCtrl.newBookingOptions.currentAffiliation"
ng-current-block-blocks="bookCtrl.availability.blocks"
>
<div ng-if="bookCtrl.currentUserCanCreateAsCompany && bookCtrl.availability.company.affiliatesCount > 0">
<div ng-if="bookCtrl.availability.company.affiliatesCount > Affiliation.MAX_SELECTABLE_AFFILIATES"
ng-then="remoteDropdown"
>
<div class="bookform-affiliation-affiliation "
ng-django-field="bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;]"
>
<div ng-current-option="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;]"
ng-current-option-collection=""
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="affiliation"
ng-model="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;]"
ng-disabled=""
ng-dropdown
ng-placeholder="Not booked by an affiliate"
ng-dropdown-remote-options="option.pk as option.affiliateCompany.name for option in affiliationCtrl.affiliatesNgDropdownEndpoint"
ng-dropdown-current-option="bookCtrl.newBookingOptions.currentAffiliation"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div ng-else="remoteDropdown">
<div class="fh-grey"
ng-if="affiliationCtrl.status === 'loading'"
>Loading affiliates...</div>
<div ng-if="affiliationCtrl.status !== 'loading'">
<div class="bookform-affiliation-affiliation "
ng-django-field="bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;]"
>
<div ng-current-option="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;]"
ng-current-option-collection="affiliationCtrl.affiliations"
ng-current-option-key="'pk'"
ng-current-option-target="bookCtrl.newBookingOptions.currentAffiliation"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="affiliation"
ng-model="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;]"
ng-disabled=""
ng-options="option.pk as option.affiliateCompany.name for option in affiliationCtrl.affiliations"
ng-dropdown
ng-placeholder="Not booked by an affiliate"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliation&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
</div>
<div ng-if="bookCtrl.newBookingOptions.currentAffiliation">
<div class="fields "
>
<div class="bookform-affiliation-voucher-vouchernumber "
ng-django-field="bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;]"
ng-django-field-required="newBookingOptions.currentAffiliation.isVoucherNumberRequired"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_voucher_number" maxlength="128" name="voucherNumber" ng-autofocus="true" ng-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;]" ng-pattern="/\S/" ng-placeholder="Voucher" ng-prefix="'affiliation-voucher'" ng-required="newBookingOptions.currentAffiliation.isVoucherNumberRequired" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;].$error['pattern']">Invalid value</li>
<li ng-repeat="error in bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<h2 class="affiliate-form-header">Agent</h2>
<div ng-if="affiliationCtrl.substatus === 'loading'" ng-then="subloading"
class="fh-grey"
>
Loading agents...
</div>
<div ng-else="subloading">
<div class="bookform-affiliation-voucher-agent "
ng-django-field="bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agent&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agent&#39;]"
>
<div ng-current-option="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agent&#39;]"
ng-current-option-collection="affiliationCtrl.agents"
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="agent"
ng-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agent&#39;]"
ng-disabled=""
ng-options="option.pk as affiliationCtrl.agentName(option) for option in affiliationCtrl.agents"
ng-dropdown
ng-placeholder="No agent selected"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agent&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agent&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="help-input-wrap"
ng-if="bookCtrl.newBooking['affiliation-voucher' + '-agent'] === Agent.OTHER_AGENT.pk"
>
<div class="bookform-affiliation-voucher-agentname "
ng-django-field="bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agentName&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agentName&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_agent_name" maxlength="128" name="agentName" ng-autofocus="true" ng-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agentName&#39;]" ng-placeholder="Agent name (new)" ng-prefix="'affiliation-voucher'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;agentName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<span class="help-icon"
ng-tip="[! T('Only enter names of real people who should be added to the list of options. (Otherwise, use the booking notes instead.)') !]"
></span>
</div>
<div ng-if="affiliationCtrl.showDesks">
<div class="bookform-affiliation-voucher-desk "
ng-django-field="bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;desk&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;desk&#39;]"
>
<div ng-current-option="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;desk&#39;]"
ng-current-option-collection="affiliationCtrl.desks"
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="desk"
ng-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;desk&#39;]"
ng-disabled=""
ng-options="option.pk as option.name for option in affiliationCtrl.desks"
ng-dropdown
ng-placeholder="No desk selected"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;desk&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;desk&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="help-input-wrap"
ng-if="bookCtrl.newBooking['affiliation-voucher' + '-desk'] === Desk.OTHER_DESK.pk"
>
<div class="bookform-affiliation-voucher-deskname "
ng-django-field="bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;deskName&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;deskName&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_desk_name" maxlength="128" name="deskName" ng-autofocus="true" ng-model="bookCtrl.newBooking [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;deskName&#39;]" ng-placeholder="Desk name (new)" ng-prefix="'affiliation-voucher'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;affiliation-voucher&#39; + &#39;-&#39; + &#39;deskName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<span class="help-icon"
ng-tip="[! T('Only enter names of desks that should be added to the list of options. (Otherwise, use the booking notes instead.)') !]"
></span>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div ng-if="currentBlock">
<h2 class="affiliate-form-header">Block</h2>
<div class="bookform-affiliation-isblockable field-cb "
ng-django-field="bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;isBlockable&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;isBlockable&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_blockable" name="isBlockable" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;isBlockable&#39;]" ng-prefix="'affiliation'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Book into the seats blocked for [[ newBookingOptions.currentAffiliation.affiliateCompany.name ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;isBlockable&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="booking-block-info">
<div class="booking-block-stat current-block">
<span class="icon-user-small"></span>
[[
interpolate(nT('%(seatCount)s seat blocked, %(customerCount)s already filled', '%(seatCount)s seats blocked, %(customerCount)s already filled', currentBlock.reservedCapacity),
{ seatCount: currentBlock.reservedCapacity, customerCount: currentBlock.customerCount })
]]
</div>
<div class="booking-block-stat"
ng-show="bookCtrl.newBooking['affiliation-isBlockable']"
>
<div ng-show="(currentBlock.customerCount + bookCtrl.bookCountsCtrl.customerCount) > currentBlock.reservedCapacity">
<div ng-show="(currentBlock.customerCount + customerCards.length) - currentBlock.reservedCapacity > bookCtrl.availability.nonResourceBookableCapacity" ng-then="overbookingBlockOnly">
<span class="badge badge-error">Potential Overbooking</span>
<div class="block-overbook-message">
Creating this booking will fill the block, and there are not enough unblocked seats to accommodate it. (Need [[ ((currentBlock.customerCount + bookCtrl.bookCountsCtrl.customerCount) - currentBlock.reservedCapacity) - bookCtrl.availability.nonResourceBookableCapacity ]] more seats.)
</div>
</div>
<div ng-hide="overbookingBlockOnly">
<span class="badge badge-warning">Booking fills beyond block</span>
<div class="block-overbook-message">
Creating this booking will also fill [[ (currentBlock.customerCount + bookCtrl.bookCountsCtrl.customerCount) - currentBlock.reservedCapacity ]] unblocked seats on this availability.
</div>
</div>
</div>
<div class="[[ currentBlock|capacityClass:(currentBlock.customerCount + bookCtrl.bookCountsCtrl.customerCount) ]]">
<span class="icon-user-small"></span>
[[ currentBlock.customerCount + bookCtrl.bookCountsCtrl.customerCount ]] of [[ currentBlock.reservedCapacity ]] will be filled after this booking is created.
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="bookform-affiliation-affiliatecompanyshortname "
ng-django-field="bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliateCompanyShortname&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliateCompanyShortname&#39;]"
>
<label >
<span class="label-text">
Affiliate company shortname
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_affiliate_company_shortname" name="affiliateCompanyShortname" ng-model="bookCtrl.newBooking [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliateCompanyShortname&#39;]" ng-prefix="'affiliation'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;affiliation&#39; + &#39;-&#39; + &#39;affiliateCompanyShortname&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="auth-book-sidebar-section with-border book-form-contact"
ng-if="!isMobileBookForm"
ng-autofocus
>
<div ng-if="!rebook.currentBooking">
<div ng-if="plusbook.currentContact" ng-then="plusbooking">
<div class="hint">
<p>You can edit the contact information after this booking is completed.</p>
</div>
<div class="field field-person-icon">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ plusbook.currentContact.name ]]"
ng-model="bookCtrl.newBooking"
disabled
ng-placeholder="Full name"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<div class="field field-globe-icon">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ SupportedLanguage.display(plusbook.currentContact.language) || plusbook.currentContact.language ]]"
ng-model="bookCtrl.newBooking"
disabled
ng-placeholder="Language"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<div class="field field-phone-icon">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ plusbook.currentContact.phone ]]"
ng-model="bookCtrl.newBooking"
disabled
ng-placeholder="Phone number"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<div class="field field-email-icon">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ plusbook.currentContact.email ]]"
ng-model="bookCtrl.newBooking"
disabled
ng-placeholder="Email address"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<div ng-else="plusbooking"
ng-shortcut="'shift+c'"
ng-shortcut-focus
>
<div class="fields "
>
<div class="bookform-contact-name field-person-icon hide-label-text "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]" ng-placeholder="Full name" ng-prefix="'contact'" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if-once="contact ? contact.company.companyFeatures.isContentTranslationEnabled : company.companyFeatures.isContentTranslationEnabled">
<a ng-toggle="contactLanguageDropdown" class="form-link-subtle hide-when-toggled contact-language-toggle"
ng-toggle-default="contact.language"
>
Change contact language
</a>
<div ng-toggled="contactLanguageDropdown">
<div class="bookform-contact-language
field-globe-icon
"
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-language-dropdown
>
<div ng-current-option="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-current-option-collection=""
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="language"
ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-disabled="languageDropdownCtrl.isLoading"
ng-options="lang.code as lang.display group by lang.group for lang in languageDropdownCtrl.languageChoices"
ng-dropdown
ng-placeholder="[! T('Select a language') !]"
ng-dropdown-allow-clear="false"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="bookform-contact-phone field-phone-icon hide-label-text
international-phone-field
"
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Phone number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone" maxlength="32" name="phone" ng-international-phone-field="true" ng-international-phone-field-countries="Contact.COUNTRIES" ng-international-phone-field-phone-country-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]" ng-pattern="/^[^a-zA-Z]{5,32}$/" ng-placeholder="Phone number" ng-prefix="'contact'" ng-required="!auth.currentUser.isAuthenticated" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="
company.isSmsEnabled &&
SmsNotification.isEligiblePhoneNumber(
bookCtrl.newBooking['contact' + '-phone'],
bookCtrl.newBooking['contact' + '-phoneCountry'],
company
)
">
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value="false"
class="ng-pristine"
ng-model="bookCtrl.newBooking.isSmsEnabled"
>
</span>
<span class="label-text">
Opt-in to text messages
<span class="icon-hint" ng-tip="[[ company.features.isInternationalSmsEnabled ? T('Customer may pay fees to their carrier') : T('Customer may pay fees to their carrier, US numbers only') ]]"></span>
</span>
</span>
</label>
</div>
</div>
<div class="bookform-contact-email field-email-icon hide-label-text "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-prefix="'contact'" ng-required="!auth.currentUser.isAuthenticated" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<span ng-mailcheck="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]"
class="mailcheck-suggestion"
></span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-show="(auth.currentUser.isAuthenticated && (newBooking['contact-email'] || bookCtrl.newBooking.email)) || !auth.currentUser.isAuthenticated">
<div ng-if="auth.currentUser.isAuthenticated" ng-then="internalSubscribe">
<div class="bookform-contact-issubscribed field-cb-light "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-prefix="'contact'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Subscribe to company email list
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-else="internalSubscribe">
<div class="bookform-contact-issubscribed field-cb-light "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-prefix="'contact'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Get future email updates from [[ company.name ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="bookform-contact-phonecountry "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]"
>
<label >
<span class="label-text">
Phone country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone_country" name="phoneCountry" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-prefix="'contact'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div ng-can-create="Notification on bookCtrl.availability.company"
ng-can-only-when="(!!bookCtrl.newBooking['contact-email'] || !!plusbook.currentContact.email || !!rebook.currentBooking.contact.email)"
class="book-form-send-email"
ng-book-notification="bookCtrl.newBooking"
></div>
<div class="book-form-booking-note"
ng-can="updateBookingNote on Booking with availability.company"
>
<a ng-toggle="bookFormBookingNotes" class="form-link-subtle hide-when-toggled"
ng-toggle-default="rebook.currentBooking.note"
ng-shortcut="'shift+b'"
ng-shortcut-click
title="[! T('Shortcut: shift+b') !]"
>
Add booking note
</a>
<div ng-toggled="bookFormBookingNotes">
<div class="bookform-note "
ng-django-field="bookForm [&#39;note&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-model="bookCtrl.newBooking [&#39;note&#39;]" ng-placeholder="Booking note (not visible to customer)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="auth-book-sidebar-section ava-section">
<div ng-book-counts></div>
</div>
</div>
<div ng-hide="bookCtrl.pricesCtrl.status === 'initializing'"
class="auth-book-middle"
>
<div ng-book-cards></div>
<div ng-book-booking-fields></div>
</div>
<div ng-if="!anonBookForm && isMobileBookForm"
class="auth-book-sidebar-section auth-contact-mobile book-form-contact"
>
<div ng-if="!rebook.currentBooking">
<div ng-if="plusbook.currentContact" ng-then="plusbooking">
<div class="hint">
<p>You can edit the contact information after this booking is completed.</p>
</div>
<div class="field field-person-icon">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ plusbook.currentContact.name ]]"
ng-model="bookCtrl.newBooking"
disabled
ng-placeholder="Full name"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<div class="field field-globe-icon">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ SupportedLanguage.display(plusbook.currentContact.language) || plusbook.currentContact.language ]]"
ng-model="bookCtrl.newBooking"
disabled
ng-placeholder="Language"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<div class="field field-phone-icon">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ plusbook.currentContact.phone ]]"
ng-model="bookCtrl.newBooking"
disabled
ng-placeholder="Phone number"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<div class="field field-email-icon">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ plusbook.currentContact.email ]]"
ng-model="bookCtrl.newBooking"
disabled
ng-placeholder="Email address"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<div ng-else="plusbooking"
ng-shortcut="'shift+c'"
ng-shortcut-focus
>
<div class="fields "
>
<div class="bookform-contact-name field-person-icon hide-label-text "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]" ng-placeholder="Full name" ng-prefix="'contact'" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if-once="contact ? contact.company.companyFeatures.isContentTranslationEnabled : company.companyFeatures.isContentTranslationEnabled">
<a ng-toggle="contactLanguageDropdown" class="form-link-subtle hide-when-toggled contact-language-toggle"
ng-toggle-default="contact.language"
>
Change contact language
</a>
<div ng-toggled="contactLanguageDropdown">
<div class="bookform-contact-language
field-globe-icon
"
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-language-dropdown
>
<div ng-current-option="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-current-option-collection=""
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="language"
ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-disabled="languageDropdownCtrl.isLoading"
ng-options="lang.code as lang.display group by lang.group for lang in languageDropdownCtrl.languageChoices"
ng-dropdown
ng-placeholder="[! T('Select a language') !]"
ng-dropdown-allow-clear="false"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="bookform-contact-phone field-phone-icon hide-label-text
international-phone-field
"
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Phone number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone" maxlength="32" name="phone" ng-international-phone-field="true" ng-international-phone-field-countries="Contact.COUNTRIES" ng-international-phone-field-phone-country-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]" ng-pattern="/^[^a-zA-Z]{5,32}$/" ng-placeholder="Phone number" ng-prefix="'contact'" ng-required="!auth.currentUser.isAuthenticated" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="
company.isSmsEnabled &&
SmsNotification.isEligiblePhoneNumber(
bookCtrl.newBooking['contact' + '-phone'],
bookCtrl.newBooking['contact' + '-phoneCountry'],
company
)
">
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value="false"
class="ng-pristine"
ng-model="bookCtrl.newBooking.isSmsEnabled"
>
</span>
<span class="label-text">
Opt-in to text messages
<span class="icon-hint" ng-tip="[[ company.features.isInternationalSmsEnabled ? T('Customer may pay fees to their carrier') : T('Customer may pay fees to their carrier, US numbers only') ]]"></span>
</span>
</span>
</label>
</div>
</div>
<div class="bookform-contact-email field-email-icon hide-label-text "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-prefix="'contact'" ng-required="!auth.currentUser.isAuthenticated" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<span ng-mailcheck="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]"
class="mailcheck-suggestion"
></span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-show="(auth.currentUser.isAuthenticated && (newBooking['contact-email'] || bookCtrl.newBooking.email)) || !auth.currentUser.isAuthenticated">
<div ng-if="auth.currentUser.isAuthenticated" ng-then="internalSubscribe">
<div class="bookform-contact-issubscribed field-cb-light "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-prefix="'contact'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Subscribe to company email list
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-else="internalSubscribe">
<div class="bookform-contact-issubscribed field-cb-light "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-prefix="'contact'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Get future email updates from [[ company.name ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="bookform-contact-phonecountry "
ng-django-field="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]"
>
<label >
<span class="label-text">
Phone country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone_country" name="phoneCountry" ng-model="bookCtrl.newBooking [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-prefix="'contact'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div ng-can-create="Notification on bookCtrl.availability.company"
ng-can-only-when="(!!bookCtrl.newBooking['contact-email'] || !!plusbook.currentContact.email || !!rebook.currentBooking.contact.email)"
class="book-form-send-email"
ng-book-notification="bookCtrl.newBooking"
></div>
<div class="book-form-booking-note"
ng-can="updateBookingNote on Booking with availability.company"
>
<a ng-toggle="bookFormBookingNotes" class="form-link-subtle hide-when-toggled"
ng-toggle-default="rebook.currentBooking.note"
ng-shortcut="'shift+b'"
ng-shortcut-click
title="[! T('Shortcut: shift+b') !]"
>
Add booking note
</a>
<div ng-toggled="bookFormBookingNotes">
<div class="bookform-note "
ng-django-field="bookForm [&#39;note&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-model="bookCtrl.newBooking [&#39;note&#39;]" ng-placeholder="Booking note (not visible to customer)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="auth-book-sidebar shim-right"></div>
<div class="auth-book-sidebar-right-wrap">
<div class="auth-book-sidebar right"
ng-dimensions="authDimensions.right"
ng-sticky
ng-sticky-content=".book-form-fields"
ng-sticky-edge-top-margin="0"
ng-sticky-top-margin="0"
ng-sticky-bottom-margin="0"
>
<div ng-show="bookCtrl.bookCountsCtrl.customerCount > 0">
<div ng-link="book.totals"
class="auth-book-sidebar-section with-border"
></div>
<div class="auth-book-sidebar-section with-border"
ng-can-view-invoice-amounts="availability.company"
ng-can-only-when="bookTotalsCtrl.totals.invoice !== null"
>
<table class="book-form-totals-table block-loading--init"
ng-class="{ 'block-loading': bookCtrl.pricesCtrl.status === 'loading' }"
>
<tr>
<td class="subtotal-label">
Invoice price <span class="icon-hint" ng-tip="[! T('The total amount that should be invoiced for this booking') !]"></span>
</td>
<td class="subtotal-value">
[[ bookTotalsCtrl.totals.invoice|amount:availability ]]
</td>
<td class="td-hide"></td>
</tr>
</table>
</div>
<div class="auth-book-sidebar-section with-border"
ng-hide="bookCtrl.pricesCtrl.status === 'initializing'"
>
<div ng-if="rebook.currentBooking" ng-then="rebooking">
<div class="hint hint-alert"
ng-can="rebook on rebook.currentBooking"
ng-then="canRebook"
>
<p><b>Payments or refunds are not automatically created while rebooking.</b></p>
<p>After clicking <i>Rebook now</i> below, use the payment or refund buttons on the next screen.</p>
</div>
<div class="hint hint-alert"
ng-can="rebookEligible on rebook.currentBooking"
ng-can-only-when="
!canRebook &&
rebook.currentBooking.affiliation &&
rebook.currentBooking.paidStatus !== Booking.UNPAID_PAID_STATUS
"
>
<p>
After clicking <i>Rebook now</i> the booking will be marked as paid in full by [[ rebook.currentBooking.affiliation.affiliateCompany.name ]].
</p>
</div>
</div>
<div ng-else="rebooking">
<div class="fields
respond-print-hide
"
>
<div ng-if="!paymentCtrl.isAnonymous">
<div class="bookform-payments-payment-kind "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]"
ng-django-field-required=""
>
<ul ng-radio-flyer
class="field-radio-group "
>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.SKIP_KIND)"
class="test-payment-kind-skip-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.SKIP_KIND"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
Don&#039;t add payment now
</label>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.DEFER_KIND)"
class="test-payment-kind-defer-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.DEFER_KIND"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
Save card to charge later
</label>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.PARTIAL_KIND)"
class="test-payment-kind-partial-action"
>
<label class="has-child">
<input type="radio" name="kind"
ng-value="paymentCtrl.PARTIAL_KIND"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
[[ paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND ? T('Partial payment:') : T('Partial payment') ]]
</label>
</li>
<li ng-if="paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND">
<div class="radio-content">
<div class="bookform-payments-payment-gross field-partial-payment-gross
field-amount
"
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-default="paymentCtrl.defaultGross()" ng-amount-input-max="paymentCtrl.amountMax()" ng-amount-input-min="paymentCtrl.amountMin()" ng-amount-input-positive="true" ng-autofocus="true" ng-autofocus-select="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'payments-payment'" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="tb tb--inset-mobile" ng-if="!!splitPaymentCtrl">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="splitPaymentCalc"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate split payment') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate split payment</abbr>
</div>
<div ng-toggled="splitPaymentCalc"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-section flyout-section--no-border">
<h2>Calculate split payment</h2>
<div class="hint">
Divide the booking total after taxes ([[ splitPaymentCtrl.amount|amount:company ]]) into equal amounts.
</div>
<table class="split-payment-table">
<tr>
<td class="text-right">
Split into:
</td>
<td>
<div class="field people-field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
ng-model="splitPaymentCtrl.divideByPeople"
ng-pattern="/^\d+$/"
ng-int-input
ng-int-input-min="1"
>
</span>
<div class="people-label">[[ nT('payment', 'payments', splitPaymentCtrl.divideByPeople) ]]</div>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td class="text-right">
Apply:
</td>
<td ng-autofocus>
<div class="field people-field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
ng-model="splitPaymentCtrl.payForPeople"
ng-pattern="/^\d+$/"
ng-int-input
ng-int-input-min="1"
ng-int-input-max="splitPaymentCtrl.divideByPeople"
>
</span>
<div class="people-label">[[ nT('payment', 'payments', splitPaymentCtrl.payForPeople) ]]</div>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td class="text-right">
Cost:
</td>
<td>
[[ splitPaymentCtrl.splitAmount|amount:company ]]
</td>
</tr>
<tr class="split-payment-set">
<td></td>
<td>
<button type="submit"
ng-click="splitPaymentCtrl.useSplitAmount()"
class="btn-tiny btn-green"
ng-disabled="splitPaymentCtrl.splitAmount <= 0"
>Set</button>
</td>
</tr>
</table>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'splitPaymentCalc'"></div>
</div>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.FULL_KIND)"
class="test-payment-kind-full-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.FULL_KIND"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
[[ paymentCtrl.isDefaultAmountInvoicePrice() ? T('Invoice amount') : T('Pay in full') ]]
</label>
</li>
<li ng-if="!paymentCtrl.isAnyKindValid()"
class="form-error"
>
<b>No available payment options.</b> Please contact your administrator.
</li>
</ul>
</div>
<div ng-if="paymentCtrl.affiliation() && paymentCtrl.needsPayment()">
<div class="bookform-payments-payment-iscollectedbyaffiliate "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]"
>
<div class="affiliate-form-header">Collected By</div>
<ul ng-radio-flyer
class="test-payment-collected-by-field-indicator field field-radio-group "
>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(false)"
class="test-collected-by-affiliate-false-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="false"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>[[ paymentCtrl.company|name ]]</b>
</span>
</label>
</li>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(true)"
class="test-collected-by-affiliate-true-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="true"
ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>[[ paymentCtrl.affiliation().affiliateCompany|name ]]</b>
</span>
</label>
</li>
</ul>
</div>
</div>
</div>
<div ng-if="paymentCtrl.needsPayment() && paymentCtrl.needsOption()">
<div class="bookform-optionandextras "
ng-django-field="bookForm [&#39;optionAndExtras&#39;]" ng-django-field-model="paymentCtrl [&#39;optionAndExtras&#39;]"
>
<div class="affiliate-form-header">Payment Type</div>
<ul ng-radio-flyer
class="field-radio-group
"
>
<li class="field-radio-inline-header fh-green">
Pay [[ paymentCtrl.amount()|amount:company ]] with:
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IN_STORE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.inStorePaymentTypes"
class="test-payment-action-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="bookform-payments-payment-instorepaymentnote "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payments-payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.AFFILIATE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.affiliateInStorePaymentTypes"
class="test-payment-action-affiliate-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="bookform-payments-payment-instorepaymentnote "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payments-payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.FILE_OPTION)" ng-repeat="payment in paymentCtrl.cardPayments"
class="test-payment-action-file field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="payment"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge <b>[[ payment.displayProcessorBasedType ]]</b> <b>[[ payment.processorBasedIdentifier ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CARD_ON_FILE_OPTION)" ng-repeat="cardOnFile in paymentCtrl.cardsOnFile"
class="test-payment-action-card-on-file field-radio-icon--cc"
>
<label class="[! addClassIf(paymentCtrl.company.isDemoModeEnabled, 'is-disabled') !]">
<input type="radio" name=""
ng-value="cardOnFile"
ng-disabled="paymentCtrl.company.isDemoModeEnabled"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge company card <b>[[ cardOnFile.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CHARGE_OPTION)"
class="test-payment-action-charge field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.CHARGE_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge card
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.EMV_OPTION)"
class="test-payment-action-emv field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.EMV_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge with <b>[[ emv.currentDevice.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IDEAL_OPTION)"
class="test-payment-action-ideal"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.IDEAL_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
iDEAL
<i ng-svg="svg-ideal"></i>
</label>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.SOFORT_OPTION)"
class="test-payment-action-sofort"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.SOFORT_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Sofort
<i ng-svg="svg-sofort"></i>
</label>
</li>
<li ng-if="!paymentCtrl.isAnyOptionValid()">
No valid payment options
</li>
</ul>
</div>
</div>
<div ng-if="paymentCtrl.option() === paymentCtrl.IDEAL_OPTION"
class="labels-above"
>
<div class="bookform-payments-payment-stripeidealbanktype "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Please select your bank
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_stripe_ideal_bank_type" name="stripeIdealBankType" ng-dropdown="true" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]" ng-options="choice[0] as choice[1] for choice in Payment.IDEAL_BANK_TYPE_CHOICES" ng-placeholder="Bank name" ng-prefix="'payments-payment'" ng-required="true">
<option value="abn_amro">ABN AMRO</option>
<option value="asn_bank">ASN Bank</option>
<option value="bunq">bunq</option>
<option value="handelsbanken">Handelsbanken</option>
<option value="ing">ING</option>
<option value="knab">Knab</option>
<option value="moneyou">Moneyou</option>
<option value="rabobank">Rabobank</option>
<option value="regiobank">RegioBank</option>
<option value="sns_bank">De Volksbank (SNS Bank)</option>
<option value="triodos_bank">Triodos Bank</option>
<option value="van_lanschot">Van Lanschot</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="paymentCtrl.option() === paymentCtrl.SOFORT_OPTION"
class="labels-above"
>
<div class="bookform-payments-payment-stripesofortcountry "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Please select your country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_stripe_sofort_country" name="stripeSofortCountry" ng-dropdown="true" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]" ng-options="choice[0] as choice[1] for choice in Payment.SOFORT_COUNTRY_CHOICES" ng-placeholder="Country name" ng-prefix="'payments-payment'" ng-required="true">
<option value="AT">Austria</option>
<option value="BE">Belgium</option>
<option value="DE">Germany</option>
<option value="IT">Italy</option>
<option value="NL">Netherlands</option>
<option value="ES">Spain</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="paymentCtrl.needsCharge()">
<div class="form-error" ng-if="paymentCtrl.isAmountTooLow()">
<span ng-if="!auth.currentUser.isAuthenticated" ng-then="isAnonUser">
Sorry, payment cannot be taken at this time.
<a href="https://fareharbor.com/help/submit/">Please contact FareHarbor.</a>
(Error code LH-[! Payment.MIN_CHARGE_AMOUNT !].)
</span>
<span ng-else="isAnonUser">
<span ng-if="paymentCtrl.needsCharge()" ng-then="chargeTooLow">
Sorry, cards cannot be charged for amounts less than [! Payment.MIN_CHARGE_AMOUNT|amount:company !].
</span>
<span ng-else="chargeTooLow">
Sorry, payments cannot be created for [! 0|amount:company !].
</span>
</span>
</div>
</div>
<div ng-if="paymentCtrl.needsCardFields() && !paymentCtrl.isAmountTooLow()">
<div class="card-fields card-type-[[ paymentCtrl.cardTypeAbbreviation() ]]"
ng-class="{ 'test-cards-only': paymentCtrl.company.isDemoModeEnabled }"
>
<div class="card-fields-inner">
<div ng-if="paymentCtrl.company.isDemoModeEnabled" ng-then="demoCardForm"
class="card-fields-demo"
>
Demo mode
<i class="help-icon"
ng-tip="[! T('You can only use test credit card numbers while demo mode is on') !]"
></i>
</div>
<div ng-else="demoCardForm"
class="card-fields-secure"
>
<i class="icon-lock-green"></i> Secure and encrypted
<i class="icon-hint"
ng-hide="auth.currentUser.isAuthenticated"
ng-tip="[! interpolate(T('%(companyName)s will only be able to see the last 4 digits of your card number'), { companyName: paymentCtrl.company.name }) !]"
ng-tip-classes="tip-indent"
ng-tip-touch="true"
></i>
</div>
<div class="native-swiped-container"
ng-if="paymentCtrl.swiped && native.isNative"
ng-then="nativeSwiped"
>
<div>
<span class="badge badge-green">Swiped successfully</span>
</div>
<span class="card-number">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardLast4() ]]"
ng-model="bookCtrl.newBooking"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</span>
<div class="card-name">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardholdersName() ]]"
ng-model="bookCtrl.newBooking"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<a ng-click="paymentCtrl.stopSwiping()" class="btn btn-grey">
Enter different card
</a>
</div>
<div ng-else="nativeSwiped">
<span class="card-type-logo"></span>
<span class="card-number" ng-if-once="clientOptions.isKioskModeEnabled" ng-then="kioskMode">
<div class="bookform-payments-payment-cardnumber hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payments-payment'" ng-required="true" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span class="card-number" ng-else-once="kioskMode">
<div class="bookform-payments-payment-cardnumber hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payments-payment'" ng-required="true" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="card-name">
<span ng-if-once="kioskMode">
<div class="bookform-payments-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payments-payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="bookform-payments-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payments-payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Cardholder\'s name must match the name printed on the card') !]"
ng-tip-touch="true"
></div>
</div>
<div class="card-expiry">
<div class="card-form-header">Expiration date</div>
<div class="exp-month">
<div class="bookform-payments-payment-cardexpirymonth
pseudo-select
"
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName()" ng-then="hasValuecardMonth">
[[ KioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName() ]]
</span>
<span ng-else="hasValuecardMonth" class="exp-placeholder">
Month
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_month" name="cardExpiryMonth" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-prefix="'payments-payment'" required="required">
<option value="1">01 - January</option>
<option value="2">02 - February</option>
<option value="3">03 - March</option>
<option value="4">04 - April</option>
<option value="5">05 - May</option>
<option value="6">06 - June</option>
<option value="7">07 - July</option>
<option value="8">08 - August</option>
<option value="9">09 - September</option>
<option value="10">10 - October</option>
<option value="11">11 - November</option>
<option value="12">12 - December</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="exp-year">
<div class="bookform-payments-payment-cardexpiryyear
pseudo-select
"
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year()" ng-then="hasValuecardYear">
[[ KioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year() ]]
</span>
<span ng-else="hasValuecardYear" class="exp-placeholder">
Year
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_year" name="cardExpiryYear" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-prefix="'payments-payment'" required="required">
<option value="2019">2019</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
<option value="2028">2028</option>
<option value="2029">2029</option>
<option value="2030">2030</option>
<option value="2031">2031</option>
<option value="2032">2032</option>
<option value="2033">2033</option>
<option value="2034">2034</option>
<option value="2035">2035</option>
<option value="2036">2036</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="card-country-code">
<div class="bookform-payments-payment-countrycode field-select-full "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
>
<label >
<span class="label-text">
Country/Region
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_country_code" name="countryCode" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]">
<option value="" selected="selected"></option>
<option value="US">USA</option>
<option value="AF">Afghanistan</option>
<option value="AL">Albania</option>
<option value="DZ">Algeria</option>
<option value="AS">American Samoa</option>
<option value="AD">Andorra</option>
<option value="AO">Angola</option>
<option value="AI">Anguilla</option>
<option value="AQ">Antarctica</option>
<option value="AG">Antigua & Barbuda</option>
<option value="AR">Argentina</option>
<option value="AM">Armenia</option>
<option value="AW">Aruba</option>
<option value="AU">Australia</option>
<option value="AT">Austria</option>
<option value="AZ">Azerbaijan</option>
<option value="BS">Bahama</option>
<option value="BH">Bahrain</option>
<option value="BD">Bangladesh</option>
<option value="BB">Barbados</option>
<option value="BY">Belarus</option>
<option value="BE">Belgium</option>
<option value="BZ">Belize</option>
<option value="BJ">Benin</option>
<option value="BM">Bermuda</option>
<option value="BT">Bhutan</option>
<option value="BO">Bolivia</option>
<option value="BA">Bosnia and Herzegovina</option>
<option value="BW">Botswana</option>
<option value="BV">Bouvet Island</option>
<option value="BR">Brazil</option>
<option value="IO">British Indian Ocean Territory</option>
<option value="VG">British Virgin Islands</option>
<option value="BN">Brunei Darussalam</option>
<option value="BG">Bulgaria</option>
<option value="BF">Burkina Faso</option>
<option value="BI">Burundi</option>
<option value="KH">Cambodia</option>
<option value="CM">Cameroon</option>
<option value="CA">Canada</option>
<option value="CV">Cape Verde</option>
<option value="KY">Cayman Islands</option>
<option value="CF">Central African Republic</option>
<option value="TD">Chad</option>
<option value="CL">Chile</option>
<option value="CN">China</option>
<option value="CX">Christmas Island</option>
<option value="CC">Cocos (Keeling) Islands</option>
<option value="CO">Colombia</option>
<option value="KM">Comoros</option>
<option value="CG">Congo</option>
<option value="CK">Cook Iislands</option>
<option value="CR">Costa Rica</option>
<option value="HR">Croatia</option>
<option value="CU">Cuba</option>
<option value="CY">Cyprus</option>
<option value="CZ">Czech Republic</option>
<option value="DK">Denmark</option>
<option value="DJ">Djibouti</option>
<option value="DM">Dominica</option>
<option value="DO">Dominican Republic</option>
<option value="TP">East Timor</option>
<option value="EC">Ecuador</option>
<option value="EG">Egypt</option>
<option value="SV">El Salvador</option>
<option value="GQ">Equatorial Guinea</option>
<option value="ER">Eritrea</option>
<option value="EE">Estonia</option>
<option value="ET">Ethiopia</option>
<option value="FK">Falkland Islands (Malvinas)</option>
<option value="FO">Faroe Islands</option>
<option value="FJ">Fiji</option>
<option value="FI">Finland</option>
<option value="FR">France</option>
<option value="FX">France, Metropolitan</option>
<option value="GF">French Guiana</option>
<option value="PF">French Polynesia</option>
<option value="TF">French Southern Territories</option>
<option value="GA">Gabon</option>
<option value="GM">Gambia</option>
<option value="GE">Georgia</option>
<option value="DE">Germany</option>
<option value="GH">Ghana</option>
<option value="GI">Gibraltar</option>
<option value="GR">Greece</option>
<option value="GL">Greenland</option>
<option value="GD">Grenada</option>
<option value="GP">Guadeloupe</option>
<option value="GU">Guam</option>
<option value="GT">Guatemala</option>
<option value="GN">Guinea</option>
<option value="GW">Guinea-Bissau</option>
<option value="GY">Guyana</option>
<option value="HT">Haiti</option>
<option value="HM">Heard & McDonald Islands</option>
<option value="HN">Honduras</option>
<option value="HK">Hong Kong</option>
<option value="HU">Hungary</option>
<option value="IS">Iceland</option>
<option value="IN">India</option>
<option value="ID">Indonesia</option>
<option value="IQ">Iraq</option>
<option value="IE">Ireland</option>
<option value="IR">Islamic Republic of Iran</option>
<option value="IL">Israel</option>
<option value="IT">Italy</option>
<option value="CI">Ivory Coast</option>
<option value="JM">Jamaica</option>
<option value="JP">Japan</option>
<option value="JO">Jordan</option>
<option value="KZ">Kazakhstan</option>
<option value="KE">Kenya</option>
<option value="KI">Kiribati</option>
<option value="KP">Korea, Democratic People's Republic of</option>
<option value="KR">Korea, Republic of</option>
<option value="KW">Kuwait</option>
<option value="KG">Kyrgyzstan</option>
<option value="LA">Lao People's Democratic Republic</option>
<option value="LV">Latvia</option>
<option value="LB">Lebanon</option>
<option value="LS">Lesotho</option>
<option value="LR">Liberia</option>
<option value="LY">Libyan Arab Jamahiriya</option>
<option value="LI">Liechtenstein</option>
<option value="LT">Lithuania</option>
<option value="LU">Luxembourg</option>
<option value="MO">Macau</option>
<option value="MG">Madagascar</option>
<option value="MW">Malawi</option>
<option value="MY">Malaysia</option>
<option value="MV">Maldives</option>
<option value="ML">Mali</option>
<option value="MT">Malta</option>
<option value="MH">Marshall Islands</option>
<option value="MQ">Martinique</option>
<option value="MR">Mauritania</option>
<option value="MU">Mauritius</option>
<option value="YT">Mayotte</option>
<option value="MX">Mexico</option>
<option value="FM">Micronesia</option>
<option value="MD">Moldova, Republic of</option>
<option value="MC">Monaco</option>
<option value="MN">Mongolia</option>
<option value="MS">Monserrat</option>
<option value="MA">Morocco</option>
<option value="MZ">Mozambique</option>
<option value="MM">Myanmar</option>
<option value="NA">Namibia</option>
<option value="NR">Nauru</option>
<option value="NP">Nepal</option>
<option value="NL">Netherlands</option>
<option value="AN">Netherlands Antilles</option>
<option value="NC">New Caledonia</option>
<option value="NZ">New Zealand</option>
<option value="NI">Nicaragua</option>
<option value="NE">Niger</option>
<option value="NG">Nigeria</option>
<option value="NU">Niue</option>
<option value="NF">Norfolk Island</option>
<option value="MP">Northern Mariana Islands</option>
<option value="NO">Norway</option>
<option value="OM">Oman</option>
<option value="PK">Pakistan</option>
<option value="PW">Palau</option>
<option value="PA">Panama</option>
<option value="PG">Papua New Guinea</option>
<option value="PY">Paraguay</option>
<option value="PE">Peru</option>
<option value="PH">Philippines</option>
<option value="PN">Pitcairn</option>
<option value="PL">Poland</option>
<option value="PT">Portugal</option>
<option value="PR">Puerto Rico</option>
<option value="QA">Qatar</option>
<option value="RE">Reunion</option>
<option value="RO">Romania</option>
<option value="RU">Russian Federation</option>
<option value="RW">Rwanda</option>
<option value="LC">Saint Lucia</option>
<option value="WS">Samoa</option>
<option value="SM">San Marino</option>
<option value="ST">Sao Tome & Principe</option>
<option value="SA">Saudi Arabia</option>
<option value="SN">Senegal</option>
<option value="RS">Serbia</option>
<option value="SC">Seychelles</option>
<option value="SL">Sierra Leone</option>
<option value="SG">Singapore</option>
<option value="SK">Slovakia</option>
<option value="SI">Slovenia</option>
<option value="SB">Solomon Islands</option>
<option value="SO">Somalia</option>
<option value="ZA">South Africa</option>
<option value="GS">South Georgia and the South Sandwich Islands</option>
<option value="ES">Spain</option>
<option value="LK">Sri Lanka</option>
<option value="SH">St. Helena</option>
<option value="KN">St. Kitts and Nevis</option>
<option value="PM">St. Pierre & Miquelon</option>
<option value="VC">St. Vincent & the Grenadines</option>
<option value="SD">Sudan</option>
<option value="SR">Suriname</option>
<option value="SJ">Svalbard & Jan Mayen Islands</option>
<option value="SZ">Swaziland</option>
<option value="SE">Sweden</option>
<option value="CH">Switzerland</option>
<option value="SY">Syrian Arab Republic</option>
<option value="TW">Taiwan</option>
<option value="TJ">Tajikistan</option>
<option value="TZ">Tanzania, United Republic of</option>
<option value="TH">Thailand</option>
<option value="TG">Togo</option>
<option value="TK">Tokelau</option>
<option value="TO">Tonga</option>
<option value="TT">Trinidad & Tobago</option>
<option value="TN">Tunisia</option>
<option value="TR">Turkey</option>
<option value="TM">Turkmenistan</option>
<option value="TC">Turks & Caicos Islands</option>
<option value="TV">Tuvalu</option>
<option value="UG">Uganda</option>
<option value="UA">Ukraine</option>
<option value="AE">United Arab Emirates</option>
<option value="GB">United Kingdom (Great Britain)</option>
<option value="UM">United States Minor Outlying Islands</option>
<option value="VI">United States Virgin Islands</option>
<option value="US">USA</option>
<option value="ZZ">Unknown or unspecified country</option>
<option value="UY">Uruguay</option>
<option value="UZ">Uzbekistan</option>
<option value="VU">Vanuatu</option>
<option value="VA">Vatican City State (Holy See)</option>
<option value="VE">Venezuela</option>
<option value="VN">Viet Nam</option>
<option value="WF">Wallis & Futuna Islands</option>
<option value="EH">Western Sahara</option>
<option value="YE">Yemen</option>
<option value="YU">Yugoslavia</option>
<option value="ZR">Zaire</option>
<option value="ZM">Zambia</option>
<option value="ZW">Zimbabwe</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="card-cvc-postal">
<div class="card-cvc"
ng-shortcut="'shift+alt+c'"
ng-shortcut-action="auth.permissions.can('createWithoutCVC', Payment, paymentCtrl.company) && paymentCtrl.overrideCvc()"
>
<span ng-if-once="kioskMode">
<div class="bookform-payments-payment-cardcvc hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payments-payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="bookform-payments-payment-cardcvc hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payments-payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="<span class='cvc-icon'></span> [! T('Your card\'s three or four digit verification number, usually on the back') !]"
ng-tip-classes="tip-text-left"
ng-tip-touch="true"
></div>
</div>
<div class="card-postal"
ng-if="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;] && Payment.needsPostalCode(bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;])"
>
<span ng-if-once="kioskMode">
<div class="bookform-payments-payment-postalcode field-location-icon hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="bookform-payments-payment-postalcode field-location-icon hide-label-text "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Please enter your billing postal code (zip code) for verification') !]"
ng-tip-touch="true"
></div>
</div>
</div>
</div>
<a class="card-swipe"
ng-click="paymentCtrl.startSwiping()"
ng-if="paymentCtrl.showingSwipe && !paymentCtrl.cardTypeAbbreviation()"
ng-tip="[! T('Swipe card') !]"
ng-tip-classes="tip-indent"
>
Swipe card
</a>
<div class="swiping" ng-if="paymentCtrl.swiping">
<input class="swipe-input" type="text" ng-swipe="paymentCtrl.swipeComplete" />
<div class="swiping-inner">
<div><img ng-src="//dp58aslhmbcib.cloudfront.net/static/images/card-swipe.gif?99774cb15b0528a7a2caeeb2a01921cc3e14532e" /></div>
Ready to swipe card...
</div>
</div>
</div>
<div class="amex-note"
ng-if="auth.currentUser.isAuthenticated && !bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
>
<b>Note:</b> It is strongly recommended that you enter the country for American Express cards, or the charge will fail.
</div>
<div ng-if="!company.isDemoModeEnabled"
ng-link="payment-setup-nag"
ng-init="isShort = true"
></div>
</div>
</div>
<div ng-if="!paymentCtrl.isAnonymous && paymentCtrl.isAnyKindValid() && paymentCtrl.kind() !== paymentCtrl.SKIP_KIND"
class="payment-comment"
>
<a ng-toggle="paymentComment" class="form-link-subtle hide-when-toggled">Add comment to payment</a>
<div ng-toggled="paymentComment">
<div class="bookform-payments-payment-note "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Payment comment (not visible to customer)" ng-prefix="'payments-payment'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="hide">
<div ng-if="paymentCtrl.needsCardFields()">
<div class="bookform-payments-payment-stripetoken "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-payments-payment-cardlast4 "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-payments-payment-cardtype "
ng-django-field="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="bookCtrl.newBooking [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div ng-link="book.errors"></div>
<div ng-if="bookCtrl.currentUserCanCreateAsCompany || !availability.company.features.isCancellationPoliciesEnabled">
<div ng-if="item.cancellationNotes || company.cancellationNotes"
class="chunky-error"
>
<div class="chunky-error-inner toggleable"
ng-toggle="authBookCancellation"
>Cancellation notes</div>
<div ng-toggled="authBookCancellation"
class="chunky-error-content limit-height prose"
ng-bind-html-once="item.cancellationNotesSafeHtml || company.cancellationNotesSafeHtml"
></div>
</div>
</div>
<div class="auth-book-sidebar-section">
<div class="book-form-submit" ng-noisy-invalid-fields>
<div class="book-form-submit-button">
<button class="btn-huge btn-wide btn-green test-book-action-enabled" type="submit"
ng-if="bookCtrl.showBookButton(bookForm)" ng-then="buttonEnabled"
ng-shortcut="'shift+enter'"
ng-shortcut-click
ng-scroll-to="[[ auth.currentUser.isAuthenticated ? (isMobileBookForm ? '.form-loading-overlay' : 'top') : '' ]]"
ng-scroll-on-click
ng-scroll-smooth
title="[! auth.currentUser.isAuthenticated ? T('Shortcut: shift+enter') : '' !]"
>
<span ng-if="!rebook.currentBooking">
<span ng-if-once="auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? cT('"order" as in sales order', 'Complete order') : T('Complete booking') !]
</span>
<span ng-if-once="!auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? T('Buy now') : T('Complete your booking') !]
</span>
</span>
<span ng-if="rebook.currentBooking" class="test-rebook-button-indicator">Rebook now</span>
</button>
<button class="btn-huge btn-wide btn-grey test-book-action-disabled" type="button"
ng-else="buttonEnabled"
ng-mx-click="click-disabled-book-button"
ng-mx-availability="availability"
ng-click="noisyInvalidFieldsCtrl.show()"
>
<span ng-if="!bookForm.$submitting && !rebook.currentBooking">
<span ng-if="auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? cT('"order" as in sales order', 'Complete order') : T('Complete booking') !]
</span>
<span ng-if="!auth.currentUser.isAuthenticated">
[! availability.item.isRetail ? T('Buy now') : T('Complete your booking') !]
</span>
</span>
<span ng-if="!bookForm.$submitting && rebook.currentBooking" class="test-rebook-button-indicator">Rebook now</span>
<span ng-if="bookForm.$submitting">
[! availability.item.isRetail ? T('Processing...') : T('Booking...') !]
</span>
</button>
</div>
<div ng-book-noisy-invalid-fields="!buttonEnabled && !bookForm.$submitting"></div>
<div class="book-final-note">
<p class="required-fields-note" ng-if="bookForm.$invalid">
<b ng-if-once="availability.item.isRetail" ng-then="notRetail">
Please answer all fields marked with <span class="required-flag-icon">*</span> to complete your order
</b>
<b ng-else="notRetail">
Please answer all fields marked with <span class="required-flag-icon">*</span> to complete your booking
</b>
</p>
<p ng-if="!bookForm.$invalid && !rebook.currentBooking">
<b ng-if="bookCtrl.paymentCtrl.option() === bookCtrl.paymentCtrl.CHARGE_OPTION || bookCtrl.paymentCtrl.option() === bookCtrl.paymentCtrl.FILE_OPTION">
Card will be charged for [[ bookCtrl.paymentCtrl.amount()|amount:availability ]].
</b>
<b ng-if="bookCtrl.paymentCtrl.kind() === bookCtrl.paymentCtrl.DEFER_KIND">
Card will be verified and kept on file, but not charged.
</b>
</p>
</div>
<div ng-book-policies="bookCtrl.availability.company"></div>
</div>
</div>
</div>
<div class="auth-book-customers-prompt respond-handhelds-hide"
ng-show="!bookCtrl.bookCountsCtrl.customerCount"
>
Add customers to your booking<br> to select payment and complete
</div>
</div>
</div>
</div>
<div class="hide">
<div class="bookform-onlinebookingreference "
ng-django-field="bookForm [&#39;onlineBookingReference&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;onlineBookingReference&#39;]"
>
<label >
<span class="label-text">
Online booking reference
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_online_booking_reference" name="onlineBookingReference" ng-model="bookCtrl.newBooking [&#39;onlineBookingReference&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;onlineBookingReference&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-clientuuid "
ng-django-field="bookForm [&#39;clientUuid&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;clientUuid&#39;]"
>
<label >
<span class="label-text">
Client ID
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_client_uuid" name="clientUuid" ng-model="bookCtrl.newBooking [&#39;clientUuid&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;clientUuid&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-totalsheet "
ng-django-field="bookForm [&#39;totalSheet&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;totalSheet&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Total sheet
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_total_sheet" name="totalSheet" ng-model="bookCtrl.newBooking [&#39;totalSheet&#39;]" required="required" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;totalSheet&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;totalSheet&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-invoicesheet "
ng-django-field="bookForm [&#39;invoiceSheet&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;invoiceSheet&#39;]"
>
<label >
<span class="label-text">
Invoice sheet
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_invoice_sheet" name="invoiceSheet" ng-model="bookCtrl.newBooking [&#39;invoiceSheet&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;invoiceSheet&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;invoiceSheet&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-type "
ng-django-field="bookForm [&#39;type&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;type&#39;]"
>
<label >
<span class="label-text">
Type
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_type" name="type" ng-model="bookCtrl.newBooking [&#39;type&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;type&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;type&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-isdemo "
ng-django-field="bookForm [&#39;isDemo&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;isDemo&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_demo" name="isDemo" ng-model="bookCtrl.newBooking [&#39;isDemo&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;isDemo&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-isshowinghiddencustomfields "
ng-django-field="bookForm [&#39;isShowingHiddenCustomFields&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;isShowingHiddenCustomFields&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_showing_hidden_custom_fields" name="isShowingHiddenCustomFields" ng-model="bookCtrl.newBooking [&#39;isShowingHiddenCustomFields&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;isShowingHiddenCustomFields&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-rebook "
ng-django-field="bookForm [&#39;rebook&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;rebook&#39;]"
>
<label >
<span class="label-text">
Rebook
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_rebook" name="rebook" ng-model="bookCtrl.newBooking [&#39;rebook&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;rebook&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;rebook&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-iscanceleligible "
ng-django-field="bookForm [&#39;isCancelEligible&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;isCancelEligible&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_cancel_eligible" name="isCancelEligible" ng-model="bookCtrl.newBooking [&#39;isCancelEligible&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;isCancelEligible&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-plusbook "
ng-django-field="bookForm [&#39;plusbook&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;plusbook&#39;]"
>
<label >
<span class="label-text">
Plusbook
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_plusbook" name="plusbook" ng-model="bookCtrl.newBooking [&#39;plusbook&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;plusbook&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;plusbook&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-orderizeorder "
ng-django-field="bookForm [&#39;orderizeOrder&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;orderizeOrder&#39;]"
>
<label >
<span class="label-text">
Orderize order
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_orderize_order" name="orderizeOrder" ng-model="bookCtrl.newBooking [&#39;orderizeOrder&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;orderizeOrder&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;orderizeOrder&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="bookform-orderizebooking "
ng-django-field="bookForm [&#39;orderizeBooking&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;orderizeBooking&#39;]"
>
<label >
<span class="label-text">
Orderize booking
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_orderize_booking" name="orderizeBooking" ng-model="bookCtrl.newBooking [&#39;orderizeBooking&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;orderizeBooking&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in bookForm [&#39;orderizeBooking&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="bookForm.all.$error.explicit-invoice-price-permissions">There was an error processing this request. Please refresh the page and try again. (U-INVP)</li>
<li ng-if="bookForm.all.$error.explicit-gross-permissions">There was an error processing this request. Please refresh the page and try again. (U-EXP)</li>
<li ng-if="bookForm.all.$error.demo_mismatch">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.archived_item">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.no_total_sheet">There was an error calculating prices for this booking. Please refresh the page and try again.</li>
<li ng-if="bookForm.all.$error.availability_overbooked">Sorry, there is not enough room for this many customers. Please go back and choose a different option.</li>
<li ng-if="bookForm.all.$error.rebook_rebooked_booking">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.availability_not_bookable">Some options you selected are no longer available. Please update your booking and try again.</li>
<li ng-if="bookForm.all.$error.not_visible">Sorry, this activity cannot be booked. Please go back and choose a different activity.</li>
<li ng-if="bookForm.all.$error.invalid_order">There was an error processing this request. Please refresh the page and try again. (O-INVALID)</li>
<li ng-if="bookForm.all.$error.show_hidden_permissions">There was an error processing this request. Please refresh the page and try again. (U-FIELDS)</li>
<li ng-if="bookForm.all.$error.booking-cancelled">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.price_sheet_permissions">There was an error processing this request. Please refresh the page and try again. (U-SHEET)</li>
<li ng-if="bookForm.all.$error.booking-rebooked">This booking has already been cancelled or rebooked. Please refresh the page.</li>
<li ng-if="bookForm.all.$error.unsatisfiable-resources">Sorry, we were unable to create your booking with the current selections. Please refresh the page and try again. (R-UNSAT)</li>
<li ng-if="bookForm.all.$error.unknown_error">There was an error processing this request. Please refresh the page and try again. (U-BOOK)</li>
<li ng-repeat="error in bookForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="bookForm.all.$error.$tokenization">
<li ng-repeat="error in bookForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
</div>
</script>
<script type="text/ng-template" id="anon-gift-card-button">
<div class="gift-card-wrap" ng-if="
!bookCtrl.item.company.features.isCartEnabled &&
bookCtrl.item.company.features.isOnlineStoredValueCardRedemptionEnabled &&
(bookTotalsCtrl.totals.price + bookTotalsCtrl.totals.tax > 0)
"
ng-book-redeem
></div>
</script>
<script type="text/ng-template" id="book.bookingFields">
<fieldset ng-if="bookBookingFieldsCtrl.hasCustomFields() && (bookCtrl.bookCountsCtrl.customerCount && bookCtrl.bookCountsCtrl.missingCount === 0 || auth.currentUser.isAuthenticated)"
class="book-form-booking-fields"
ng-mx-view="view-whole-booking-custom-fields"
ng-mx-when="!auth.currentUser.isAuthenticated"
ng-mx-form-valid="complete-whole-booking-custom-fields"
ng-mx-scope-data="bookBookingFieldsCtrl.customFieldTrackingData"
>
<legend class="book-anon-columns-section is-header"
ng-class="{ 'visually-hidden': !bookAnonColumns }"
>
Extra Information
</legend>
<ul class="custom-field-values book-anon-columns-section with-bottom-border" ng-if="bookCtrl.isAutofillingComplete">
<li class="test-booking-custom-field-indicator"
ng-repeat="customFieldInstance in bookBookingFieldsCtrl.customFieldInstances"
ng-with="customFieldPricing = pricesCtrl.totalPricing(customFieldInstance); customField = customFieldInstance.customField"
ng-if="bookCtrl.isVisibleWhenBooking(customFieldInstance)"
ng-book-field="customFieldInstance"
>
<div class="fields "
>
<div class="bookform-customfieldinstance-customfieldinstancepk-forbooking-value "
ng-django-field="bookForm [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-django-field-required="!!customFieldPricing.visibility.isRequired"
ng-class="{ 'is-display-only': customField.isDisplayOnly }"
>
<div class="cf-wrap cf-wrap--[! customField.type|css !]
[! CustomField.usesCheckbox(customField) ? 'cf-wrap--checkbox' : '' !]"
ng-class="{
'private-field': customFieldPricing.visibility.isHiddenWhenBooking || customField.isPrivate
}"
>
<span class="private-field-icon test-private-custom-field-indicator"
ng-tip="[[ customField.isPrivate ? T('Only shown to logged in users with permission to see private fields. (That\'s you!)') : T('Will not be shown when booking') ]]"
ng-tip-location=".private-field-lock"
>
<span class="private-field-lock"></span>
</span>
<div ng-if-once="customField.isDisplayOnly">
<div ng-if="customField.type === CustomField.HEADER_TYPE">
<h2>[! customField.title !]</h2>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if="customField.type === CustomField.NOTE_TYPE" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.SHORT_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field test-custom-field-[! customField.name|css !]">
<span class="label-text">[! customField.hint !]</span>
<input id="id_short" maxlength="2048" name="value" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" type="text" />
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.LONG_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="the-field test-custom-field-[! customField.name|css !]">
<textarea cols="40" id="id_long" name="value" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]" ng-placeholder="[! customField.hint !]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'" ng-required="!!customFieldPricing.visibility.isRequired" rows="10">
</textarea>
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.YES_NO_TYPE">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
<label ng-if="customField.type === CustomField.COUNT_TYPE && bookCtrl.newBooking.type !== CustomFieldInstanceCondition.RANGE_TYPE"
class="custom-field-[! customField.type|css !] cf-label table valign-middle table-dont-respond"
ng-init="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;] = ((bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]|isDefined) ? bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;] : customField.countMin)"
>
<div class="tr">
<div class="td count-field-select"
ng-hide="customField.countMin === customField.countMax && bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;] === customField.countMin"
>
<select
ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-options="option for option in customField.countMin|range:(customField.countMax + 1)"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'"
name="value"
></select>
</div>
<div class="td">
<div class="cf-title">
[! customField.title !]<span
ng-if="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)"
><span ng-if="customField.isPricingHidden && bookCtrl.newBookingOptions.totalCosts[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;] && PriceLine.showRate(customFieldPricing)"
>: <span ng-amount="bookCtrl.newBookingOptions.totalCosts[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;].price"></span>
</span>
<span ng-if="!customField.isPricingHidden">
<span class="fh-grey">&mdash;</span>
<span ng-price="customFieldPricing"
ng-price-company="customField.company"
ng-price-count="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
></span>
</span>
</span>
</div>
<div ng-inline="cf-description"></div>
</div>
</div>
</label>
<div ng-if-once="customField.type === CustomField.EXTENDED_OPTION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-prices-extended-options="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-prices-extended-options-field="customField"
ng-prices-extended-options-instance="customFieldInstance"
ng-prices-extended-options-currency="customField"
ng-current-option="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="pricesExtendedOptionsCtrl.options"
ng-current-option-target="currentOption"
>
<div ng-if="pricesExtendedOptionsCtrl.isImpossibleOption" ng-then="impossibleOption">
<div class="cf-title">
<i class="warning-icon"></i> [! customField.title !]
</div>
</div>
<div ng-if="pricesExtendedOptionsCtrl.isForcedOption" ng-then="forcedOption"
ng-init="bookForm.$setDirty()"
class="cf-title"
>
<span ng-if="!customField.isPricingHidden"
ng-with="currentOptionPricing = pricesCtrl.totalPricing(currentOption.extendedOption)"
>
<span ng-price="currentOptionPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && currentOption.extendedOption.isAlwaysPerCustomer">
per person
</span>
<span ng-if="PriceLine.showOffset(currentOptionPricing)"></span>
<span ng-if="currentOption.extendedOption.name && (
PriceLine.showOffset(currentOptionPricing) ||
PriceLine.showRate(currentOptionPricing)
)" class="fh-grey"
>&mdash;</span>
</span>
<span ng-bind="currentOption.extendedOption.name"></span>
</div>
<div ng-else="impossibleOption || forcedOption">
<label class="cf-label">
<div class="cf-title" ng-show="customField.title">
<span ng-bind="customField.title"></span>
</div>
<div class="the-field cf-extended-option-dropdown">
<select ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-options="option.pk as option.label for option in pricesExtendedOptionsCtrl.options"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'"
ng-required="!!customFieldPricing.visibility.isRequired"
name="value"
ng-dropdown
ng-placeholder="[! T('Choose an option') !]"
></select>
<i ng-link="f-req" ng-with="label = T('Choice is required')"></i>
</div>
</label>
</div>
<div ng-show="currentOption">
<div class="option-details md-inline" ng-if="currentOption.extendedOption.description"
ng-bind-html="currentOption.extendedOption.descriptionSafeHtml"
></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-current-option="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="customField.transportationOptions"
ng-current-option-target="currentTransportationOption"
>
<div class="cf-title">
<span ng-bind-once="customField.title"></span>
<span ng-if="!customField.isPricingHidden">
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</div>
<div ng-if="customField.transportationOptions.length === 1" ng-then="fullTransportation"
ng-init="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;] = customField.transportationOptions[0].pk"
></div>
<div ng-else="fullTransportation"
class="cf-transportation-dropdown"
>
<select
ng-init="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;] = bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;] || (customField.transportationOptions.length && customField.transportationOptions[0].pk)"
ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-options="transportationOption.pk as transportationOption.location for transportationOption in customField.transportationOptions"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'"
name="value"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-placeholder="[! T('Choose transportation') !]"
>
</select>
</div>
<div class="transportation-details">
<h3 class="pickup-time">
<span ng-if="currentTransportationOption.isSelfTransportation" ng-then="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
Please arrive by [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
Please arrive [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
<span ng-else="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
We'll pick you up at [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
We'll pick you up [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
</h3>
<div class="transportation-note md-inline" ng-if="currentTransportationOption.description"
ng-bind-html="currentTransportationOption.descriptionSafeHtml"></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"></div>
</div>
<div ng-if-once="customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-new-transportation="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-mx-form-valid-async
>
<div ng-if="newTransportationCtrl.status === 'loading' || newTransportationCtrl.status === 'error'">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
<div ng-if="newTransportationCtrl.status === 'success'"
ng-mx-form-valid-async-success
>
<div class="table cf-lodging-table">
<div class="tr">
<div class="td">
<label class="cf-label">
<div class="cf-title"
ng-class="{ 'no-title': !customField.title }"
>
[! customField.title || 'none' !]
</div>
<div ng-current-option="newTransportationCtrl.data.lodging"
ng-current-option-collection="newTransportationCtrl.lodgings"
ng-current-option-target="newTransportationCtrl.currentLodging"
></div>
<div ng-if="newTransportationCtrl.lodgings.length"
class="the-field cf-lodging-dropdown"
ng-class="{
'ng-invalid': bookForm['customFieldInstance' + customFieldInstance.pk + 'ForBooking' + '-lodging'].$invalid,
'ng-required': true
}"
>
<select ng-model="newTransportationCtrl.data.lodging"
ng-options="lodging.pk as lodging.effectiveName for lodging in newTransportationCtrl.lodgings"
ng-placeholder="[[ customField.hint || T('Please select where you are staying') ]]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'"
name="lodging"
></select>
<i ng-link="f-req"></i>
</div>
</label>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html="customField.descriptionSafeHtml"
></div>
</div>
<div class="td room-number-field"
ng-if="newTransportationCtrl.currentLodging && !newTransportationCtrl.currentLodging.isSelfLodging && !customField.isLodgingRoomNumberHidden"
>
<label class="cf-label">
<div class="cf-title">Room number</div>
<input id="id_lodging_room_number" maxlength="128" name="lodgingRoomNumber" ng-model="newTransportationCtrl.data.lodgingRoomNumber" ng-placeholder="If known" type="text" />
</label>
</div>
</div>
<div class="tr self-lodging-contact-field" ng-if="newTransportationCtrl.currentLodging && newTransportationCtrl.currentLodging.isSelfLodging">
<label class="cf-label">
<textarea cols="40" id="id_self_lodging_address" name="selfLodgingAddress" ng-model="newTransportationCtrl.data.selfLodgingAddress" ng-placeholder="Please let us know how we can contact you" rows="10">
</textarea>
</label>
</div>
</div>
<div class="new-transportation-details"
ng-if="newTransportationCtrl.isTransportationAvailable() || newTransportationCtrl.showSelfTransportation()"
>
<div ng-if="newTransportationCtrl.isTransportationAvailable()">
<div ng-if="newTransportationCtrl.showNeedsTransportation()"
ng-then="showNeedsTransportation"
>
<div class="new-transportation-options-header bold">
[[ newTransportationCtrl.canOverrideTransportation ?
T('Transportation option:') :
T('Transportation to our location is available. Please select an option:') ]]
</div>
<div class="field field-boolean-radio
ng-required
"
ng-class="{ 'ng-invalid': newTransportationCtrl.needsTransportation === undefined }"
ng-radio-flyer
>
<div class="the-field">
<i ng-link="f-req"></i>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="true"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('Needs transportation') : T('Please pick me up') ]]
<span ng-if="newTransportationCtrl.showTransportationPrice()">
&mdash;
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</label>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="false"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('No transportation') : T('I will provide my own transportation') ]]
</label>
</div>
</div>
</div>
<div ng-if="!showNeedsTransportation && newTransportationCtrl.showTransportationPrice()"
class="need-trans-price"
>
<b ng-hide="showNeedsTransportation">Transportation:</b>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</div>
<div ng-if="newTransportationCtrl.needsTransportation">
<div class="cf-rebook-new-transportation"
ng-if="
newTransportationCtrl.needsTransportation && newTransportationCtrl.rebookingTransportation &&
newTransportationCtrl.rebookTransportationOptions.length > 1
"
>
<h2>How should transportation be rebooked?</h2>
<ul class="cf-rebook-options" ng-radio-flyer>
<li ng-repeat="option in newTransportationCtrl.rebookTransportationOptions" class="cf-rebook-option">
<label>
<input type="radio" ng-model="newTransportationCtrl.rebookTransportationOption" ng-value="option">
[[ option.text ]]
<i ng-if="option.tip" ng-tip="[[ option.tip ]]" class="icon-hint"></i>
</label>
</li>
</ul>
</div>
<div class="new-trans-selects-wrap" ng-if="newTransportationCtrl.showRoutes() || newTransportationCtrl.showStops()">
<div class="new-trans-selects">
<div ng-if="newTransportationCtrl.showRoutes()">
<div ng-current-option="newTransportationCtrl.data.route"
ng-current-option-collection="newTransportationCtrl.routes"
ng-current-option-target="newTransportationCtrl.currentRoute"
></div>
<div class="the-field cf-route-dropdown"
ng-class="{
'ng-invalid': bookForm['customFieldInstance' + customFieldInstance.pk + 'ForBooking' + '-route'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.route"
ng-options="routeSelection.route.pk as newTransportationCtrl.routeSelectionText(routeSelection) for routeSelection in newTransportationCtrl.routeSelections"
ng-placeholder="[! T('Choose your route') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'"
name="route"
></select>
<i ng-link="f-req"></i>
</div>
</div>
<div ng-current-option="newTransportationCtrl.data.stop"
ng-current-option-collection="newTransportationCtrl.stops"
ng-current-option-target="newTransportationCtrl.currentStop"
></div>
<div ng-if="newTransportationCtrl.showStops()"
class="the-field cf-stop-dropdown"
ng-class="{
'ng-invalid': bookForm['customFieldInstance' + customFieldInstance.pk + 'ForBooking' + '-stop'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.stop"
ng-options="stop.pk as stop.unicode for stop in newTransportationCtrl.stops"
ng-placeholder="[! T('Choose a pickup location') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'"
name="stop"
></select>
<i ng-link="f-req"></i>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.needsTransportation && !newTransportationCtrl.currentStop && newTransportationCtrl.stops.length"
class="select-a-stop-note"
>
<span ng-if="newTransportationCtrl.canOverrideTransportation" ng-then="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
Select a pickup location above.
</span>
<span ng-else="required">
Select a pickup location above, or choose &quot;No transportation&quot; instead.
</span>
</span>
<span ng-else="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
Please select a pickup point from the list above.
</span>
<span ng-else="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
If you need transportation, please select a pickup point from the list above.
If you need help, please select &quot;I will provide my own transportation&quot; and call us after completing your booking.
</span>
</span>
</div>
<div ng-if="newTransportationCtrl.currentStop">
<div class="pickup-info">
<h3 class="new-pickup-time">
We'll pick you up at [[ newTransportationCtrl.currentStop.time|time ]] from [[ newTransportationCtrl.currentStop.pickup.name ]]
</h3>
<div class="pickup-notes-toggle" ng-if="newTransportationCtrl.currentStop.pickup.description">
Pickup details will be included in your confirmation email. (<a ng-toggle="showNotes">View details</a>)
</div>
<div ng-toggled="showNotes">
<div ng-if="newTransportationCtrl.currentStop.pickup.description" class="md-inline"
ng-bind-html="newTransportationCtrl.currentStop.pickup.descriptionSafeHtml"
></div>
</div>
</div>
<div ng-toggled="showNotes">
<a ng-href="[[ newTransportationCtrl.currentStop.pickup.mapUrl ]]"
ng-if="newTransportationCtrl.currentStop.pickup.mapUrl"
ng-outbound-link="_blank"
class="pickup-map-link"
>
<b class="map-link-headline">See pickup location on a map</b>
</a>
</div>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.showSelfTransportation()"
class="pickup-info"
>
<h3 class="new-pickup-time">
Please arrive by [[ availability.startAt|dateSubtract:availability.item.noTransportationMinutes:'minutes'|time ]]
</h3>
<div ng-if="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
>
<div class="pickup-notes-toggle">
Directions will be included in your confirmation email. (<a ng-toggle="showSelfNotes">View directions</a>)
</div>
<div class="md-inline"
ng-toggled="showSelfNotes"
ng-bind-html="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
></div>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'" ng-prevalidate-custom-field="bookCtrl.newBookingOptions" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div class="cf-admin-note md-inline"
ng-can-list="Code on customField.company"
>
<span class="icon-lock" ng-tip="[! T('Customers booking online don\'t see this note.') !]"></span>
Accepts codes from <a ng-href="[! customField.campaign.$url(urls.dashboard.settings.campaigns.campaign.index) !]"> [! customField.campaign.name !]</a>.
<span ng-show="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)">
Changes price by <span class="option-offset" ng-price="customFieldPricing" ng-price-company="customField.company"></span> when code is valid.
</span>
</div>
<div ng-with="prevalidity = bookCtrl.newBookingOptions.prevalidity[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_GENERATOR_TYPE">
<div ng-if="!!customFieldPricing.visibility.isRequired" ng-then="requiredField" ng-init="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;] = true;">
<div class="cf-title">
<span ng-if="!customField.isPricingHidden && (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing))">
<span class="option-offset"
ng-price="customFieldPricing"
ng-price-company="customField.company"
></span>
<span ng-if="!!customField.title">&mdash;</span>
</span>
[! customField.title !]
</div>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-else="requiredField">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CARD_GENERATOR_TYPE">
<div ng-can-view-amounts="customField.company" ng-then="canViewAmounts"
ng-card-generator="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-form="cardGeneratorSubform"
>
<div ng-if="cardGeneratorCtrl.isAlreadyGenerated" ng-then="alreadyGenerated">
<b ng-amount="cardGeneratorCtrl.selectedAmount"
ng-amount-company="customField.company"
></b> <span class="fh-grey">&mdash;</span>
This field has already generated a gift card.
</div>
<div ng-if="!alreadyGenerated && customFieldValue" ng-then="hasValue">
This field cannot be edited from here. Please edit the generated gift card instead.
</div>
<div ng-if="!alreadyGenerated && !hasValue">
<div ng-if="!customFieldPricing.visibility.isRequired"
class="table table-dont-respond valign-middle
cf-checkbox cf-checkbox--no-offset
test-custom-field-[! customField.name|css !]-select
"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input type="checkbox"
class="ng-pristine"
ng-model="cardGeneratorCtrl.isSelected"
ng-checkbox-madness="true"
>
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if-once="customField.title">[! customField.title !]</h2>
</div>
</div>
</label>
</div>
<div ng-if="cardGeneratorCtrl.isSelected">
<div class="cf-title" ng-if="customField.title && customFieldPricing.visibility.isRequired">[[ customField.title ]]</div>
<fieldset>
<legend class="card-generator-header">Choose Amount</legend>
<div class="card-generator-amounts-wrap">
<div class="table table-dont-respond full-width">
<ul ng-radio-flyer
class="card-generator-amounts tr"
ng-class="{ '-custom-amount': toggles.state(cardGeneratorCtrl.toggleValue) }"
>
<li class="td">
<label ng-toggle ng-toggle-value="cardGeneratorCtrl.toggleValue"
ng-toggle-interactive="false"
ng-toggle-default="cardGeneratorCtrl.defaultToOther"
ng-click="toggles.toggle(cardGeneratorCtrl.toggleValue, true)"
>
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]">
<div>Custom</div>
</label>
</li>
<li ng-repeat="suggestedAmount in cardGeneratorCtrl.suggestedAmounts"
class="td"
>
<label ng-click="cardGeneratorCtrl.selectAmount(suggestedAmount)">
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]" ng-checked="!toggles.state(cardGeneratorCtrl.toggleValue) && cardGeneratorCtrl.selectedAmount === suggestedAmount">
<div ng-amount="suggestedAmount" ng-amount-currency="customField" ng-amount-hide-cents></div>
</label>
</li>
</ul>
</div>
</div>
</fieldset>
<div ng-toggled ng-toggled-value="cardGeneratorCtrl.toggleValue"
class="card-generator-custom-amount"
>
<div class="cardgeneratorsubform-selectedamount
field-amount
"
ng-django-field="cardGeneratorSubform [&#39;selectedAmount&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Gift amount:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount" max="999999.99" min="0" name="amount" ng-amount-input="true" ng-amount-input-default="cardGeneratorCtrl.minimumAmount" ng-amount-input-min="cardGeneratorCtrl.minimumAmount" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cardGeneratorSubform [&#39;selectedAmount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="cardGeneratorCtrl.selectedAmount">
<div class="p-t-15 prose"
ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
<fieldset>
<legend class="card-generator-header">Recipient Info</legend>
<p class="p-b-10">
You&#039;ll confirm these details, add an optional note, and send your digital gift card after checkout.
</p>
<div class="m-b-5 test-custom-field-[! customField.name|css !]-name">
<div class="cardgeneratorsubform-name field-person-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;name&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;name&#39;]"
ng-django-field-required="!auth.permissions.can('skipRecipientName', customField)"
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="cardGeneratorCtrl [&#39;name&#39;]" ng-placeholder="Full name" ng-required="!auth.permissions.can('skipRecipientName', customField)" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="cardgeneratorsubform-email field-email-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;email&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;email&#39;]"
ng-django-field-required="false"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="cardGeneratorCtrl [&#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-required="false" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</fieldset>
</div>
</div>
</div>
</div>
<div ng-else="canViewAmounts">
Sorry, you are not authorized to create gift cards.
</div>
</div>
<div ng-if-once="customField.type === CustomField.MULTI_CAMPAIGN_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label ng-toggle ng-toggle-value="'addCampaignCode' + customField.pk"
ng-toggle-default="auth.currentUser.isAuthenticated || customFieldPricing.visibility.isRequired || customField.isCodeInputShownByDefault || !!bookCtrl.newBooking[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
class="cf-label hide-when-toggled"
ng-mx-click="click-add-promo-code"
>
<span class="fh-grey underline pointer">[! customField.codeToggleText || T('Add promo or discount code') !]</span>
</label>
<label class="cf-label"
ng-toggled ng-toggled-value="'addCampaignCode' + customField.pk"
>
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'ForBooking'" ng-prevalidate-custom-field="bookCtrl.newBookingOptions" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div
ng-with="prevalidity = bookCtrl.newBookingOptions.prevalidity[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.WAIVER_TYPE">
<div class="custom-field-[! customField.type|css !]"
ng-can-create="Waiver on customField.company"
ng-can-only-when="customField.connectedWaivers.length"
>
<div class="cf-admin-note md-inline">
<span class="icon-lock" ng-tip="[! T('Only people in your company see this note') !]"></span>
<b ng-show="!!customField.name">[! customField.name !]:</b>
Customers will be asked to sign:
<span ng-repeat="connectedWaiver in customField.connectedWaivers" >
<a ng-href="[! connectedWaiver.waiver.$url(urls.dashboard.settings.waivers.waiver.index) !]">[! connectedWaiver.waiver.name !]</a><span ng-if="!$last">,</span>
</span>
</div>
</div>
</div>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;ForBooking&#39; + &#39;-&#39; + &#39;value&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="hide">
</div>
</li>
</ul>
</fieldset>
</script>
<script type="text/ng-template" id="book.callToBook">
<div class="company-text-heading">
<h2 class="sold-out" ng-if-once="bookCtrl.availability.isSoldOut" ng-then="soldOut">
[! Availability.soldOutText(bookCtrl.availability) !]
</h2>
<div ng-else="soldOut"
ng-mx-view="view-call-to-book"
>
<h2>
<span ng-if="company.phone">
Not currently available online, please call us at <a ng-href="tel:[! company.phone !]">[! company.phone|phone !]</a>.
</span>
<span ng-else="company.phone">Not currently available online.</span>
</h2>
<div class="company-text-call-button respond-handhelds-show">
<a class="btn-big btn-green btn-wide btn-icon phone"
ng-href="tel:[! company.phone !]"
>
Call [! company.phone|phone !]</a>
</div>
</div>
<p>
<span ng-if="soldOut" ng-then="isSoldOut">
<span ng-if="availability.headline">
<b>[! availability.item.name !]  <span ng-bind="availability.headline"></span> </b> on <b>[! availability.startAt|datetimeRange:(availability.endAt):'long' !]</b>.
</span>
<span ng-else="availability.headline">
<b>[! availability.item.name !]</b> on <b>[! availability.startAt|datetimeRange:(availability.endAt):'long' !]</b>.
</span>
</span>
<span ng-else="isSoldOut">
<span ng-if="availability.headline">
We may still have space for <b>[! availability.item.name !]  <span ng-bind="availability.headline"></span> </b> on <b>[! availability.startAt|datetimeRange:(availability.endAt):'long' !]</b>.
</span>
<span ng-else="availability.headline">
We may still have space for <b>[! availability.item.name !]</b> on <b>[! availability.startAt|datetimeRange:(availability.endAt):'long' !]</b>.
</span>
</span>
</p>
</div>
<div class="text-center"
ng-if="auth.currentUser.isAuthenticated" ng-then="browserBack"
>
<a class="btn-back" ng-back-button><span class="respond-handhelds-show">Go back</span><span class="respond-handhelds-hide">Go back and choose a different date or time</span></a>
</div>
<div class="text-center" ng-else="browserBack">
<a class="btn-back"
ng-if="availability.item.isGroupedCalendar" ng-then="backToDay"
ng-href="[! availability.$url(urls.company.item.date) !]"
ng-mx-click="goto-item--from-call-to-book"
>Go back and choose a different time</a>
<a class="btn-back"
ng-else="backToDay"
ng-href="[! availability.$url(urls.company.item.calendar) !]"
ng-mx-click="goto-item--from-call-to-book"
><span class="respond-handhelds-show">Go back</span><span class="respond-handhelds-hide">Go back and choose a different date or time</span></a>
</div>
</script>
<script type="text/ng-template" id="book.cards">
<div class="[[ bookAnonColumns ? 'book-anon-columns-section with-bottom-border' : 'book-form-customers company-wrap-inner custom-fields-wrap' ]]"
ng-else="(!bookCardsCtrl.hasCustomFields() && bookCardsCtrl.cards.length && bookCtrl.bookCountsCtrl.missingCount === 0) || (auth.currentUser.isAuthenticated && !bookCardsCtrl.cards.length)"
>
<div class="add-more-message" ng-if="!bookCardsCtrl.cards.length && !auth.currentUser.isAuthenticated">
<h2>
<i class="icon-add-from-dropdown"></i>
Nothing added yet. <span class="fh-grey">Use the menus above to get started.</span>
</h2>
</div>
<div class="add-more-message" ng-if="bookCardsCtrl.cards.length && bookCtrl.bookCountsCtrl.missingCount > 0">
<h2><i class="icon-add-from-dropdown"></i>
[[
interpolate(nT('Please add %(count)s more selection to continue making your booking', 'Please add %(count)s more selections to continue making your booking', bookCtrl.bookCountsCtrl.missingCount ), { count: bookCtrl.bookCountsCtrl.missingCount })
]]
</h2>
A minimum of [[ Availability.minimumPartySize(bookCtrl.availability) ]] is required to make this booking. Use the menus above to add more.
</div>
<ul class="customer-type-cards-list"
ng-class="{ 'customer-type-cards-two-col': !auth.currentUser.isAuthenticated && !bookAnonColumns }"
ng-if="bookCardsCtrl.cards.length && bookCardsCtrl.hasCustomFields() && bookCtrl.bookCountsCtrl.missingCount === 0"
>
<li ng-repeat="card in bookCardsCtrl.cards">
<div class="custom-field-values customer-type-card test-customer-indicator test-customer-card-[! card.customerType.singular|css !]"
ng-if="bookCtrl.isAutofillingComplete"
ng-mx-when="!auth.currentUser.isAuthenticated"
ng-mx-view="view-customer-type-card"
ng-mx-form-valid="complete-customer-type-custom-fields"
ng-mx-data-customer-type-rate="card.customerTypeRate"
ng-mx-scope-data="card.customFieldTrackingData"
>
<fieldset>
<legend class="customer-type-card-header">
<span class="customer-type-name">
[! card.customerType.singular|capitalize !]
</span>
<span class="customer-type-card-cost"
ng-can-view-amounts="item.company"
ng-can-only-when="card.costs.totalCost.price"
ng-amount="card.costs.totalCost.price + (card.isTaxIncluded ? card.costs.totalCost.tax : 0)"
ng-amount-currency="item"
ng-amount-hide-cents
></span>
</legend>
<ul>
<li class="test-customer-custom-field-indicator"
ng-repeat="customFieldInstance in card.customerPrototype.customFieldInstances"
ng-with="customFieldPricing = pricesCtrl.totalPricing(customFieldInstance); customField = customFieldInstance.customField"
ng-if="bookCtrl.isVisibleWhenBooking(customFieldInstance, card)"
ng-book-field="customFieldInstance"
ng-book-field-card="card"
>
<div class="fields "
>
<div class="bookform-customfieldinstance-customfieldinstancepk-for-cardkey-value "
ng-django-field="bookForm [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-django-field-required="!!customFieldPricing.visibility.isRequired"
ng-class="{ 'is-display-only': customField.isDisplayOnly }"
>
<div class="cf-wrap cf-wrap--[! customField.type|css !]
[! CustomField.usesCheckbox(customField) ? 'cf-wrap--checkbox' : '' !]"
ng-class="{
'private-field': customFieldPricing.visibility.isHiddenWhenBooking || customField.isPrivate
}"
>
<span class="private-field-icon test-private-custom-field-indicator"
ng-tip="[[ customField.isPrivate ? T('Only shown to logged in users with permission to see private fields. (That\'s you!)') : T('Will not be shown when booking') ]]"
ng-tip-location=".private-field-lock"
>
<span class="private-field-lock"></span>
</span>
<div ng-if-once="customField.isDisplayOnly">
<div ng-if="customField.type === CustomField.HEADER_TYPE">
<h2>[! customField.title !]</h2>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if="customField.type === CustomField.NOTE_TYPE" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.SHORT_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field test-custom-field-[! customField.name|css !]">
<span class="label-text">[! customField.hint !]</span>
<input id="id_short" maxlength="2048" name="value" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" type="text" />
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.LONG_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="the-field test-custom-field-[! customField.name|css !]">
<textarea cols="40" id="id_long" name="value" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]" ng-placeholder="[! customField.hint !]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key" ng-required="!!customFieldPricing.visibility.isRequired" rows="10">
</textarea>
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.YES_NO_TYPE">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
<label ng-if="customField.type === CustomField.COUNT_TYPE && bookCtrl.newBooking.type !== CustomFieldInstanceCondition.RANGE_TYPE"
class="custom-field-[! customField.type|css !] cf-label table valign-middle table-dont-respond"
ng-init="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;] = ((bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]|isDefined) ? bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;] : customField.countMin)"
>
<div class="tr">
<div class="td count-field-select"
ng-hide="customField.countMin === customField.countMax && bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;] === customField.countMin"
>
<select
ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-options="option for option in customField.countMin|range:(customField.countMax + 1)"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key"
name="value"
></select>
</div>
<div class="td">
<div class="cf-title">
[! customField.title !]<span
ng-if="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)"
><span ng-if="customField.isPricingHidden && bookCtrl.newBookingOptions.totalCosts[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;] && PriceLine.showRate(customFieldPricing)"
>: <span ng-amount="bookCtrl.newBookingOptions.totalCosts[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;].price"></span>
</span>
<span ng-if="!customField.isPricingHidden">
<span class="fh-grey">&mdash;</span>
<span ng-price="customFieldPricing"
ng-price-company="customField.company"
ng-price-count="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
></span>
</span>
</span>
</div>
<div ng-inline="cf-description"></div>
</div>
</div>
</label>
<div ng-if-once="customField.type === CustomField.EXTENDED_OPTION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-prices-extended-options="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-prices-extended-options-field="customField"
ng-prices-extended-options-instance="customFieldInstance"
ng-prices-extended-options-currency="customField"
ng-current-option="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="pricesExtendedOptionsCtrl.options"
ng-current-option-target="currentOption"
>
<div ng-if="pricesExtendedOptionsCtrl.isImpossibleOption" ng-then="impossibleOption">
<div class="cf-title">
<i class="warning-icon"></i> [! customField.title !]
</div>
</div>
<div ng-if="pricesExtendedOptionsCtrl.isForcedOption" ng-then="forcedOption"
ng-init="bookForm.$setDirty()"
class="cf-title"
>
<span ng-if="!customField.isPricingHidden"
ng-with="currentOptionPricing = pricesCtrl.totalPricing(currentOption.extendedOption)"
>
<span ng-price="currentOptionPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && currentOption.extendedOption.isAlwaysPerCustomer">
per person
</span>
<span ng-if="PriceLine.showOffset(currentOptionPricing)"></span>
<span ng-if="currentOption.extendedOption.name && (
PriceLine.showOffset(currentOptionPricing) ||
PriceLine.showRate(currentOptionPricing)
)" class="fh-grey"
>&mdash;</span>
</span>
<span ng-bind="currentOption.extendedOption.name"></span>
</div>
<div ng-else="impossibleOption || forcedOption">
<label class="cf-label">
<div class="cf-title" ng-show="customField.title">
<span ng-bind="customField.title"></span>
</div>
<div class="the-field cf-extended-option-dropdown">
<select ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-options="option.pk as option.label for option in pricesExtendedOptionsCtrl.options"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key"
ng-required="!!customFieldPricing.visibility.isRequired"
name="value"
ng-dropdown
ng-placeholder="[! T('Choose an option') !]"
></select>
<i ng-link="f-req" ng-with="label = T('Choice is required')"></i>
</div>
</label>
</div>
<div ng-show="currentOption">
<div class="option-details md-inline" ng-if="currentOption.extendedOption.description"
ng-bind-html="currentOption.extendedOption.descriptionSafeHtml"
></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-current-option="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="customField.transportationOptions"
ng-current-option-target="currentTransportationOption"
>
<div class="cf-title">
<span ng-bind-once="customField.title"></span>
<span ng-if="!customField.isPricingHidden">
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</div>
<div ng-if="customField.transportationOptions.length === 1" ng-then="fullTransportation"
ng-init="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;] = customField.transportationOptions[0].pk"
></div>
<div ng-else="fullTransportation"
class="cf-transportation-dropdown"
>
<select
ng-init="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;] = bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;] || (customField.transportationOptions.length && customField.transportationOptions[0].pk)"
ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-options="transportationOption.pk as transportationOption.location for transportationOption in customField.transportationOptions"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key"
name="value"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-placeholder="[! T('Choose transportation') !]"
>
</select>
</div>
<div class="transportation-details">
<h3 class="pickup-time">
<span ng-if="currentTransportationOption.isSelfTransportation" ng-then="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
Please arrive by [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
Please arrive [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
<span ng-else="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
We'll pick you up at [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
We'll pick you up [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
</h3>
<div class="transportation-note md-inline" ng-if="currentTransportationOption.description"
ng-bind-html="currentTransportationOption.descriptionSafeHtml"></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"></div>
</div>
<div ng-if-once="customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-new-transportation="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-mx-form-valid-async
>
<div ng-if="newTransportationCtrl.status === 'loading' || newTransportationCtrl.status === 'error'">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
<div ng-if="newTransportationCtrl.status === 'success'"
ng-mx-form-valid-async-success
>
<div class="table cf-lodging-table">
<div class="tr">
<div class="td">
<label class="cf-label">
<div class="cf-title"
ng-class="{ 'no-title': !customField.title }"
>
[! customField.title || 'none' !]
</div>
<div ng-current-option="newTransportationCtrl.data.lodging"
ng-current-option-collection="newTransportationCtrl.lodgings"
ng-current-option-target="newTransportationCtrl.currentLodging"
></div>
<div ng-if="newTransportationCtrl.lodgings.length"
class="the-field cf-lodging-dropdown"
ng-class="{
'ng-invalid': bookForm['customFieldInstance' + customFieldInstance.pk + 'For' + card.key + '-lodging'].$invalid,
'ng-required': true
}"
>
<select ng-model="newTransportationCtrl.data.lodging"
ng-options="lodging.pk as lodging.effectiveName for lodging in newTransportationCtrl.lodgings"
ng-placeholder="[[ customField.hint || T('Please select where you are staying') ]]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key"
name="lodging"
></select>
<i ng-link="f-req"></i>
</div>
</label>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html="customField.descriptionSafeHtml"
></div>
</div>
<div class="td room-number-field"
ng-if="newTransportationCtrl.currentLodging && !newTransportationCtrl.currentLodging.isSelfLodging && !customField.isLodgingRoomNumberHidden"
>
<label class="cf-label">
<div class="cf-title">Room number</div>
<input id="id_lodging_room_number" maxlength="128" name="lodgingRoomNumber" ng-model="newTransportationCtrl.data.lodgingRoomNumber" ng-placeholder="If known" type="text" />
</label>
</div>
</div>
<div class="tr self-lodging-contact-field" ng-if="newTransportationCtrl.currentLodging && newTransportationCtrl.currentLodging.isSelfLodging">
<label class="cf-label">
<textarea cols="40" id="id_self_lodging_address" name="selfLodgingAddress" ng-model="newTransportationCtrl.data.selfLodgingAddress" ng-placeholder="Please let us know how we can contact you" rows="10">
</textarea>
</label>
</div>
</div>
<div class="new-transportation-details"
ng-if="newTransportationCtrl.isTransportationAvailable() || newTransportationCtrl.showSelfTransportation()"
>
<div ng-if="newTransportationCtrl.isTransportationAvailable()">
<div ng-if="newTransportationCtrl.showNeedsTransportation()"
ng-then="showNeedsTransportation"
>
<div class="new-transportation-options-header bold">
[[ newTransportationCtrl.canOverrideTransportation ?
T('Transportation option:') :
T('Transportation to our location is available. Please select an option:') ]]
</div>
<div class="field field-boolean-radio
ng-required
"
ng-class="{ 'ng-invalid': newTransportationCtrl.needsTransportation === undefined }"
ng-radio-flyer
>
<div class="the-field">
<i ng-link="f-req"></i>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="true"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('Needs transportation') : T('Please pick me up') ]]
<span ng-if="newTransportationCtrl.showTransportationPrice()">
&mdash;
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</label>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="false"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('No transportation') : T('I will provide my own transportation') ]]
</label>
</div>
</div>
</div>
<div ng-if="!showNeedsTransportation && newTransportationCtrl.showTransportationPrice()"
class="need-trans-price"
>
<b ng-hide="showNeedsTransportation">Transportation:</b>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</div>
<div ng-if="newTransportationCtrl.needsTransportation">
<div class="cf-rebook-new-transportation"
ng-if="
newTransportationCtrl.needsTransportation && newTransportationCtrl.rebookingTransportation &&
newTransportationCtrl.rebookTransportationOptions.length > 1
"
>
<h2>How should transportation be rebooked?</h2>
<ul class="cf-rebook-options" ng-radio-flyer>
<li ng-repeat="option in newTransportationCtrl.rebookTransportationOptions" class="cf-rebook-option">
<label>
<input type="radio" ng-model="newTransportationCtrl.rebookTransportationOption" ng-value="option">
[[ option.text ]]
<i ng-if="option.tip" ng-tip="[[ option.tip ]]" class="icon-hint"></i>
</label>
</li>
</ul>
</div>
<div class="new-trans-selects-wrap" ng-if="newTransportationCtrl.showRoutes() || newTransportationCtrl.showStops()">
<div class="new-trans-selects">
<div ng-if="newTransportationCtrl.showRoutes()">
<div ng-current-option="newTransportationCtrl.data.route"
ng-current-option-collection="newTransportationCtrl.routes"
ng-current-option-target="newTransportationCtrl.currentRoute"
></div>
<div class="the-field cf-route-dropdown"
ng-class="{
'ng-invalid': bookForm['customFieldInstance' + customFieldInstance.pk + 'For' + card.key + '-route'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.route"
ng-options="routeSelection.route.pk as newTransportationCtrl.routeSelectionText(routeSelection) for routeSelection in newTransportationCtrl.routeSelections"
ng-placeholder="[! T('Choose your route') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key"
name="route"
></select>
<i ng-link="f-req"></i>
</div>
</div>
<div ng-current-option="newTransportationCtrl.data.stop"
ng-current-option-collection="newTransportationCtrl.stops"
ng-current-option-target="newTransportationCtrl.currentStop"
></div>
<div ng-if="newTransportationCtrl.showStops()"
class="the-field cf-stop-dropdown"
ng-class="{
'ng-invalid': bookForm['customFieldInstance' + customFieldInstance.pk + 'For' + card.key + '-stop'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.stop"
ng-options="stop.pk as stop.unicode for stop in newTransportationCtrl.stops"
ng-placeholder="[! T('Choose a pickup location') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key"
name="stop"
></select>
<i ng-link="f-req"></i>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.needsTransportation && !newTransportationCtrl.currentStop && newTransportationCtrl.stops.length"
class="select-a-stop-note"
>
<span ng-if="newTransportationCtrl.canOverrideTransportation" ng-then="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
Select a pickup location above.
</span>
<span ng-else="required">
Select a pickup location above, or choose &quot;No transportation&quot; instead.
</span>
</span>
<span ng-else="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
Please select a pickup point from the list above.
</span>
<span ng-else="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
If you need transportation, please select a pickup point from the list above.
If you need help, please select &quot;I will provide my own transportation&quot; and call us after completing your booking.
</span>
</span>
</div>
<div ng-if="newTransportationCtrl.currentStop">
<div class="pickup-info">
<h3 class="new-pickup-time">
We'll pick you up at [[ newTransportationCtrl.currentStop.time|time ]] from [[ newTransportationCtrl.currentStop.pickup.name ]]
</h3>
<div class="pickup-notes-toggle" ng-if="newTransportationCtrl.currentStop.pickup.description">
Pickup details will be included in your confirmation email. (<a ng-toggle="showNotes">View details</a>)
</div>
<div ng-toggled="showNotes">
<div ng-if="newTransportationCtrl.currentStop.pickup.description" class="md-inline"
ng-bind-html="newTransportationCtrl.currentStop.pickup.descriptionSafeHtml"
></div>
</div>
</div>
<div ng-toggled="showNotes">
<a ng-href="[[ newTransportationCtrl.currentStop.pickup.mapUrl ]]"
ng-if="newTransportationCtrl.currentStop.pickup.mapUrl"
ng-outbound-link="_blank"
class="pickup-map-link"
>
<b class="map-link-headline">See pickup location on a map</b>
</a>
</div>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.showSelfTransportation()"
class="pickup-info"
>
<h3 class="new-pickup-time">
Please arrive by [[ availability.startAt|dateSubtract:availability.item.noTransportationMinutes:'minutes'|time ]]
</h3>
<div ng-if="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
>
<div class="pickup-notes-toggle">
Directions will be included in your confirmation email. (<a ng-toggle="showSelfNotes">View directions</a>)
</div>
<div class="md-inline"
ng-toggled="showSelfNotes"
ng-bind-html="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
></div>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key" ng-prevalidate-custom-field="bookCtrl.newBookingOptions" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div class="cf-admin-note md-inline"
ng-can-list="Code on customField.company"
>
<span class="icon-lock" ng-tip="[! T('Customers booking online don\'t see this note.') !]"></span>
Accepts codes from <a ng-href="[! customField.campaign.$url(urls.dashboard.settings.campaigns.campaign.index) !]"> [! customField.campaign.name !]</a>.
<span ng-show="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)">
Changes price by <span class="option-offset" ng-price="customFieldPricing" ng-price-company="customField.company"></span> when code is valid.
</span>
</div>
<div ng-with="prevalidity = bookCtrl.newBookingOptions.prevalidity[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_GENERATOR_TYPE">
<div ng-if="!!customFieldPricing.visibility.isRequired" ng-then="requiredField" ng-init="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;] = true;">
<div class="cf-title">
<span ng-if="!customField.isPricingHidden && (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing))">
<span class="option-offset"
ng-price="customFieldPricing"
ng-price-company="customField.company"
></span>
<span ng-if="!!customField.title">&mdash;</span>
</span>
[! customField.title !]
</div>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-else="requiredField">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CARD_GENERATOR_TYPE">
<div ng-can-view-amounts="customField.company" ng-then="canViewAmounts"
ng-card-generator="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-form="cardGeneratorSubform"
>
<div ng-if="cardGeneratorCtrl.isAlreadyGenerated" ng-then="alreadyGenerated">
<b ng-amount="cardGeneratorCtrl.selectedAmount"
ng-amount-company="customField.company"
></b> <span class="fh-grey">&mdash;</span>
This field has already generated a gift card.
</div>
<div ng-if="!alreadyGenerated && customFieldValue" ng-then="hasValue">
This field cannot be edited from here. Please edit the generated gift card instead.
</div>
<div ng-if="!alreadyGenerated && !hasValue">
<div ng-if="!customFieldPricing.visibility.isRequired"
class="table table-dont-respond valign-middle
cf-checkbox cf-checkbox--no-offset
test-custom-field-[! customField.name|css !]-select
"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input type="checkbox"
class="ng-pristine"
ng-model="cardGeneratorCtrl.isSelected"
ng-checkbox-madness="true"
>
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if-once="customField.title">[! customField.title !]</h2>
</div>
</div>
</label>
</div>
<div ng-if="cardGeneratorCtrl.isSelected">
<div class="cf-title" ng-if="customField.title && customFieldPricing.visibility.isRequired">[[ customField.title ]]</div>
<fieldset>
<legend class="card-generator-header">Choose Amount</legend>
<div class="card-generator-amounts-wrap">
<div class="table table-dont-respond full-width">
<ul ng-radio-flyer
class="card-generator-amounts tr"
ng-class="{ '-custom-amount': toggles.state(cardGeneratorCtrl.toggleValue) }"
>
<li class="td">
<label ng-toggle ng-toggle-value="cardGeneratorCtrl.toggleValue"
ng-toggle-interactive="false"
ng-toggle-default="cardGeneratorCtrl.defaultToOther"
ng-click="toggles.toggle(cardGeneratorCtrl.toggleValue, true)"
>
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]">
<div>Custom</div>
</label>
</li>
<li ng-repeat="suggestedAmount in cardGeneratorCtrl.suggestedAmounts"
class="td"
>
<label ng-click="cardGeneratorCtrl.selectAmount(suggestedAmount)">
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]" ng-checked="!toggles.state(cardGeneratorCtrl.toggleValue) && cardGeneratorCtrl.selectedAmount === suggestedAmount">
<div ng-amount="suggestedAmount" ng-amount-currency="customField" ng-amount-hide-cents></div>
</label>
</li>
</ul>
</div>
</div>
</fieldset>
<div ng-toggled ng-toggled-value="cardGeneratorCtrl.toggleValue"
class="card-generator-custom-amount"
>
<div class="cardgeneratorsubform-selectedamount
field-amount
"
ng-django-field="cardGeneratorSubform [&#39;selectedAmount&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Gift amount:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount" max="999999.99" min="0" name="amount" ng-amount-input="true" ng-amount-input-default="cardGeneratorCtrl.minimumAmount" ng-amount-input-min="cardGeneratorCtrl.minimumAmount" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cardGeneratorSubform [&#39;selectedAmount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="cardGeneratorCtrl.selectedAmount">
<div class="p-t-15 prose"
ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
<fieldset>
<legend class="card-generator-header">Recipient Info</legend>
<p class="p-b-10">
You&#039;ll confirm these details, add an optional note, and send your digital gift card after checkout.
</p>
<div class="m-b-5 test-custom-field-[! customField.name|css !]-name">
<div class="cardgeneratorsubform-name field-person-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;name&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;name&#39;]"
ng-django-field-required="!auth.permissions.can('skipRecipientName', customField)"
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="cardGeneratorCtrl [&#39;name&#39;]" ng-placeholder="Full name" ng-required="!auth.permissions.can('skipRecipientName', customField)" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="cardgeneratorsubform-email field-email-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;email&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;email&#39;]"
ng-django-field-required="false"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="cardGeneratorCtrl [&#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-required="false" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</fieldset>
</div>
</div>
</div>
</div>
<div ng-else="canViewAmounts">
Sorry, you are not authorized to create gift cards.
</div>
</div>
<div ng-if-once="customField.type === CustomField.MULTI_CAMPAIGN_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label ng-toggle ng-toggle-value="'addCampaignCode' + customField.pk"
ng-toggle-default="auth.currentUser.isAuthenticated || customFieldPricing.visibility.isRequired || customField.isCodeInputShownByDefault || !!bookCtrl.newBooking[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
class="cf-label hide-when-toggled"
ng-mx-click="click-add-promo-code"
>
<span class="fh-grey underline pointer">[! customField.codeToggleText || T('Add promo or discount code') !]</span>
</label>
<label class="cf-label"
ng-toggled ng-toggled-value="'addCampaignCode' + customField.pk"
>
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="bookCtrl.newBooking [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]" ng-prefix="'customFieldInstance' + customFieldInstance.pk + 'For' + card.key" ng-prevalidate-custom-field="bookCtrl.newBookingOptions" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div
ng-with="prevalidity = bookCtrl.newBookingOptions.prevalidity[&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.WAIVER_TYPE">
<div class="custom-field-[! customField.type|css !]"
ng-can-create="Waiver on customField.company"
ng-can-only-when="customField.connectedWaivers.length"
>
<div class="cf-admin-note md-inline">
<span class="icon-lock" ng-tip="[! T('Only people in your company see this note') !]"></span>
<b ng-show="!!customField.name">[! customField.name !]:</b>
Customers will be asked to sign:
<span ng-repeat="connectedWaiver in customField.connectedWaivers" >
<a ng-href="[! connectedWaiver.waiver.$url(urls.dashboard.settings.waivers.waiver.index) !]">[! connectedWaiver.waiver.name !]</a><span ng-if="!$last">,</span>
</span>
</div>
</div>
</div>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;customFieldInstance&#39; + customFieldInstance.pk + &#39;For&#39; + card.key + &#39;-&#39; + &#39;value&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="hide">
</div>
</li>
</ul>
<div class="customer-type-card-remove" ng-if="bookCardsCtrl.canRemoveCard(card)">
<button class="fh-red test-remove-customer-action" type="button"
ng-click="bookCardsCtrl.removeCard(card)"
ng-mx-click="remove-customer"
ng-mx-data-customer-type-rate="card.customerTypeRate"
ng-mx-data="{ number: card.number }"
ng-tip="[! T('Remove') !]"
ng-tip-classes="tip-large tip-indent"
ng-shortcut="'shift+delete'"
ng-shortcut-click
><span>Remove: [! card.customerType.singular !]</span></button>
</div>
</fieldset>
</div>
</li>
<li ng-if="!bookCtrl.bookCountsCtrl.isCompletelyFull && !auth.currentUser.isAuthenticated">
<div class="add-more-card">
Use the menus above to add more
</div>
</li>
</ul>
</div>
</script>
<script type="text/ng-template" id="book.counts">
<div ng-if="bookCtrl.pricesCtrl.status !== 'initializing'" ng-then="initialized">
<fieldset>
<legend class="visually-hidden">[! availability.item.isRetail ? T("Add to your order") : T("Add to your booking") !]</legend>
<ul class="customer-type-rate-counts block-loading--init"
ng-if="bookCtrl.pricesCtrl.totalPricing(bookCtrl.availability).visibility.isVisible && bookCountsCtrl.visibleCustomerTypeRates.length > 0"
ng-then="availabilityIsBookable"
ng-class="{
'block-loading': bookCtrl.pricesCtrl.status === 'loading',
'disable-selects': bookCountsCtrl.status === 'loading'
}"
>
<li ng-repeat="customerTypeRate in bookCountsCtrl.visibleCustomerTypeRates">
<div class="fields "
>
<div class="bookform-customertyperate-customertyperatepk-count
customer-type-count-select
test-select-count-[! customerTypeRate.customerPrototype.customerType.singular|css !]
[! addClassIf(bookCountsCtrl.isAlreadyFull(customerTypeRate), 'is-already-full') !]
[! addClassIf(bookCountsCtrl.isCallToBook(customerTypeRate), 'is-call-to-book') !]
"
ng-django-field="bookForm [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;]"
ng-book-select-count="bookCtrl.newBooking [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;]"
ng-with="totalPricing = pricesCtrl.totalPricing(customerTypeRate)"
>
<div class="customer-type-count-select-inner">
<label for="ctr-select-[! customerTypeRate.pk !]" class="flex-row flex--nowrap flex--items-stretch">
<div ng-if="bookCountsCtrl.isCallToBook(customerTypeRate)" ng-then="callToBook"
class="customer-select flex-row flex--items-center"
>
<div class="flex-item">
<span class="icon-phone"></span> Call to book
</div>
</div>
<div ng-else="callToBook"
class="customer-select flex-row flex--items-center flex--justify-center"
title="[[ (auth.currentUser.isAuthenticated && $index < 9) ? T('Shortcut: shift+') + ($index + 1) : '' ]]"
>
<div class="customer-select-inner">
<div class="customer-select-status respond-handhelds-show">
[[ bookCtrl.newBooking [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;] ]]
</div>
<select class="test-select-count-action"
name="count"
id="ctr-select-[! customerTypeRate.pk !]"
ng-model="bookCtrl.newBooking [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;]"
ng-options="option group by selectCountCtrl.optionGroup(option) for option in selectCountCtrl.options track by option"
ng-prefix="'customerTypeRate' + customerTypeRate.pk"
ng-disabled="selectCountCtrl.isDisabled()"
ng-watch="selectCountCtrl.maxCutoff"
ng-mx-change="add-customer-type"
ng-mx-change-when="$value > $oldValue"
ng-mx-data-customer-type-rate="customerTypeRate"
ng-shortcut="$index < 9 ? ('shift+' + ($index + 1)) : ''"
ng-shortcut-action="$index < 9 && bookCountsCtrl.incrementCount(customerTypeRate)"
></select>
</div>
</div>
<div class="customer-type-info">
<div class="customer-type-info-header">
<span class="customer-type-info-header--name">
[! customerTypeRate.customerPrototype.customerType.plural !]
</span>
<span class="customer-type-info-header--rate"
ng-can-view-amounts="bookCtrl.item.company"
ng-can-only-when="PriceLine.showOffset(totalPricing)"
>
([[ PriceLine.effectiveOffset(totalPricing)|amount:customerTypeRate:true ]])
</span>
</div>
<div class="customer-select-note"
ng-if-once="customerTypeRate.customerPrototype.note || customerTypeRate.customerPrototype.customerType.note"
>
[! customerTypeRate.customerPrototype.note || customerTypeRate.customerPrototype.customerType.note !]
</div>
<div class="customer-select-note"
ng-can="viewCapacities on availability"
>
<span ng-if="customerTypeRate.capacity !== null" ng-then="hasCapacity">
[[ bookCountsCtrl.remainingCustomerTypeRateCapacities[customerTypeRate.uri] ]] of [[ customerTypeRate.capacity ]] left
</span>
<span ng-else="hasCapacity">
[[ customerTypeRate.customerCount ]] on previous bookings
</span>
<span class="badge badge-warning"
ng-if="bookCtrl.bookCountsCtrl.liveCapacity.overbookedCustomerTypeRatesByUri[customerTypeRate.uri]"
>
Overbooking
</span>
<span class="badge badge-warning"
ng-if="selectCountCtrl.isBelowMin()"
>
Under minimum
</span>
</div>
<div class="customer-select-note"
ng-if="bookCountsCtrl.isCallToBook(customerTypeRate)"
>
Please call [! company.phone|phone !] to book
</div>
<div class="exclusively-disabled">
[! bookCtrl.currentUserCanCreateAsCompany ? T('Not available with current exclusivity settings') : T('Not available with current selections') !]
</div>
<div class="party-size-disabled">
[! bookCtrl.currentUserCanCreateAsCompany ? T('Not available with current party-size settings') : T('Not available with current selections') !]
</div>
<div class="too-few">
Please select more
</div>
<div class="too-many">
Please select fewer
</div>
</div>
<div class="customer-type-rate flex-row flex--items-center flex--justify-center test-customer-type-rate-cost-[! customerTypeRate.customerPrototype.customerType.singular|css !]"
ng-can-view-amounts="bookCtrl.item.company"
ng-can-only-when="PriceLine.showOffset(totalPricing)"
>
<span class="price-wrap">
[[ PriceLine.effectiveOffset(totalPricing)|amount:customerTypeRate:true ]]
</span>
</div>
</label>
</div>
</div>
</div>
<div class="hide">
<div class="bookform-customertyperate-customertyperatepk-count "
ng-django-field="bookForm [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;]"
>
<label >
<span class="label-text">
Count
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_count" name="count" ng-int-input="" ng-int-input-min="0" ng-model="bookCtrl.newBooking [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;]" ng-pattern="/^\d+$/" ng-prefix="'customerTypeRate' + customerTypeRate.pk" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;].$error['pattern']">Invalid value</li>
<li ng-if="bookForm [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;].$error['invalid']">Enter a whole number.</li>
<li ng-if="bookForm [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;].$error['min']">Ensure this value is greater than or equal to 0.</li>
<li ng-repeat="error in bookForm [&#39;customerTypeRate&#39; + customerTypeRate.pk + &#39;-&#39; + &#39;count&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
</ul>
</fieldset>
<div ng-else="availabilityIsBookable" class="flash warn">
<span ng-if="bookCtrl.currentUserCanCreateAsCompany"
ng-then="showAuthError"
>
[[ !bookCountsCtrl.visibleCustomerTypeRates.length ?
T('This availability cannot be booked because all customer types are set to hidden for this price sheet.') :
T('This availability cannot be booked because its item is set to hidden for this price sheet.')
]]
</span>
<span ng-else="showAuthError">
Sorry, there are no available options for this time.
</span>
</div>
</div>
<div ng-else="initialized" class="text-center fh-grey">
Loading booking options...
</div>
</script>
<script type="text/ng-template" id="book.noisy">
<div ng-if="bookNoisyInvalidFieldsCtrl.isShowingAllowed && noisyInvalidFieldsCtrl.isShowing"
class="book-form-missing-fields"
aria-live="assertive"
>
<span class="warning-icon"></span> You haven&#039;t finished filling in all fields yet.
<button class="button-reset fh-blue underline" type="button"
ng-scroll-to=".field.ng-invalid:not(.is-display-only),.field.ng-pseudo-invalid"
ng-scroll-smooth
ng-scroll-on-click
ng-scroll-force
>Scroll there.</button>
</div>
</script>
<script type="text/ng-template" id="book.notification">
<div ng-can-create="Notification on company">
<div class="bookform-sendnotification field-cb-light "
ng-django-field="bookForm [&#39;sendNotification&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="bookCtrl.newBooking [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
[[ !!rebook.currentBooking.contact.email ? T('Send rebooked email') : T('Send confirmation email') ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="bookCtrl.newBooking.sendNotification">
<div class="fields "
>
<a class="form-link-subtle hide-when-toggled test-add-note-action"
ng-toggle="fullEmailForm"
ng-toggle-default="bookCtrl.newBooking['notification-note']"
>Add custom message</a>
<div class="email-form" ng-toggled="fullEmailForm">
<div class="bookform-notification-note field-textarea
"
ng-django-field="bookForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".bookform-notification-note" ng-model="bookCtrl.newBooking [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in bookForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="book.policies">
<p class="booking-fh-tos-note"
ng-if="bookPoliciesCtrl.company.features.isTosOverrideEnabled"
ng-then="customPolicies"
>
<span ng-if="auth.currentUser.isAuthenticated" ng-then="customerAgrees">
Customer agrees to these <a tabindex="0" role="button" ng-click="bookPoliciesCtrl.showCompanyPolicies()">policies</a>.
</span>
<span ng-else="customerAgrees">
By booking you also agree to our <a tabindex="0" role="button" ng-click="bookPoliciesCtrl.showCompanyPolicies()">policies</a>.
</span>
</p>
<p class="booking-fh-tos-note"
ng-else="customPolicies"
>
<span ng-if="bookPoliciesCtrl.company.tos">
<span ng-if="auth.currentUser.isAuthenticated" ng-then="customerAgrees">
Customer agrees to your <a tabindex="0" role="button" ng-click="bookPoliciesCtrl.showCompanyPolicies()">policies</a>, and FareHarbor's <a tabindex="0" role="button" ng-click="bookPoliciesCtrl.showFareHarborPolicies()">terms of service</a>.
</span>
<span ng-else="customerAgrees">
By booking you also agree to our <a tabindex="0" role="button" ng-click="bookPoliciesCtrl.showCompanyPolicies()">policies</a>, and FareHarbor's <a tabindex="0" role="button" ng-click="bookPoliciesCtrl.showFareHarborPolicies()">terms of service</a>.
</span>
</span>
<span ng-else="bookPoliciesCtrl.company.tos">
<span ng-if="auth.currentUser.isAuthenticated" ng-then="customerAgrees">
Customer agrees to FareHarbor's <a tabindex="0" role="button" ng-click="bookPoliciesCtrl.showFareHarborPolicies()">terms of service</a>.
</span>
<span ng-else="customerAgrees">
By booking you also agree to FareHarbor's <a tabindex="0" role="button" ng-click="bookPoliciesCtrl.showFareHarborPolicies()">terms of service</a>.
</span>
</span>
</p>
<div class="theater"
ng-body-class="'hide-body-overflow'"
ng-if="bookPoliciesCtrl.showingCompanyPolicies || bookPoliciesCtrl.showingFareHarborPolicies"
ng-click="bookPoliciesCtrl.hidePolicies()"
ng-click-strict
ng-shortcut="'esc'"
ng-shortcut-click
>
<div class="book-form-policies">
<button class="button-reset policies-theater-close" type="button" ng-click="bookPoliciesCtrl.hidePolicies()">Close</button>
<div class="book-form-policies-copy prose"
ng-overthrow
>
<div ng-show="bookPoliciesCtrl.showingCompanyPolicies">
<h1 ng-if="!bookPoliciesCtrl.company.features.isTosOverrideEnabled">
[[ bookPoliciesCtrl.company.name ]] Policies and Terms
</h1>
<div
ng-if="bookPoliciesCtrl.company.tos"
ng-bind-html="bookPoliciesCtrl.company.tosSafeHtml"
></div>
</div>
<div ng-show="bookPoliciesCtrl.showingFareHarborPolicies">
<h1>FareHarbor Policies and Terms</h1>
<div ng-if="!!bookPoliciesCtrl.fareHarborTosSafeHtml" ng-then="showingPolicies"
ng-bind-html="bookPoliciesCtrl.fareHarborTosSafeHtml"
></div>
<div ng-else="showingPolicies">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
</div>
</div>
</div>
</div>
</script>
<script id="ng-taxes-and-fees" type="text/ng-template">
<tr class="subtotal-row"
ng-if="!company.features.isExtendedBreakdownEnabled && taxesAndFeesCtrl.totals.bookingFee"
ng-then="taxAndFeesTogether"
>
<td class="subtotal-label">
<span ng-if="taxesAndFeesCtrl.hasTax()">[! Company.taxDisplayName(company) !] &amp;</span>
Fees
</td>
<td class="subtotal-value test-taxes-and-fees-indicator notranslate">
[[ ((taxesAndFeesCtrl.hasTax() ? taxesAndFeesCtrl.totals.tax : 0) + taxesAndFeesCtrl.totals.bookingFee)|amount:taxesAndFeesCtrl.source ]]
</td>
</tr>
<tr class="subtotal-row"
ng-if="!taxAndFeesTogether && !taxesAndFeesCtrl.taxTypes && taxesAndFeesCtrl.hasTax()"
>
<td class="subtotal-label">[! Company.taxDisplayName(company) !]</td>
<td class="subtotal-value test-taxes-and-fees-indicator notranslate">[[ taxesAndFeesCtrl.totals.tax|amount:taxesAndFeesCtrl.source ]]</td>
</tr>
<tr class="subtotal-row"
ng-repeat="taxType in taxesAndFeesCtrl.taxTypes"
ng-if="!taxAndFeesTogether && taxesAndFeesCtrl.showTaxType(taxType)"
>
<td class="subtotal-label">[! taxType|name !]</td>
<td class="subtotal-value test-taxes-and-fees-indicator notranslate">[[ taxesAndFeesCtrl.totals.taxByType[taxType.pk]|amount:taxesAndFeesCtrl.source ]]</td>
</tr>
<tr class="subtotal-row"
ng-if="company.features.isExtendedBreakdownEnabled && taxesAndFeesCtrl.totals.bookingFee"
>
<td class="subtotal-label">Fees</td>
<td class="subtotal-value notranslate">[[ taxesAndFeesCtrl.totals.bookingFee|amount:taxesAndFeesCtrl.source ]]</td>
</tr>
</script>
<script type="text/ng-template" id="book.totals">
<div class="book-form-totals [[ addClassIf(bookAnonColumns, 'book-anon') ]]">
<div class="table valign-middle full-width">
<div class="tr">
<div class="td p-l-5">
<table class="book-form-totals-table block-loading--init"
ng-class="{ 'block-loading': bookCtrl.pricesCtrl.status === 'loading' }"
ng-can-view-amounts="bookCtrl.item.company"
ng-hide="
!bookTotalsCtrl.totals.total &&
!bookCtrl.currentUserCanCreateAsCompany &&
!bookCtrl.redeemStoredValueCardsCtrl.isRedeeming()
"
>
<tbody>
<tr class="line-items-row" ng-if="bookTotalsCtrl.totals.lineItems">
<td class="subtotal-label">Line Items</td>
<td class="subtotal-label notranslate">[[ bookTotalsCtrl.totals.lineItems|amount:bookCtrl.item ]]</td>
</tr>
<tr class="subtotal-row">
<td class="subtotal-label">Subtotal<span ng-if="bookCtrl.item.company.features.isCombinedTaxEnabled">
(Includes [! Company.taxDisplayName(bookCtrl.item.company) !])</span></td>
<td class="subtotal-value test-subtotal-indicator notranslate">
[[ (bookCtrl.item.company.features.isCombinedTaxEnabled ? bookTotalsCtrl.totals.price + bookTotalsCtrl.totals.tax : bookTotalsCtrl.totals.price)|amount:bookCtrl.item ]]
</td>
</tr>
</tbody>
<tbody ng-taxes-and-fees
ng-taxes-and-fees-source="bookCtrl.item"
ng-taxes-and-fees-totals="bookTotalsCtrl.totals"
ng-taxes-and-fees-is-user-authenticated="bookCtrl.currentUserCanCreateAsCompany || bookCtrl.currentUserCanCreateAsAffiliate"
></tbody>
<tbody>
<tr class="subtotal-row is-highlighted" ng-repeat="card in bookCtrl.redeemStoredValueCardsCtrl.storedValueCards">
<td class="subtotal-label">[! card.storedValueType.name !] ([! card.last5 !]) </td>
<td class="subtotal-value">
<span class="notranslate">-[[ bookCtrl.redeemStoredValueCardsCtrl.applied(card)|amount:bookCtrl.item ]]</span>
<a class="gift-card-close" ng-click="bookCtrl.redeemStoredValueCardsCtrl.unapply(card)" ng-tip="[! T('Remove gift card') !]"></a>
</td>
</tr>
</tbody>
<tbody>
<tr aria-live="polite">
<td class="subtotal-label final-total-label">Total</td>
<td class="subtotal-value">
<a ng-can="updateExplicitTotal on Booking with bookCtrl.availability.company" ng-then="canExplicitTotal"
class="set-total-toggle hide-when-toggled"
ng-tip="[! T('Change booking total') !]"
ng-tip-classes="tip-indent"
ng-tip-location=".set-total-toggle-icon"
ng-toggle="changeExplicitGross"
ng-toggle-default="rebook.currentBooking && rebook.currentBooking.explicitGross !== null"
ng-shortcut="'shift+t'"
ng-shortcut-click
title="[! T('Shortcut: shift+t') !]"
>
<span class="final-total test-total-indicator">
[[ bookTotalsCtrl.totals.total|amount:bookCtrl.item ]]
</span>
<span class="set-total-toggle-icon"></span>
</a>
<span class="final-total test-total-indicator notranslate"
ng-if="toggles.state('changeExplicitGross') || !canExplicitTotal"
>
[[ bookTotalsCtrl.totals.total|amount:bookCtrl.item ]]
</span>
</td>
</tr>
</tbody>
<tbody ng-if="canExplicitTotal"
class="set-total-row"
>
<tr ng-toggled="changeExplicitGross">
<td class="subtotal-label final-total-label">
Set booking total to:
</td>
<td class="subtotal-value set-total-input">
<div class="bookform-explicitgross
field-amount
"
ng-django-field="bookForm [&#39;explicitGross&#39;]" ng-django-field-model="bookCtrl.newBooking [&#39;explicitGross&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_explicit_gross" max="999999.99" min="0" name="explicitGross" ng-amount-input="true" ng-amount-input-positive="true" ng-autofocus="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="bookCtrl.newBooking [&#39;explicitGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="bookForm [&#39;explicitGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="bookForm [&#39;explicitGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in bookForm [&#39;explicitGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<a class="button-close"
ng-click="bookTotalsCtrl.unexpect()"
ng-tip="[! T('Don\'t change total') !]"
ng-tip-classes="tip-indent"
></a>
<div class="set-total-difference">
<span ng-amount="bookTotalsCtrl.totals.finalTotal - bookTotalsCtrl.totals.total" ng-amount-company="bookCtrl.availability.company"></span> difference
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="book.errors">
<div class="chunky-error light-orange" ng-if="rebook.nonRebookableCustomers.length">
<div class="chunky-error-inner">
[[
interpolate(nT('%(count)s customer could not be automatically filled in', '%(count)s customers could not be automatically filled in', rebook.nonRebookableCustomers.length ), { count: rebook.nonRebookableCustomers.length })
]]
</div>
</div>
<div class="chunky-error orange" ng-if="Availability.isInPast(availability)">
<div class="chunky-error-inner">In the past</div>
</div>
<div class="chunky-error red" ng-if="bookCtrl.bookCountsCtrl.customerCount > 0 && bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity <= -1">
<div class="chunky-error-inner">
Overbooking availability by [[ -(bookCtrl.bookCountsCtrl.remainingAvailabilityCapacity) ]]
</div>
</div>
<div class="chunky-error light-orange" ng-if="bookCtrl.bookCountsCtrl.liveCapacity.pendingCustomerCount > 0">
<div class="chunky-error-inner">
[[
interpolate(nT('%(booking_count)s pending booking might affect capacity and resource use once completed',
'%(booking_count)s pending bookings might affect capacity and resource use once completed',
bookCtrl.bookCountsCtrl.liveCapacity.pendingBookingCount),
{ booking_count: bookCtrl.bookCountsCtrl.liveCapacity.pendingBookingCount })
]]
([[
interpolate(nT('%(customer_count)s customer', '%(customer_count)s customers', bookCtrl.bookCountsCtrl.liveCapacity.pendingCustomerCount),
{ customer_count: bookCtrl.bookCountsCtrl.liveCapacity.pendingCustomerCount })
]] pending)
</div>
</div>
<div ng-if="bookCtrl.bookCountsCtrl.liveCapacity">
<div class="chunky-error orange"
ng-repeat="customerTypeRate in bookCtrl.bookCountsCtrl.liveCapacity.overbookedCustomerTypeRates"
>
<div class="chunky-error-inner">
Overbooking [! customerTypeRate.customerPrototype.customerType.plural !]
</div>
</div>
<div ng-if="bookCtrl.availability.requirementGroup"
ng-book-resource-overview
></div>
</div>
</script>
<script type="text/ng-template" id="book.redeem">
<button class="button-reset apply-gift-card hide-when-toggled"
type="button"
ng-toggle="applyStoredValueCard"
ng-mx-click="click-apply-gift-card"
>
<i class="card-icon-small-black"></i>Apply a gift card
</button>
<form name="applyStoredValueCardForm" ng-toggled="applyStoredValueCard"
ng-submit="redeemStoredValueCardsCtrl.apply(applyStoredValueCardForm)"
class="apply-gift-card-form"
>
<div class="table full-width valign-bottom">
<div class="tr">
<div class="td">
<fieldset ng-disabled="applyStoredValueCardForm.$submitting">
<div class="field gift-card-field">
<label>
<span class="label-text">
Gift card number:
</span>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="redeemStoredValueCardsCtrl.currentStoredValueCardNumber"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</fieldset>
</div>
<div class="td gift-card-buttons">
<div class="flex-row--desktop-only flex--nowrap">
<button class="btn-tiny btn-green" type="submit"
ng-disabled="
applyStoredValueCardForm.$submitting ||
redeemStoredValueCardsCtrl.isInvalid()
"
>
Apply
</button>
<button class="btn-tiny btn-grey btn-right"
ng-disabled="applyStoredValueCardForm.$submitting"
ng-click="redeemStoredValueCardsCtrl.cancel()"
>
Cancel
</button>
</div>
</div>
</div>
</div>
<div ng-if="redeemStoredValueCardsCtrl.error" class="form-error">
[[ redeemStoredValueCardsCtrl.error ]]
</div>
</form>
</script>
<script type="text/ng-template" id="book.liveCapacity">
<div ng-if="liveCapacityCtrl.status === 'loading'" class="live-capacity-loading">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-if="liveCapacityCtrl.status === 'success'" class="table table-dont-respond valign-middle capacity-table
[! liveCapacityCtrl.isLarge ? 'large shade-second-col' : 'small' !]
"
>
<div class="thead capacity-table-header nowrap"
ng-if-once="liveCapacityCtrl.isLarge"
>
<div class="tr">
<div class="td fh-blue">Capacities</div>
<div class="td">
<div class="fh-grey">Booked</div>
<div class="header-capacity [[ availability|capacityClass ]]">
<i class="[! company|capacityIndicatorClass:'filled' !]"></i> [[ availability.customerCount ]]
</div>
</div>
<div class="td" ng-tip="[! T('The numbers below are the most you could book of just that type') !]"
ng-tip-location=".icon-hint"
>
<div class="fh-grey">Available <i class="icon-hint"></i></div>
<div ng-if-once="availability.bookableCapacity !== null" class="header-capacity [[ availability|capacityClass ]]">
<i class="[! company|capacityIndicatorClass !]" ng-if-once="availability.customerCount === 0 || availability.nonResourceBookableCapacity >= 0"></i>
[! availability.customerCount > 0 && availability.nonResourceBookableCapacity < 0 ?
interpolate(T('Overbooked by %(count)s'), { count: -availability.nonResourceBookableCapacity }) :
availability.bookableCapacity
!]
</div>
</div>
</div>
</div>
<div class="tbody capacity-overview">
<div ng-repeat="customerTypeRate in liveCapacityCtrl.liveCapacity.customerTypeRates"
class="tr [! customerTypeRate.liveBookableCapacity === null || customerTypeRate.liveBookableCapacity > 0 ? 'bookable' : 'not-bookable' !]"
>
<div class="td" title="[! liveCapacityCtrl.isLarge ? '' : customerTypeRate.customerPrototype.customerType.plural !]">
<div class="capacity-table-ct-name">
[! customerTypeRate.customerPrototype.customerType.plural !]
</div>
</div>
<div class="td nowrap
[! customerTypeRate.capacity !== null ? (customerTypeRate|capacityClass) : (customerTypeRate|hasCustomersClass) !]
"
title="[! T('Booked') !]"
>
<i class="[! company|capacityIndicatorClass:'filled' !]"></i>
[[ customerTypeRate.customerCount ]]<span ng-if-once="customerTypeRate.capacity !== null">/[[ customerTypeRate.capacity ]]</span>
</div>
<div class="td nowrap [! customerTypeRate.liveBookableCapacity ? 'ava-is-booked' : 'ava-is-empty' !]" title="[! T('Available to book') !]">
<span ng-if="customerTypeRate.liveBookableCapacity !== null">
<i class="[! company|capacityIndicatorClass !]"></i>
[[ customerTypeRate.liveBookableCapacity ]]
</span>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="resourceUseTable">
<table class="spreadsheet">
<thead class="ss-header">
<tr class="ss-header-shade">
<td class="nowrap"><span ng-if="toResourceUses">From </span>#</td>
<td class="nowrap" ng-if="toResourceUses">To #</td>
<td>Resource</td>
<td class="nowrap" ng-if="isShowOverused()">
Overused?
<span class="icon-hint"
ng-tip="[! T('Will this resource be overused after submitting?') !]"
></span>
</td>
</tr>
</thead>
<tbody>
<tr class="[[ resourceUseSummary.isOverused|addClassIf:'warning-color' ]]"
ng-repeat="resourceUseSummary in resourceUseSummaries"
>
<td>[[ resourceUseSummary.originalUseCount ]]</td>
<td ng-if="toResourceUses">[[ resourceUseSummary.totalUseCount ]]</td>
<td class="break-words">[! resourceUseSummary.resourceName !]</td>
<td ng-if="isShowOverused()">[[ resourceUseSummary.isOverused ? T('Overused') : T('Not overused') ]]</td>
</tr>
</tbody>
</table>
</script>
<script type="text/ng-template" id="book.resourceOverview">
<div class="chunky-error [[ addClassIf(resourceOverviewCtrl.isOverusing(), 'red') ]]"
ng-if="!(bookCtrl.bookCountsCtrl.liveCapacity.resourceUses|isEmptyFilter)"
>
<div class="chunky-error-inner toggleable" ng-toggle ng-toggle-value="'resources' + resourceOverviewCtrl.$id">
[[
resourceOverviewCtrl.isOverusing() ?
interpolate(T('Resources (%(count)s) - Overusing'), { count: resourceOverviewCtrl.useCount() }) :
interpolate(T('Resources (%(count)s)'), { count: resourceOverviewCtrl.useCount() })
]]
</div>
<div class="chunky-error-content" ng-toggled ng-toggled-value="'resources' + resourceOverviewCtrl.$id">
<p>This booking will use these resources:</p>
<div ng-resource-use-table
resource-uses="bookCtrl.bookCountsCtrl.liveCapacity.resourceUses"
unsatisfiable-resources="bookCtrl.bookCountsCtrl.liveCapacity.unsatisfiableResources"
></div>
<div ng-selected-resources
availability="availability"
requirements="resourceOverviewCtrl.requirements"
reset="resourceOverviewCtrl.reset()"
selections="resourceOverviewCtrl.resourceUseData"
>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="selectedResources">
<div ng-if="requirements|isEmptyFilter" ng-then="hasRequirements">
<span class="hint hint-alert">No other resource options available for this booking.</span>
</div>
<div class="flyout-wrap">
<div ng-else="hasRequirements">
<a class="fh-blue underline"
ng-toggle
ng-toggle-value="'selected' + resourceOverviewCtrl.$id"
ng-toggle-default="resourceOverviewCtrl.isPreselecting"
ng-can="overuseResources on availability"
>Change resources</a>
</div>
</div>
<div ng-toggled ng-toggled-value="'selected' + resourceOverviewCtrl.$id">
<div ng-repeat="requirement in requirements">
<div class="flyout-checklist-header">
<span ng-if-once="selectedResourcesCtrl.isUsingDefaults(requirement)">
For: <b>[[ Requirement.forCustomerPrototypes(requirement) ]]</b>
(using defaults)
</span>
<span ng-else-once="selectedResourcesCtrl.isUsingDefaults(requirement)">
For: <b>[[ Requirement.forCustomerPrototypes(requirement) ]]</b>
</span>
</div>
<ul class="flyout-checklist">
<li ng-repeat="resourceRequirement in requirement.resourceRequirements">
<label>
<input type="radio" ng-if-once="!requirement.isSplittable"
name="[! requirement.pk + resourceOverviewCtrl.$id!]"
ng-model="selections.selectedNonSplittableRequirementsResources[requirement.pk]" ng-value="resourceRequirement.pk"
>
<input type="checkbox" ng-if-once="requirement.isSplittable"
ng-model="selections.selectedSplittableRequirementsResources[resourceRequirement.pk]"
>
[[ resourceRequirement.resource|name ]]
</label>
</li>
</ul>
</div>
<div class="flyout-wrap">
<a class="fh-grey underline" ng-click="reset()">Reset</a>
</div>
</div>
</script>
<script type="text/ng-template" id="book.customFieldValueNotes">
<div ng-if="prevalidity && prevalidity.isCodeFound && auth.currentUser.isAuthenticated"
class="cf-admin-note-list md-inline"
>
<div class="cf-admin-note-list-item is-warning"
ng-if="prevalidity.isValid && (prevalidity.isOverusingCode || prevalidity.isInvalidDate || prevalidity.isInvalidAvailability)"
>
<i class="warning-icon"></i> Overriding code use rules
</div>
<div ng-if="prevalidity.isInvalidDate" class="cf-admin-note-list-item">
<span class="badge badge-error">Cannot be used today</span>
<span>Does not meet specified date requirements</span>
</div>
<div ng-if="prevalidity.isInvalidAvailability" class="cf-admin-note-list-item">
<span class="badge badge-error">Not valid for this availability</span>
<span>Does not meet specified date requirements</span>
</div>
<div class="cf-admin-note-list-item">
<span class="badge badge-error" ng-if="prevalidity.isOverusingCode">Overuse</span>
<span ng-if="prevalidity.codeMaximumUses === null" ng-then="noMaxUse">
<span ng-if="booking" ng-then="hasBookings">
[[
interpolate(nT('Code used %(count)s time', 'Code used %(count)s times', prevalidity.codeUseCount),
{ count: prevalidity.codeUseCount })
]]
</span>
<span ng-else="hasBookings">
[[
interpolate(nT('Code used %(count)s time on previous booking', 'Code used %(count)s times on previous bookings', prevalidity.codeUseCount),
{ count: prevalidity.codeUseCount })
]]
</span>
</span>
<span ng-else="noMaxUse">
<span ng-if="booking" ng-then="hasBookings">
Code used <b>[[ prevalidity.codeUseCount ]]</b> of <b>[[ prevalidity.codeMaximumUses ]]</b> times
<span ng-if="prevalidity.pendingCodeUseCount">
[[
interpolate(nT('and %(pending_count)s time on pending bookings', 'and %(pending_count)s times on pending bookings', prevalidity.pendingCodeUseCount),
{ pending_count: prevalidity.pendingCodeUseCount })
]]
</span>
</span>
<span ng-else="hasBookings">
Code used <b>[[ prevalidity.codeUseCount ]]</b> of <b>[[ prevalidity.codeMaximumUses ]]</b> times on previous bookings
<span ng-if="prevalidity.pendingCodeUseCount">
[[
interpolate(nT('and %(pending_count)s time on pending bookings', 'and %(pending_count)s times on pending bookings', prevalidity.pendingCodeUseCount),
{ pending_count: prevalidity.pendingCodeUseCount })
]]
</span>
</span>
</span>
</div>
</div>
<div ng-if="prevalidity && prevalidity.isCodeFound && prevalidity.isOverusingCode && !auth.currentUser.isAuthenticated"
class="cf-code-error"
>
This code has been used the maximum number of times
</div>
<div class="cf-admin-note md-inline"
ng-can-list="Code on customField.company"
ng-can-only-when="!(prevalidity || {}).isCodeFound && !!customField.connectedCampaigns.length"
>
<span class="icon-lock" ng-tip="[! T('Customers booking online don\'t see this note') !]"></span>
Accepts codes from <a ng-toggle ng-toggle-value="'showConnectedCampaigns-' + [[ customField.pk ]]" ng-toggle-default="customField.connectedCampaigns.length < 3" class="hide-when-toggled">[! customField.connectedCampaigns.length !] campaigns</a>
<span ng-toggled ng-toggled-value="'showConnectedCampaigns-' + [[ customField.pk ]]" >
<span ng-repeat="connectedCampaign in customField.connectedCampaigns" >
<a ng-href="[! connectedCampaign.campaign.$url(urls.dashboard.settings.campaigns.campaign.index) !]">[! connectedCampaign.campaign.name !]</a><span ng-if="!$last">,</span>
</span>
</span>
</div>
</script>
<script type="text/ng-template" id="book.itemRatings">
<div ng-data="itemRatingsCtrl.ratings.$promise" ng-data-small>
<div ng-if-once="itemRatingsCtrl.ratings.tripadvisor"
ng-init="rating = itemRatingsCtrl.ratings.tripadvisor"
class="tripadvisor-rating"
itemscope
itemtype="http://schema.org/AggregateRating"
>
<div class="table valign-middle table-dont-respond">
<div class="tr">
<div class="td"
ng-if-once="rating.rating"
>
<img ng-src="[! rating.ratingImageUrl !]"
alt="TripAdvisor Traveler Rating: [! rating.rating !]/5"
itemprop="image"
/>
<meta itemprop="ratingValue" content="[! rating.rating !]">
<meta itemprop="worstRating" content="1">
<meta itemprop="bestRating" content="5">
</div>
<div class="td tripadvisor-reviewer-count"
ng-if-once="rating.numReviews"
>
<span itemprop="reviewCount">[! rating.numReviews !]</span> Reviewers
</div>
</div>
</div>
<div class="tripadvisor-ranking"
ng-if-once="rating.ranking"
itemprop="disambiguatingDescription"
>
[! rating.rankingString !]
</div>
<div class="tripadvisor-disclaimer"
itemscope
itemtype="https://schema.org/Corporation"
>
<div ng-if-once="rating.ranking || rating.rating"
itemprop="name author brand"
>
TripAdvisor Traveler Rating
</div>
<div ng-if-once="rating.ranking && rating.cachedAt"
itemprop="description"
class="nowrap--desktop"
>
According to TripAdvisor travelers as of [! rating.cachedAt|month:'long' !]
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-item-rating-nudges">
<div class="item-rating-nudge-container" ng-data="itemRatingNudgesCtrl.ratings.$promise">
<div class="item-rating-nudge item-rating-nudge--blue"
ng-if-once="itemRatingNudgesCtrl.ratings.fareharborCount.count >= itemRatingNudgesCtrl.MINIMUM_COUNT"
ng-then="countReachesMinimum"
ng-mx-view="view-nudge-booked-a-lot"
>
<i ng-svg="svg-trending" class="item-rating-nudge-icon"></i>
<div class="item-rating-nudge-text fade-in-right">
Over [! itemRatingNudgesCtrl.ratings.fareharborCount.count | approximate !] booked
</div>
</div>
<div class="item-rating-nudge item-rating-nudge--orange"
ng-if-once="itemRatingNudgesCtrl.ratings.fareharborCount.isFrequentlySoldOut"
ng-mx-view="view-nudge-fills-up"
>
<i ng-svg="svg-clock" class="item-rating-nudge-icon"></i>
<div class="item-rating-nudge-text fade-in-right">Fills up quickly</div>
</div>
<div class="item-rating-nudge item-rating-nudge--green"
ng-if-once="itemRatingNudgesCtrl.ratings.fareharborCount.isNew || !countReachesMinimum"
ng-mx-view="view-nudge-brand-new"
>
<i ng-svg="svg-star" class="item-rating-nudge-icon"></i>
<div class="item-rating-nudge-text fade-in-right">Brand new</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ngSuggestedItems">
<div ng-data="suggestedItemsCtrl.flowNode">
<div class="suggested-items table test-suggested-items-indicator"
ng-if="suggestedItemsCtrl.children.length > 0"
ng-mx-view="view-suggested-items"
ng-mx-scope-data="{
'suggested-items-count': suggestedItemsCtrl.children.length,
'has-suggested-items-description': !!suggestedItemsCtrl.notesSafeHtml
}"
ng-class="{'has-notes': suggestedItemsCtrl.notesSafeHtml }"
>
<div class="tr">
<div class="suggested-items-notes td valign-middle"
ng-if="suggestedItemsCtrl.notesSafeHtml"
>
<div class="prose prose-section break-words"
ng-bind-html="suggestedItemsCtrl.notesSafeHtml"
></div>
</div>
<div class="suggested-items-slider td"
ng-suggested-items-slider
ng-dimensions
ng-dimensions-when="!dimensions"
>
<div class="suggested-items-scroller">
<ul>
<li class="suggested-item test-suggested-item"
ng-repeat="flowNode in suggestedItemsCtrl.children"
>
<div class="suggested-item-inner"
ng-class="{ 'has-bg': FlowNode.imageUrl(flowNode) }"
ng-image="FlowNode.imageUrl(flowNode)"
ng-image-max-width="550"
>
<a
ng-mx-click="goto-[! flowNode.type !]--from-suggested-items"
ng-mx-data-flow-node="flowNode"
ng-href="[! FlowNode.suggestedItemUrl(flowNode, suggestedItemsCtrl.targetDate) !]"
>
<span class="item-block-info test-block-[! (flowNode.item || flowNode).name|css !]-indicator">
<h3 class="item-block-name test-item-name"
ng-bind-once="FlowNode.heading(flowNode)"
></h3>
<span class="item-block-headline notranslate"
ng-show-once="FlowNode.subheading(flowNode)"
ng-bind-once="FlowNode.subheading(flowNode)"
></span>
</span>
<span class="item-block-button"
ng-if-once="flowNode.type !== FlowNode.LINK_TYPE"
ng-bind-once="flowNode.item ? (flowNode.item.isRetail ? T('Buy') : T('Book')) : T('View')"
></span>
<span class="item-block-badges"
ng-show-once="flowNode.item && auth.currentUser.isAuthenticated"
>
<span class="badge badge-lock" ng-show-once="flowNode.item.isPrivate">Private</span>
<span class="badge" ng-show-once="!flowNode.item.isPrivate && flowNode.item.isUnlisted">Unlisted</span>
</span>
</a>
</div>
</li>
</ul>
</div>
<div class="suggested-items-arrow suggested-items-arrow-left"
ng-click="scroll('left')"
><span><i></i></span></div>
<div class="suggested-items-arrow suggested-items-arrow-right"
ng-click="scroll('right')"
><span><i></i></span></div>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-flow-breadcrumbs">
<div class="company-container-back respond-print-hide"
ng-if="breadcrumbsCtrl.showBackButton"
>
<a class="btn-back test-back-button-indicator"
ng-click="breadcrumbsCtrl.clickCallback(breadcrumbsCtrl.lastBreadcrumb)"
ng-href="[! breadcrumbsCtrl.lastBreadcrumb ? breadcrumbsCtrl.lastBreadcrumb.$url(urls.company.flowNode.index) : flows.initialFlowNodeUrl() !]"
ng-mx-click="goto-item-grid--from-item"
>[! breadcrumbsCtrl.item && !breadcrumbsCtrl.item.isRetail ? T('Choose a different activity') : T('Choose a different option') !]</a>
</div>
<div class="tb tb--white tb--bottom-border test-breadcrumbs-indicator"
ng-if="breadcrumbsCtrl.showBreadcrumbs"
>
<div class="tb-group tb-group--shaded"
ng-if-once="breadcrumbsCtrl.showHomeButton"
>
<a class="tb-btn test-breadcrumbs-home-button-indicator"
ng-tip="[! interpolate(T('Return to %(flowName)s'), { flowName: FlowNode.breadcrumbName(flows.initialFlowNode) }) !]"
ng-mx-click="goto-home-grid--from-breadcrumbs"
ng-href="[! flows.initialFlowNodeUrl() !]"
>
<i class="tb-icon home"></i>
<abbr>
Return to [! FlowNode.breadcrumbName(flows.initialFlowNode) !]
</abbr>
</a>
</div>
<div class="tb-group"
ng-if-once="breadcrumbsCtrl.breadcrumbs.length"
>
<a class="tb-btn test-breadcrumbs-previous-button-indicator"
ng-click="breadcrumbsCtrl.clickCallback(breadcrumbsCtrl.lastBreadcrumb)"
ng-href="[! breadcrumbsCtrl.lastBreadcrumb.$url(urls.company.flowNode.index) !]"
ng-tip="[! T('Back') !]"
ng-mx-click="goto-previous-breadcrumb"
ng-mx-data-flow-node="breadcrumbsCtrl.flowNode"
>
<i class="tb-icon back"></i>
<abbr>[! FlowNode.breadcrumbName(breadcrumbsCtrl.lastBreadcrumb) !]</abbr>
</a>
</div>
<div class="tb-group js-breadcrumb-links respond-handhelds-hide"
ng-class="{ 'tb-group--breadcrumbs-overflowing': breadcrumbsCtrl.isOverflowing }"
>
<a class="tb-breadcrumb is-link test-flow-node-breadcrumb"
ng-repeat="flowNode in breadcrumbsCtrl.breadcrumbs"
ng-click="breadcrumbsCtrl.clickCallback(flowNode)"
ng-href="[! flowNode.$url(urls.company.flowNode.index) !]"
ng-mx-click="goto-item-grid--from-item"
ng-mx-data-flow-node="flowNode"
>[! FlowNode.breadcrumbName(flowNode) !]</a>
<span class="tb-breadcrumb test-current-breadcrumb">
[! breadcrumbsCtrl.item ? breadcrumbsCtrl.item.name : FlowNode.breadcrumbName(breadcrumbsCtrl.flowNode) !]
</span>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-prices-navigation">
<div>
<div class="field">
<label>
<b ng-if-once="availability.company.affiliatesCount" class="label-text">
Total pricing
</b>
<span class="the-field-outer">
<span class="the-field"
ng-data="pricesNavigationCtrl.totalPromises"
ng-data-small
>
<select ng-model="bookCtrl.totalSheetOrSchedule"
ng-options="sheetOrSchedule as PriceSheet.dropdownLabel(sheetOrSchedule) for sheetOrSchedule in bookCtrl.totalSheetsAndSchedules"
ng-dropdown
ng-dropdown-watch-type="'uri'"
ng-dropdown-allow-clear="false"
></select>
</span>
</span>
</label>
</div>
<div class="field"
ng-if="availability.company.affiliatesCount && !!bookCtrl.newBookingOptions.currentAffiliation"
>
<label>
<b class="label-text">Invoice pricing</b>
<span class="the-field-outer">
<span class="the-field"
ng-data="pricesNavigationCtrl.invoicePromises"
ng-data-small
>
<select ng-model="bookCtrl.invoiceSheetOrSchedule"
ng-options="sheetOrSchedule as PriceSheet.dropdownLabel(sheetOrSchedule) for sheetOrSchedule in bookCtrl.invoiceSheetsAndSchedules"
ng-dropdown
ng-dropdown-watch-type="'uri'"
ng-dropdown-allow-clear="true"
ng-placeholder="None"
></select>
</span>
</span>
</label>
</div>
</div>
</script>
<script type="text/ng-template" id="prices.price">
<span ng-if="effectivePricing.price.modifierType === PriceLine.SET_MODIFIER_TYPE || effectivePricing.price.modifierType === PriceLine.ADJUST_MODIFIER_TYPE"
class="notranslate"
>
<span ng-if="PriceLine.showOffset(effectivePricing)"
ng-amount="PriceLine.effectiveOffset(effectivePricing, count)"
ng-amount-company="company"
></span>
[[ PriceLine.showRate(effectivePricing) ? (PriceLine.effectiveRate(effectivePricing, count)|percentage) : '' ]]
</span>
</script>
<script type="text/ng-template" id="prices.costs">
<span ng-amount="costs.totalCost ? costs.totalCost.price : null" ng-amount-company="company"></span>
</script>
<script type="text/ng-template" id="cart.cart">
<div ng-if="cart.entries.length > 0" ng-then="hasEntries"
ng-mx-view="view-cart"
>
<form name="orderForm"
ng-submit="cartCtrl.submit(orderForm)"
ng-confirm-navigate-away
ng-confirm-navigate-away-when="!cartCtrl.isNavigateAwayAllowed(orderForm)"
class="create-booking book-anon [[ addClassIf(orderForm.$submitting, 'form-loading') ]]"
ng-scroll-to="top"
>
<div class="company-wrap-inner cart-text-heading">
<div class="company-text-heading">
<h2>Checkout</h2>
<p>
You&#039;re moments away from completing your booking.
<span class="fh-light-grey">&mdash;
<a class="test-keep-shopping-link" ng-href="[! cart.keepShoppingUrl(company) !]">Keep shopping <span aria-hidden="true">&rsaquo;</span></a>
</span>
</p>
</div>
</div>
<div class="company-wrap-inner">
<ul class="cart-entries">
<li ng-repeat="entry in cart.entries track by entry.availability.uri"
ng-cart-entry="entry"
></li>
</ul>
</div>
<div ng-cart-totals></div>
<div ng-cart-complete></div>
</form>
</div>
<div ng-else="hasEntries"
ng-mx-view="view-empty-cart"
>
<div class="company-container-back respond-print-hide">
<a ng-href="[! cart.keepShoppingUrl(company) !]" class="btn-back">Keep shopping</a>
</div>
<div class="company-wrap-inner">
<div class="company-text-heading test-empty-cart-indicator">
<h2>
Your cart is empty.
</h2>
<p>Click Keep Shopping above to add something!</p>
</div>
<div ng-if="company.preCheckoutFlowNode"
ng-suggested-items="company.preCheckoutFlowNode"
></div>
</div>
</div>
</script>
<script type="text/ng-template" id="cart-entry-actions">
<div ng-if="cartEntryCtrl.status === 'loading'">
Checking availability...
</div>
<div ng-if="cartEntryCtrl.status === 'error'" class="cart-entry-error">
<span class="required-flag-icon">*</span>
<span ng-if="cartEntryCtrl.isPossiblyBookable">
Some options you selected are no longer available. Please <a tabindex="0" role="button" ng-click="cartEntryCtrl.change()">adjust this booking</a> or <a tabindex="0" role="button"> ng-click="cartEntryCtrl.remove()" ng-confirm-click="[! T('Are you sure you want to remove this from your cart?') !]" >remove it from your cart.</a>
</span>
<span ng-if="!cartEntryCtrl.isPossiblyBookable">
Our apologies, this is no longer available for online booking. Please <a tabindex="0" role="button" ng-click="cartEntryCtrl.remove()">remove it from your cart</a>.
</span>
</div>
<div ng-if="cartEntryCtrl.status === 'success'">
<button class="button-reset underline no-select test-remove-cart-entry-action" type="button"
ng-click="cartEntryCtrl.remove()"
ng-confirm-click="[! T('Are you sure you want to remove this item from your cart?') !]"
>Remove</button>
<span ng-if="cartEntryCtrl.entry.availability.item.cancellationNotes || cartEntryCtrl.entry.availability.company.cancellationNotes">
<span class="fh-light-grey">|</span>
<button class="button-reset cart-action-toggle" type="button"
ng-toggle ng-toggle-value="'cancellationPolicy-' + cartEntryCtrl.entry.availability.pk"
>
Cancellation policy
</button>
</span>
</div>
</script>
<script type="text/ng-template" id="cart.entry">
<div class="cart-entry-wrap field"
ng-class="{ 'ng-invalid': cartEntryCtrl.status === 'error' }"
>
<div class="table full-width valign-middle cart-entry">
<div class="tr">
<div class="td test-cart-entry-indicator">
<h3 class="cart-entry-item">
[! cartEntryCtrl.entry.availability.item.name !]
<span ng-if-once="cartEntryCtrl.entry.availability.headline">
&mdash;
<span ng-if-once="cartEntryCtrl.entry.availability.headline"
ng-bind="cartEntryCtrl.entry.availability.headline"
></span>
</span>
</h3>
<div class="cart-entry-availability notranslate"
ng-if-once="!cartEntryCtrl.entry.availability.item.isRetail"
>
[! cartEntryCtrl.entry.availability.startAt|datetimeRange:cartEntryCtrl.entry.availability.endAt:'long' !]
</div>
<div class="cart-actions respond-handhelds-hide"
ng-link="cart-entry-actions"
></div>
</div>
<div class="td cart-breakdown">
<span ng-repeat="breakdown in cartEntryCtrl.entry.customerBreakdown">
[! breakdown.count !] [! breakdown.count|pluralize:breakdown.customerTypeRate.customerPrototype.customerType.singular:breakdown.customerTypeRate.customerPrototype.customerType.plural !]<span ng-if="!$last">,</span>
</span>
<span ng-if="cartEntryCtrl.isPossiblyBookable"
class="fh-grey"
>
(<button class="button-reset underline" type="button"
ng-click="cartEntryCtrl.change()"
>Change</button>)
</span>
</div>
<div class="td nowrap cart-entry-amount">
[! cartEntryCtrl.total|amount:cartEntryCtrl.entry.availability !]
</div>
</div>
</div>
<ul class="errors"
ng-if="orderForm['booking' + $index + '-all'].$error.$server.length"
>
<li ng-repeat="error in orderForm['booking' + $index + '-all'].$error.$server">
[[ error ]]
</li>
</ul>
<div class="cart-actions respond-handhelds-show"
ng-link="cart-entry-actions"
></div>
<div ng-toggled ng-toggled-value="'cancellationPolicy-' + cartEntryCtrl.entry.availability.pk"
aria-live="assertive"
>
<div ng-init="availability = entry.availability">
<div ng-if="!rebook.currentBooking && (availability.item.cancellationNotes || availability.company.cancellationNotes)">
<div class="booking-cancellation-policy prose"
ng-bind-html-once="availability.item.cancellationNotesSafeHtml || availability.company.cancellationNotesSafeHtml"
></div>
</div>
</div>
</div>
</div>
<div ng-if="$last && entry.availability.item.effectivePreCheckoutFlowNode"
ng-suggested-items="entry.availability.item.effectivePreCheckoutFlowNode"
ng-suggested-items-cart-entries="cart.entries"
class="cart-suggested-items"
></div>
</script>
<script type="text/ng-template" id="cart.add">
<div class="book-form-submit" ng-noisy-invalid-fields>
<div class="book-form-submit-button">
<button class="btn-huge btn-wide btn-blue test-add-to-cart-action-enabled" type="button"
ng-if="bookCtrl.showBookButton(bookForm) && !cartAddCtrl.isAdding" ng-then="buttonEnabled"
ng-click="cartAddCtrl.add()"
>
[[ cartAddCtrl.isAvailabilityInCart ? T('Save + Return to cart') : T('Add to cart') ]] <span aria-hidden="true">&nbsp;&rsaquo;</span>
</button>
<button class="btn-huge btn-wide btn-grey test-add-to-cart-action-disabled" type="button"
ng-else="buttonEnabled"
ng-disabled="cartAddCtrl.isAdding"
ng-mx-click="click-disabled-add-to-cart-button"
ng-mx-availability="availability"
ng-click="noisyInvalidFieldsCtrl.show()"
>
<span ng-if="cartAddCtrl.isAdding" ng-then="adding">
[[ cartAddCtrl.isAvailabilityInCart ? T('Saving...') : T('Adding to cart...') ]]
</span>
<span ng-else="adding">
[[ cartAddCtrl.isAvailabilityInCart ? T('Save + Return to cart') : T('Add to cart') ]] <span aria-hidden="true">&nbsp;&rsaquo;</span>
</span>
</button>
</div>
<div ng-if="!buttonEnabled && !cartAddCtrl.isAdding">
<div ng-book-noisy-invalid-fields="!buttonEnabled"></div>
<div class="book-final-note">
<p class="required-fields-note">
<b>
Please answer all fields marked with <span class="required-flag-icon">*</span> to check out
</b>
</p>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="cart.totals">
<div class="book-form-totals">
<div class="table valign-middle full-width">
<div class="tr">
<div class="td">
<div class="gift-card-wrap" ng-if="
cartCtrl.company.features.isOnlineStoredValueCardRedemptionEnabled &&
(cartTotalsCtrl.totals.price + cartTotalsCtrl.totals.tax > 0)
">
<div ng-book-redeem></div>
</div>
<div class="secure-badge respond-handhelds-hide" ng-if="!lightframe.isParentInsecure()">
<i class="icon-lock-white"></i> Secured with 2048-bit encryption
</div>
</div>
<div class="td">
<table class="book-form-totals-table block-loading--init"
ng-can-view-amounts="cartCtrl.company"
ng-hide="
!cartTotalsCtrl.totals.total &&
!cartCtrl.redeemStoredValueCardsCtrl.isRedeeming()
"
>
<tr class="subtotal-row">
<td class="subtotal-label">Subtotal<span ng-if="cartCtrl.company.features.isCombinedTaxEnabled">
(Includes [! Company.taxDisplayName(cartCtrl.company) !])</span></td>
<td class="subtotal-value test-subtotal-indicator notranslate">
[[ (cartCtrl.company.features.isCombinedTaxEnabled ? cartTotalsCtrl.totals.price + cartTotalsCtrl.totals.tax : cartTotalsCtrl.totals.price)|amount:cartCtrl.company ]]
</td>
</tr>
<tbody ng-taxes-and-fees
ng-taxes-and-fees-source="cart"
ng-taxes-and-fees-totals="cartTotalsCtrl.totals"
></tbody>
<tr class="subtotal-row is-highlighted" ng-repeat="card in cartCtrl.redeemStoredValueCardsCtrl.storedValueCards">
<td class="subtotal-label">[! card.storedValueType.name !] ([! card.last5 !]) </td>
<td class="subtotal-value">
<span class="notranslate">-[[ cartCtrl.redeemStoredValueCardsCtrl.applied(card)|amount:cartCtrl.company ]]</span>
<a class="gift-card-close" ng-click="cartCtrl.redeemStoredValueCardsCtrl.unapply(card)" ng-tip="[! T('Remove gift card') !]"></a>
</td>
</tr>
<tbody>
<tr>
<td class="subtotal-label final-total-label">Total</td>
<td class="subtotal-value">
<span class="final-total test-total-indicator notranslate" aria-live="polite">
[[ cartTotalsCtrl.totals.total|amount:cartCtrl.company ]]
</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="cart.complete">
<div class="fields "
>
<div class="form-errors">
<ul class="errors test-server-error-indicator">
<li ng-if="orderForm.all.$error.unknown_error">There was an error processing this request. Please refresh the page and try again. (U-ORDER)</li>
<li ng-if="orderForm.all.$error.invalid_contact">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="orderForm.all.$error.no_cart_entries">Your cart is empty. Please refresh the page and try again.</li>
<li ng-if="orderForm.all.$error.no_uuid">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="orderForm.all.$error.booking_errors">Sorry, we were unable to create your order with the current selections. Please update your selections, and try again.</li>
<li ng-repeat="error in orderForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="orderForm.all.$error.$tokenization">
<li ng-repeat="error in orderForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
</div>
<div class="company-wrap-inner">
<div class="book-form-complete-left"
ng-mx-form-valid="complete-contact-form"
>
<fieldset ng-book-notification="cartCtrl.newOrder" ng-book-notification-anonymous ng-book-notification-cart>
<legend class="booking-sub-header">
Contact
</legend>
<div class="fields "
>
<div class="orderform-contact-name field-person-icon hide-label-text "
ng-django-field="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;]" ng-placeholder="Full name" ng-prefix="'contact'" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if-once="contact ? contact.company.companyFeatures.isContentTranslationEnabled : company.companyFeatures.isContentTranslationEnabled">
<a ng-toggle="contactLanguageDropdown" class="form-link-subtle hide-when-toggled contact-language-toggle"
ng-toggle-default="contact.language"
>
Change contact language
</a>
<div ng-toggled="contactLanguageDropdown">
<div class="orderform-contact-language
field-globe-icon
"
ng-django-field="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-language-dropdown
>
<div ng-current-option="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-current-option-collection=""
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="language"
ng-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;]"
ng-disabled="languageDropdownCtrl.isLoading"
ng-options="lang.code as lang.display group by lang.group for lang in languageDropdownCtrl.languageChoices"
ng-dropdown
ng-placeholder="[! T('Select a language') !]"
ng-dropdown-allow-clear="false"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;language&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="orderform-contact-phone field-phone-icon hide-label-text
international-phone-field
"
ng-django-field="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Phone number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone" maxlength="32" name="phone" ng-international-phone-field="true" ng-international-phone-field-countries="Contact.COUNTRIES" ng-international-phone-field-phone-country-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;]" ng-pattern="/^[^a-zA-Z]{5,32}$/" ng-placeholder="Phone number" ng-prefix="'contact'" ng-required="!auth.currentUser.isAuthenticated" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;phone&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="
company.isSmsEnabled &&
SmsNotification.isEligiblePhoneNumber(
cartCtrl.newOrder['contact' + '-phone'],
cartCtrl.newOrder['contact' + '-phoneCountry'],
company
)
">
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value="false"
class="ng-pristine"
ng-model="cartCtrl.newOrder.isSmsEnabled"
>
</span>
<span class="label-text">
Opt-in to text messages
<span class="icon-hint" ng-tip="[[ company.features.isInternationalSmsEnabled ? T('Customer may pay fees to their carrier') : T('Customer may pay fees to their carrier, US numbers only') ]]"></span>
</span>
</span>
</label>
</div>
</div>
<div class="orderform-contact-email field-email-icon hide-label-text "
ng-django-field="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-prefix="'contact'" ng-required="!auth.currentUser.isAuthenticated" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<span ng-mailcheck="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;]"
class="mailcheck-suggestion"
></span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-show="(auth.currentUser.isAuthenticated && (newBooking['contact-email'] || cartCtrl.newOrder.email)) || !auth.currentUser.isAuthenticated">
<div ng-if="auth.currentUser.isAuthenticated" ng-then="internalSubscribe">
<div class="orderform-contact-issubscribed field-cb-light "
ng-django-field="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-prefix="'contact'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Subscribe to company email list
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-else="internalSubscribe">
<div class="orderform-contact-issubscribed field-cb-light "
ng-django-field="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;]" ng-prefix="'contact'" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Get future email updates from [[ company.name ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="orderform-contact-phonecountry "
ng-django-field="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]"
>
<label >
<span class="label-text">
Phone country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone_country" name="phoneCountry" ng-model="cartCtrl.newOrder [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;]" ng-prefix="'contact'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;contact&#39; + &#39;-&#39; + &#39;phoneCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</fieldset>
</div>
<div class="book-form-complete-middle book-form-payment"
ng-mx-form-valid="complete-payment-form"
>
<fieldset ng-if="paymentCtrl.kind() !== paymentCtrl.SKIP_KIND">
<legend class="booking-sub-header">
Payment
</legend>
<div class="fields
respond-print-hide
"
>
<div ng-if="!paymentCtrl.isAnonymous">
<div class="orderform-payments-payment-kind "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]"
ng-django-field-required=""
>
<ul ng-radio-flyer
class="field-radio-group "
>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.SKIP_KIND)"
class="test-payment-kind-skip-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.SKIP_KIND"
ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
Don&#039;t add payment now
</label>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.DEFER_KIND)"
class="test-payment-kind-defer-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.DEFER_KIND"
ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
Save card to charge later
</label>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.PARTIAL_KIND)"
class="test-payment-kind-partial-action"
>
<label class="has-child">
<input type="radio" name="kind"
ng-value="paymentCtrl.PARTIAL_KIND"
ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
[[ paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND ? T('Partial payment:') : T('Partial payment') ]]
</label>
</li>
<li ng-if="paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND">
<div class="radio-content">
<div class="orderform-payments-payment-gross field-partial-payment-gross
field-amount
"
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-default="paymentCtrl.defaultGross()" ng-amount-input-max="paymentCtrl.amountMax()" ng-amount-input-min="paymentCtrl.amountMin()" ng-amount-input-positive="true" ng-autofocus="true" ng-autofocus-select="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'payments-payment'" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="tb tb--inset-mobile" ng-if="!!splitPaymentCtrl">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="splitPaymentCalc"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate split payment') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate split payment</abbr>
</div>
<div ng-toggled="splitPaymentCalc"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-section flyout-section--no-border">
<h2>Calculate split payment</h2>
<div class="hint">
Divide the booking total after taxes ([[ splitPaymentCtrl.amount|amount:company ]]) into equal amounts.
</div>
<table class="split-payment-table">
<tr>
<td class="text-right">
Split into:
</td>
<td>
<div class="field people-field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
ng-model="splitPaymentCtrl.divideByPeople"
ng-pattern="/^\d+$/"
ng-int-input
ng-int-input-min="1"
>
</span>
<div class="people-label">[[ nT('payment', 'payments', splitPaymentCtrl.divideByPeople) ]]</div>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td class="text-right">
Apply:
</td>
<td ng-autofocus>
<div class="field people-field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
ng-model="splitPaymentCtrl.payForPeople"
ng-pattern="/^\d+$/"
ng-int-input
ng-int-input-min="1"
ng-int-input-max="splitPaymentCtrl.divideByPeople"
>
</span>
<div class="people-label">[[ nT('payment', 'payments', splitPaymentCtrl.payForPeople) ]]</div>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td class="text-right">
Cost:
</td>
<td>
[[ splitPaymentCtrl.splitAmount|amount:company ]]
</td>
</tr>
<tr class="split-payment-set">
<td></td>
<td>
<button type="submit"
ng-click="splitPaymentCtrl.useSplitAmount()"
class="btn-tiny btn-green"
ng-disabled="splitPaymentCtrl.splitAmount <= 0"
>Set</button>
</td>
</tr>
</table>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'splitPaymentCalc'"></div>
</div>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.FULL_KIND)"
class="test-payment-kind-full-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.FULL_KIND"
ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
[[ paymentCtrl.isDefaultAmountInvoicePrice() ? T('Invoice amount') : T('Pay in full') ]]
</label>
</li>
<li ng-if="!paymentCtrl.isAnyKindValid()"
class="form-error"
>
<b>No available payment options.</b> Please contact your administrator.
</li>
</ul>
</div>
<div ng-if="paymentCtrl.affiliation() && paymentCtrl.needsPayment()">
<div class="orderform-payments-payment-iscollectedbyaffiliate "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]"
>
<div class="affiliate-form-header">Collected By</div>
<ul ng-radio-flyer
class="test-payment-collected-by-field-indicator field field-radio-group "
>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(false)"
class="test-collected-by-affiliate-false-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="false"
ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>[[ paymentCtrl.company|name ]]</b>
</span>
</label>
</li>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(true)"
class="test-collected-by-affiliate-true-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="true"
ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payments-payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>[[ paymentCtrl.affiliation().affiliateCompany|name ]]</b>
</span>
</label>
</li>
</ul>
</div>
</div>
</div>
<div ng-if="paymentCtrl.needsPayment() && paymentCtrl.needsOption()">
<div class="orderform-optionandextras "
ng-django-field="orderForm [&#39;optionAndExtras&#39;]" ng-django-field-model="paymentCtrl [&#39;optionAndExtras&#39;]"
>
<div class="affiliate-form-header">Payment Type</div>
<ul ng-radio-flyer
class="field-radio-group
"
>
<li class="field-radio-inline-header fh-green">
Pay [[ paymentCtrl.amount()|amount:company ]] with:
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IN_STORE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.inStorePaymentTypes"
class="test-payment-action-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="orderform-payments-payment-instorepaymentnote "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payments-payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.AFFILIATE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.affiliateInStorePaymentTypes"
class="test-payment-action-affiliate-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="orderform-payments-payment-instorepaymentnote "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payments-payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.FILE_OPTION)" ng-repeat="payment in paymentCtrl.cardPayments"
class="test-payment-action-file field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="payment"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge <b>[[ payment.displayProcessorBasedType ]]</b> <b>[[ payment.processorBasedIdentifier ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CARD_ON_FILE_OPTION)" ng-repeat="cardOnFile in paymentCtrl.cardsOnFile"
class="test-payment-action-card-on-file field-radio-icon--cc"
>
<label class="[! addClassIf(paymentCtrl.company.isDemoModeEnabled, 'is-disabled') !]">
<input type="radio" name=""
ng-value="cardOnFile"
ng-disabled="paymentCtrl.company.isDemoModeEnabled"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge company card <b>[[ cardOnFile.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CHARGE_OPTION)"
class="test-payment-action-charge field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.CHARGE_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge card
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.EMV_OPTION)"
class="test-payment-action-emv field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.EMV_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge with <b>[[ emv.currentDevice.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IDEAL_OPTION)"
class="test-payment-action-ideal"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.IDEAL_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
iDEAL
<i ng-svg="svg-ideal"></i>
</label>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.SOFORT_OPTION)"
class="test-payment-action-sofort"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.SOFORT_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Sofort
<i ng-svg="svg-sofort"></i>
</label>
</li>
<li ng-if="!paymentCtrl.isAnyOptionValid()">
No valid payment options
</li>
</ul>
</div>
</div>
<div ng-if="paymentCtrl.option() === paymentCtrl.IDEAL_OPTION"
class="labels-above"
>
<div class="orderform-payments-payment-stripeidealbanktype "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Please select your bank
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_stripe_ideal_bank_type" name="stripeIdealBankType" ng-dropdown="true" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;]" ng-options="choice[0] as choice[1] for choice in Payment.IDEAL_BANK_TYPE_CHOICES" ng-placeholder="Bank name" ng-prefix="'payments-payment'" ng-required="true">
<option value="abn_amro">ABN AMRO</option>
<option value="asn_bank">ASN Bank</option>
<option value="bunq">bunq</option>
<option value="handelsbanken">Handelsbanken</option>
<option value="ing">ING</option>
<option value="knab">Knab</option>
<option value="moneyou">Moneyou</option>
<option value="rabobank">Rabobank</option>
<option value="regiobank">RegioBank</option>
<option value="sns_bank">De Volksbank (SNS Bank)</option>
<option value="triodos_bank">Triodos Bank</option>
<option value="van_lanschot">Van Lanschot</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeIdealBankType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="paymentCtrl.option() === paymentCtrl.SOFORT_OPTION"
class="labels-above"
>
<div class="orderform-payments-payment-stripesofortcountry "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Please select your country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_stripe_sofort_country" name="stripeSofortCountry" ng-dropdown="true" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;]" ng-options="choice[0] as choice[1] for choice in Payment.SOFORT_COUNTRY_CHOICES" ng-placeholder="Country name" ng-prefix="'payments-payment'" ng-required="true">
<option value="AT">Austria</option>
<option value="BE">Belgium</option>
<option value="DE">Germany</option>
<option value="IT">Italy</option>
<option value="NL">Netherlands</option>
<option value="ES">Spain</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeSofortCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="paymentCtrl.needsCharge()">
<div class="form-error" ng-if="paymentCtrl.isAmountTooLow()">
<span ng-if="!auth.currentUser.isAuthenticated" ng-then="isAnonUser">
Sorry, payment cannot be taken at this time.
<a href="https://fareharbor.com/help/submit/">Please contact FareHarbor.</a>
(Error code LH-[! Payment.MIN_CHARGE_AMOUNT !].)
</span>
<span ng-else="isAnonUser">
<span ng-if="paymentCtrl.needsCharge()" ng-then="chargeTooLow">
Sorry, cards cannot be charged for amounts less than [! Payment.MIN_CHARGE_AMOUNT|amount:company !].
</span>
<span ng-else="chargeTooLow">
Sorry, payments cannot be created for [! 0|amount:company !].
</span>
</span>
</div>
</div>
<div ng-if="paymentCtrl.needsCardFields() && !paymentCtrl.isAmountTooLow()">
<div class="card-fields card-type-[[ paymentCtrl.cardTypeAbbreviation() ]]"
ng-class="{ 'test-cards-only': paymentCtrl.company.isDemoModeEnabled }"
>
<div class="card-fields-inner">
<div ng-if="paymentCtrl.company.isDemoModeEnabled" ng-then="demoCardForm"
class="card-fields-demo"
>
Demo mode
<i class="help-icon"
ng-tip="[! T('You can only use test credit card numbers while demo mode is on') !]"
></i>
</div>
<div ng-else="demoCardForm"
class="card-fields-secure"
>
<i class="icon-lock-green"></i> Secure and encrypted
<i class="icon-hint"
ng-hide="auth.currentUser.isAuthenticated"
ng-tip="[! interpolate(T('%(companyName)s will only be able to see the last 4 digits of your card number'), { companyName: paymentCtrl.company.name }) !]"
ng-tip-classes="tip-indent"
ng-tip-touch="true"
></i>
</div>
<div class="native-swiped-container"
ng-if="paymentCtrl.swiped && native.isNative"
ng-then="nativeSwiped"
>
<div>
<span class="badge badge-green">Swiped successfully</span>
</div>
<span class="card-number">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardLast4() ]]"
ng-model="cartCtrl.newOrder"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</span>
<div class="card-name">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardholdersName() ]]"
ng-model="cartCtrl.newOrder"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<a ng-click="paymentCtrl.stopSwiping()" class="btn btn-grey">
Enter different card
</a>
</div>
<div ng-else="nativeSwiped">
<span class="card-type-logo"></span>
<span class="card-number" ng-if-once="clientOptions.isKioskModeEnabled" ng-then="kioskMode">
<div class="orderform-payments-payment-cardnumber hide-label-text "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payments-payment'" ng-required="true" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span class="card-number" ng-else-once="kioskMode">
<div class="orderform-payments-payment-cardnumber hide-label-text "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payments-payment'" ng-required="true" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="card-name">
<span ng-if-once="kioskMode">
<div class="orderform-payments-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payments-payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderform-payments-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payments-payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Cardholder\'s name must match the name printed on the card') !]"
ng-tip-touch="true"
></div>
</div>
<div class="card-expiry">
<div class="card-form-header">Expiration date</div>
<div class="exp-month">
<div class="orderform-payments-payment-cardexpirymonth
pseudo-select
"
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName()" ng-then="hasValuecardMonth">
[[ KioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName() ]]
</span>
<span ng-else="hasValuecardMonth" class="exp-placeholder">
Month
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_month" name="cardExpiryMonth" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-prefix="'payments-payment'" required="required">
<option value="1">01 - January</option>
<option value="2">02 - February</option>
<option value="3">03 - March</option>
<option value="4">04 - April</option>
<option value="5">05 - May</option>
<option value="6">06 - June</option>
<option value="7">07 - July</option>
<option value="8">08 - August</option>
<option value="9">09 - September</option>
<option value="10">10 - October</option>
<option value="11">11 - November</option>
<option value="12">12 - December</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="exp-year">
<div class="orderform-payments-payment-cardexpiryyear
pseudo-select
"
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year()" ng-then="hasValuecardYear">
[[ KioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year() ]]
</span>
<span ng-else="hasValuecardYear" class="exp-placeholder">
Year
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_year" name="cardExpiryYear" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-prefix="'payments-payment'" required="required">
<option value="2019">2019</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
<option value="2028">2028</option>
<option value="2029">2029</option>
<option value="2030">2030</option>
<option value="2031">2031</option>
<option value="2032">2032</option>
<option value="2033">2033</option>
<option value="2034">2034</option>
<option value="2035">2035</option>
<option value="2036">2036</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="card-country-code">
<div class="orderform-payments-payment-countrycode field-select-full "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
>
<label >
<span class="label-text">
Country/Region
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_country_code" name="countryCode" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]">
<option value="" selected="selected"></option>
<option value="US">USA</option>
<option value="AF">Afghanistan</option>
<option value="AL">Albania</option>
<option value="DZ">Algeria</option>
<option value="AS">American Samoa</option>
<option value="AD">Andorra</option>
<option value="AO">Angola</option>
<option value="AI">Anguilla</option>
<option value="AQ">Antarctica</option>
<option value="AG">Antigua & Barbuda</option>
<option value="AR">Argentina</option>
<option value="AM">Armenia</option>
<option value="AW">Aruba</option>
<option value="AU">Australia</option>
<option value="AT">Austria</option>
<option value="AZ">Azerbaijan</option>
<option value="BS">Bahama</option>
<option value="BH">Bahrain</option>
<option value="BD">Bangladesh</option>
<option value="BB">Barbados</option>
<option value="BY">Belarus</option>
<option value="BE">Belgium</option>
<option value="BZ">Belize</option>
<option value="BJ">Benin</option>
<option value="BM">Bermuda</option>
<option value="BT">Bhutan</option>
<option value="BO">Bolivia</option>
<option value="BA">Bosnia and Herzegovina</option>
<option value="BW">Botswana</option>
<option value="BV">Bouvet Island</option>
<option value="BR">Brazil</option>
<option value="IO">British Indian Ocean Territory</option>
<option value="VG">British Virgin Islands</option>
<option value="BN">Brunei Darussalam</option>
<option value="BG">Bulgaria</option>
<option value="BF">Burkina Faso</option>
<option value="BI">Burundi</option>
<option value="KH">Cambodia</option>
<option value="CM">Cameroon</option>
<option value="CA">Canada</option>
<option value="CV">Cape Verde</option>
<option value="KY">Cayman Islands</option>
<option value="CF">Central African Republic</option>
<option value="TD">Chad</option>
<option value="CL">Chile</option>
<option value="CN">China</option>
<option value="CX">Christmas Island</option>
<option value="CC">Cocos (Keeling) Islands</option>
<option value="CO">Colombia</option>
<option value="KM">Comoros</option>
<option value="CG">Congo</option>
<option value="CK">Cook Iislands</option>
<option value="CR">Costa Rica</option>
<option value="HR">Croatia</option>
<option value="CU">Cuba</option>
<option value="CY">Cyprus</option>
<option value="CZ">Czech Republic</option>
<option value="DK">Denmark</option>
<option value="DJ">Djibouti</option>
<option value="DM">Dominica</option>
<option value="DO">Dominican Republic</option>
<option value="TP">East Timor</option>
<option value="EC">Ecuador</option>
<option value="EG">Egypt</option>
<option value="SV">El Salvador</option>
<option value="GQ">Equatorial Guinea</option>
<option value="ER">Eritrea</option>
<option value="EE">Estonia</option>
<option value="ET">Ethiopia</option>
<option value="FK">Falkland Islands (Malvinas)</option>
<option value="FO">Faroe Islands</option>
<option value="FJ">Fiji</option>
<option value="FI">Finland</option>
<option value="FR">France</option>
<option value="FX">France, Metropolitan</option>
<option value="GF">French Guiana</option>
<option value="PF">French Polynesia</option>
<option value="TF">French Southern Territories</option>
<option value="GA">Gabon</option>
<option value="GM">Gambia</option>
<option value="GE">Georgia</option>
<option value="DE">Germany</option>
<option value="GH">Ghana</option>
<option value="GI">Gibraltar</option>
<option value="GR">Greece</option>
<option value="GL">Greenland</option>
<option value="GD">Grenada</option>
<option value="GP">Guadeloupe</option>
<option value="GU">Guam</option>
<option value="GT">Guatemala</option>
<option value="GN">Guinea</option>
<option value="GW">Guinea-Bissau</option>
<option value="GY">Guyana</option>
<option value="HT">Haiti</option>
<option value="HM">Heard & McDonald Islands</option>
<option value="HN">Honduras</option>
<option value="HK">Hong Kong</option>
<option value="HU">Hungary</option>
<option value="IS">Iceland</option>
<option value="IN">India</option>
<option value="ID">Indonesia</option>
<option value="IQ">Iraq</option>
<option value="IE">Ireland</option>
<option value="IR">Islamic Republic of Iran</option>
<option value="IL">Israel</option>
<option value="IT">Italy</option>
<option value="CI">Ivory Coast</option>
<option value="JM">Jamaica</option>
<option value="JP">Japan</option>
<option value="JO">Jordan</option>
<option value="KZ">Kazakhstan</option>
<option value="KE">Kenya</option>
<option value="KI">Kiribati</option>
<option value="KP">Korea, Democratic People's Republic of</option>
<option value="KR">Korea, Republic of</option>
<option value="KW">Kuwait</option>
<option value="KG">Kyrgyzstan</option>
<option value="LA">Lao People's Democratic Republic</option>
<option value="LV">Latvia</option>
<option value="LB">Lebanon</option>
<option value="LS">Lesotho</option>
<option value="LR">Liberia</option>
<option value="LY">Libyan Arab Jamahiriya</option>
<option value="LI">Liechtenstein</option>
<option value="LT">Lithuania</option>
<option value="LU">Luxembourg</option>
<option value="MO">Macau</option>
<option value="MG">Madagascar</option>
<option value="MW">Malawi</option>
<option value="MY">Malaysia</option>
<option value="MV">Maldives</option>
<option value="ML">Mali</option>
<option value="MT">Malta</option>
<option value="MH">Marshall Islands</option>
<option value="MQ">Martinique</option>
<option value="MR">Mauritania</option>
<option value="MU">Mauritius</option>
<option value="YT">Mayotte</option>
<option value="MX">Mexico</option>
<option value="FM">Micronesia</option>
<option value="MD">Moldova, Republic of</option>
<option value="MC">Monaco</option>
<option value="MN">Mongolia</option>
<option value="MS">Monserrat</option>
<option value="MA">Morocco</option>
<option value="MZ">Mozambique</option>
<option value="MM">Myanmar</option>
<option value="NA">Namibia</option>
<option value="NR">Nauru</option>
<option value="NP">Nepal</option>
<option value="NL">Netherlands</option>
<option value="AN">Netherlands Antilles</option>
<option value="NC">New Caledonia</option>
<option value="NZ">New Zealand</option>
<option value="NI">Nicaragua</option>
<option value="NE">Niger</option>
<option value="NG">Nigeria</option>
<option value="NU">Niue</option>
<option value="NF">Norfolk Island</option>
<option value="MP">Northern Mariana Islands</option>
<option value="NO">Norway</option>
<option value="OM">Oman</option>
<option value="PK">Pakistan</option>
<option value="PW">Palau</option>
<option value="PA">Panama</option>
<option value="PG">Papua New Guinea</option>
<option value="PY">Paraguay</option>
<option value="PE">Peru</option>
<option value="PH">Philippines</option>
<option value="PN">Pitcairn</option>
<option value="PL">Poland</option>
<option value="PT">Portugal</option>
<option value="PR">Puerto Rico</option>
<option value="QA">Qatar</option>
<option value="RE">Reunion</option>
<option value="RO">Romania</option>
<option value="RU">Russian Federation</option>
<option value="RW">Rwanda</option>
<option value="LC">Saint Lucia</option>
<option value="WS">Samoa</option>
<option value="SM">San Marino</option>
<option value="ST">Sao Tome & Principe</option>
<option value="SA">Saudi Arabia</option>
<option value="SN">Senegal</option>
<option value="RS">Serbia</option>
<option value="SC">Seychelles</option>
<option value="SL">Sierra Leone</option>
<option value="SG">Singapore</option>
<option value="SK">Slovakia</option>
<option value="SI">Slovenia</option>
<option value="SB">Solomon Islands</option>
<option value="SO">Somalia</option>
<option value="ZA">South Africa</option>
<option value="GS">South Georgia and the South Sandwich Islands</option>
<option value="ES">Spain</option>
<option value="LK">Sri Lanka</option>
<option value="SH">St. Helena</option>
<option value="KN">St. Kitts and Nevis</option>
<option value="PM">St. Pierre & Miquelon</option>
<option value="VC">St. Vincent & the Grenadines</option>
<option value="SD">Sudan</option>
<option value="SR">Suriname</option>
<option value="SJ">Svalbard & Jan Mayen Islands</option>
<option value="SZ">Swaziland</option>
<option value="SE">Sweden</option>
<option value="CH">Switzerland</option>
<option value="SY">Syrian Arab Republic</option>
<option value="TW">Taiwan</option>
<option value="TJ">Tajikistan</option>
<option value="TZ">Tanzania, United Republic of</option>
<option value="TH">Thailand</option>
<option value="TG">Togo</option>
<option value="TK">Tokelau</option>
<option value="TO">Tonga</option>
<option value="TT">Trinidad & Tobago</option>
<option value="TN">Tunisia</option>
<option value="TR">Turkey</option>
<option value="TM">Turkmenistan</option>
<option value="TC">Turks & Caicos Islands</option>
<option value="TV">Tuvalu</option>
<option value="UG">Uganda</option>
<option value="UA">Ukraine</option>
<option value="AE">United Arab Emirates</option>
<option value="GB">United Kingdom (Great Britain)</option>
<option value="UM">United States Minor Outlying Islands</option>
<option value="VI">United States Virgin Islands</option>
<option value="US">USA</option>
<option value="ZZ">Unknown or unspecified country</option>
<option value="UY">Uruguay</option>
<option value="UZ">Uzbekistan</option>
<option value="VU">Vanuatu</option>
<option value="VA">Vatican City State (Holy See)</option>
<option value="VE">Venezuela</option>
<option value="VN">Viet Nam</option>
<option value="WF">Wallis & Futuna Islands</option>
<option value="EH">Western Sahara</option>
<option value="YE">Yemen</option>
<option value="YU">Yugoslavia</option>
<option value="ZR">Zaire</option>
<option value="ZM">Zambia</option>
<option value="ZW">Zimbabwe</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="card-cvc-postal">
<div class="card-cvc"
ng-shortcut="'shift+alt+c'"
ng-shortcut-action="auth.permissions.can('createWithoutCVC', Payment, paymentCtrl.company) && paymentCtrl.overrideCvc()"
>
<span ng-if-once="kioskMode">
<div class="orderform-payments-payment-cardcvc hide-label-text "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payments-payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderform-payments-payment-cardcvc hide-label-text "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payments-payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="<span class='cvc-icon'></span> [! T('Your card\'s three or four digit verification number, usually on the back') !]"
ng-tip-classes="tip-text-left"
ng-tip-touch="true"
></div>
</div>
<div class="card-postal"
ng-if="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;] && Payment.needsPostalCode(cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;])"
>
<span ng-if-once="kioskMode">
<div class="orderform-payments-payment-postalcode field-location-icon hide-label-text "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderform-payments-payment-postalcode field-location-icon hide-label-text "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payments-payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Please enter your billing postal code (zip code) for verification') !]"
ng-tip-touch="true"
></div>
</div>
</div>
</div>
<a class="card-swipe"
ng-click="paymentCtrl.startSwiping()"
ng-if="paymentCtrl.showingSwipe && !paymentCtrl.cardTypeAbbreviation()"
ng-tip="[! T('Swipe card') !]"
ng-tip-classes="tip-indent"
>
Swipe card
</a>
<div class="swiping" ng-if="paymentCtrl.swiping">
<input class="swipe-input" type="text" ng-swipe="paymentCtrl.swipeComplete" />
<div class="swiping-inner">
<div><img ng-src="//dp58aslhmbcib.cloudfront.net/static/images/card-swipe.gif?99774cb15b0528a7a2caeeb2a01921cc3e14532e" /></div>
Ready to swipe card...
</div>
</div>
</div>
<div class="amex-note"
ng-if="auth.currentUser.isAuthenticated && !cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
>
<b>Note:</b> It is strongly recommended that you enter the country for American Express cards, or the charge will fail.
</div>
<div ng-if="!company.isDemoModeEnabled"
ng-link="payment-setup-nag"
ng-init="isShort = true"
></div>
</div>
</div>
<div ng-if="!paymentCtrl.isAnonymous && paymentCtrl.isAnyKindValid() && paymentCtrl.kind() !== paymentCtrl.SKIP_KIND"
class="payment-comment"
>
<a ng-toggle="paymentComment" class="form-link-subtle hide-when-toggled">Add comment to payment</a>
<div ng-toggled="paymentComment">
<div class="orderform-payments-payment-note "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Payment comment (not visible to customer)" ng-prefix="'payments-payment'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="hide">
<div ng-if="paymentCtrl.needsCardFields()">
<div class="orderform-payments-payment-stripetoken "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderform-payments-payment-cardlast4 "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderform-payments-payment-cardtype "
ng-django-field="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="cartCtrl.newOrder [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-prefix="'payments-payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;payments-payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</fieldset>
</div>
<div class="book-form-complete-right"
ng-cart-submit
></div>
</div>
</div>
<div class="hide">
<div class="orderform-type "
ng-django-field="orderForm [&#39;type&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;type&#39;]"
>
<label >
<span class="label-text">
Type
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_type" name="type" ng-model="cartCtrl.newOrder [&#39;type&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;type&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderForm [&#39;type&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderform-bookingcount "
ng-django-field="orderForm [&#39;bookingCount&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;bookingCount&#39;]"
>
<label >
<span class="label-text">
Booking count
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_booking_count" name="bookingCount" ng-int-input="" ng-int-input-min="0" ng-model="cartCtrl.newOrder [&#39;bookingCount&#39;]" ng-pattern="/^\d+$/" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderForm [&#39;bookingCount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="orderForm [&#39;bookingCount&#39;].$error['invalid']">Enter a whole number.</li>
<li ng-if="orderForm [&#39;bookingCount&#39;].$error['min']">Ensure this value is greater than or equal to 0.</li>
<li ng-repeat="error in orderForm [&#39;bookingCount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderform-issmsenabled "
ng-django-field="orderForm [&#39;isSmsEnabled&#39;]" ng-django-field-model="cartCtrl.newOrder [&#39;isSmsEnabled&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_sms_enabled" name="isSmsEnabled" ng-model="cartCtrl.newOrder [&#39;isSmsEnabled&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderForm [&#39;isSmsEnabled&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="orderForm.all.$error.unknown_error">There was an error processing this request. Please refresh the page and try again. (U-ORDER)</li>
<li ng-if="orderForm.all.$error.invalid_contact">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="orderForm.all.$error.no_cart_entries">Your cart is empty. Please refresh the page and try again.</li>
<li ng-if="orderForm.all.$error.no_uuid">There was an error processing this request. Please refresh the page and try again.</li>
<li ng-if="orderForm.all.$error.booking_errors">Sorry, we were unable to create your order with the current selections. Please update your selections, and try again.</li>
<li ng-repeat="error in orderForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="form-loading-overlay"
ng-scroll-to="[[ auth.currentUser.isAuthenticated ? 'top' : '' ]]"
ng-scroll-on-click
ng-scroll-smooth
ng-if="orderForm.$submitting"
>
<div class="spinner-booking"></div>
<div class="processing-note">
<span ng-if="cartCtrl.tokenizingCard">
Processing payment...
</span>
<span ng-if="!cartCtrl.tokenizingCard">
Finishing order...
</span>
</div>
<div class="processing-refresh-note">Please do not leave or refresh this page.</div>
</div>
</script>
<script type="text/ng-template" id="cart.submit">
<div ng-noisy-invalid-fields>
<h2 class="booking-sub-header">
Complete
</h2>
<div class="book-form-submit-button">
<button class="btn-huge btn-wide btn-green test-order-action-enabled" type="submit"
ng-if="cartCtrl.showCompleteButton(orderForm)" ng-then="buttonEnabled"
>
Submit + Pay
</button>
<button class="btn-huge btn-wide btn-grey test-order-action-disabled" type="button"
ng-else="buttonEnabled"
ng-mx-click="click-disabled-book-button"
ng-click="noisyInvalidFieldsCtrl.show()"
>
[[ orderForm.$submitting ? T('Processing...') : T('Submit + Pay') ]]
</button>
</div>
<div ng-book-noisy-invalid-fields="!buttonEnabled"></div>
<div class="book-final-note">
<p class="required-fields-note" ng-if="!cartCtrl.showCompleteButton(orderForm)" ng-then="notComplete">
<b>
Please answer all fields marked with <span class="required-flag-icon">*</span> to complete your order
</b>
</p>
<p ng-else="notComplete">
<b ng-if="cartCtrl.paymentCtrl.option() === cartCtrl.paymentCtrl.CHARGE_OPTION">
Your card will be charged for [[ cartCtrl.paymentCtrl.amount()|amount:cartCtrl.company ]].
</b>
<b ng-if="cartCtrl.paymentCtrl.kind() === cartCtrl.paymentCtrl.DEFER_OPTION">
Your card will be verified and kept on file, but not charged.
</b>
</p>
</div>
<div ng-book-policies="cartCtrl.company"></div>
</div>
</script>
<script type="text/ng-template" id="realtime.users">
<div class="tb-presence-users"
ng-if="channel.users.length"
>
<span class="tb-presence-icon"
ng-tip="[[ tip ]]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon [[ icon ]]"></i>
</span>
<div ng-repeat="user in channel.users"
ng-tip="[! effectiveName(user) !]"
class="presence-user"
ng-image="user.imageCdnUrl"
ng-image-square="52"
>
[! user.imageCdnUrl ? '' : (user.name|initials) !]
</div>
</div>
</script>
<script type="text/ng-template" id="ng-sonar-paused">
<div ng-if="sonar.paused.length > 0" class="sonar-paused">
<span ng-repeat="description in sonarPausedCtrl.descriptions()">
[[ description|capitalize ]]<span ng-if="!$last">,</span>
</span>
was updated.
<a ng-click="sonarPausedCtrl.unpause()" class="underline">Refresh</a>
</div>
</script>
<script type="text/ng-template" id="ng-activities">
<div ng-if-once="objectActivitiesCtrl.canList">
<h2 ng-if-once="objectActivitiesCtrl.header" class="print-h3">[! objectActivitiesCtrl.header !]</h2>
<div ng-controller="dashboard.shared.ObjectActivitiesCtrl">
<div ng-if="objectActivitiesCtrl.isNoteEnabled">
<div class="activities-add-note respond-print-hide"
ng-if="activitiesCtrl.canCreateNote && activitiesCtrl.newNote"
>
<form class="add-note-form table valign-top" name="addNoteForm"
ng-submit="activitiesCtrl.submit(addNoteForm)"
>
<div class="tr">
<div class="add-note-fields td">
<div class="fields "
>
<div class="addnoteform-note "
ng-django-field="addNoteForm [&#39;note&#39;]" ng-django-field-model="activitiesCtrl.newNote [&#39;note&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-model="activitiesCtrl.newNote [&#39;note&#39;]" ng-placeholder="Add comment..." required="required" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in addNoteForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in addNoteForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div class="add-note-submit td test-create-booking-note-activity-action">
<button type="submit" class="btn-big btn-wide btn-green test-add-note-action"
ng-disabled="addNoteForm.$invalid || addNoteForm.$submitting"
>
[[ addNoteForm.$submitting ? T('Adding...') : T('Comment') ]]
</button>
</div>
</div>
</form>
</div>
</div>
<div ng-link="activity-list"
ng-init="forceShowLinks = objectActivitiesCtrl.forceShowLinks"
></div>
</div>
</div>
</script>
<script type="text/ng-template" id="activities">
<div ng-if="activities.length"
class="table break-on-print activities"
>
<div ng-repeat="activity in activities"
class="tr activity activity-[! activityType|css !]"
ng-init="activityType = activity.context.adminOnlyOriginalType || activity.type; user = activity.user; timeStamp = activity.createdAt;"
>
<div class="td activity-meta" ng-with="">
<span class="activity-admin-only-icon icon-lock respond-print-hide"
ng-if="activity && auth.currentUser.company.isAdmin && Activity.isAdminOnly(activity)"
ng-tip="[! T('This activity is admin-only') !]"
ng-tip-position="right"
></span>
<div class="table valign-top table-dont-respond break-on-print">
<div class="tr">
<div class="td activity-meta-image respond-print-hide" ng-if-once="user.imageCdnUrl">
<a ng-href="[! user.$url(urls.dashboard.settings.permissions.user.index) !]">
<img ng-image="user.imageCdnUrl" ng-image-square="60" class="image-profile-tiny" />
</a>
</div>
<div class="td">
<div class="activity-meta-user" ng-if-once="user">
<a ng-href="[! user.$url(urls.dashboard.settings.permissions.user.index) !]">[! user.name !]</a>
<span class="badge badge-blue" ng-if-once="Company.isAdmin(user.company)"
ng-tip="[! user.name !] is FareHarbor staff"
>FH</span>
</div>
<div class="activity-meta-company respond-print-hide"
ng-if-once="user && !Company.isAdmin(user.company) && user.company !== navigation.currentCompany"
>
[! user.company.name !]
</div>
<div ng-if-once="activity"
ng-activity-flyout
></div>
<div ng-else-once="activity"
ng-interval="60"
title="[[ timeStamp|datetime ]]"
class="activity-meta-date"
>
[[ timeStamp|datetime:'relative':'relative-time' ]]
</div>
</div>
</div>
</div>
</div>
<div class="td activity-content"
ng-init="instance = (activity.context.instance || activity.object)"
>
<div class="activity-content-inner">
<div class="activity-content-icon"></div>
<div ng-if-once="activityType === 'marked-paid-payment'"
class="test-marked-paid-payment-activity-indicator"
>
<ul>
<li>
<span ng-can-view-amounts="instance.booking.company"
ng-then="displayPaymentAmount"
>
<span class="badge badge-paid"
ng-amount="instance.initialReceipt.gross"
ng-amount-currency="instance.booking"
ng-can-view-amounts="instance.booking.company"
></span>
payment
</span>
<span ng-if-once="!displayPaymentAmount">
Payment
</span>
</li>
<li ng-if-once="instance.isCollectedByAffiliate">
<span class="fh-grey">Collected by:</span>
<b ng-if-once="instance.booking.affiliation">[! instance.booking.affiliation.affiliateCompany.name !]</b>
<b ng-if-once="!instance.booking.affiliation">Affiliate</b>
</li>
<li ng-if-once="instance.type !== Payment.AFFILIATE_TYPE">
<span class="fh-grey">Type:</span> <b>[! instance.displayType !]</b>
</li>
<li ng-if-once="instance.inStorePaymentNote">
<span class="fh-grey">[! instance.inStorePaymentType.effectiveNoteLabel !]:</span> <b>[! instance.inStorePaymentNote !]</b>
</li>
</ul>
<div class="fh-grey"
ng-if-once="instance.noteSafeHtml"
ng-bind-html="instance.noteSafeHtml"
></div>
</div>
<div ng-if-once="activityType === 'charged-payment'"
class="test-charged-payment-activity-indicator"
>
<span ng-can-view-amounts="instance.booking.company"
ng-then="displayPaymentAmount"
></span>
<ul ng-if="instance.isCardOnFile">
<li>
<span ng-if-once="displayPaymentAmount">
<span class="badge badge-paid">
<span ng-amount="instance.initialReceipt.gross"
ng-amount-company="instance.company"
></span>
<span ng-inline="booking-fee-flag" ng-with="payment = instance"></span>
</span>
payment
</span>
<span ng-else-once="displayPaymentAmount">
Payment
</span>
<span ng-processor-identifier></span>
</li>
<li><span class="fh-grey">From company card:</span> <b>[! instance.cardName !]</b></li>
</ul>
<ul ng-if="Payment.isNotCardOnFileProcessorBasedType(instance)">
<li>
<span ng-if-once="displayPaymentAmount">
<span class="badge badge-paid">
<span ng-amount="instance.initialReceipt.gross"
ng-amount-company="instance.company"
></span>
<span ng-inline="booking-fee-flag" ng-with="payment = instance"></span>
</span>
payment
</span>
<span ng-else-once="displayPaymentAmount">
Payment
</span>
<span ng-processor-identifier></span>
</li>
<li>
<span class="fh-grey">From:</span> <b>[! instance.displayProcessorBasedType !] [! instance.processorBasedIdentifier !]</b>
</li>
<li ng-if-once="instance.processorBasedAccountholdersName">
<span class="fh-grey">Account holder:</span> <b>[! instance.processorBasedAccountholdersName !]</b>
</li>
</li>
<p ng-if-once="instance.isCollectedByAffiliate && instance.booking.affiliation"
class="fh-grey test-activity-commission-note-indicator"
>
Collected by [! instance.booking.affiliation.affiliateCompany.name !]
</p>
<div class="fh-grey"
ng-if-once="instance.noteSafeHtml"
ng-bind-html="instance.noteSafeHtml"
></div>
<div class="activity-note-content"
ng-can-admin-view="company"
ng-can-only-when="!!instance.metadata && toggles.state('showProcessorIdentifier')"
ng-format-json="instance.metadata"
></div>
</div>
<div ng-if-once="activityType === 'refunded-payment'">
<div class="simple-warning" ng-if-once="activity.context.refund.isVoided">
<i class="warning-icon"></i>
<b>This refund was cancelled.</b> (Refund #[! activity.context.refund.pk !].)
</div>
<span ng-can-view-amounts="instance.booking.company"
ng-then="displayRefundAmount"
></span>
<ul ng-if-once="instance.isCardOnFile" ng-then="isCardOnFilePayment">
<li>
<span ng-if-once="displayRefundAmount">
<span class="badge badge-refunded"
ng-can-view-amounts="instance.booking.company"
>
[! (-1 * activity.context.refund.receipt.gross)|amount:instance !]
<span ng-inline="booking-fee-flag"
ng-if="activity.context.refund.receipt.bookingFee && activity.context.refund.isFull"
ng-with="payment = instance"
></span>
</span>
refund
</span>
<span ng-else-once="displayRefundAmount">
Refund
</span>
</li>
<li><span class="fh-grey">To company card:</span> <b>[! instance.cardName !]</b></li>
</ul>
<ul ng-if-once="Payment.isNotCardOnFileProcessorBasedType(instance)" ng-then="ccRefund">
<li>
<span ng-if-once="displayRefundAmount">
<span class="badge badge-refunded"
ng-can-view-amounts="instance.booking.company"
>
[! (-1 * activity.context.refund.receipt.gross)|amount:instance !]
<span ng-inline="booking-fee-flag"
ng-if="activity.context.refund.receipt.bookingFee && activity.context.refund.isFull"
ng-with="payment = instance"
></span>
</span>
refund
</span>
<span ng-else-once="displayRefundAmount">
Refund
</span>
<span ng-processor-identifier="activity.context.refund"
ng-processor-identifier-company="instance.company"
></span>
</li>
<li><span class="fh-grey">To:</span> <b>[! instance.displayProcessorBasedType !] [! instance.processorBasedIdentifier !]</b></li>
</ul>
<span ng-if-once="instance.type === Payment.AFFILIATE_TYPE" ng-then="affiliateRefund">
<span ng-if-once="displayRefundAmount">
<span class="badge badge-refunded"
ng-can-view-amounts="instance.booking.company"
>
[! (-1 * activity.context.refund.receipt.gross)|amount:instance !]
<span ng-inline="booking-fee-flag"
ng-if="activity.context.refund.receipt.bookingFee && activity.context.refund.isFull"
ng-with="payment = instance"
></span>
</span>
refund
</span>
<span ng-if-once="!displayRefundAmount">
Refund
</span>
</span>
<ul ng-else="ccRefund || isCardOnFilePayment || affiliateRefund">
<li>
<span ng-if-once="displayRefundAmount">
<span class="badge badge-refunded"
ng-can-view-amounts="instance.booking.company"
>
[! (-1 * activity.context.refund.receipt.gross)|amount:instance !]
<span ng-inline="booking-fee-flag"
ng-if="activity.context.refund.receipt.bookingFee && activity.context.refund.isFull"
ng-with="payment = instance"
></span>
</span>
refund
</span>
<span ng-else-once="displayRefundAmount">
Refund
</span>
</li>
<li><span class="fh-grey">Type:</span> <b>[! instance.displayType !]</b></li>
</ul>
<ul ng-if-once="affiliateRefund">
<li ng-if-once="instance.booking.affiliation" ng-then="bookingHasAffiliation">
<span class="fh-grey">Collected by:</span> <b>[! instance.booking.affiliation.affiliateCompany.name !]</b>
</li>
<li ng-else="bookingHasAffiliation">
<span class="fh-grey">Collected by:</span> <b>Affiliate</b>
</li>
</ul>
<div ng-if-once="instance.inStorePaymentNote">
<span class="fh-grey">[! instance.inStorePaymentType.effectiveNoteLabel !]:</span> <b>[! instance.inStorePaymentNote !]</b>
</div>
<a class="activity-timeline"
ng-if-once="!!activity.context.refund.upload"
ng-href="[! activity.context.refund.upload.$url(urls.dashboard.reports.accounts.upload) !]"
ng-link="activity-upload-status"
ng-with="upload = activity.context.refund.upload; refund = activity.context.refund"
></a>
<div class="fh-grey"
ng-if-once="instance.noteSafeHtml"
ng-bind-html="instance.noteSafeHtml"
></div>
</div>
<div ng-if-once="activityType === 'voided-refund'">
<i class="warning-icon"></i>
Cancelled refund
<a class="fh-blue underline" ng-toggle="voidedRefundInfo">#[! instance.pk !]</a>
<div ng-toggled="voidedRefundInfo">
<span ng-can-view-amounts="instance.booking.company"
ng-then="displayRefundAmount"
></span>
<span ng-if-once="instance.payment.isCardOnFile">
<span ng-if-once="displayRefundAmount">
<span class="badge badge-refunded"
ng-can-view-amounts="instance.payment.company" ng-then="displayRefundAmount"
>
[! instance.gross|amount:instance.payment !]
<span ng-inline="booking-fee-flag"
ng-if="instance.bookingFee && instance.isFull"
ng-with="payment = instance.payment"
></span>
</span>
to company card <b>[! instance.payment.cardName !]</b>
</span>
<span ng-else-once="displayRefundAmount">
Refund to company card <b>[! instance.payment.cardName !]</b>
</span>
</span>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(instance.payment)">
<span ng-if-once="displayRefundAmount">
<span class="badge badge-refunded"
ng-can-view-amounts="instance.payment.company" ng-then="displayRefundAmount"
>
[! instance.gross|amount:instance.payment !]
<span ng-inline="booking-fee-flag"
ng-if="instance.bookingFee && instance.isFull"
ng-with="payment = instance.payment"
></span>
</span>
to <b>[! instance.payment.displayProcessorBasedType !] [! instance.payment.processorBasedIdentifier !]</b>
</span>
<span ng-else-once="displayRefundAmount">
Refund to <b>[! instance.payment.displayProcessorBasedType !] [! instance.payment.processorBasedIdentifier !]</b>
</span>
</span>
<span ng-processor-identifier ng-processor-identifier-company="instance.payment.company"></span>
</div>
</div>
<div ng-if-once="activityType === 'deferred-payment'"
class="test-deferred-payment-activity-indicator"
>
<span ng-if="instance.isCardOnFile">
<span class="fh-grey">Saved company card:</span> <b>[! instance.cardName !]</b>
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(instance)">
<span class="fh-grey">Saved card:</span> <b>[! instance.displayProcessorBasedType !] [! instance.processorBasedIdentifier !]</b>
</span>
<span ng-processor-identifier></span>
<div class="fh-grey"
ng-if-once="instance.noteSafeHtml"
ng-bind-html="instance.noteSafeHtml"
></div>
</div>
<div ng-if-once="activityType === 'activated-emv-device'">
Activated payment device "<b>[! instance.unicode !]</b>"
</div>
<div ng-if-once="activityType === 'transferred-payment'">
<p class="fh-grey">[Admin only] Moved payment</p>
</div>
<div ng-if-once="activityType === 'was-transferred-payment'">
<p class="fh-grey">[Admin only] Payment was moved</p>
</div>
<div ng-if-once="activityType === 'charge-disputed' || activityType === 'admin-charge-disputed'">
<i class="warning-icon"></i>
<span ng-if="instance.isCardOnFile">
<b>Customer disputed</b>
<span ng-if-once="activity.context.paymentEffectiveDisputedAmount|isDefined"
ng-then="isPaymentEffectiveDisputedAmountDefined"
ng-amount="activity.context.paymentEffectiveDisputedAmount"
ng-amount-company="instance.company"
></span>
<span ng-else="isPaymentEffectiveDisputedAmountDefined">
<span ng-if-once="activity.context.effectiveDisputedAmount|isDefined"
ng-then="isEffectiveDisputedAmountDefined"
ng-amount="activity.context.effectiveDisputedAmount"
ng-amount-company="instance.company"
></span>
<span ng-else="isEffectiveDisputedAmountDefined"
ng-amount="activity.context.disputedAmount"
ng-amount-company="instance.company"
></span>
</span>
charge to company card <b>[! instance.cardName !]</b>
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(instance)">
<b>Customer disputed</b>
<span ng-if-once="activity.context.paymentEffectiveDisputedAmount|isDefined"
ng-then="isPaymentEffectiveDisputedAmountDefined"
ng-amount="activity.context.paymentEffectiveDisputedAmount"
ng-amount-company="instance.company"
></span>
<span ng-else="isPaymentEffectiveDisputedAmountDefined">
<span ng-if-once="activity.context.effectiveDisputedAmount|isDefined"
ng-then="isEffectiveDisputedAmountDefined"
ng-amount="activity.context.effectiveDisputedAmount"
ng-amount-company="instance.company"
></span>
<span ng-else="isEffectiveDisputedAmountDefined"
ng-amount="activity.context.disputedAmount"
ng-amount-company="instance.company"
></span>
</span>
charge to <b>[! instance.displayProcessorBasedType !]</b> &mdash; <b>[! instance.processorBasedIdentifier !]</b>
</span>
&mdash; <a ng-href="/help/payments/disputes/" ng-outbound-link="_blank" class="fh-blue underline">About disputes</a>
<span ng-processor-identifier></span>
</div>
<div ng-if-once="activityType === 'dispute-closed' || activityType === 'admin-dispute-closed'">
<span ng-if="instance.isCardOnFile">
Dispute for
<span ng-if-once="activity.context.paymentEffectiveDisputedAmount|isDefined"
ng-then="isPaymentEffectiveDisputedAmountDefined"
ng-amount="activity.context.paymentEffectiveDisputedAmount"
ng-amount-company="instance.company"
></span>
<span ng-else="isPaymentEffectiveDisputedAmountDefined">
<span ng-if-once="activity.context.effectiveDisputedAmount|isDefined"
ng-then="isEffectiveDisputedAmountDefined"
ng-amount="activity.context.effectiveDisputedAmount"
ng-amount-company="instance.company"
></span>
<span ng-else="isEffectiveDisputedAmountDefined"
ng-amount="activity.context.disputedAmount"
ng-amount-company="instance.company"
></span>
</span>
on charge to company card <b>[! instance.cardName !]</b> closed with status <b>[! activity.context.disputeStatus !]</b>
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(instance)">
Dispute for
<span ng-if-once="activity.context.paymentEffectiveDisputedAmount|isDefined"
ng-then="isPaymentEffectiveDisputedAmountDefined"
ng-amount="activity.context.paymentEffectiveDisputedAmount"
ng-amount-company="instance.company"
></span>
<span ng-else="isPaymentEffectiveDisputedAmountDefined">
<span ng-if-once="activity.context.effectiveDisputedAmount|isDefined"
ng-then="isEffectiveDisputedAmountDefined"
ng-amount="activity.context.effectiveDisputedAmount"
ng-amount-company="instance.company"
></span>
<span ng-else="isEffectiveDisputedAmountDefined"
ng-amount="activity.context.disputedAmount"
ng-amount-company="instance.company"
></span>
</span>
on charge to <b>[! instance.displayProcessorBasedType !]</b> &mdash; <b>[! instance.processorBasedIdentifier !]</b> closed with status <b>[! activity.context.disputeStatus !]</b>
</span>
&mdash; <a ng-href="/help/payments/disputes/" ng-outbound-link="_blank" class="fh-blue underline">About disputes</a>
<span ng-processor-identifier></span>
</div>
<div ng-if-once="activityType === 'changed-gross'">
<span ng-if-once="activity.context.explicitGross === null" ng-then="removedExplicitTotal">
Removed <b>set booking total</b> <span class="fh-grey">(was <span ng-amount="activity.context.previousExplicitGross" ng-amount-currency="activity"></span>)</span>
</span>
<span ng-else-once="removedExplicitTotal">
<span ng-can-view-amounts="activity.company" ng-then="showSetAmounts">
<span ng-if-once="activity.context.previousExplicitGross !== null" ng-then="showWas">
Set <b>booking total</b> to <span ng-amount="activity.context.explicitGross" ng-amount-currency="activity"></span> <span class="fh-grey">(was <span ng-amount="activity.context.previousExplicitGross" ng-amount-currency="activity"></span>)</span>
</span>
<span ng-else-once="showWas">
Set <b>booking total</b> to <span ng-amount="activity.context.explicitGross" ng-amount-currency="activity"></span>
</span>
</span>
<span ng-else-once="showSetAmounts">
Set <b>booking total</b>
</span>
</span>
</div>
<div ng-if-once="activityType === 'booked-order'"
class="test-booked-order-activity-indicator"
>
<span class="booked-at booked-at-online"
ng-if-once="!instance.originalUser" ng-then="bookedOnline"
>
<span class="booked-online-icon"></span> <b>Booked online</b>
</span>
<span ng-else="bookedOnline">
Order created
</span>
<div ng-if-once="!!activity.context.requestData" class="activity-note-content">
<div ng-if-once="!!activity.context.requestData.order" ng-then="isOrder"
ng-format-json="activity.context.requestData.order"
></div>
<div ng-else-once="isOrder" ng-format-json="activity.context.requestData"
></div>
</div>
</div>
<div ng-if-once="activityType === 'added-booking'">
Added booking <a class="badge badge-booking-pk" ng-href="[! activity.context.instance|bookingUrl !]">#[! activity.context.instance.pk !]</a>
</div>
<div ng-if-once="activityType === 'removed-booking'">
Removed booking <a class="badge badge-booking-pk" ng-href="[! activity.context.instance|bookingUrl !]">#[! activity.context.instance.pk !]</a>
</div>
<div ng-if-once="activityType === 'moved-bookings'">
[! nT('Moved booking', 'Moved bookings', activity.context.bookings.length) !]
<span ng-repeat="booking in activity.context.bookings">
<a class="badge badge-booking-pk" ng-href="[! booking|bookingUrl !]">#[! booking.pk !]</a>[! !$last ? ',' : '' !]
</span>
</div>
<div ng-if-once="activityType === 'booked-booking'"
class="test-booked-booking-activity-indicator"
>
<span ng-if-once="activity.context.rebooked" ng-then="rebooked"
class="test-rebooked-booking-activity-indicator"
>
<a ng-if-once="activity.context.originalBooking"
ng-then="originalBooking"
ng-href="[! activity.context.originalBooking|bookingUrl !]"
ng-shortcut="'shift+,'"
ng-shortcut-click
title="[! T('Shortcut: shift+&lt;') !]"
>
Rebooked from <span class="badge badge-booking-pk">#[! activity.context.originalBooking.pk !]</span>
</a>
<span ng-else-once="originalBooking">
Rebooked from a previous booking
</span>
</span>
<span ng-else="rebooked">
<span class="booked-at booked-at-online"
ng-if-once="!instance.user" ng-then="bookedOnline"
>
<span class="booked-online-icon"></span> <b>Booked online</b>
<span class="booked-online-ref" ng-show="instance.onlineBookingReference">
<br /><b>Ref:</b> [! instance.onlineBookingReference !]
</span>
</span>
<span ng-else="bookedOnline">
Booking created
</span>
</span>
<div ng-if-once="!!activity.context.originalRequestData.additionalCriteria" class="activity-note-content"
ng-format-json="activity.context.originalRequestData.additionalCriteria"
></div>
<div ng-if-once="!!activity.context.originalRequestData" class="activity-note-content"
ng-format-json="activity.context.originalRequestData"
></div>
<div ng-if-once="!!activity.context.requestData" class="activity-note-content"
ng-format-json="activity.context.requestData"
></div>
<div ng-if-once="!!activity.context.viatorRequestData" class="activity-note-content">
<div ng-if-once="!!activity.context.viatorRequestData.Traveller">
<b>Travellers</b>
<table class="spreadsheet width-auto">
<tr class="ss-header-shade">
<td><b>Name</b></td>
<td><b>Age</b></td>
<td><b>Lead traveller?</b></td>
</tr>
<tr ng-repeat="traveller in activity.context.viatorRequestData.Traveller">
<td>[! traveller.TravellerTitle !] [! traveller.GivenName !] [! traveller.Surname !]</td>
<td>[! traveller.AgeBand !]</td>
<td>[! traveller.LeadTraveller ? T('Yes') : '' !]</td>
</tr>
</table>
</div>
<div ng-if-once="!!activity.context.viatorRequestData.RequiredInfo">
<b>Required Info</b>
<table class="spreadsheet width-auto">
<tr class="ss-header-shade">
<td><b>Question</b></td>
<td><b>Answer</b></td>
</tr>
<tbody ng-repeat="info in activity.context.viatorRequestData.RequiredInfo">
<tr ng-repeat="question in info">
<td>[! question.QuestionText !]</td>
<td>[! question.QuestionAnswer !]</td>
</tr>
</tbody>
</table>
</div>
<div class="prose">
<ul>
<li><b>Booking reference:</b> [! activity.context.viatorRequestData.BookingReference !]</li>
<li><b>Location:</b> [! activity.context.viatorRequestData.Location !]</li>
<li ng-if-once="!!activity.context.viatorRequestData.SpecialRequirement">
<b>Special requirement:</b> [! activity.context.viatorRequestData.SpecialRequirement !]
</li>
<li ng-if-once="!!activity.context.viatorRequestData.PickupPoint">
<b>Pickup point:</b> [! activity.context.viatorRequestData.PickupPoint !]
</li>
</ul>
<div ng-if-once="!!activity.context.viatorRequestData.Inclusions">
<b>Inclusions</b>
<ul>
<span ng-repeat="inclusionBlock in activity.context.viatorRequestData.Inclusions">
<li ng-repeat="inclusion in inclusionBlock">[! inclusion !]</li>
</span>
</ul>
</div>
<div ng-if-once="!!activity.context.viatorRequestData.AdditionalRemarks">
<b>Additional remarks</b>
<ul>
<li ng-repeat="remark in activity.context.viatorRequestData.AdditionalRemarks.Remark">
[! remark !]
</li>
</ul>
</div>
<div ng-if-once="!!activity.context.viatorRequestData.ContactDetail">
<b>Contact detail</b>
<ul>
<li><b>Name:</b> [! activity.context.viatorRequestData.ContactDetail.ContactName !]</li>
<li><b>Type:</b> [! activity.context.viatorRequestData.ContactDetail.ContactType !]</li>
<li><b>Value:</b> [! activity.context.viatorRequestData.ContactDetail.ContactValue !]</li>
</ul>
</div>
</div>
</div>
</div>
<div ng-if-once="activityType === 'cancelled-booking'">
<span ng-if-once="activity.context.rebooking && activity.context.newBooking" ng-then="rebooked">
<a ng-href="[! activity.context.newBooking|bookingUrl !]">
Rebooked to <span class="badge badge-booking-pk">#[! activity.context.newBooking.pk !]</span>
</a>
</span>
<span class="badge badge-error">Cancelled booking</span>
<div class="cancelled-booking-note activity-note-content prose prose--small"
ng-if-once="activity.context.noteSafeHtml"
ng-bind-html="activity.context.noteSafeHtml"
></div>
</div>
<div ng-if-once="activityType === 'rebooked-booking'">
<a ng-if-once="activity.context.newBooking"
ng-then="newBooking"
ng-href="[! activity.context.newBooking|bookingUrl !]"
>
Rebooked to <span class="badge badge-booking-pk">#[! activity.context.newBooking.pk !]</span>
</a>
<span ng-else-once="newBooking">
Rebooked this booking
</span>
</div>
<div ng-if-once="activityType === 'imported-booking'">
<span class="booked-at booked-at-online" ng-if-once="instance.userType === 'online' && !instance.affiliation">
<span class="booked-online-icon"></span> <b>Booked online</b>
</span>
<b>Booking imported.</b>
Originally created on [! instance.originalCreatedAt|date !]
</div>
<div ng-if-once="activityType === 'created-voucher'">
Set affiliate:
<div class="activity-content-shaded test-set-affiliate-activity-indicator"
ng-link="activity-changes"
></div>
</div>
<div ng-if-once="activityType === 'changed-voucher'">
Updated affiliate:
<div class="activity-content-shaded"
ng-link="activity-changes"
></div>
</div>
<div ng-if-once="activityType === 'repriced-booking'">
Repriced booking:
<div class="activity-content-shaded"
ng-link="activity-changes"
></div>
</div>
<div ng-if-once="activityType === 'changed-booking-affiliation'">
<div ng-if-once="activity.context.originalAffiliation !== activity.context.newAffiliation">
<span ng-if-once="activity.context.originalAffiliation" ng-then="originalAffiliate">
Changed affiliate from <a ng-href="[! activity.context.originalAffiliation.affiliateCompany.$url(urls.company.index) !]">[! activity.context.originalAffiliation.affiliateCompany.name !]</a> to <b> <a ng-href="[! activity.context.newAffiliation.affiliateCompany.$url(urls.company.index) !]">[! activity.context.newAffiliation.affiliateCompany.name !]</a> </b>
</span>
<span ng-if-once="!originalAffiliate">
Set affiliate to <b> <a ng-href="[! activity.context.newAffiliation.affiliateCompany.$url(urls.company.index) !]">[! activity.context.newAffiliation.affiliateCompany.name !]</a> </b>
</span>
</div>
<div ng-if-once="activity.context.changedVoucherNumber">
<span ng-if-once="activity.context.originalVoucherNumber" ng-then="originalVoucherNumber">
Changed voucher number to <b>[! activity.context.newVoucherNumber !]</b> <span class="fh-grey">(was [! activity.context.originalVoucherNumber !])</span>
</span>
<span ng-if-once="!originalVoucherNumber">
Set voucher number to <b>[! activity.context.newVoucherNumber !]</b>
</span>
</div>
<div ng-if-once="activity.context.newIsBlockable !== activity.context.originalIsBlockable">
<span ng-if-once="activity.context.newIsBlockable" ng-then="newIsBlockable">
Changed to <b>blocking</b> <span class="fh-grey">(was not blocking)</span>
</span>
<span ng-if-once="!newIsBlockable">
Changed to <b>not blocking</b> <span class="fh-grey">(was blocking)</span>
</span>
</div>
</div>
<div ng-if-once="activityType === 'removed-booking-affiliation'">
Removed affiliate <b><a ng-href="[! activity.context.affiliation.affiliateCompany.$url(urls.company.index) !]">[! activity.context.affiliation.affiliateCompany.name !]</a></b>
<br>
Removed voucher number <b>[! activity.context.voucherNumber !]</b>
</div>
<div ng-if-once="activityType === 'changed-booking-voucher-number'">
Changed voucher number to <b>[! activity.context.newVoucherNumber !]</b> <span class="fh-grey">(was [! activity.context.originalVoucherNumber !])</span>
</div>
<div ng-if-once="activityType === 'created-availabilities'">
[! interpolate(nT('Created %(count)s availability', 'Created %(count)s availabilities', activity.context.count), { count: activity.context.count }) !]<span ng-if-once="activity.context.changes && activity.context.changes.length" ng-then="hasChanges">:</span>
<div class="activity-ava"
ng-if-once="hasChanges"
>
<div ng-link="activity-changes"></div>
<div ng-can-create="Availability on instance"
ng-can-only-when="activity.context.tag"
>
<b>Tag:</b> [! activity.context.tag !]
</div>
</div>
<div class="activity-delete"
ng-can-clear="Availability on activity.object"
ng-can-only-when="activity.context.tag"
>
<a ng-click="activitiesCtrl.actions.clearAvailabilitiesByTag(activity.context.tag)"
class="fh-red underline"
>Remove</a>
</div>
</div>
<div ng-if-once="activityType === 'updated-availabilities' || activityType === 'updated-availabilities-single'"
ng-init="
context = activity.context.referenceActivity ? activity.context.referenceActivity.context : activity.context;
previousValues = activity.context.previousValues || {};
"
>
<div ng-if-once="activityType === 'updated-availabilities'">
[! activity.context.update === 'hid-availabilities' ?
interpolate(nT('Removed %(count)s availability:', 'Removed %(count)s availabilities:', activity.context.count), { count: activity.context.count }) :
interpolate(nT('Modified %(count)s availability:', 'Modified %(count)s availabilities:', activity.context.count), { count: activity.context.count })
!]
</div>
<div ng-if-once="activityType === 'updated-availabilities-single'">
<span ng-if-once="context.count > 1" ng-then="hasCount">
<span ng-if="(context.count - 1) === 1" ng-then="singleUpdate">
Modified availability <a class="form-link" ng-href="[! activity.context.referenceActivity.$url(urls.dashboard.overlay.activity.index) !]">(with 1 other)</a>
</span>
<span ng-else="singleUpdate">
Modified availability <a class="form-link" ng-href="[! activity.context.referenceActivity.$url(urls.dashboard.overlay.activity.index) !]">(with [! context.count - 1 !] others)</a>
</span>
</span>
<span ng-else-once="hasCount">
Modified availability <a class="form-link" ng-href="[! activity.context.referenceActivity.$url(urls.dashboard.overlay.activity.index) !]">using updater</a>
</span>
</div>
<div class="activity-ava">
<div ng-if-once="context.customerType">
Type: <b>[! context.type !]</b><br>
Customer type: <b>[! context.customerType.plural !]</b>
</div>
<div ng-if-once="context.update === 'changed-customer-type-rate-total' || context.update === 'rate'">
Old cost: <b>[! context.originalTotal|amount:activity !]</b><br>
New cost: <b>[! context.total|amount:activity !]</b><br>
</div>
<div ng-if-once="context.update === 'changed-times'">
Old starting time: <b>[! context.originalTime !]</b><br>
Old length in hours: <b>[! context.originalHours !]</b><br>
New starting time: <b>[! context.time !]</b><br>
New length in hours: <b>[! context.hours !]</b><br>
</div>
<div ng-if-once="context.update === 'changed-status'">
<div ng-if-once="context.status|isDefined">
Changed <b>status</b> to <b>[! context.status !]</b>
</div>
<div ng-if-once="context.isUnlisted|isBoolean">
<span ng-if-once="context.isUnlisted">
Changed <b>is unlisted</b> to <b>true</b>
</span>
<span ng-else-once="context.isUnlisted">
Changed <b>is unlisted</b> to <b>false</b>
</span>
</div>
</div>
<div ng-if-once="context.update === 'changed-capacity'">
<span ng-if-once="context.capacity === null" ng-then="capacityNull">
Changed <b>total capacity</b> to <b>None</b>
</span>
<span ng-else-once="capacityNull">
Changed <b>total capacity</b> to <b>[!context.capacity !]</b>
</span>
</div>
<div ng-if-once="context.update === 'changed-headline'">
<span ng-if-once="context.headlineField === 'headline_private'" ng-then="headlinePrivate">
Changed <b>private headline</b> to <b>[! context.headline !]</b>
</span>
<span ng-else-once="headlinePrivate">
Changed <b>public headline</b> to <b>[! context.headline !]</b>
</span>
</div>
<div ng-if-once="context.update === 'changed-start-time'">
<span ng-if-once="previousValues.startTime">
Changed <b>start time</b> to <b>[! context.startTime !]</b> <span class="fh-grey">(was [! previousValues.startTime !])</span>
</span>
<span ng-else-once="previousValues.startTime">
Changed <b>start time</b> to <b>[! context.startTime !]</b>
</span>
</div>
<div ng-if-once="context.update === 'changed-hours-long'">
Changed <b>length (hours)</b> to <b>[! context.hours !]</b>
</div>
<div ng-if-once="context.update === 'hid-customer-type-rate'">
Removed customer type <b>[! context.customerPrototype.displayName !]</b>
</div>
<div ng-if-once="context.update === 'created-customer-type-rate'">
<span ng-if="context.capacity|isNumber" ng-then="capacityIsNumber">
Added customer type <b>[! context.customerPrototype.displayName !]</b> with a <b>capacity</b> of <b>[! context.capacity !]</b>
</span>
<span ng-else="capacityIsNumber">
Added customer type <b>[! context.customerPrototype.displayName !]</b>
</span>
</div>
<div ng-if-once="context.update === 'changed-customer-type-rate-capacity'">
<span ng-if-once="context.capacity === null" ng-then="capacityNull">
Changed <b>[! context.customerPrototype.displayName !] capacity</b> to <b>None</b>
</span>
<span ng-else-once="capacityNull">
Changed <b>[! context.customerPrototype.displayName !] capacity</b> to <b>[! context.capacity !]</b>
</span>
</div>
<div ng-if-once="context.update === 'changed-customer-type-rate-party-sizes'">
For <b>[! context.customerPrototype.displayName !]</b><br> Changed <b>minimum party size</b> to <b>[! context.minimumPartySize !]</b><br> Changed <b>maximum party size</b> to <b>[! context.maximumPartySize !]</b>
</div>
<div ng-if-once="context.update === 'changed-pricing'">
For <b>[! context.customerPrototype.displayName !]</b> on sheet <b>[! context.sheet.unicode !]</b>
<br>
<div ng-if-once="context.visibility !== 'unchanged'">
Changed <b>Visibility</b> to <b>[! context.visibility !]</b>
</div>
<div ng-if-once="context.priceType !== 'unchanged'">
Changed <b>Offset</b> to <b ng-amount="context.offset" ng-amount-currency="activity"></b>
<br>
</div>
<div ng-if-once="context.isTaxable !== 'unchanged'">
Changed <b>Taxed</b> to <b>[! (PriceLine.displayTaxable(context.isTaxable)) + (context.isTaxable && context.taxTypeObjects.length ? ':' : '') !]</b> <span ng-if-once="context.taxTypeObjects.length"> <span ng-repeat="taxType in context.taxTypeObjects track by taxType.pk"> [! TaxType.displayName(taxType) !]: [! (PriceLine.displayTaxable(context.taxTypes[taxType.pk])) + ($last ? '' : ',') !] </span> </span>
</div>
<div ng-if-once="context.sheetRateType !== 'unchanged'">
Changed <b>Discount:</b> to <b>[! context.sheetRate|percentage:'hidePlus' !]</b>
</div>
</div>
<div ng-if-once="context.update === 'changed-custom-field-instance-group'">
Changed <b>custom field instance group</b> to <b>[! context.customFieldInstanceGroup|name !]</b>
</div>
<div ng-if-once="context.update === 'changed-requirement-group'">
Changed <b>resource requirements</b> to <b>[! context.requirementGroup|name !]</b>
</div>
<div ng-if-once="context.update === 'changed-default-route' || context.update === 'route'">
Changed <b>default route</b> to <b>[! (context.defaultRoute|name) || context.route.name !]</b>
</div>
<div ng-if-once="context.update === 'changed-booking-restriction'">
Changed <b>booking restriction</b> to <b>[! context.bookingRestriction|name !]</b>
</div>
<div ng-if-once="context.update === 'created-crew-member'">
Added <b>[! (context.role|name) || T('Crew') !]</b>:
<b>[! context.user.name !]</b>
<b ng-if-once="context.note">([! context.note !])</b>
</div>
<div ng-if-once="context.update === 'hid-crew-member'">
Removed <b>[! context.user.name !]</b> from crew
<b ng-if-once="context.role">([! context.role|name !])</b>
</div>
<div ng-if-once="context.update === 'created-blocks'">
Added <b>[! context.affiliation.affiliateCompany.name !]</b> blocks (reserving <b>[! context.reservedCapacity !]</b>)
</div>
<div ng-if-once="context.update === 'hid-blocks'">
Removed <b>[! context.affiliation.affiliateCompany.name !]</b> blocks
</div>
<div ng-if-once="context.update === 'changed-notes'">
Changed <b>availability note</b> to <b>[! context.note !]</b>
</div>
<div class="activity-ava-filters"
ng-if-once="activityType !== 'updated-availabilities-single'"
ng-init="filters = context.filters"
>
<div><span>For these availabilities:</span></div>
<div ng-if-once="context.startAtTime">
Starting time: <b>[! context.startAtTime !]</b>
</div>
<div ng-if-once="context.endAtTime">
Ending time: <b>[! context.endAtTime !]</b>
</div>
<div ng-if-once="context.originalHeadline">
Original headline: <b>[! context.originalHeadline !]</b>
</div>
<div ng-if-once="filters.items">
Items: <b>[! filters.items|names !]</b>
</div>
Starting on: <b>[! filters.startDate !]</b><br>
Ending on: <b>[! filters.endDate !]</b><br>
<div ng-if-once="filters.weekDays">
Week days: <b>[! filters.weekDays !]</b>
</div>
<div ng-if-once="filters.startTimeStart">
Starting time:
<b>[! filters.startTimeStart + (filters.startTimeEnd ? ' - ' + filters.startTimeEnd : '') !]</b>
</div>
<div ng-if-once="filters.endTimeStart">
Ending time:
<b>[! filters.endTimeStart + (filters.endTimeEnd ? ' - ' + filters.endTimeEnd : '') !]</b>
</div>
<div ng-if-once="filters.hours|isNumber">
Length (hours): <b>[! filters.hours !]</b>
</div>
<div ng-if-once="filters.headline|fieldOrBoolean">
Public headline: <b>[! filters.headline|fieldOrBoolean !]</b>
</div>
<div ng-if-once="filters.headlinePrivate|fieldOrBoolean">
Private headline: <b>[! filters.headlinePrivate|fieldOrBoolean !]</b>
</div>
<div ng-if-once="filters.status || context.originalStatus">
Online booking status: <b>[! filters.status || context.originalStatus !]</b>
</div>
<div ng-if-once="filters.isUnlisted|isBoolean">
<span ng-if-once="filters.isUnlisted">
Unlisted status: <b>Unlisted</b>
</span>
<span ng-else-once="filters.isUnlisted">
Unlisted status: <b>Listed</b>
</span>
</div>
<div ng-if-once="(filters.capacity|isNumber) || (context.originalCapacity|isNumber)">
Capacity: <b>[! filters.capacity || context.originalCapacity !]</b>
</div>
<div ng-if-once="filters.defaultRoute|fieldOrBoolean">
Default route: <b>[! filters.defaultRoute|fieldOrBoolean !]</b>
</div>
<div ng-if-once="filters.customFieldInstanceGroup|fieldOrBoolean">
Whole-booking custom fields: <b>[! filters.customFieldInstanceGroup|fieldOrBoolean !]</b>
</div>
<div ng-if-once="filters.requirementGroup|fieldOrBoolean">
Resource requirements: <b>[! filters.requirementGroup|fieldOrBoolean !]</b>
</div>
<div ng-if-once="filters.bookingRestriction|fieldOrBoolean">
<b>Booking restriction:</b> [! filters.bookingRestriction|name !]
</div>
<div ng-if-once="filters.customerPrototype|isDefined">
<div ng-if-once="filters.customerTypeRateCapacity|fieldOrBoolean">
[! filters.customerPrototype.displayName !] capacity:
<b>[! filters.customerTypeRateCapacity|fieldOrBoolean !]</b>
</div>
<div ng-if-once="filters.customerTypeRateMinimumPartySize|fieldOrBoolean">
[! filters.customerPrototype.displayName !] minimum party size:
<b>[! filters.customerTypeRateMinimumPartySize|fieldOrBoolean !]</b>
</div>
<div ng-if-once="filters.customerTypeRateMaximumPartySize|fieldOrBoolean">
[! filters.customerPrototype.displayName !] maximum party size:
<b>[! filters.customerTypeRateMaximumPartySize|fieldOrBoolean !]</b>
</div>
</div>
<div ng-if-once="!(filters.hasBookings|isEmptyFilter)">
Has bookings: <b>[! filters.hasBookings !]</b>
</div>
<div ng-if-once="!(filters.crewUser|isEmptyFilter)">
Crew member: <b>[! filters.crewUser|name !]</b>
</div>
<div ng-if-once="!(filters.crewRole|isEmptyFilter)">
Crew role: <b>[! filters.crewRole|name !]</b>
</div>
</div>
</div>
</div>
<div ng-if-once="activityType === 'updated-availability-rate'">
Changed rate for [! activity.context.customerType.name !] to <span ng-amount="activity.context.total" ng-amount-currency="activity"></span> <span class="fh-grey">(was <span ng-amount="activity.context.originalTotal" ng-amount-currency="activity"></span>)</span>
</div>
<div ng-if-once="activityType === 'hid-availability'">
<b>Removed availability</b> for [! instance.startAt|datetimeRange:(instance.endAt) !]
<a ng-toggle ng-toggle-value="'showChanges' + activity.pk"
class="form-link"
><span class="hide-when-toggled">(Show details)</span><span class="show-when-toggled">(Hide details)</span></a>
<div class="activity-ava"
ng-toggled ng-toggled-value="'showChanges' + activity.pk"
>
<ul>
<li><b>Capacity:</b> [! instance.capacity === null ? T('None') : instance.capacity !]</li>
<li><b>Customer types:</b>
<span ng-repeat="customerTypeRate in instance.customerTypeRates">[! customerTypeRate.customerPrototype.customerType.plural !]<span ng-if="customerTypeRate.capacity">
(Max: [! customerTypeRate.capacity !])</span><span ng-if="!$last">, </span></span>
</li>
<li ng-if="instance.headline"><b>Headline:</b> [! instance.headline !]</li>
<li ng-if="instance.headlinePrivate"><b>Private headline:</b> [! instance.headlinePrivate !]</li>
<li ng-if="instance.customFieldInstanceGroup"><b>Custom fields group:</b> [! instance.customFieldInstanceGroup.name !]</li>
<li ng-if="instance.requirementGroup"><b>Requirements:</b> [! instance.requirementGroup.shortName !]</li>
</ul>
</div>
</div>
<div ng-if-once="activityType === 'hid-availabilities'">
Removed <b>[! activity.context.count !]</b> availabilities
</div>
<div ng-if-once="activityType === 'created-line-item'"
ng-init="changes = Activity.changesByFieldName(activity)"
>
<div ng-if-once="changes.isTaxable">
Added
<span ng-amount="changes.offset.newValue" ng-amount-company="instance.company" class="badge"></span>
<span class="fh-grey">(taxed)</span> for [! changes.description.newValue !]
</div>
<div ng-if-once="!changes.isTaxable">
Added
<span ng-amount="changes.offset.newValue" ng-amount-company="instance.company" class="badge"></span>
<span class="fh-grey">(not taxed)</span> for [! changes.description.newValue !]
</div>
</div>
<div ng-if-once="activityType === 'hid-line-item'">
<div ng-if-once="changes.isTaxable">
Removed
<span ng-amount="instance.offset" ng-amount-company="instance.company" class="badge"></span>
<span class="fh-grey">(taxed)</span> for [! instance.description !]
</div>
<div ng-if-once="!changes.isTaxable">
Removed
<span ng-amount="instance.offset" ng-amount-company="instance.company" class="badge"></span>
<span class="fh-grey">(taxed)</span> for [! instance.description !]
</div>
</div>
<div ng-if-once="activityType === 'transferred-line-item'">
<p class="activity-move-note">
Copied from booking <a ng-href="[! activity.context.originalBooking|bookingUrl !]" class="badge badge-booking-pk"> #[! activity.context.originalBooking.pk !] </a>:
</p>
<span class="badge" ng-amount="instance.offset" ng-amount-company="instance.company"></span> for <b>[! instance.description !]</b>
</div>
<div ng-if-once="activityType === 'duplicated-custom-field'">
Duplicated <a ng-href="[! activity.context.originalCustomField.$url(urls.dashboard.settings.customFields.customField) !]">[! activity.context.originalCustomField.name !]</a>
</div>
<div ng-if-once="activityType === 'created-extended-option'">
Added option:
<div class="activity-ava"
ng-if-once="activity.context.changes && activity.context.changes.length"
ng-link="activity-changes"
></div>
</div>
<div ng-if-once="activityType === 'hid-extended-option'">
Removed <b>[! instance.name !]</b> option
</div>
<div ng-if-once="activityType === 'created-custom-field-instances'">
[! interpolate(nT('Added %(count)s custom field', 'Added %(count)s custom fields', activity.context.count), { count: activity.context.count }) !]
</div>
<div ng-if-once="activityType === 'created-custom-field-instance'">
<span ng-if-once="activity.context.object.cls == CustomFieldInstanceGroup.cls" ng-then="forInstanceGroup">
Added <b><a ng-href="[! activity.context.customFieldInstance.customField.$url(urls.dashboard.settings.customFields.customField) !]"> [! activity.context.customFieldInstance.customField.name !] </a></b> to [! activity.context.object.name !]
</span>
<span ng-else="forInstanceGroup">
Added <b><a ng-href="[! activity.context.customFieldInstance.customField.$url(urls.dashboard.settings.customFields.customField) !]"> [! activity.context.customFieldInstance.customField.name !] </a></b> to <b ng-link="customer-prototype-name" ng-with="customerPrototype = activity.context.object"></b>
</span>
</div>
<div ng-if-once="activityType === 'sent-email'"
class="test-sent-email-activity-indicator"
>
<span ng-if-once="activity.context.notification.type == 'booking-share' || activity.context.isFromCustomer" ng-then="isFromCustomer">
<span ng-if-once="activity.context.noteSafeHtml">
Customer sent [! activity.context.which !] email from receipt page with a message
</span>
<span ng-if-once="!activity.context.noteSafeHtml">
Customer sent [! activity.context.which !] email from receipt page
</span>
</span>
<span ng-else="isFromCustomer">
<span ng-if-once="activity.context.email">
<span ng-if-once="activity.context.noteSafeHtml" class="test-sent-email-with-note-indicator">
Sent [! activity.context.which !] email to <b>[! activity.context.email !]</b> with a message:
</span>
<span ng-if-once="!activity.context.noteSafeHtml">
Sent [! activity.context.which !] email to <b>[! activity.context.email !]</b>
</span>
</span>
<span ng-if-once="activity.context.addresses">
<span ng-if="activity.context.addresses.length > 2" ng-then="countOnly"
ng-hide="toggles.state('showActivityEmailAddresses')"
>
<span ng-if-once="activity.context.noteSafeHtml">
Sent [! activity.context.which !] email to <a class="fh-blue underline hide-when-toggled" ng-toggle="showActivityEmailAddresses">[[ activity.context.addresses.length ]] addresses</a> with a message:
</span>
<span ng-if-once="!activity.context.noteSafeHtml">
Sent [! activity.context.which !] email to <a class="fh-blue underline hide-when-toggled" ng-toggle="showActivityEmailAddresses">[[ activity.context.addresses.length ]] addresses</a>
</span>
</span>
<span ng-if="!countOnly || toggles.state('showActivityEmailAddresses')">
<span ng-if-once="activity.context.noteSafeHtml">
Sent [! activity.context.which !] email to
<span ng-repeat="address in activity.context.addresses">
<b>[! address !]</b><span ng-if="!$last">,</span>
</span>
with a message:
</span>
<span ng-if-once="!activity.context.noteSafeHtml">
Sent [! activity.context.which !] email to
<span ng-repeat="address in activity.context.addresses">
<b>[! address !]</b><span ng-if="!$last">,</span>
</span>
</span>
</span>
</span>
<div class="activity-sent-email-note activity-note-content prose prose--small"
ng-if-once="activity.context.noteSafeHtml"
ng-bind-html="activity.context.noteSafeHtml"
></div>
</span>
<div ng-if-once="
!!activity.context.notification.status &&
activity.context.notification.status !== 'unknown'
">
<ul class="activity-timeline">
<span ng-if-once="
activity.context.notification.status === 'processed' ||
activity.context.notification.status === 'deferred'
">
<li class="active">Sent</li>
<li>Delivered</li>
<li>Opened</li>
</span>
<span ng-if-once="activity.context.notification.status === 'delivered'">
<li class="active">Sent</li>
<li class="active">Delivered</li>
<li>Opened</li>
</span>
<span ng-if-once="
activity.context.notification.status === 'open' ||
activity.context.notification.status === 'click'
">
<li class="active">Sent</li>
<li class="active">Delivered</li>
<li class="active">Opened<span class="respond-print-show" ng-if-once="Notification.isOpened(activity.context.notification.status)">[! activity.context.notification.modifiedAt|datetime !]</span></li>
</span>
<span ng-if-once="activity.context.notification.status === 'bounce'">
<li class="active">Sent</li>
<li class="active error"
ng-tip="[! T('Email address may be incorrect') !]"
ng-tip-location=".icon-hint"
>Delivery failed <span class="icon-hint white"></span></li>
</span>
<span ng-if-once="activity.context.notification.status === 'dropped'">
<li class="active">Sent</li>
<li class="active error"
ng-tip="[! T('Email address may be incorrect, or the recipient may have unsubscribed, or marked a previous email as spam') !]"
ng-tip-location=".icon-hint"
>Delivery failed <span class="icon-hint white"></span></li>
</span>
<span ng-if-once="activity.context.notification.status === 'spamreport'">
<li class="active">Sent</li>
<li class="active">Delivered</li>
<li class="active error"
ng-tip="[! T('Future messages sent to this address will not be delivered') !]"
ng-tip-location=".icon-hint"
>Customer marked as spam <span class="icon-hint white"></span></li>
</span>
<span ng-if-once="activity.context.notification.status === 'unsubscribe'">
<li class="active">Sent</li>
<li class="active">Delivered</li>
<li class="active error"
ng-tip="[! T('Future messages sent to this address will not be delivered') !]"
ng-tip-location=".icon-hint"
>Customer unsubscribed <span class="icon-hint white"></span></li>
</span>
</ul>
</div>
</div>
<div ng-if-once="activityType === 'sent-sms' || activityType === 'rejected-sms'">
Sent text message to <b>[[ activity.context.smsNotification.number|phone ]]</b>:
<div class="activity-sms-bubble">[[ activity.context.smsNotification.body ]]</div>
<div class="activity-sms-status">
[[ activity.context.smsNotification.displayStatus ]]
<span ng-if-once="activity.context.smsNotification.error">
(Error: [[ activity.context.smsNotification.displayError ]])
</span>
</div>
</div>
<div ng-if-once="activityType === 'sent-mass-sms'" ng-init="groups=SmsNotification.groupByStatus(activity.context.smsNotifications)">
Sent multiple SMS messages
<div ng-repeat="group in groups" class="m-t-5">
<span ng-show="(group.items.length >= 3) && !toggles.state(group.status + '-sms-' + activity.pk)">
<span class="badge badge-sms-[! group.status !]">[! group.displayStatus !]</span>
to <span class="fh-blue underline pointer hide-when-toggled" ng-toggle ng-toggle-value="group.status + '-sms-' + activity.pk"> [! group.items.length !] numbers </span>
</span>
<span ng-toggled
ng-toggled-value="group.status + '-sms-' + activity.pk"
ng-toggled-always-when="group.items.length < 3"
>
<span class="badge badge-sms-[! group.status !]">[! group.displayStatus !]</span>
to
<span ng-repeat="sms in group.items">
<b>[! sms.booking.contact.name !]</b> <span class="fh-grey">[! sms.number|phone !]</span><span ng-if-once="!$last">,</span>
</span>
</span>
</div>
<div class="activity-sms-bubble activity-sms-bubble-initial">[! activity.context.message !]</div>
</div>
<div ng-if-once="activityType === 'sent-review-express-mapping'">
<div>
<i class="icon-tripadvisor-logo"></i>
</div>
Sent Review Express mapping
</div>
<div ng-if-once="activityType === 'sent-review-express-request'">
<div>
<i class="icon-tripadvisor-logo"></i>
</div>
Sent TripAdvisor Review Express email to <b>[[ activity.context.email ]]</b>
</div>
<div ng-if-once="activityType === 'note' && activity.context.textSafeHtml"
class="test-note-activity-indicator prose prose--small"
ng-bind-html="activity.context.textSafeHtml"
></div>
<div ng-if-once="activityType === 'note' && !activity.context.textSafeHtml"
class="test-note-activity-indicator"
>
[! activity.context.text !]
</div>
<div ng-if-once="activityType === 'transferred-note'" class="test-transferred-note-activity-indicator">
<p class="activity-move-note">
Copied from booking <a ng-href="[! activity.context.originalBooking|bookingUrl !]" class="badge badge-booking-pk"> #[! activity.context.originalBooking.pk !] </a>:
</p>
<div ng-if-once="activity.context.originalActivity.context.textSafeHtml"
ng-bind-html="activity.context.originalActivity.context.textSafeHtml"
></div>
<div ng-if-once="!activity.context.originalActivity.context.textSafeHtml">
[! activity.context.originalActivity.context.text !]
</div>
<p class="activity-note-created">
<span ng-if-once="activity.context.originalActivity.user" ng-then="originalActivity">
Created by <a ng-href="[! activity.context.originalActivity.user.$url(urls.dashboard.settings.users.user.index) !]">[! activity.context.originalActivity.user.name !]</a> on [! activity.context.originalActivity.createdAt|datetime !]
</span>
<span ng-else="originalActivity">
Created on [! activity.context.originalActivity.createdAt|datetime !]
</span>
</p>
</div>
<div ng-if-once="activityType === 'verified-bank-account'">
Verified <b>[! activity.context.bankAccount.unicode !]</b>
</div>
<div ng-if-once="activityType === 'hide-item'">
Removed <b>[! instance.name !]</b>
</div>
<div ng-if-once="activityType === 'hid-runs'">
<span ng-if-once="activity.context.count === 1" ng-then="singularActivity">
Removed 1 run associated with <b>[! instance.name !]</b>
</span>
<span ng-else-once="singularActivity">
Removed [! activity.context.count !] runs associated with <b>[! instance.name !]</b>
</span>
</div>
<div ng-if-once="activityType === 'subscribed-to-notifications' || activityType === 'unsubscribed-from-notifications'">
<span ng-if-once="activity.context.item">
<span ng-if-once="activityType === 'subscribed-to-notifications'">
Subscribed to <b>[! activity.context.type !]</b> notifications for <b>[! activity.context.item|name !]</b>
</span>
<span ng-if-once="activityType === 'unsubscribed-from-notifications'">
Unsubscribed from <b>[! activity.context.type !]</b> notifications for <b>[! activity.context.item|name !]</b>
</span>
</span>
<span ng-else-once="activity.context.item">
<span ng-if-once="activityType === 'subscribed-to-notifications'">
Subscribed to <b>[! activity.context.type !]</b> notifications
</span>
<span ng-if-once="activityType === 'unsubscribed-from-notifications'">
Unsubscribed from <b>[! activity.context.type !]</b> notifications
</span>
</span>
<div ng-if-once="activity.context.isAffiliate|isDefined">
<b>Affiliate bookings:</b> [! activity.context.isAffiliate !]
</div>
<div ng-if-once="activity.context.isDirect|isDefined">
<b>Direct bookings:</b> [! activity.context.isDirect !]
</div>
<div ng-if-once="activity.context.isOnline|isDefined">
<b>Online bookings:</b> [! activity.context.isOnline !]
</div>
<div ng-if-once="activity.context.isRebooked|isDefined">
<b>Rebooked bookings:</b> [! activity.context.isRebooked !]
</div>
<div ng-if-once="activity.context.isForCrewAvailabilitiesOnly|isDefined">
<b>Crew availabilities only:</b> [! activity.context.isForCrewAvailabilitiesOnly !]
</div>
<div ng-if-once="activity.context.isForOnlineBookingsOnly|isDefined">
<b>Online bookings only:</b> [! activity.context.isForOnlineBookingsOnly !]
</div>
<div ng-if-once="activity.context.hoursBefore|isDefined">
<b>Hours before:</b> [! activity.context.hoursBefore !]
</div>
</div>
<div ng-if-once="activityType === 'changed-subscription'">
<span ng-if-once="activity.context.item">
Updated subscription to <b>[! activity.context.type !]</b> notifications for <b>[! activity.context.item|name !]</b>
</span>
<span ng-else-once="activity.context.item">
Updated subscription to <b>[! activity.context.type !]</b> notifications
</span>
<ul class="activity-changes">
<li class="activity-change" ng-repeat="change in activity.context.changes">
<b>
<span ng-if-once="change.fieldName === 'is_affiliate'">Affiliate bookings:</span>
<span ng-if-once="change.fieldName === 'is_direct'">Direct bookings:</span>
<span ng-if-once="change.fieldName === 'is_online'">Online bookings:</span>
<span ng-if-once="change.fieldName === 'is_rebooked'">Rebooked bookings:</span>
<span ng-if-once="change.fieldName === 'is_for_crew_availabilities_only'">Crew availabilities only:</span>
<span ng-if-once="change.fieldName === 'is_for_online_bookings_only'">Online bookings only:</span>
<span ng-if-once="change.fieldName === 'hours_before'">Hours before:</span>
</b>
<span class="fh-grey">[! change.newValue !] (was [! change.originalValue !])</span>
</li>
</ul>
</div>
<div ng-if-once="activityType === 'updated-sms-notification-status'">
Updated status of [! instance.displayType !] SMS notification (recipient <b>[! instance.toNumber !]</b>) to [! activity.context.newDisplayStatus !] (was [! activity.context.originalDisplayStatus !])
</div>
<div ng-if-once="activityType === 'duplicated-route'">
Duplicated <a ng-href="[! activity.context.originalRoute.$url(urls.dashboard.settings.routes.route) !]">[! activity.context.originalRoute.name !]</a>
</div>
<div ng-if-once="activityType === 'created-transportation-option'">
Added <b>[! instance.location !]</b>
</div>
<div ng-if-once="activityType === 'hid-transportation-option'">
Removed <b>[! instance.location !]</b>
</div>
<div ng-if-once="activityType === 'generated-report'">
[! activity.context.text !]
</div>
<div ng-if-once="activityType === 'ran-report'">
<b>[! instance.displayType !]</b> for [! instance.company.name !]
</div>
<div ng-if-once="activityType === 'stripe-error'">
<div>
Error: [! activity.context.message !]
</div>
<div>
[! (activity.context.cardType || activity.context.processorBasedType)|capitalize !] &mdash; [! activity.context.cardLast4 || activity.context.processorBasedIdentifier !]
</div>
</div>
<div ng-if-once="activityType === 'card-error'">
<div class="fh-red">
[! activity.context.description !]
</div>
<div>
[! (activity.context.cardType || activity.context.processorBasedType)|capitalize !] &mdash; [! activity.context.cardLast4 || activity.context.processorBasedIdentifier !]
</div>
</div>
<div ng-if-once="activityType === 'processor-webhook-error'">
<b>Processor type:</b> [! activity.context.processorType !]
<div class="fh-red">
[! activity.context.description !]
</div>
</div>
<div ng-if-once="activityType === 'created-codes'">
<span ng-if-once="activity.context.type === 'enter'">
<span ng-if-once="activity.context.codeCount === 1" ng-then="singularCode">
Entered <b>1</b> code
</span>
<span ng-else-once="singularCode">
Entered <b>[! activity.context.codeCount !]</b> codes
</span>
</span>
<span ng-if-once="activity.context.type === 'create'">
<span ng-if-once="activity.context.codeCount === 1" ng-then="singularCode">
Generated <b>1</b> code
</span>
<span ng-else-once="singularCode">
Generated <b>[! activity.context.codeCount !]</b> codes
</span>
</span>
<div class="activity-delete"
ng-can-only-when="activity.context.tag"
ng-can-clear="Code on activity.object"
>
<a ng-click="activitiesCtrl.actions.clearCodesByTag(activity.context.tag)"
class="fh-red underline"
ng-if-once="activitiesCtrl.isCampaignPage"
ng-confirm-click="[! T('Are you sure you want to remove these codes?') + '\n\n' + T('Codes attached to bookings will not be removed.') !]"
>
Remove
</a>
</div>
</div>
<div ng-if-once="activityType === 'deleted-codes'">
[! interpolate(nT('Deleted %(count)s code', 'Deleted %(count)s codes', activity.context.codeCount ), { count: activity.context.codeCount }) !]
</div>
<div ng-if-once="activityType === 'created-stored-value-cards'"
ng-with="cardsCount = (activity.context.codes ? activity.context.codes.length : activity.context.count)"
>
<span ng-if-once="cardsCount === 1">
<span ng-if-once="activity.context.type === 'simple'">
Generated <b>1</b> gift card
</span>
<span ng-if-once="activity.context.type === 'advanced'">
Imported <b>1</b> gift card
</span>
</span>
<span ng-if-once="cardsCount !== 1">
<span ng-if-once="activity.context.type === 'simple'">
Generated <b>[! cardsCount !]</b> gift cards
</span>
<span ng-if-once="activity.context.type === 'advanced'">
Imported <b>[! cardsCount !]</b> gift cards
</span>
</span>
</div>
<div ng-if-once="activityType === 'updated-tags'">
<ul class="activity-changes activity-content-shaded">
<li class="activity-change"
ng-if-once="activity.context.added.length > 0"
>
Added <b>tags:</b>
<span ng-repeat="tag in activity.context.added">
[! tag.name + ($last ? '' : ',') !]
</span>
</li>
<li class="activity-change"
ng-if-once="activity.context.removed.length > 0"
>
Removed <b>tags:</b>
<span ng-repeat="tag in activity.context.removed">
[! tag.name + ($last ? '' : ',') !]
</span>
</li>
</ul>
</div>
<div ng-if-once="activityType === 'changed-card-affiliation'">
<ul class="activity-changes">
<li class="activity-change" ng-repeat="change in activity.context.changes">
Changed card affiliation settings for <b>[! change.affiliationCompanyName !]</b>
<ul class="activity-ava activity-changes">
<li class="activity-change" ng-repeat="field in change.fields">
Set <b>[! field[0] !]</b> to <b>[! field[2] !]</b> <span class="fh-grey">(was <b>[! field[1] !]</b>)</span>
</li>
</ul>
</li>
</ul>
</div>
<div ng-if-once="activityType === 'created-upload'">
<span ng-if-once="
auth.permissions.can('viewAmounts', instance.company) ||
auth.permissions.can('viewAmounts', instance.bankAccount.company)"
ng-then="canViewAmounts"
>
Created bank debit for <span ng-amount="instance.total" ng-amount-currency="instance.company" class="badge badge-paid"></span>
</span>
<span ng-else-once="canViewAmounts">Created bank debit</span>
<span ng-processor-identifier></span>
<div class="activity-content-shaded"
ng-link="activity-changes"
></div>
<ul class="activity-timeline"
ng-link="activity-upload-status"
ng-with="upload = instance"
></ul>
</div>
<div ng-if-once="activityType === 'retried-upload'">
Retried bank debit
<span ng-processor-identifier ng-processor-identifier-identifier="activity.context.processorIdentifier"></span>
</div>
<div ng-if-once="activityType === 'created-payout'">
<b>Payout created</b> for
<span ng-amount="instance.total" ng-amount-company="instance.company" class="badge [! (instance.total > 0)|addClassIf:'badge-paid' !]"></span>
<span ng-processor-identifier
ng-processor-identifier-identifier="activity.context.processorIdentifier"
></span>
</div>
<div ng-if-once="activityType === 'retried-payout'">
Retried payout
<span ng-processor-identifier
ng-processor-identifier-identifier="activity.context.processorIdentifier"
></span>
</div>
<div ng-if-once="activityType === 'created-invoice'">
Created invoice for <b>[! instance.affiliation.affiliateCompany.name !]</b> for [! activity.context.offset|abs|amount:activity !]
</div>
<div ng-if-once="activityType === 'changed-invoice-price'">
<span ng-if-once="activity.context.explicitInvoicePrice" ng-then="removedExplicitInvoiceTotal">
<span ng-if-once="!activity.context.previousExplicitInvoicePrice">
Set <b>invoice price</b> to <b>[! activity.context.explicitInvoicePrice|amount:activity !]</b>
</span>
<span ng-if-once="activity.context.previousExplicitInvoicePrice">
Set <b>invoice price</b> to <b>[! activity.context.explicitInvoicePrice|amount:activity !]</b> <span class="fh-grey">(was [! activity.context.previousExplicitInvoicePrice|amount:activity !])</span>
</span>
</span>
<span ng-else="removedExplicitInvoiceTotal">
Removed <b>set invoice price</b> <span class="fh-grey">(was [! activity.context.previousExplicitInvoicePrice|amount:activity !])</span>
</span>
</div>
<div ng-if-once="activityType === 'price-line-created' || activityType === 'price-line-changed'"
ng-with="changes = Activity.changesByFieldName(activity)"
>
<div ng-show="instance !== activity.object">
For <b>[[ instance.object.name || instance.object.displayName || instance.object.customField.name || instance.object.title || instance.object.unicode ]]</b> on <b>[[ instance.sheet.displayName ]]</b> sheet:
</div>
<fieldset ng-disabled="true" class="updater-price-form-wrap">
<div class="table valign-middle price-form-columns table-dont-respond">
<div class="tr">
<div class="td vis" ng-if-once="instance.sheet.cls === TotalSheet.cls">
<h2 class="price-col-header">Visibility</h2>
</div>
<div class="td price">
<h2 class="price-col-header">Price</h2>
</div>
<div class="td taxes">
<h2 class="price-col-header">Tax</h2>
</div>
<div class="td discount"
ng-if-once="instance.sheet.cls === InvoiceSheet.cls || instance.company.features.isTotalSheetDiscountsEnabled"
>
<h2 class="price-col-header">
<span ng-if-once="instance.sheet.cls === TotalSheet.cls">
Discount
</span>
<span ng-if-once="instance.sheet.cls === InvoiceSheet.cls">
Commission
</span>
</h2>
</div>
</div>
</div>
<div class="table price-form-columns valign-top table-dont-respond">
<div class="tr">
<div class="td vis" ng-if-once="instance.sheet.cls === TotalSheet.cls">
<div class="price-col-inner">
<div class="field field-price-line-type">
<select>
<option>[! changes.visibility.newValue|capitalize !]</option>
</select>
</div>
<div ng-if-once="changes.visibility.newValue === 'visible'">
<div ng-if-once="!!changes.isRequired">
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-checked="changes.isRequired.newValue"
>
</span>
<span class="label-text">
[! !!changes.isRequired.originalValue ? interpolate(T('Require an answer (was %(originalValue)s)'), { originalValue: changes.isRequired.originalValue }) : T('Require an answer') !]
</span>
</span>
</label>
</div>
</div>
<div ng-if-once="!!changes.isHiddenOnReceipts">
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-checked="changes.isHiddenOnReceipts.newValue"
>
</span>
<span class="label-text">
[! !!changes.isHiddenOnReceipts.originalValue ? interpolate(T('Hide on receipts (was %(originalValue)s)'), { originalValue: changes.isHiddenOnReceipts.originalValue }) : T('Hide on receipts') !]
</span>
</span>
</label>
</div>
</div>
<div ng-if-once="!!changes.isHiddenWhenBooking">
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-checked="changes.isHiddenWhenBooking.newValue"
>
</span>
<span class="label-text">
[! !!changes.isHiddenWhenBooking.originalValue ? interpolate(T('Hide when booking (was %(originalValue)s)'), { originalValue: changes.isHiddenWhenBooking.originalValue }) : T('Hide when booking') !]
</span>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div class="td price">
<div class="price-col-inner">
<div class="field field-price-line-type">
<select>
<option>[! changes.priceType.newValue|capitalize !]</option>
</select>
</div>
<div ng-if-once="changes.priceType.newValue !== 'inherit'">
<span ng-if-once="changes.modifierType.newValue === 'set'">
Set to <b>[! changes.modifierKind.newValue === 'offset' ? (changes.offset.newValue|amount:activity) : (changes.rate.newValue|percentage) !]</b>
<span ng-if-once="
changes.priceType.originalValue !== 'inherit' &&
(!!changes.offset.originalValue || !!changes.rate.originalValue) &&
(changes.offset.originalValue !== changes.offset.newValue || changes.rate.originalValue !== changes.rate.newValue)
"
class="fh-grey"
>
(was [! changes.modifierKind.newValue === 'offset' ? (changes.offset.originalValue|amount:activity) : (changes.rate.originalValue|percentage) !])
</span>
</span>
<span ng-if-once="changes.modifierType.newValue === 'adjust'">
Adjust by <b>[! changes.modifierKind.newValue === 'offset' ? (changes.offset.newValue|amount:activity) : (changes.rate.newValue|percentage) !]</b>
<span ng-if-once="
changes.priceType.originalValue !== 'inherit' &&
(!!changes.offset.originalValue || !!changes.rate.originalValue) &&
(changes.offset.originalValue !== changes.offset.newValue || changes.rate.originalValue !== changes.rate.newValue)
"
class="fh-grey"
>
(was [! changes.modifierKind.newValue === 'offset' ? (changes.offset.originalValue|amount:activity) : (changes.rate.originalValue|percentage) !])
</span>
</span>
<div ng-if-once="!!changes.customTax && changes.customTax.newValue !== changes.customTax.originalValue"
class="field field-price-line-type"
>
<select>
<option>[! PriceLine.displayCustomTax(changes.customTax.newValue) !]</option>
</select>
</div>
<div ng-if-once="!!changes.taxInclusion && changes.taxInclusion.newValue !== changes.taxInclusion.originalValue"
class="field field-price-line-type"
>
<select>
<option>[! PriceLine.displayTaxInclusion(changes.taxInclusion.newValue) !]</option>
</select>
</div>
</div>
</div>
</div>
<div class="td taxes">
<div class="price-col-inner">
<div class="field field-price-line-type"
ng-if-once="instance.object.cls !== Item.cls"
>
<select>
<option>[! PriceLine.displayTaxable(changes.isTaxable.newValue) !]</option>
</select>
</div>
<div ng-if-once="changes.taxTypes && activity.context.taxTypes">
<div class="field"
ng-repeat="taxType in activity.context.taxTypes track by taxType.pk"
>
[! TaxType.displayName(taxType) !]
<br>
<select>
<option>[! PriceLine.displayTaxable(changes.taxTypes.newValue[taxType.pk]) !]</option>
</select>
<span ng-if-once="changes.taxTypes.newValue[taxType.pk] !== changes.taxTypes.originalValue[taxType.pk]"
class="fh-grey"
>
(was [! PriceLine.displayTaxable(changes.taxTypes.originalValue[taxType.pk]) !])
</span>
</div>
</div>
</div>
</div>
<div class="td discount"
ng-if-once="instance.sheet.cls === InvoiceSheet.cls || instance.company.features.isTotalSheetDiscountsEnabled"
>
<div class="price-col-inner">
<div class="field field-price-line-type">
<select>
<option>[! changes.sheetRateType.newValue|capitalize !]</option>
</select>
</div>
<div ng-if-once="!!changes.sheetRate && changes.sheetRateType.newValue !== 'inherit'">
<b ng-if-once="instance.sheet.cls === TotalSheet.cls">
[! TotalSheet.displaySheetRate(changes.sheetRate.newValue)|percentage !]
<span ng-if-once="
changes.sheetRateType.originalValue !== 'inherit' &&
!!changes.sheetRate.originalValue &&
changes.sheetRate.originalValue !== changes.sheetRate.newValue"
class="fh-grey"
>
(was [! TotalSheet.displaySheetRate(changes.sheetRate.originalValue)|percentage !])
</span>
</b>
<b ng-if-once="instance.sheet.cls === InvoiceSheet.cls">
[! InvoiceSheet.displaySheetRate(changes.sheetRate.newValue, instance.sheet.relationship)|percentage:'hidePlus' !]
<span ng-if-once="
changes.sheetRateType.originalValue !== 'inherit' &&
!!changes.sheetRate.originalValue &&
changes.sheetRate.originalValue !== changes.sheetRate.newValue"
class="fh-grey"
>
(was [! InvoiceSheet.displaySheetRate(changes.sheetRate.originalValue, instance.sheet.relationship)|percentage:'hidePlus' !])
</span>
</b>
</div>
</div>
</div>
</div>
</div>
</fieldset>
</div>
<div ng-if-once="activityType === 'duplicated-sheet'">
Duplicated <a ng-href="[! activity.context.originalSheet.$url() !]">[! activity.context.originalSheet.displayName !]</a>
</div>
<div ng-if-once="activityType === 'hid-waiver-instance'">
Removed waiver
<span class="fh-grey">
(<a ng-href="[! instance.redirectUrl !]" ng-outbound-link="_blank" class="underline">View PDF</a>)
</span>
<div class="activity-content-shaded">
<div ng-repeat="participant in instance.participants">
<div>
[! participant.name !]
<span ng-if-once="!!participant.email">(<a ng-href="mailto:[! participant.email !]">[! participant.email !]</a>)</span>
</div>
<div ng-if-once="participant.dobAt">
<div ng-if-once="participant.isAgeVerified">
Age verified
</div>
<div ng-if-once="!participant.isAgeVerified">
[!
interpolate(nT('%(count)s year old', '%(count)s years old', participant.ageInYears), { count: participant.ageInYears })
!]
<span class="fh-grey">([! participant.dobAt|date !])</span>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="activityType === 'message'">
[! activity.context.text !]
</div>
<div ng-if-once="activityType === 'reordered'">
Reordered <span ng-if-once="instance.unicode">[! instance.unicode !]</span>
</div>
<div ng-if-once="activityType === 'created'">
<span ng-if-once="activity.context.changes && activity.context.changes.length" ng-then="hasChanges">
Created <b>[! instance.unicode !]</b>:
</span>
<span ng-else-once="hasChanges">
Created <b>[! instance.unicode !]</b>
</span>
<div class="activity-ava" ng-if-once="hasChanges"
ng-link="activity-changes"
></div>
<div ng-if-once="activity.context.referenceActivity">
<a class="form-link"
ng-href="[! activity.context.referenceActivity.$url(urls.dashboard.overlay.activity.index) !]"
>Details</a>
</div>
</div>
<div ng-if-once="activityType === 'multi-created'">
<span ng-if-once="activity.context.displayName">
<span ng-if-once="activity.context.count === 1" ng-then="singularActivity">
Added <b>1</b> [! activity.context.displayName !] to [! activity.object.unicode !]
</span>
<span ng-else-once="singularActivity">
Added <b>[! activity.context.count !]</b> [! activity.context.displayName + 's' !] to [! activity.object.unicode !]
</span>
</span>
<span ng-if-once="!activity.context.displayName">
<span ng-if-once="activity.context.count === 1" ng-then="singularActivity">
Added <b>1</b> object to [! activity.object.unicode !]
</span>
<span ng-else-once="singularActivity">
Added <b>[! activity.context.count !]</b> objects to [! activity.object.unicode !]
</span>
</span>
<div class="activity-content-shaded">
[!
(activity.context.summary|commaSeparated) + (
activity.context.count > activity.context.summary.length ?
(' + ' + (interpolate(T('%(count)s more.'), { count: (activity.summary.count - activity.context.summary.length) })) ) : ''
)
!]
</div>
</div>
<div ng-if-once="Activity.isChangedType(activityType)">
<div ng-show="instance !== activity.object && instance.unicode">
For <b>[! instance.unicode !]</b>:
</div>
<div class="activity-content-shaded" ng-link="activity-changes"></div>
</div>
<div ng-if-once="activityType === 'aggregate'">
<div ng-link="activity-changes"></div>
</div>
<div ng-if-once="activityType === 'deleted' || activityType === 'hid' || activityType === 'disabled'">
Removed <b>[! instance.unicode !]</b>
</div>
<div ng-if-once="activityType === 'reapplied-resources'">
Reapplied resource uses
<a ng-toggle ng-toggle-value="activity.pk"
class="form-link"
>
<span class="hide-when-toggled">Show changes</span><span class="show-when-toggled">Hide changes</span>
</a>
<div ng-toggled
ng-toggled-value="activity.pk"
>
<div ng-resource-use-table
resource-uses="activity.context.originalResourceUses"
to-resource-uses="activity.context.updatedResourceUses"
></div>
</div>
</div>
<div ng-if-once="activityType == 'duplicated-x-companies-single'">
<span ng-if="activity.context.referenceActivity.context.count > 1" ng-then="multipleActivities">
<span ng-if-once="(context.count - 1) === 1" ng-then="singularContext">
Duplicated <b>[! activity.object.unicode !]</b> from <b>[! activity.context.sourceCompany.unicode !]</b> <a class="form-link" ng-href="[! activity.context.referenceActivity.$url(urls.dashboard.overlay.activity.index) !]" ng-init="context = activity.context.referenceActivity.context">with [! context.count - 1 !] other</a>
</span>
<span ng-then="singularContext">
Duplicated <b>[! activity.object.unicode !]</b> from <b>[! activity.context.sourceCompany.unicode !]</b> <a class="form-link" ng-href="[! activity.context.referenceActivity.$url(urls.dashboard.overlay.activity.index) !]" ng-init="context = activity.context.referenceActivity.context">with [! context.count - 1 !] others</a>
</span>
</span>
<span ng-else="multipleActivities">
Duplicated <b>[! activity.object.unicode !]</b> from <b>[! activity.context.sourceCompany.unicode !]</b>
</span>
</div>
<div ng-controller="dashboard.settings.DuplicateAcrossCompaniesActivityCtrl"
ng-if-once="activityType === 'duplicated-x-companies'">
<div ng-if="unnecessaryDuplications.length > 0"
ng-then="showCompanyElsewhere"
>
Tried to duplicate some [! unnecessaryDuplications.join(', ') !] from <b>[! activity.context.sourceCompany.unicode !]</b> but they already existed
</div>
<div ng-if="actualDuplications.length > 0">
<span ng-if="showCompanyElsewhere">
Duplicated [! actualDuplications.join(', ') !]
</span>
<span ng-else="showCompanyElsewhere">
Duplicated [! actualDuplications.join(', ') !] from <b>[! activity.context.sourceCompany.unicode !]</b>
</span>
</div>
<ul class="activity-ava" ng-if="actualDuplications.length > 0">
<li ng-repeat="(modelClassname, newModels) in activity.context.changes">
<div ng-if="newModels.length > 0">
[! modelClassname !]
<a ng-toggle ng-toggle-value="modelClassname + activity.pk"
class="form-link"
>(<span class="hide-when-toggled">Show changes</span><span class="show-when-toggled">Hide changes</span>)</a>
<ul class="activity-ava" ng-toggled ng-toggled-value="modelClassname + activity.pk">
<li ng-repeat="newModel in newModels">
[! newModel.unicode !]
</li>
</ul>
</div>
</li>
</ul>
</div>
<div ng-if-once="activityType === 'duplicated'">
Duplicated <a ng-href="[! activity.context.original.$url() !]">[! activity.context.original.unicode !]</a>
</div>
<div ng-if-once="activityType === 'translation-changed' || activityType === 'translation-update'">
<span ng-if-once="activity.object.cls === SupportedLanguage.cls" ng-then="specifyLanguage">
Modified translation for <b>[! activity.context.modelName !]</b>
</span>
<span ng-else="specifyLanguage">
Modified <b>[! activity.context.instance.supportedLanguage.unicode !]</b> translation for <b>[! activity.context.modelName !]</b>
</span>
<div class="activity-content-shaded"
ng-link="activity-changes"
></div>
</div>
<div ng-if-once="activityType === 'changed-booking-checkin-status'">
<span ng-if-once="activity.context.checkinStatus !== null" ng-then="notCheckedIn">
Set all customers to <b>[! activity.context.checkinStatus.name !]</b>
</span>
<span ng-else="notCheckedIn">
Set all customers to <b>not yet checked in</b>
</span>
</div>
<div ng-if-once="activityType === 'duplicated-group'">
Duplicated <a ng-href="[! activity.context.originalGroup.$url(urls.dashboard.settings.permissions.group) !]">[! activity.context.originalGroup.name !]</a>
</div>
<div ng-if-once="activityType === 'created-resource-overrides'">
[! interpolate(nT('Created %(count)s override', 'Created %(count)s overrides', activity.context.count), { count: activity.context.count }) !]
<div class="activity-content-shaded"
ng-link="activity-changes"
></div>
<div class="activity-delete"
ng-can-clear="ResourceOverride on activity.object"
ng-can-only-when="activity.context.tag"
>
<a ng-click="activitiesCtrl.actions.clearResourceOverridesByTag(activity.context.tag)"
class="fh-red underline"
ng-confirm-click="[! T('Are you sure you want to remove these overrides?') !]"
>
Remove
</a>
</div>
</div>
<div ng-if-once="activityType === 'hid-resource-overrides'">
[! interpolate(nT('Removed %(count)s override', 'Removed %(count)s overrides', activity.context.count), { count: activity.context.count }) !]
</div>
<span ng-if-once="activityType === 'toggled-admin-only-status'">
<b>[! activity.context.changes[0].newValue === Activity.ADMIN_ONLY_TYPE ? T('Made admin-only') : T('Made not admin-only') !]</b>
</span>
<div ng-if-once="activityType === 'created-seats'">
Created <b>[! activity.context.instances|map:'unicode'|commaSeparated !]</b>:
<div class="activity-content-shaded"
ng-link="activity-changes"
></div>
</div>
<div ng-if-once="activityType === 'duplicated-seats'">
<div ng-if-once="activity.context.instances.length === 1" ng-then="singularDuplicateActivity">
Created <b>[! activity.context.instances|map:'unicode'|commaSeparated !]</b> (duplicated)
</div>
<div ng-else-once="singularDuplicateActivity">
Created <b>[! activity.context.instances.length !]</b> seats (duplicated):
<div class="activity-content-shaded">
<b>[! activity.context.instances|map:'unicode'|commaSeparated !]</b>
</div>
</div>
</div>
<div ng-if-once="activityType === 'changed-seats'">
<div ng-if-once="activity.context.instances.length === 1" ng-then="singularUpdateActivity">
For <b>[! activity.context.instances|map:'unicode'|commaSeparated !]</b>:
</div>
<div ng-else-once="singularUpdateActivity">
Updated <b>[! activity.context.instances.length !]</b> seats:
</div>
<div class="activity-content-shaded">
<div ng-if-once="activity.context.positionChanges">
<div ng-if-once="activity.context.positionChanges.xCoord">
Moved <b>x coordinate</b> by <b>[! activity.context.positionChanges.xCoord !]</b> <span class="fh-grey">(from original position)</span>
</div>
<div ng-if-once="activity.context.positionChanges.yCoord">
Moved <b>y coordinate</b> by <b>[! activity.context.positionChanges.yCoord !]</b> <span class="fh-grey">(from original position)</span>
</div>
</div>
<div ng-link="activity-changes"></div>
</div>
</div>
<div ng-if-once="activityType === 'hid-seats'">
<div ng-if-once="activity.context.instances.length === 1" ng-then="singularRemoveActivity">
Removed <b>[! activity.context.instances|map:'unicode'|commaSeparated !]</b>
</div>
<div ng-else-once="singularRemoveActivity">
Removed <b>[! activity.context.instances.length !]</b> seats:
<div class="activity-content-shaded">
<b>[! activity.context.instances|map:'unicode'|commaSeparated !]</b>
</div>
</div>
</div>
<div ng-if-once="activityType === 'webhook-request-failed'">
[! activity.context.webhookDisplayName !] request failed
<a ng-href="[! activity.context.resellerKey.$url() !]">
([! activity.context.resellerKey.user.name !]: [! activity.context.resellerKey.name !])
</a><br>
<b>Error: </b> [! activity.context.error !]
</div>
<div ng-if-once="activityType === 'webhook-request-succeeded'">
[! activity.context.webhookDisplayName !] request succeeded
<a ng-href="[! activity.context.resellerKey.$url() !]">
([! activity.context.resellerKey.user.name !]: [! activity.context.resellerKey.name !])
</a><br>
</div>
<div class="activity-used-by" ng-if-once="activity.context.usedBy && activity.context.usedBy.length">
used by
<a ng-repeat="usedBy in activity.context.usedBy"
ng-href="[! usedBy.$url(change.usedByUrl || '') !]"
><b>[! usedBy|name !][! $last ? '': ', ' !]</b></a>
</div>
</div>
</div>
<a class="td activity-source"
ng-if="showLink"
ng-href="[! Activity.objectUrl(activity) !]"
>
&raquo;
</a>
</div>
</div>
</script>
<script type="text/ng-template" id="activity-list">
<div class="tb activities-tb" ng-if="activitiesCtrl.isFilteringEnabled">
<div class="tb-left">
<div class="tb-group">
<div class="tb-flyout-wrap tb-collapse-on-mobile">
<div class="tb-btn tb-btn--flyout"
ng-toggle="filterActivities"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-class="{ 'highlighted': activitiesCtrl.isFiltering() }"
ng-shortcut="'/|shift+s'"
ng-shortcut-click
>
<i class="tb-icon filter"></i>
<span ng-if="activitiesCtrl.isFiltering()" ng-then="filtering">Filtered</span>
<span ng-else="filtering">Filter activity</span>
</div>
<div class="tb-flyout tb-flyout--auto-width-narrow"
ng-toggled="filterActivities"
ng-shortcut="'esc'"
ng-shortcut-action="toggles.toggle('filterActivities', false)"
>
<div class="flyout-section flyout-section--no-border">
<div class="field-search-wrap">
<input class="field-search js-disable-shortcuts"
type="text"
ng-autofocus
ng-model="activitiesCtrl.queryFilter"
ng-placeholder="[! T('Search all') !]"
/>
<div ng-clear-input="activitiesCtrl.queryFilter"></div>
</div>
</div>
<div class="flyout-checklist-header">
Filter by:
<a ng-click="activitiesCtrl.reset()" ng-if="activitiesCtrl.isFiltering()"
class="flyout-reset-all"
>Reset all</a>
</div>
<ul class="toggle-header-list">
<li>
<a ng-toggle="filterDate"
class="flyout-toggle-header small [[ addClassIf(!!activitiesCtrl.dateFilter, 'active') ]]"
>
Date
</a>
<div ng-toggled="filterDate"
class="flyout-section flyout-section--no-border"
>
<label>
<div class="field-search-wrap">
<input class="field-search js-disable-shortcuts" type="text"
ng-model="activitiesCtrl.dateFilter"
ng-datepicker
ng-datepicker-allow-empty
ng-autofocus
/>
<div ng-clear-input="activitiesCtrl.dateFilter" ng-clear-input-refocus="false"></div>
</div>
</label>
</div>
</li>
<li>
<a ng-toggle="filterUser"
class="flyout-toggle-header small [[ addClassIf(!!activitiesCtrl.userFilter, 'active') ]]"
>
User
</a>
<div ng-toggled="filterUser"
class="flyout-section flyout-section--no-border"
>
<label class="field-search-wrap">
<div class="field-search-wrap">
<input class="field-search js-disable-shortcuts" type="text"
ng-model="activitiesCtrl.userFilter"
ng-autofocus
/>
<div ng-clear-input="activitiesCtrl.userFilter"></div>
</div>
</label>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="activities" ng-if="activitiesCtrl.status == 'refreshing'">
<div class="activities">
<div class="activity-empty">
Loading...
</div>
</div>
</div>
<div ng-if="activitiesCtrl.status == 'success' && !activitiesCtrl.activities.length">
<div class="activities">
<div class="activity-empty">
<span ng-if="activitiesCtrl.isFiltering()" ng-then="filteringActivity">
No matching activity.
<a ng-click="activitiesCtrl.reset()" class="underline">Reset filters</a>
</span>
<span ng-else="filteringActivity">
No recent activity
</span>
</div>
</div>
</div>
<div ng-link="activities"
ng-init="activities = activitiesCtrl.activities; showLink = forceShowLinks || activitiesCtrl.showingActivityLinks;"
></div>
<div ng-if="activitiesCtrl.nextPage" class="activities-next-page">
<div class="activities-load-more"
ng-if="activitiesCtrl.status == 'loading'" ng-then="loadingMore"
>
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
<a class="activities-load-more test-load-more-activities-action" ng-click="activitiesCtrl.loadMore()" ng-else="loadingMore">
&darr; Load more...
</a>
</div>
</script>
<script type="text/ng-template" id="activity-changes">
<ul>
<li ng-repeat="change in activity.context.changes">
<div ng-if-once="change.fieldType === 'ImageURLField' || change.fieldType === 'JSONField' || change.fieldName === 'password'" ng-then="hideValues">
<span ng-if-once="change.newValue && !change.oldValue">
Set <b>[! change.fieldName !]</b></span>
<span ng-if-once="change.newValue && change.oldValue">
Updated <b>[! change.fieldName !]</b></span>
<span ng-if-once="!change.newValue">
Removed <b>[! change.fieldName !]</b></span>
<span ng-if-once="change.newValue && change.fieldType === 'JSONField'">
<a ng-toggle="showingJSON" class="form-link">(Show)</a>
</span>
<div ng-toggled="showingJSON" class="activity-note-content">
<div ng-format-json="change.newValue"></div>
</div>
</div>
<div ng-else-once="hideValues">
<span ng-if-once="change.fieldName === 'is called off'" ng-then="private">
<span ng-show="change.newValue">Made availability <b>private</b></span>
<span ng-show="!change.newValue">Made availability <b>not private</b></span>
</span>
<span ng-else="private">
<span ng-init="isImageField = change.fieldType === 'CDNURLField';
isLongValue = (change.originalValue.length > 100 || change.newValue.length > 100)
">
<span ng-if-once="isImageField || isLongValue" ng-then="hasPreview">
Changed <b>[! change.fieldName !]</b>
<a ng-toggle ng-toggle-value="'show-changes-' + activity.pk + '-' + $index"
class="form-link"
>(<span class="hide-when-toggled">Show</span><span class="show-when-toggled">Hide</span>)</a>
<div ng-toggled ng-toggled-value="'show-changes-' + activity.pk + '-' + $index">
<img ng-if-once="isImageField" ng-image="change.newValue" class="image-profile-huge">
<pre ng-if-once="isLongValue" class="activity-diff"
ng-diff="change.newValue.unicode || change.newValue"
ng-diff-with="change.originalValue.unicode || change.originalValue"
></pre>
</div>
</span>
</span>
<span ng-else="hasPreview"
ng-init="isColorField = change.fieldType === 'ColorField';
isAmountField = change.fieldType === 'AmountField'"
>
<span ng-if-once="change.originalValue || change.originalValue === 0" ng-then="hasOriginal">
<span ng-if-once="change.newValue || change.newValue === 0" ng-then="hasNew">
Changed <b>[! change.fieldName !]</b> to
<i ng-if-once="isColorField"
class="inline-swatch [! change.newValue|colorClass:'-swatch':'no-color' !]"
></i>
<b ng-if-once="isAmountField" ng-amount="change.newValue"></b>
<b ng-else-once="isColorField || isAmountField">
[! change.newValue|activityChange:change.fieldType !]
</b>
</span>
<span ng-else-once="hasNew">
Removed <b>[! change.fieldName !]</b></span>
<span class="fh-grey">
(was
<i ng-if-once="isColorField"
class="inline-swatch [! change.originalValue|colorClass:'-swatch':'no-color' !]"
></i><span ng-if-once="isAmountField"
ng-amount="change.originalValue"
></span><span ng-else-once="isColorField || isAmountField">[!
change.originalValue|activityChange:change.fieldType
!]</span>)
</span>
</span>
<span ng-else="hasOriginal">
Set <b>[! change.fieldName !]</b> to
<i ng-if-once="isColorField"
class="inline-swatch [! change.newValue|colorClass:'-swatch':'no-color' !]"
></i>
<b ng-if-once="isAmountField" ng-amount="change.newValue"></b>
<b ng-else-once="isColorField || isAmountField">
[!
change.newValue|activityChange:change.fieldType
!]
</b>
</span>
</span>
</span>
</div>
</li>
</ul>
</script>
<script type="text/ng-template" id="activity-flyout">
<div class="activity-flyout-wrap"
ng-if-once="canToggleAdminOnlyStatus"
ng-then="flyout"
>
<span class="activity-meta-date is-dropdown"
ng-toggle ng-toggle-value="'activity-settings-' + $id"
ng-toggle-group="activity-settings"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-interval="60"
title="[[ timeStamp|datetime ]]"
>
[[ timeStamp|datetime:'relative':'relative-time' ]]
<span class="activity-note-count"
ng-if="activity.context.adminNoteCount"
>
[[ activity.context.adminNoteCount ]]
</span>
</span>
<div class="tb-flyout tb-flyout--auto-width-narrow activity-flyout"
ng-toggled ng-toggled-value="'activity-settings-' + $id"
>
<ul class="flyout-menu-items">
<li ng-if-once="showActivityLink">
<a ng-href="[! activity.$url(urls.dashboard.overlay.activity.index) !]">
Go to activity
</a>
</li>
<li>
<button ng-click="toggleAdminOnly()" type="button">
[[ adminOnlyText() ]]
</button>
</li>
</ul>
</div>
</div>
<div class="activity-meta-date"
ng-if-once="!flyout && showActivityLink"
ng-then="simpleLink"
ng-interval="60"
>
<a ng-href="[! activity.$url(urls.dashboard.overlay.activity.index) !]"
title="[[ timeStamp|datetime ]]"
>
[[ timeStamp|datetime:'relative':'relative-time' ]]
</a>
</div>
<div class="activity-meta-date"
ng-else-once="flyout || simpleLink"
ng-interval="60"
title="[[ timeStamp|datetime ]]"
>
[[ timeStamp|datetime:'relative':'relative-time' ]]
</div>
</script>
<script type="text/ng-template" id="activity-upload-status">
<li class="active">Bank debit started</li>
<li ng-if-once="upload.status !== Upload.FAILED_STATUS"
ng-class="{ 'active': upload.status === Upload.SUCCEEDED_STATUS }"
>Debit successful</li>
<li ng-if-once="upload.status === Upload.FAILED_STATUS"
class="active error"
>Debit failed</li>
<li ng-if-once="upload.isExternal && refund && refund.transferStatus !== Refund.FAILED_TRANSFER_STATUS"
ng-class="{ 'active': refund.transferStatus === Refund.SUCCEEDED_TRANSFER_STATUS }"
>Refund sent to card</li>
<li ng-if-once="upload.isExternal && refund && refund.transferStatus === Refund.FAILED_TRANSFER_STATUS"
class="active error"
>Refund to card failed</li>
</script>
<script type="text/ng-template" id="availability-booking">
<div class="status-badge">
<span ng-can-view-amounts="booking.company"
ng-can-only-when="!booking.rebookedTo"
class="badge nowrap
[! booking.isUnprocessed || booking.isCancelled ? '' : 'badge-' + booking.paidStatus|css !]"
>
[!
booking.isUnprocessed ? T('Pending') : (
booking.isCancelled ?
!booking.receipt.gross ? T('Refunded') : interpolate(T('%(amount)s Paid'), { amount: (booking.receipt.gross|amount:booking) })
: (
booking.amountDue || booking.amountOverpaid ? (
booking.amountDue ?
interpolate(T('%(amount)s Due'), { amount: (booking.amountDue|amount:booking) }) :
interpolate(T('%(amount)s Overpaid'), { amount: (booking.amountOverpaid|amount:booking) })
) : T('Paid')
)
)
!]
</span>
</div>
<i class="presence-small-eye"
ng-presence-indicator="[! booking.contact.uri !]"
ng-presence-tip="[[ interpolate(nT('%(usercount)s user viewing', '%(usercount)s users viewing', channel.userCount), { usercount: channel.userCount} ) ]]"
></i>
<b class="availability-booking-contact">[! booking.contact.name !]</b>
<span class="text-medium">
<span class="booking-pk-color">#[! booking.pk !]</span>
&bull; [! booking.customerBreakdownShort !]
</span>
<span class="booking-block-affiliate
[! booking.isOnline ? 'booked-via-online' :
(booking.user.company.pk === booking.affiliation.affiliateCompany.pk ? 'booked-via-affiliate-db' : '') !]
"
ng-if-once="booking.affiliation"
>
<b>
[! navigation.isCurrentCompany(booking.affiliation.affiliateCompany) ? booking.company.name : booking.affiliation.affiliateCompany.name !]
</b>
[! booking.voucherNumber ? '(' + booking.voucherNumber + ')' : '' !]
</span>
<span class="booked-at fh-grey [! addClassIf(!booking.isCancelled && !booking.user, 'booked-at-online') !]">
<span ng-if="booking.isCancelled" ng-then="cancelled"
>
<span class="badge badge-error"
ng-if-once="!booking.rebookedTo"
>Cancelled</span>
<span class="badge"
ng-if-once="!!booking.rebookedTo"
>Rebooked</span>
[! booking.modifiedAt|datetime:'relative' !]
</span>
<span ng-else="cancelled"
>
<i ng-if-once="booking.rebookedFrom" class="rebooked-icon" ng-tip="[! T('Rebooked') !]"></i>
<span ng-if-once="!booking.user"
class="test-view-online-booking-action"
>
<i class="booked-online-icon"></i> Booked online
</span>
[! booking.createdAt|datetime:'relative' !]
[! booking.user.name ? interpolate(T('by %(personName)s'), { personName: booking.user.name }) : '' !]
<span ng-if-once="!!booking.user && !navigation.isCurrentCompany(booking.user.company)">
([! booking.user.company.name !])
</span>
</span>
</span>
</script>
<script type="text/ng-template" id="book.availabilityBlocks">
<div class="table table-dont-respond valign-middle capacity-table large nowrap"
ng-if="availability.blocks.length"
>
<div class="thead capacity-table-header">
<div class="tr"
ng-with="
blockedCustomerCount = Availability.blockedCustomerCount(availability);
reservedCapacity = Availability.reservedCapacity(availability);
"
>
<div class="td fh-blue">Blocks</div>
<div class="td">
<div class="fh-grey">Booked</div>
<div class="header-capacity [[ blockedCustomerCount|blockedCapacityClass:reservedCapacity ]]">
<i class="[! company|capacityIndicatorClass:'filled' !]"></i>
[! blockedCustomerCount !]
</div>
</div>
<div class="td fh-grey">
Blocked
<div class="header-capacity">[! reservedCapacity !]</div>
</div>
</div>
</div>
<div class="tbody capacity-overview">
<div class="tr" ng-repeat="block in availability.blocks">
<div class="td">[! block.affiliation.affiliateCompany.name !]</div>
<div class="td [! block|capacityClass !]">
<i class="[! company|capacityIndicatorClass:'filled' !]"></i>
[! block.customerCount !]
</div>
<div class="td fh-grey">[! block.reservedCapacity !]</div>
</tr>
</div>
</table>
</script>
<script type="text/ng-template" id="
availability-popover
">
<div class="popover "
ng-body-class="'hide-body-overflow--handhelds is-popover-open'"
>
<div class="triangle js-triangle"></div>
<div class="popover-content-wrap">
<div class="popover-content"
ng-if-once="needsCalBlock"
>
<a
ng-href="[! availability.$url(urls.company.item.book) !][! resource ? '?select-resource=' + resource.pk : '' !]"
ng-confirm-click="[[ Availability.isInPast(availability) ? T('This availability is in the past. Do you still want to book it?') : '' ]]"
ng-start-booking
ng-shift-or-alt-navigate="[! !rebook.currentBooking ? (availability.$url(urls.company.item.book) + (resource ? '?select-resource=' + resource.pk : '' )) : (availability|availabilityUrl) !]"
ng-confirm-click="[! T('This availability is in the past. Do you still want to rebook to it?') !]"
ng-confirm-click-when="Availability.isInPast(availability) && ($event.shiftKey || $event.altKey)"
ng-init="
bookableCapacity = calendarFilter.countBlockedAsFilled !== false ? availability.bookableCapacity : availability.blocksIncludedBookableCapacity;
nonResourceBookableCapacity = calendarFilter.countBlockedAsFilled !== false ? availability.nonResourceBookableCapacity : availability.blocksIncludedNonResourceBookableCapacity;
"
class="cal-block test-select-availability-action
[! calendarFilter.isColorCoded ?
(availability|colorClass:'-fill') + ' ava-no-capacity-color' :
''
!]
[! availability|capacityClass:undefined:calendarFilter.countBlockedAsFilled !]
[! availability.customerCount ? (bookableCapacity !== null ? 'is-showing-progress' : '') : 'is-empty' !]
"
>
<i class="presence-small-editing"
ng-presence-indicator="[! availability.uri !]:book"
ng-presence-tip="[[ interpolate(nT('%(count)s user booking', '%(count)s users booking', channel.userCount), { count: channel.userCount }) ]]"
></i>
<i class="cb-icon [! availability|onlineStatusClass !]"></i>
<b ng-else-once="availability|isAllDay" class="cb-time">
[! (availability.startAt|time:(availability.endAt)) !]
</b>
<b class="cb-item">
[! availability.item|name !]
</b>
<b class="cb-headline" ng-show-once="availability.headline">
&mdash;
<span ng-bind-once="availability.headline"></span>
</b>
<b class="cb-private-headline"
ng-if="availability.headlinePrivate && (calendarFilter.showPrivateHeadline || !calendarFilter)"
>[! availability.headlinePrivate !]</b>
<div class="cb-stat"
ng-can="viewCapacities on availability"
ng-can-only-when="calendarFilter.showEmptySeats || calendarFilter.showFilledSeats || !calendarFilter"
ng-init="
isFull = bookableCapacity === 0;
isOverbooked = 0 > nonResourceBookableCapacity;
"
>
<div ng-if-once="company.companyFeatures.isResourceBookableCapacityEnabled" ng-then="resourceBookableCapacityEnabled">
<span class="badge" ng-if-once="availability.customerCount && isFull && !isOverbooked">Full</span>
<span ng-if="calendarFilter.showFilledSeats || !calendarFilter" ng-tip="[! T('Booked') !]" ng-tip-location="i" class="cb-inline-stat">
<i class="cb-square filled"></i>
[! availability.customerCount !]
</span>
<span ng-if="(calendarFilter.showEmptySeats || !calendarFilter) && bookableCapacity !== null"
ng-tip="[! T('Available to book') !]" ng-tip-location="i"
class="cb-inline-stat"
>
<i class="cb-square"></i>
[! bookableCapacity !]
</span>
<div ng-if-once="availability.customerCount > 0 && isOverbooked">
<span class="badge">
[! interpolate(T('Overbooked by %(count)s'), { count: (-nonResourceBookableCapacity) }) !]
</span>
</div>
<div ng-if-once="availability.isOverusingResources">
Overusing resources
</div>
</div>
<div ng-else-once="resourceBookableCapacityEnabled">
<div ng-if-once="availability.capacity === null" ng-then="nullCapacity">
<div ng-if="calendarFilter.showFilledSeats">
<i ng-svg="svg-user" ng-tip="[! T('Booked') !]"></i>
[! availability.customerCount !]
</div>
</div>
<div ng-else="nullCapacity">
<div ng-if-once="bookableCapacity > 0 || (availability.customerCount === 0 && bookableCapacity === 0)">
<div ng-if="calendarFilter.showFilledSeats">
<i ng-svg="svg-user" ng-tip="[! T('Booked') !]"></i>
[! availability.customerCount !]/[! availability.capacity !]
</div>
<div ng-if="calendarFilter.showEmptySeats || !calendarFilter">
<i ng-svg="svg-user-outline" ng-tip="[! T('Available to book') !]"></i>
[! bookableCapacity !== availability.capacity ? bookableCapacity + '/' : '' !][! availability.capacity !]
</div>
</div>
[! (availability.customerCount > 0) && (nonResourceBookableCapacity === 0) ?
interpolate(T('All %(count)s full'), { count: availability.customerCount }) :
''
!]
<span class="[! calendarFilter.isColorCoded ? 'color-fill-primary color-coded-overbooked-message' : '' !]"
ng-if-once="availability.customerCount > 0 && isOverbooked"
>
[! interpolate(T('Overbooked by %(count)s'), { count: (-nonResourceBookableCapacity) }) !]
</span>
</div>
</div>
</div>
<ul class="cb-list crew" ng-if="availability.groupedCrewMembers.length && calendarFilter.showCrew">
<li ng-repeat="group in availability.groupedCrewMembers">
<span ng-if="!!group.role" class="fh-grey">[[ group.role.shortName ]]:</span>
<span ng-repeat="crewMember in group.crewMembers">
[! crewMember.user.name + ($last ? '' : ',') !]
</span>
</li>
</ul>
<ul ng-if="availability.resourceUseSummaries.length && calendarFilter.showResources" class="cb-list resources">
<li ng-repeat="resourceUseSummary in availability.resourceUseSummaries"
ng-if="
(calendarFilter.showAllResources || calendarFilter.visibleResources[resourceUseSummary.resource.uri])
&&
(resourceUseSummary.totalUseCount > 0 || calendarFilter.showVirtualResources)
&&
(!resource || resource === resourceUseSummary.resource)
"
>
<b>[! resourceUseSummary.resource|name !]:</b> [! resourceUseSummary.totalUseCount|count !]
</li>
</ul>
<div class="cb-progress"
ng-if-once="availability.customerCount && bookableCapacity !== null"
ng-style-once="{ 'width': ((availability.customerCount / (availability.customerCount + bookableCapacity))|cssPercentage) }"
></div>
</a>
</div>
<ul class="popover-menu">
<li ng-can-create="Booking on availability.company"
ng-can-only-when="!duplicateAvailability"
ng-then="includesBookButton"
>
<a ng-can-create="Booking on availability.company"
ng-can-only-when="!availability.item.isArchived"
class="
popover-menu-action with-chevron
[[ Availability.isInPast(availability) ? '
' : '
green
' ]]
"
ng-href="[! availability.$url(urls.company.item.book) !][! resource ? '?select-resource=' + resource.pk : '' !]"
ng-start-booking
ng-confirm-click="[! T('This availability is in the past. Do you still want to book it?') !]"
ng-confirm-click-when="Availability.isInPast(availability)"
>
<span class="tb-icon plus test-action-book"></span>
[!
rebook.currentBooking ?
resource ?
interpolate(T('Rebook to %(resourceName)s'), { resourceName: (resource|name) }) :
T('Rebook to here')
:
resource ?
interpolate(T('%(resourceName)s booking'), { resourceName: (resource|name) }) :
T('New booking')
!]
</a>
</li>
<li ng-can-view-dashboard-section="availability.company"
ng-then="includesSettings"
>
<a ng-href="[! availability.$url(urls.dashboard.overlay.availability.index) !]"
class="popover-menu-action with-popup"
>
<span class="tb-icon cog"></span> Actions & Settings
</a>
</li>
<li ng-can-view-manifest-section="availability.company"
ng-can-only-when="availability.customerCount"
ng-then="includesManifest"
>
<a ng-href="[! Availability.manifestUrl(availability) !]"
class="popover-menu-action with-chevron"
>
<span class="tb-icon manifest"></span> Manifest
</a>
</li>
<li ng-can-create="Availability on availability.company"
ng-can-only-when="!!duplicateAvailability && !availability.item.isArchived"
ng-then="includesDuplicate"
>
<a ng-click="duplicateAvailability(availability)"
class="popover-menu-action with-popup"
>
<span class="tb-icon plus"></span> Duplicate
</a>
</li>
<li ng-else="includesBookButton ||
includesSettings ||
includesDuplicate ||
includesManifest ||
includesCapacities"
>
<span class="popover-menu-content fh-grey">No available actions</span>
</li>
</ul>
<div ng-live-capacity="availability" class="ava-popover-capacity"
ng-can="viewCapacities on availability" ng-then="includesCapacities"
></div>
</div>
</div>
</script>
<script type="text/ng-template" id="availabilityResourceUses">
<div class="live-capacity-loading"
ng-if="resourceUsesCtrl.status === 'loading'"
ng-then="loading"
>
<i class="spinner-ticker-css"><span></span></i>
</div>
<div class="table table-dont-respond valign-middle capacity-table large"
ng-if="resourceUsesCtrl.status === 'success' && resourceUsesCtrl.resourceUses.length"
ng-then="hasUses"
>
<div class="thead capacity-table-header nowrap">
<div class="tr">
<div class="td fh-blue">Resource</div>
<div class="td">
<div class="fh-grey">Use count</div>
</div>
</div>
</div>
<div class="tbody capacity-overview">
<a ng-repeat="row in resourceUsesCtrl.resourceUsesRows"
ng-href="[! row.dayViewUrl !]"
class="tr"
>
<div class="td" title="[! T('View all uses') !]">[! row.resourceName !]</div>
<div class="td">[! row.useCount|count !]</div>
</a>
</div>
</div>
<div class="flyout-presets-empty"
ng-else="loading || hasUses"
>
This availability does not use any resources
</div>
</script>
<script type="text/ng-template" id="availability-stats">
<div ng-controller=
"dashboard.shared.AvailabilityStatsCtrl"
class="[[ dataCtrl.status|css ]]
stats-tb
"
>
<div ng-if="dataCtrl.status === 'loading'">
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div class="tb tb--inset-mobile no-margin">
<div class="tb-left respond-print-hide">
<div class="tb-group">
<div class="tb-flyout-wrap respond-print-hide"
ng-can-view="availability"
ng-with="statusToggle = 'status-' + $id"
>
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="statusToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<span ng-if="availability.isBookableOnlyByPhone" ng-then="callToBook">
<i class="tb-icon phone"></i> Call to book
</span>
<span ng-if="!callToBook && availability.unbookableReason" ng-then="closed">
<i class="tb-icon lock"></i> Online closed
</span>
<span ng-else="closed || callToBook" class="fh-blue">
<span ng-if="availability.isUnlisted">
<i class="tb-icon unlisted"></i> Unlisted
</span>
<span ng-else="availability.isUnlisted">
<i class="tb-icon online"></i> Bookable online
</span>
</span>
</div>
<div class="tb-flyout tb-flyout-availability-status tb-flyout--auto-width"
ng-toggled ng-toggled-value="statusToggle"
>
<div ng-controller=
"dashboard.shared.AvailabilityStatusEditable"
class="
availability-status-editable
" >
<div
ng-can-view="availability"
ng-then="allowed">
<form name="updateAvailabilityStatusForm"
ng-can-update="availability" ng-then="editing"
>
<div class="fields "
>
<div class="ava-status-header">
<div class="table table-dont-respond valign-middle ava-status-header-table">
<div class="tr">
<div class="td">
<div ng-if="Availability.isInPast(availability)" ng-then="noStatusPast">
This availability cannot be booked by or shown to online customers because it&#039;s in the past
</div>
<div ng-if="availability.item.isPrivate && !noStatusPast" ng-then="noStatusPrivate">
This availability cannot be booked by or shown to online customers because the item is set to private
</div>
<div ng-if="availability.unbookableReason && !noStatusPast && !noStatusPrivate" ng-then="unbookable">
Not bookable online: <b>[[ availability.unbookableReason ]]</b>
</div>
<div ng-if="!(unbookable || noStatusPast || noStatusPrivate)"
ng-then="bookableOnline"
>
<b class="ava-status-header-online">Currently bookable online</b>
</div>
</div>
</div>
</div>
</div>
<div class="flyout-section nowrap--desktop"
ng-else="noStatusPrivate || noStatusPast"
>
<ul class="list-filters">
<li ng-toggle="avaChangeStatus" ng-toggle-group="avaStatus" ng-toggle-default="true">
Change Status
</li>
<li ng-toggle="avaBookability" ng-toggle-group="avaStatus">
Bookability
</li>
</ul>
</div>
<div class="smush-fields" ng-toggled="avaChangeStatus">
<div class="updateavailabilitystatusform-status "
ng-django-field="updateAvailabilityStatusForm [&#39;status&#39;]" ng-django-field-model="editableAvailability [&#39;status&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<ul class="status-options">
<li ng-click="editableAvailability [&#39;status&#39;] = Availability.AUTO_STATUS; editCtrl.submit(updateAvailabilityStatusForm)"
class="availability-status [[ addClassIf(editableAvailability [&#39;status&#39;] === Availability.AUTO_STATUS, 'selected') ]]"
>
<h2>Auto close</h2>
<div class="status-hint">
&bull; When no space left<br>
<div ng-if="availability.customerCount > 0" ng-then="hasBookings">
<div ng-show="Availability.cutoffReachedKind(availability) === BookingRestriction.BEFORE_MIDNIGHT_CUTOFF_KIND">
&bull;
<span ng-show="Availability.cutoffReachedHours(availability)" ng-then="isNotMidnight">
[! Availability.cutoffReachedHours(availability) !] hours before midnight day of
</span>
<span ng-hide="isNotMidnight">At midnight day of</span>
</div>
<div ng-show="Availability.cutoffReachedKind(availability) === BookingRestriction.BEFORE_START_CUTOFF_KIND">
&bull;
<span ng-show="Availability.cutoffReachedHours(availability)" ng-then="isNotStart">
[! Availability.cutoffReachedHours(availability) !] hours before start
</span>
<span ng-hide="isNotStart">At start time</span>
</div>
</div>
<div ng-else="hasBookings">
<div ng-show="Availability.cutoffUnreachedKind(availability) === BookingRestriction.BEFORE_MIDNIGHT_CUTOFF_KIND">
&bull;
<span ng-show="Availability.cutoffUnreachedHours(availability)" ng-then="isNotMidnight">
[! Availability.cutoffUnreachedHours(availability) !] hours before midnight day of
</span>
<span ng-hide="isNotMidnight">At midnight day of</span>
</div>
<div ng-show="Availability.cutoffUnreachedKind(availability) === BookingRestriction.BEFORE_START_CUTOFF_KIND">
&bull;
<span ng-show="Availability.cutoffUnreachedHours(availability)" ng-then="isNotStart">
[! Availability.cutoffUnreachedHours(availability) !] hours before start
</span>
<span ng-hide="isNotStart">At start time</span>
</div>
</div>
</div>
</li>
<li ng-click="editableAvailability [&#39;status&#39;] = Availability.OPEN_STATUS; editCtrl.submit(updateAvailabilityStatusForm)"
class="availability-status [[ addClassIf(editableAvailability [&#39;status&#39;] === Availability.OPEN_STATUS, 'selected') ]]"
ng-else="availability.unbookableReason === 'Full'"
>
<h2><i class="tb-icon online"></i> Open override</h2>
<div class="status-hint">Ignore cutoff times when there is still space available</div>
</li>
<li ng-click="editableAvailability [&#39;status&#39;] = Availability.CALL_STATUS; editCtrl.submit(updateAvailabilityStatusForm)"
class="availability-status [[ addClassIf(editableAvailability [&#39;status&#39;] === Availability.CALL_STATUS, 'selected') ]]"
>
<h2><i class="tb-icon phone"></i> Closed & Call to book</h2>
<div class="status-hint">Don't allow online bookings, show "Call to Book" message</div>
</li>
<li ng-click="editableAvailability [&#39;status&#39;] = Availability.CLOSED_STATUS; editCtrl.submit(updateAvailabilityStatusForm)"
class="availability-status [[ addClassIf(editableAvailability [&#39;status&#39;] === Availability.CLOSED_STATUS, 'selected') ]]"
>
<h2><i class="tb-icon lock"></i> Closed & hidden</h2>
<div class="status-hint">
Only let [! company.name !] users see and book
</div>
</li>
</ul>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateAvailabilityStatusForm [&#39;status&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in updateAvailabilityStatusForm [&#39;status&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-toggled="avaBookability">
<div class="flyout-section">
<h2>Online booking link</h2>
<div ng-if="!Availability.isInPast(availability) && !availability.item.isPrivate && availability.status !== Availability.CLOSED_STATUS">
<ul class="giant-toggle field-margin-bottom">
<li ng-class="{ 'toggled': !editableAvailability.isUnlisted }"
ng-click="editableAvailability.isUnlisted = false; editCtrl.submit(updateAvailabilityStatusForm);"
>
Public
</li>
<li ng-class="{ 'toggled': editableAvailability.isUnlisted }"
ng-click="editableAvailability.isUnlisted = true; editCtrl.submit(updateAvailabilityStatusForm);"
>
<i class="ab-icon-unlisted icon-ava-unlisted"></i> Unlisted
</li>
</ul>
<div class="hint hint-alert" ng-if="availability.isUnlisted">
<span ng-if-once="availability.status !== Availability.CALL_STATUS">Only people with the link can see and book.</span>
<span ng-else-once="availability.status !== Availability.CALL_STATUS">Only people with the link can see.</span>
<a ng-href="https://fareharbor.com/help/dashboard/availabilities/unlisted/"
ng-outbound-link="_blank"
class="hint-help-link nowrap"
>How to use</a>
</div>
</div>
<textarea class="monospace url-copy-field" ng-autoselect readonly="readonly">https://fareharbor.com[[ availability.$url(urls.embeds.book.item.book) ]]?full-items=yes</textarea>
</div>
<div class="flyout-section"
ng-if="bookingRestrictions.length"
>
<h2>Restrictions</h2>
<ul class="flyout-presets">
<li class="flyout-preset-edit-wrap-clickable"
ng-else="editCtrl.editingBookingRestriction"
ng-click="editCtrl.editingBookingRestriction = true"
>
<span class="fh-blue" ng-if-once="availability.bookingRestriction">
Overridden: [[ availability.bookingRestriction.name ]]
</span>
<span class="fh-grey" ng-else-once="availability.bookingRestriction">
Use item settings ([[ availability.item.bookingRestriction ? availability.item.bookingRestriction.name : T('Custom restrictions') ]])
</span>
<a class="flyout-preset-edit-btn">
<span>Edit</span>
</a>
</li>
<li ng-if="editCtrl.editingBookingRestriction"
ng-init="editCtrl.isRestrictionsOverridden = !!availability.bookingRestriction"
>
<div class="field field-cb"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="editCtrl.isRestrictionsOverridden"
>
</span>
<span class="label-text">
Override restrictions
</span>
</span>
</label>
</div>
<div ng-if="editCtrl.isRestrictionsOverridden">
<div class="updateavailabilitystatusform-bookingrestriction "
ng-django-field="updateAvailabilityStatusForm [&#39;bookingRestriction&#39;]" ng-django-field-model="editableAvailability [&#39;bookingRestriction&#39;]"
>
<div ng-current-option="editableAvailability [&#39;bookingRestriction&#39;]"
ng-current-option-collection="bookingRestrictions"
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field">
<select name="booking_restriction"
ng-model="editableAvailability [&#39;bookingRestriction&#39;]"
ng-disabled=""
ng-options="bookingRestriction.pk as bookingRestriction.name for bookingRestriction in bookingRestrictions"
ng-dropdown
ng-placeholder="Choose restrictions"
ng-dropdown-allow-clear="false"
>
</select>
<i ng-link="f-req"></i>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="updateAvailabilityStatusForm [&#39;bookingRestriction&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in updateAvailabilityStatusForm [&#39;bookingRestriction&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div class="btns">
<button class="btn-tiny btn-green btn-left"
type="button"
ng-disabled="updateAvailabilityStatusForm.$invalid || updateAvailabilityStatusForm.$submitting || updateAvailabilityStatusForm.$pristine"
ng-click="editCtrl.submit(updateAvailabilityStatusForm)"
>Save</button>
<button class="btn-tiny btn-grey"
type="button"
ng-click="editCtrl.editingBookingRestriction = false"
>Cancel</button>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in updateAvailabilityStatusForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</form>
<div ng-else="editing"
class="ava-status-header"
>
<div ng-if="Availability.isInPast(availability)" ng-then="noStatusPast">
This availability cannot be booked by or shown to online customers because it&#039;s in the past
</div>
<div ng-if="availability.item.isPrivate && !noStatusPast" ng-then="noStatusPrivate">
This availability cannot be booked by or shown to online customers because the item is set to private
</div>
<div ng-if="availability.unbookableReason && !noStatusPast && !noStatusPrivate" ng-then="unbookable">
Not bookable online: <b>[[ availability.unbookableReason ]]</b>
</div>
<div ng-if="!(unbookable || noStatusPast || noStatusPrivate)"
ng-then="bookableOnline"
>
<b class="ava-status-header-online">Currently bookable online</b>
</div>
</div>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
<div class="flyout-section">
<div class="hint">
<a ng-href="https://fareharbor.com/help/dashboard/availabilities/updating/online-booking-status/"
ng-outbound-link="_blank"
class="hint-help-link"
>Get help with online booking statuses</a>
</div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = statusToggle"></div>
</div>
</div>
<div class="tb-flyout-wrap"
ng-can="viewCapacities on availability"
ng-with="capacityToggle = 'capacity-' + $id; "
>
<div class="tb-btn tb-btn--flyout test-availability-capacity
[[ availability|capacityClass ]]
"
ng-if-once="company.companyFeatures.isResourceBookableCapacityEnabled"
ng-then="resourceBookableCapacityEnabled"
ng-toggle ng-toggle-value="capacityToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="[! company|capacityIndicatorClass:'filled':'large' !]"></i>
<span>
[[ availability.customerCount ]] booked
</span>
<span ng-if="availability.bookableCapacity !== null">
<i class="[! company|capacityIndicatorClass:'large' !]"></i>
[[
availability.nonResourceBookableCapacity < 0 ?
' ' + interpolate(T('Overbooked by %(count)s'), { count: -availability.nonResourceBookableCapacity }) :
''
]]
[[
!availability.blocks.length && !(availability.nonResourceBookableCapacity < 0) ?
interpolate(T('%(count)s available'), { count: availability.bookableCapacity }) :
''
]]
[[
availability.blocks.length && !(availability.nonResourceBookableCapacity < 0) ?
interpolate(T('%(count)s unreserved available'), { count: availability.bookableCapacity }) :
''
]]
</span>
<div class="tb-progress" ng-show="availability.customerCount && availability.bookableCapacity !== null">
<div class="tb-progress-gutter"></div>
<div class="cb-progress"
ng-style-once="{ 'width': ((availability.customerCount / (availability.customerCount + availability.bookableCapacity))|cssPercentage) }"
></div>
</div>
</div>
<div class="tb-btn tb-btn--flyout test-availability-capacity
[[ availability|capacityClass ]]
"
ng-else-once="resourceBookableCapacityEnabled"
ng-toggle ng-toggle-value="capacityToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="[! company|capacityIndicatorClass:'large' !]"></i>
<span ng-if-once="availability.bookableCapacity === null" ng-then="nullCapacity">
[[ availability.customerCount ]] booked
</span>
<span ng-if-once="availability.customerCount > 0 && availability.nonResourceBookableCapacity < 0" ng-then="isOverbooking">
<b>Overbooked</b> by [[ -availability.nonResourceBookableCapacity ]]
<span class="icon-hint"
ng-tip="[! T('You can change this availability\'s capacity in Settings if it is not actually overbooked') !]"
ng-can-update="availability"
></span>
</span>
<span ng-if-once="!nullCapacity && !isOverbooking && availability.blocksIncludedNonResourceBookableCapacity === 0 && availability.customerCount > 0"
ng-then="isFullIncludingBlocks"
>
All [[ availability.customerCount ]] full
</span>
<span ng-else-once="nullCapacity || isOverbooking || isFullIncludingBlocks">
<span ng-if-once="availability.blocks.length">
[[ availability.bookableCapacity ]] of [[ availability.customerCount + availability.bookableCapacity ]] unreserved available
</span>
<span ng-else-once="availability.blocks.length">
[[ availability.bookableCapacity ]] of [[ availability.customerCount + availability.bookableCapacity ]] available
</span>
</span>
<div class="tb-progress" ng-show="availability.customerCount && availability.capacity !== null">
<div class="tb-progress-gutter"></div>
<div class="cb-progress"
ng-style-once="{ 'width': (((availability.customerCount || 0) / (availability.customerCount + availability.bookableCapacity))|cssPercentage)}"
></div>
</div>
</div>
<div class="tb-flyout tb-flyout--auto-width nowrap--desktop"
ng-toggled ng-toggled-value="capacityToggle"
>
<div ng-link="capacity-flyout"></div>
<div ng-link="mobile-flyout-close" ng-with="toggle = capacityToggle"></div>
</div>
</div>
<div class="tb-flyout-wrap respond-print-hide"
ng-can-list="Block on availability.company"
ng-can-only-when="company.affiliatesCount && (availability.capacity !== null || blockCount > 0)"
ng-with="blocksToggle = 'blocks-' + $id; blockCount = availability.blocks ? availability.blocks.length : (availability.blockCount || 0)"
>
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="blocksToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
>
<i class="tb-icon blocks"></i> [[ interpolate(nT('%(count)s block', '%(count)s blocks', blockCount), { count: blockCount }) ]]
</div>
<div class="tb-flyout tb-flyout--show-overflow"
ng-toggled ng-toggled-value="blocksToggle"
>
<div ng-controller=
"dashboard.shared.BlocksCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div class="flyout-section flyout-section--no-border">
<h2>Blocks</h2>
<div class="hint">
Reserve spots for affiliate bookings
</div>
</div>
<ul class="flyout-presets">
<li ng-repeat="block in blocks">
<div ng-controller=
"dashboard.shared.BlockEditableCtrl"
class="" >
<div
ng-can-view="block"
ng-then="allowed">
<div ng-can-update="block" ng-can-only-when="editCtrl.editing" ng-then="editing">
<form class="flyout-preset-edit-form"
name="blockForm" ng-submit="editCtrl.submit(blockForm)"
>
<div class="flyout-create-form-header">
[! block.affiliation.affiliateCompany.name !]
</div>
<div class="fields "
>
<div class="blockform-reservedcapacity "
ng-django-field="blockForm [&#39;reservedCapacity&#39;]" ng-django-field-model="editableBlock [&#39;reservedCapacity&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_reserved_capacity" min="0" name="reservedCapacity" ng-int-input="" ng-int-input-max="100000" ng-int-input-min="0" ng-model="editableBlock [&#39;reservedCapacity&#39;]" ng-pattern="/^\d+$/" ng-placeholder="Number of seats to reserve" required="required" type="text" value="0" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="blockForm [&#39;reservedCapacity&#39;].$error['pattern']">Please enter a positive whole number</li>
<li ng-if="blockForm [&#39;reservedCapacity&#39;].$error['max']">Ensure this value is less than or equal to 100000.</li>
<li ng-if="blockForm [&#39;reservedCapacity&#39;].$error['invalid']">Enter a whole number.</li>
<li ng-if="blockForm [&#39;reservedCapacity&#39;].$error['min']">Ensure this value is greater than or equal to 0.</li>
<li ng-repeat="error in blockForm [&#39;reservedCapacity&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in blockForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<button class="btn-tiny btn-green btn-right" type="submit"
ng-disabled="blockForm.$invalid || blockForm.$pristine || blockForm.$submitting"
>
Save
</button>
<button class="btn-tiny btn-grey" type="button"
ng-click="editCtrl.cancel(blockForm)"
ng-disabled="blockForm.$submitting"
>
Cancel
</button>
<button class="btn-tiny btn-red btn--push-right" type="button"
ng-can-remove="block"
ng-click="editCtrl.remove()"
ng-confirm-click="[! T('Are you sure you want to delete this block?') !]"
ng-disabled="blockForm.$submitting"
>
Remove
</button>
</div>
</form>
</div>
<div ng-else="editing">
<div class="flyout-preset-text"
ng-click="editCtrl.edit()"
>
[! block.affiliation.affiliateCompany.name !]: <span class="[! company|capacityIndicatorClass:'filled' !]"></span>&nbsp;[! block.reservedCapacity !]
</div>
<a class="flyout-preset-edit-btn" ng-click="editCtrl.edit()" ng-can-update="block">
<span>Edit</span>
</a>
</div>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
</li>
<li class="flyout-presets-empty" ng-show="!blocks.length">No blocks added</li>
</ul>
<div ng-can-create="Block on availability">
<div class="flyout-create-form-toggle shaded hide-when-toggled"
ng-toggle="createBlock"
>Add block</div>
<form class="flyout-create-form shaded"
name="blockForm"
ng-submit="listCtrl.submit(blockForm)"
ng-toggled="createBlock"
>
<div class="flyout-create-form-header">
Add block
</div>
<div class="fields "
>
<div class="blockform-affiliation "
ng-django-field="blockForm [&#39;affiliation&#39;]" ng-django-field-model="newBlock [&#39;affiliation&#39;]"
ng-django-field-required=""
>
<div ng-current-option="newBlock [&#39;affiliation&#39;]"
ng-current-option-collection=""
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="affiliation"
ng-model="newBlock [&#39;affiliation&#39;]"
ng-disabled=""
required="required"
ng-options="option.pk as option.affiliateCompany.name for option in affiliations"
ng-dropdown
ng-placeholder="Choose affiliate"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="blockForm [&#39;affiliation&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in blockForm [&#39;affiliation&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="blockform-reservedcapacity "
ng-django-field="blockForm [&#39;reservedCapacity&#39;]" ng-django-field-model="newBlock [&#39;reservedCapacity&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_reserved_capacity" min="0" name="reservedCapacity" ng-int-input="" ng-int-input-max="100000" ng-int-input-min="0" ng-model="newBlock [&#39;reservedCapacity&#39;]" ng-pattern="/^\d+$/" ng-placeholder="Number of seats to reserve" required="required" type="text" value="0" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="blockForm [&#39;reservedCapacity&#39;].$error['pattern']">Please enter a positive whole number</li>
<li ng-if="blockForm [&#39;reservedCapacity&#39;].$error['max']">Ensure this value is less than or equal to 100000.</li>
<li ng-if="blockForm [&#39;reservedCapacity&#39;].$error['invalid']">Enter a whole number.</li>
<li ng-if="blockForm [&#39;reservedCapacity&#39;].$error['min']">Ensure this value is greater than or equal to 0.</li>
<li ng-repeat="error in blockForm [&#39;reservedCapacity&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in blockForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-tiny btn-green" type="submit"
ng-disabled="blockForm.$invalid || blockForm.$submitting"
>
Add block
</button>
</div>
</form>
</div>
<div class="flyout-section">
<div class="hint">
<a ng-href="https://fareharbor.com/help/dashboard/availabilities/updating/affiliate-blocks/" ng-outbound-link="_blank"
class="hint-help-link"
>How to use blocks</a>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = blocksToggle"></div>
</div>
</div>
</div>
<div class="tb-group">
<div class="tb-flyout-wrap respond-print-hide"
ng-can-list="CrewMember on availability.company"
ng-controller="dashboard.shared.AvailabilityCrewCtrl"
ng-with="crewToggle = 'crew-' + $id"
>
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="crewToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
>
<i class="tb-icon user"></i>
[[ availability.crewMembers.length ]] crew
</div>
<div class="tb-flyout tb-flyout--show-overflow"
ng-toggled ng-toggled-value="crewToggle"
>
<div ng-toggle="availability-crew-members"
ng-toggle-group="availability-crew"
ng-toggle-default="true"
ng-hide="true"
></div>
<div ng-toggle="availability-roles"
ng-toggle-group="availability-crew"
ng-hide="true"
></div>
<div ng-toggled="availability-crew-members">
<div ng-controller=
"dashboard.shared.CrewMembersCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div
ng-can-list="CrewMember on availability.company"
ng-then="allowed">
<ul ng-sortable="listCtrl.reorder"
class="flyout-presets flyout-presets--sortable"
>
<li class="flyout-presets-empty"
ng-if="!crewMembers.length"
>
No crew added to this availability
</li>
<li ng-repeat="crewMember in crewMembers" ng-sortable-item="crewMember">
<div ng-controller=
"dashboard.shared.CrewMemberEditableCtrl"
class="
crew-member
" >
<div
ng-can-view="crewMember"
ng-then="allowed">
<div ng-can-update="crewMember" ng-can-only-when="editCtrl.editing" ng-then="editing">
<form class="flyout-preset-edit-form"
name="crewMemberForm"
ng-submit="editCtrl.submit(crewMemberForm)"
>
<div class="fields "
>
<div class="crewmemberform-user "
ng-django-field="crewMemberForm [&#39;user&#39;]" ng-django-field-model="editableCrewMember [&#39;user&#39;]"
ng-django-field-required=""
>
<div ng-current-option="editableCrewMember [&#39;user&#39;]"
ng-current-option-collection="users"
ng-current-option-key="'pk'"
ng-current-option-target="user"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="user"
ng-model="editableCrewMember [&#39;user&#39;]"
ng-disabled=""
required="required"
ng-options="user.pk as User.displayName(user) for user in selectableUsers"
ng-dropdown
ng-placeholder="Choose user"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="crewMemberForm [&#39;user&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in crewMemberForm [&#39;user&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="crewmemberform-role "
ng-django-field="crewMemberForm [&#39;role&#39;]" ng-django-field-model="editableCrewMember [&#39;role&#39;]"
>
<div ng-current-option="editableCrewMember [&#39;role&#39;]"
ng-current-option-collection="selectableRoles"
ng-current-option-key="'pk'"
ng-current-option-target="role"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="role"
ng-model="editableCrewMember [&#39;role&#39;]"
ng-disabled=""
ng-options="option.pk as option.shortName for option in selectableRoles"
ng-dropdown
ng-placeholder="No role assigned"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="crewMemberForm [&#39;role&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in crewMemberForm [&#39;role&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="crewmemberform-note "
ng-django-field="crewMemberForm [&#39;note&#39;]" ng-django-field-model="editableCrewMember [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" name="note" ng-model="editableCrewMember [&#39;note&#39;]" ng-placeholder="Note (optional)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in crewMemberForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="crewMemberForm.all.$error.unauthorized">You are not authorized to edit crew assignments.</li>
<li ng-repeat="error in crewMemberForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div ng-hide="crewMemberForm.$pristine">
<div ng-if="user && isCrewChangeNotificationNeeded(user)"
class="crew-flyout-email-note"
>
[[ user.username ]] will be notified via email
<a class="icon-hint"
ng-tip="[[ interpolate(T('%(personName)s is subscribed to crew email notifications. Click here to learn more.'), { personName: user.name }) ]]"
ng-href="https://fareharbor.com/help/dashboard/users/email-notifications/#when-added-or-removed-as-a-crew-member" ng-outbound-link="_new"
></a>
</div>
<span ng-if="crewMember.user !== user">
<div ng-if="crewMember.user && isCrewChangeNotificationNeeded(crewMember.user)"
class="crew-flyout-email-note"
>
[[ crewMember.user.username ]] will be notified via email
<a class="icon-hint"
ng-tip="[[ interpolate(T('%(personName)s is subscribed to crew email notifications. Click here to learn more.'), { personName: crewMember.user.name }) ]]"
ng-href="https://fareharbor.com/help/dashboard/users/email-notifications/#when-added-or-removed-as-a-crew-member" ng-outbound-link="_new"
></a>
</div>
</span>
</div>
<div class="btns btns--reversed">
<button class="btn-tiny btn-green btn-right" type="submit"
ng-disabled="crewMemberForm.$invalid || crewMemberForm.$submitting || crewMemberForm.$pristine"
>
[[ crewMemberForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn-tiny btn-grey" type="button"
ng-click="editCtrl.cancel(crewMemberForm)"
>
Cancel
</button>
<button class="btn-tiny btn-red btn--push-right"
type="button"
ng-can-remove="crewMember"
ng-click="editCtrl.remove()"
ng-confirm-click="[! T('Delete this crew member?') !]"
>
Delete
</button>
</div>
</form>
</div>
<div ng-else="editing">
<div class="flyout-preset-text"
ng-click="editCtrl.edit()"
>
[! crewMember.user.name !]
<span class="fh-grey"
ng-if="crewMember.user.isInactive"
>
(deactivated)
</span>
<span ng-show="crewMember.role"
class="crew-flyout-role"
>
- [! crewMember.role.shortName !]
</span>
<div ng-show="crewMember.note"
class="crew-flyout-note"
>
[! crewMember.note !]
</div>
</div>
<a class="flyout-preset-edit-btn" ng-click="editCtrl.edit()" ng-can-update="crewMember">
<span>Edit</span>
</a>
</div>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
<span class="sortable-handle small"
ng-tip="[! T('Drag to reorder') !]" ng-tip-classes="tip-indent"
ng-can-update="crewMember"
ng-can-only-when="crewMembers.length > 1"
></span>
</li>
</ul>
<div ng-if-once="showAddCrewMemberForm">
<div class="flyout-create-form-toggle shaded hide-when-toggled"
ng-toggle="addCrewmember"
>Add crew member</div>
<form class="flyout-create-form shaded"
name="crewMemberForm"
ng-toggled="addCrewmember"
ng-submit="listCtrl.submit(crewMemberForm)"
>
<div class="flyout-create-form-header">
Add crew member
</div>
<div class="fields "
>
<div class="crewmemberform-user "
ng-django-field="crewMemberForm [&#39;user&#39;]" ng-django-field-model="newCrewMember [&#39;user&#39;]"
ng-django-field-required=""
>
<div ng-current-option="newCrewMember [&#39;user&#39;]"
ng-current-option-collection="users"
ng-current-option-key="'pk'"
ng-current-option-target="user"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="user"
ng-model="newCrewMember [&#39;user&#39;]"
ng-disabled=""
required="required"
ng-options="user.pk as User.displayName(user) for user in selectableUsers"
ng-dropdown
ng-placeholder="Choose user"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="crewMemberForm [&#39;user&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in crewMemberForm [&#39;user&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="crewmemberform-role "
ng-django-field="crewMemberForm [&#39;role&#39;]" ng-django-field-model="newCrewMember [&#39;role&#39;]"
>
<div ng-current-option="newCrewMember [&#39;role&#39;]"
ng-current-option-collection="selectableRoles"
ng-current-option-key="'pk'"
ng-current-option-target="role"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="role"
ng-model="newCrewMember [&#39;role&#39;]"
ng-disabled=""
ng-options="option.pk as option.shortName for option in selectableRoles"
ng-dropdown
ng-placeholder="No role assigned"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="crewMemberForm [&#39;role&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in crewMemberForm [&#39;role&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="crewmemberform-note "
ng-django-field="crewMemberForm [&#39;note&#39;]" ng-django-field-model="newCrewMember [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" name="note" ng-model="newCrewMember [&#39;note&#39;]" ng-placeholder="Note (optional)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in crewMemberForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="crewMemberForm.all.$error.unauthorized">You are not authorized to edit crew assignments.</li>
<li ng-repeat="error in crewMemberForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div ng-if="user && isCrewChangeNotificationNeeded(user)"
class="crew-flyout-email-note"
>
[[ user.username ]] will be notified via email
<a class="icon-hint"
ng-tip="[[ interpolate(T('%(personName)s is subscribed to crew email notifications. Click here to learn more.'), { personName: user.name }) ]]"
ng-href="https://fareharbor.com/help/dashboard/users/email-notifications/#when-added-or-removed-as-a-crew-member" ng-outbound-link="_new"
></a>
</div>
<button class="btn-tiny btn-green" type="submit"
ng-disabled="crewMemberForm.$invalid || crewMemberForm.$submitting"
>
Add
</button>
<div class="manage-roles-link"
ng-can-create="Role on availability.company"
>
<a ng-toggle="availability-roles" ng-toggle-group="availability-crew">Manage roles</a>
</div>
</form>
</div>
<div class="flyout-section">
<div class="hint">
<a ng-href="https://fareharbor.com/help/dashboard/crew/adding-and-removing/" ng-outbound-link="_blank"
class="hint-help-link"
>How to use crew</a>
</div>
</div>
</div>
<div ng-else="allowed">
<div ng-inline="forbidden"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-toggled="availability-roles">
<div ng-controller=
"dashboard.shared.RolesCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div
ng-can-list="Role on company"
ng-then="allowed">
<a class="flyout-back"
ng-toggle="availability-crew-members"
ng-toggle-group="availability-crew"
>Crew</a>
<ul class="flyout-presets">
<li ng-repeat="role in roles">
<div ng-controller=
"dashboard.shared.RoleEditableCtrl"
class="
role
" >
<div
ng-can-view="role"
ng-then="allowed">
<div ng-can-update="role" ng-can-only-when="editCtrl.editing" ng-then="editing">
<form class="flyout-preset-edit-form"
name="roleForm"
ng-submit="editCtrl.submit(roleForm)"
>
<div class="fields "
>
<div class="roleform-shortname flyout-create-form-field "
ng-django-field="roleForm [&#39;shortName&#39;]" ng-django-field-model="editableRole [&#39;shortName&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_short_name" maxlength="128" name="shortName" ng-model="editableRole [&#39;shortName&#39;]" ng-placeholder="Role name" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in roleForm [&#39;shortName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in roleForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<button class="btn-tiny btn-green btn-right" type="submit"
ng-disabled="roleForm.$invalid || roleForm.$submitting || roleForm.$pristine"
>
[[ roleForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn-tiny btn-grey" type="button"
ng-click="editCtrl.cancel(roleForm)"
>
Cancel
</button>
<a class="btn-tiny btn-red btn--push-right"
ng-can-remove="role"
ng-click="editCtrl.remove()"
ng-confirm-click="[! T('Delete this role?') !]"
>
Delete
</a>
</div>
</form>
</div>
<div ng-else="editing"
ng-click="editCtrl.edit()"
>
<div class="flyout-preset-text">
[! role.shortName !]
</div>
<a class="flyout-preset-edit-btn" ng-click="editCtrl.edit()" ng-can-update="role"><span>Edit</span></a>
</div>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
</li>
<li class="flyout-presets-empty" ng-show="!roles.length">No roles added</li>
</ul>
<form class="flyout-create-form shaded"
name="roleForm"
ng-can-create="Role on company"
ng-submit="listCtrl.submit(roleForm)"
>
<div class="fields "
>
<div class="roleform-shortname flyout-create-form-field "
ng-django-field="roleForm [&#39;shortName&#39;]" ng-django-field-model="newRole [&#39;shortName&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_short_name" maxlength="128" name="shortName" ng-model="newRole [&#39;shortName&#39;]" ng-placeholder="Role name" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in roleForm [&#39;shortName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in roleForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<button class="btn-tiny btn-green" type="submit"
ng-disabled="roleForm.$invalid || roleForm.$submitting"
>
Add
</button>
</form>
<div class="flyout-section">
<div class="hint">
<a ng-href="https://fareharbor.com/help/dashboard/crew/roles/" ng-outbound-link="_blank"
class="hint-help-link"
>Working with roles</a>
</div>
</div>
</div>
<div ng-else="allowed">
<div ng-inline="forbidden"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = crewToggle"></div>
</div>
</div>
</div>
</div>
<div class="tb-right">
<div class="tb-group respond-print-hide"
ng-can-update="availability"
ng-can-only-when="!hideAvailabilityStatsSettings"
>
<a class="tb-btn tb-btn--popup"
ng-href="[! availability.$url(urls.dashboard.overlay.availability.index) !]"
>
<span class="tb-icon cog"></span>
Actions & Settings
</a>
</div>
<div class="tb-group">
<div class="tb-data"
ng-if-once="showAvailabilityPrintAll"
ng-link="manifest-print-all"
></div>
<div class="respond-print-hide tb-data"
ng-presence="[! availability.uri !]:book"
ng-presence-view-only
ng-presence-tip="[! T('Currently booking') !]"
ng-presence-icon="pencil-writing"
ng-presence-company="availability.company"
></div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</script>
<script type="text/ng-template" id="auto-exporter">
<span ng-if="autoExport.canExport(namespace)">
<a ng-if="autoExport.isDownloadSupported" ng-then="downloadsSupported"
class="tb-btn [[ (!autoExport.ready())|addClassIf:'tb-btn--processing toggled' ]]"
ng-tip="[! T('Download CSV') !]"
ng-disabled="!autoExport.ready()"
ng-click="autoExport.autoExport(namespace, filename)"
>
<i class="tb-icon download"></i> <abbr>Download CSV</abbr>
</a>
<div ng-else="downloadsSupported" class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="downloadMenu"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Download') !]"
>
<i class="tb-icon download"></i> <abbr>Download</abbr>
</div>
<div class="tb-flyout [! isLeft|addClassIf:'tb-flyout--left' !] tb-flyout--auto-width-narrow" ng-toggled="downloadMenu">
<ul class="flyout-menu-items-lis">
<li ng-if="autoExport.ready()" ng-then="canDownload"
ng-click="autoExport.autoExport(namespace, filename)"
ng-alt-click="autoExport.autoExport(namespace, filename, { openWindow: true })"
>
Download CSV
</li>
<li ng-else="canDownload"
class="is-disabled"
>
Processing...
</li>
</ul>
<div class="flyout-section">
<div class="hint">
<a ng-href="https://fareharbor.com/help/more/downloading/#slow-downloads" ng-outbound-link="_blank"
class="hint-help-link"
>Trouble with slow downloads?</a>
</div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'downloadMenu'"></div>
</div>
</div>
</span>
</script>
<script type="text/ng-template" id="booking-actions-notify-toggle">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2 ng-if="actionsCtrl.isSelected(actionsCtrl.NOTIFY)">Send email</h2>
<h2 ng-if="actionsCtrl.isSelected(actionsCtrl.NOTIFY_SMS)">Send text message</h2>
</div>
</div>
<ul ng-if="actionsCtrl.isSelectable(actionsCtrl.NOTIFY) && actionsCtrl.isSelectable(actionsCtrl.NOTIFY_SMS)"
class="field field-radio-group field-radio-group--large hack-hide-notify-submitting"
>
<li>
<label ng-click="actionsCtrl.select(actionsCtrl.NOTIFY)"
ng-class="{ 'radio-selected': actionsCtrl.isSelected(actionsCtrl.NOTIFY) }"
>
<input type="radio" ng-checked="actionsCtrl.isSelected(actionsCtrl.NOTIFY)" />
Email
</label>
</li>
<li>
<label ng-click="actionsCtrl.select(actionsCtrl.NOTIFY_SMS)"
ng-class="{ 'radio-selected': actionsCtrl.isSelected(actionsCtrl.NOTIFY_SMS) }"
>
<input type="radio" ng-checked="actionsCtrl.isSelected(actionsCtrl.NOTIFY_SMS)" />
Text message
</label>
</li>
</ul>
</script>
<script type="text/ng-template" id="booking-fee-flag">
<i class="booked-online-icon grey respond-print-hide"
ng-if-once="payment.initialReceipt.bookingFee"
ng-tip="
[!
auth.permissions.can('viewAdminSection', auth.currentUser.company) ?
'Booking fee: ' + (payment.initialReceipt.bookingFee|amount:payment) :
T('+ booking fee')
!]
"
></i>
</script>
<script type="text/ng-template" id="booking-invoices-list">
<div class="invoice-affiliation-invoices"
ng-if="booking.invoiceEntries"
>
[! nT('On invoice', 'On invoices', booking.invoiceEntries.length) !]
<span ng-repeat="entry in booking.invoiceEntries">
<span class="affiliation-invoice-link">
<a class="invoice-link-id" ng-can-view="entry.invoice" ng-then="canViewInvoice"
ng-href="[! entry.invoice|invoiceUrl !]"
>
[! entry.invoice.identifier !]
</a>
<span ng-else="canViewInvoice">[! entry.invoice.identifier !]</span>
<span ng-link="invoice-paid-status" ng-with="invoice = entry.invoice"></span>
</a><span ng-if="!$last">,</span>
</span>
</div>
</script>
<script type="text/ng-template" id="booking-network-contact">
<div ng-if="navigation.isCurrentCompany(booking.affiliation.affiliateCompany)" ng-then="showCharterInfo">
<div ng-link="booking-network-contact-details"
ng-with="company = booking.company"
></div>
</div>
<div ng-else="showCharterInfo">
<div ng-link="booking-network-contact-details"
ng-with="company = booking.affiliation.affiliateCompany"
></div>
</div>
</script>
<script type="text/ng-template" id="booking-network-contact-details">
<b>[! company.name !]</b>
<table class="spreadsheet show-links spreadsheet--shade-first-col"
ng-if="company.phone || company.alternatePhone || company.fax || company.email"
ng-then="hasContactInfo"
>
<tbody>
<tr ng-show="company.phone">
<td><b>Phone</b></td>
<td>
<a ng-href="tel:[! company.phone !]">[! company.phone|phone !]</a>
</td>
</tr>
<tr ng-show="company.alternatePhone">
<td><b>Alt phone</b></td>
<td>
<a ng-href="tel:[! company.alternatePhone !]">[! company.alternatePhone|phone !]</a>
</td>
</tr>
<tr ng-show="company.fax">
<td><b>Fax</b></td>
<td>[! company.fax|phone !]</td>
</tr>
<tr ng-show="company.email">
<td><b>Email</b></td>
<td>
<a ng-href="mailto:[! company.email !]">
[! company.email !]
</a>
</td>
</tr>
</tbody>
</table>
<div class="hint"
ng-else="hasContactInfo"
>
No contact information available
</div>
</script>
<script type="text/ng-template" id="overview-payment-refund-meta">
<table class="overview-payment-row overview-payment-meta">
<tr>
<td>
<div ng-toggled ng-toggled-value="'paymentDetails' + refund.pk">
<div>Payment ID: <b>#[! refund.pk !]</b></div>
<div>Refund time: <b>[! refund.createdAt|time !]</b></div>
</div>
[! refund.createdAt|date !] by [! refund.user.name !]
</td>
<td class="op-meta">
<div ng-toggled ng-toggled-value="'paymentDetails' + refund.pk">
<div>
Subtotal: -<b ng-amount="refund.costs.totalCost.price" ng-amount-currency="refund.payment"></b>
</div>
<div ng-init="
company = refund.payment.company;
taxByType = Refund.taxByType(refund);
isRefund = true;"
>
<div ng-if-once="taxByType"
ng-inline="dashboard.bookings.taxByType"
></div>
<div ng-else-once="taxByType">
[! Company.taxDisplayName(refund.payment.company) !]: -<b ng-amount="refund.costs.totalCost.tax" ng-amount-currency="refund.payment"></b>
</div>
</div>
</div>
<a class="op-details-link"
ng-toggle ng-toggle-value="'paymentDetails' + refund.pk"
>
Details
</a>
</td>
</tr>
</table>
</script>
<script type="text/ng-template" id="capacity-flyout">
<div class="capacity-flyout">
<ul class="list-filters flyout-section flyout-section--bottom-border"
ng-show="availability.requirementGroup"
>
<li ng-toggle="customerCapacities"
ng-toggle-group="capacityFlyout"
ng-toggle-default="true"
title="[! T('View customer capacities') !]"
>
Capacities
</li>
<li ng-toggle="resourceUses"
ng-toggle-group="capacityFlyout"
title="[! T('View resource usage') !]"
>
Resources
</li>
</ul>
<div ng-toggled-show="customerCapacities">
<div ng-live-capacity="availability"
ng-live-capacity-large
></div>
<div ng-link="book.availabilityBlocks"></div>
</div>
<div ng-toggled-show="resourceUses"
ng-if="availability.requirementGroup"
ng-availability-resource-uses="availability"
></div>
</div>
</script>
<script type="text/ng-template" id="contact-booking-row">
<div class="td">
<span class="badge badge-error"
ng-if="!booking.rebookedTo && booking.isCancelled"
>Cancelled</span>
<b>
<i class="[! booking|colorClass:'-swatch inline-swatch' !]"></i>
[! booking.availability.item|name !]
<span ng-if="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</b>
<span class="fh-grey contact-booking-meta">
<span ng-if-once="Availability.isInPast(booking.availability)"
class="badge ghost warning-color"
>Past</span>
[! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !]
&bull;
[! booking.customerBreakdownShort !]
</span>
</div>
<div class="td contact-booking-id">
<span ng-can-view-amounts="booking.company"
ng-can-only-when="!booking.rebookedTo"
class="badge nowrap
[[ booking.isUnprocessed || booking.isCancelled ? '' : 'badge-' + booking.paidStatus|css ]]"
>
[[
booking.isUnprocessed ? T('Pending') : (
booking.isCancelled ?
!booking.receipt.gross ? T('Refunded') : interpolate(T('%(amount)s Paid'), { amount: (booking.receipt.gross|amount:booking) })
: (
booking.amountDue || booking.amountOverpaid ? (
booking.amountDue ?
interpolate(T('%(amount)s Due'), { amount: (booking.amountDue|amount:booking) }) :
interpolate(T('%(amount)s Overpaid'), { amount: (booking.amountOverpaid|amount:booking) })
) : T('Paid')
)
)
]]
</span>
<span class="booking-pk-color">#[! booking.pk !]</span>
</div>
</script>
<script type="text/ng-template" id="contact-actions-menu">
<div ng-controller="dashboard.bookings.ContactActionsCtrl" is-menu>
<div class="tb-flyout-wrap respond-handhelds-hide"
ng-if="actionsCtrl.isAnySelectable(actionsCtrl.CREATE_BOOKING)"
ng-then="showContactActions"
>
<div class="tb-btn tb-btn--flyout tb-collapse-on-mobile"
ng-toggle="contactAdvanced"
ng-toggle-auto-close
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-tip="[! T('Contact options') !]"
>
<i class="tb-icon hamburger"></i>
</div>
<div ng-toggled="contactAdvanced" class="tb-flyout tb-flyout--auto-width-narrow tb-flyout--left">
<div ng-link="mobile-flyout-close" ng-with="toggle = 'contactAdvanced'"></div>
<ul class="flyout-menu-items"
ng-toggle="contactAdvanced"
>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.MODIFY)">
<a ng-href="[! contact|contactUrl !]?action=modify">
Manage orders
</a>
</li>
</ul>
</div>
</div>
<div class="respond-handhelds-show"
ng-if="showContactActions"
>
<a class="tb-btn"
ng-href="[! contact|contactUrl !]"
>
<i class="tb-icon cog"></i>
Contact actions
</a>
</div>
</div>
</script>
<script type="text/ng-template" id="custom-field-editable">
<div ng-controller=
"dashboard.shared.CustomFieldEditableCtrl"
class="
test-editable-custom-field-[[ customField.name|css ]] tb-flyout-wrap
" >
<div
ng-can-update="customField"
ng-then="allowed">
<div class="tb-btn tb-btn--flyout test-edit-custom-field-link"
ng-toggle ng-toggle-value="toggleValue"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
>
<i class="tb-icon pencil"></i>
Edit field
</div>
<div class="tb-flyout tb-flyout--auto-width"
ng-toggled ng-toggled-value="toggleValue"
>
<div class="flyout-section" ng-if="showLink">
<a ng-href="[[ customField.$url(urls.dashboard.settings.customFields.customField) ]]"
class="btn btn-darkgrey btn-wide"
ng-confirm-click="[! T('Go to Settings and edit this custom field?') !]"
>
Edit all options &raquo;
</a>
</div>
<form class="test-edit-custom-field-form"
name="updateCustomFieldForm"
ng-submit="editCtrl.submit(updateCustomFieldForm)"
ng-confirm-navigate-away
>
<div class="fields "
>
<div class="flyout-section">
<h2>Custom field settings</h2>
<div class="hint">
<i class="warning-icon"></i> Changes made to these settings will be applied everywhere this field is used, including already created bookings.
</div>
</div>
<div class="flyout-section flyout-section--shade nowrap--desktop">
<ul class="list-filters">
<li ng-toggle="cfFormDisplay"
ng-toggle-group="updateCustomField"
ng-toggle-default="true"
>
Display
</li>
<li ng-if="customField.type === CustomField.CARD_GENERATOR_TYPE"
ng-toggle="cfFormGiftCard"
ng-toggle-group="updateCustomField"
>
Gift Card
</li>
<li ng-toggle="cfFormGeneral"
ng-toggle-group="updateCustomField"
>
<span ng-if="!CustomField.isDisplayOnly(editableCustomField)">Settings & Pricing</span>
<span ng-else="!CustomField.isDisplayOnly(editableCustomField)">Settings</span>
</li>
<li ng-toggle="cfFormAdvanced"
ng-toggle-group="updateCustomField"
ng-if="CustomField.needsBookingNotes(editableCustomField)"
>
Email notes
</li>
</ul>
</div>
<div>
<div ng-toggled-show="cfFormDisplay"
ng-toggle-group="updateCustomField"
>
<div class="flyout-section">
<div ng-if="editableCustomField.type === CustomField.WAIVER_TYPE"
ng-link="waiver-description-hint"
></div>
<div ng-hide="CustomField.isDisplayOnly(editableCustomField) && !editableCustomField.title">
<div class="updatecustomfieldform-title "
ng-django-field="updateCustomFieldForm [&#39;title&#39;]" ng-django-field-model="editableCustomField [&#39;title&#39;]"
>
<label >
<span class="label-text">
Title
</span>
<span class="the-field-outer"
ng-class="{ '-is-translatable': company.companyFeatures.isContentTranslationEnabled && auth.permissions.canList(SupportedLanguage, company) && editableCustomField.pk }"
>
<span class="the-field">
<input data-lpignore="true" id="id_title" maxlength="256" name="title" ng-model="editableCustomField [&#39;title&#39;]" ng-placeholder="Heading text" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<a class="translation-jump-link"
ng-open-supported-languages-popover="&#39;title&#39;"
ng-open-supported-languages-popover-field-name="title"
ng-open-supported-languages-popover-field-ng-model="editableCustomField"
ng-open-supported-languages-popover-parent-field="null"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableCustomField.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
</a>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;title&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="CustomField.needsHint(editableCustomField)">
<div class="updatecustomfieldform-hint "
ng-django-field="updateCustomFieldForm [&#39;hint&#39;]" ng-django-field-model="editableCustomField [&#39;hint&#39;]"
>
<label >
<span class="label-text">
Hint
</span>
<span class="the-field-outer"
ng-class="{ '-is-translatable': company.companyFeatures.isContentTranslationEnabled && auth.permissions.canList(SupportedLanguage, company) && editableCustomField.pk }"
>
<span class="the-field">
<input data-lpignore="true" id="id_hint" maxlength="128" name="hint" ng-model="editableCustomField [&#39;hint&#39;]" ng-placeholder="[! customField.type === CustomField.NEW_TRANSPORTATION_TYPE ? T(&#39;Text shown inside the field before option is selected&#39;) : T(&#39;Text shown inside the field before user starts typing&#39;) !]" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<a class="translation-jump-link"
ng-open-supported-languages-popover="&#39;hint&#39;"
ng-open-supported-languages-popover-field-name="hint"
ng-open-supported-languages-popover-field-ng-model="editableCustomField"
ng-open-supported-languages-popover-parent-field="null"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableCustomField.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
</a>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;hint&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="updatecustomfieldform-description field-textarea
field-markdown
"
ng-django-field="updateCustomFieldForm [&#39;description&#39;]" ng-django-field-model="editableCustomField [&#39;description&#39;]"
>
<label >
<span class="label-text">
Description
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_description" name="description" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-parent=".updatecustomfieldform-description" ng-markdown-preview=".js-markdown-tb .js-preview-button" ng-markdown-preview-result=".js-markdown-preview-result" ng-model="editableCustomField [&#39;description&#39;]" ng-placeholder="Text displayed below the field" rows="10">
</textarea>
<span class="field-style-hook"></span>
<div ng-toggled-show class="markdown-preview prose js-markdown-preview-result"
ng-toggled-show-value="'markdownPreview-' + $id"
></div>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;description&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb markdown-field-tb tb--shaded js-markdown-tb">
<div class="tb-left"
>
<div class="tb-group">
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
<a class="tb-btn tb-btn--flyout"
ng-open-supported-languages-popover="&#39;description&#39;"
ng-open-supported-languages-popover-field-name="description"
ng-open-supported-languages-popover-field-ng-model="editableCustomField"
ng-open-supported-languages-popover-parent-field="null"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableCustomField.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
<abbr>Translations</abbr>
</a>
</div>
</div>
<div class="tb-right">
<div class="tb-group">
<span class="tb-btn js-preview-button" ng-toggle ng-toggle-value="'markdownPreview-' + $id">
Preview Markdown
<a class="icon-hint"
ng-tip="[! T('Markdown lets you format text using a special syntax. Click here to learn more about it.') !]"
ng-href="https://fareharbor.com/help/more/markdown/" ng-outbound-link="_new"
></a>
</span>
</div>
</div>
</div>
</div>
<div ng-if="editableCustomField.type === CustomField.COUNT_TYPE">
<div class="hint hint-alert">
<b>Enter the highest and lowest quantities</b> you want to allow, in whole numbers.
</div>
<table class="count-field-setup">
<tr>
<td>
<div class="updatecustomfieldform-countmin "
ng-django-field="updateCustomFieldForm [&#39;countMin&#39;]" ng-django-field-model="editableCustomField [&#39;countMin&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Minimum
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_count_min" min="0" name="countMin" ng-int-input="" ng-int-input-min="0" ng-model="editableCustomField [&#39;countMin&#39;]" ng-pattern="/^\d+$/" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateCustomFieldForm [&#39;countMin&#39;].$error['pattern']">Must be a positive number</li>
<li ng-if="updateCustomFieldForm [&#39;countMin&#39;].$error['invalid']">Enter a whole number.</li>
<li ng-if="updateCustomFieldForm [&#39;countMin&#39;].$error['min']">Ensure this value is greater than or equal to 0.</li>
<li ng-repeat="error in updateCustomFieldForm [&#39;countMin&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
<td>
<div class="updatecustomfieldform-countmax "
ng-django-field="updateCustomFieldForm [&#39;countMax&#39;]" ng-django-field-model="editableCustomField [&#39;countMax&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Maximum
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_count_max" min="0" name="countMax" ng-int-input="" ng-int-input-min="0" ng-model="editableCustomField [&#39;countMax&#39;]" ng-pattern="/^\d+$/" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateCustomFieldForm [&#39;countMax&#39;].$error['pattern']">Must be a positive number</li>
<li ng-if="updateCustomFieldForm [&#39;countMax&#39;].$error['invalid']">Enter a whole number.</li>
<li ng-if="updateCustomFieldForm [&#39;countMax&#39;].$error['min']">Ensure this value is greater than or equal to 0.</li>
<li ng-repeat="error in updateCustomFieldForm [&#39;countMax&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
</tr>
</table>
</div>
<div ng-if="customField.type === CustomField.MULTI_CAMPAIGN_TYPE">
<div class="field field-cb"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="editableCustomField.isCodeInputHiddenByDefault"
>
</span>
<span class="label-text">
Hide code input behind a link for online customers
</span>
</span>
</label>
</div>
<div ng-if="editableCustomField.isCodeInputHiddenByDefault">
<div class="updatecustomfieldform-codetoggletext "
ng-django-field="updateCustomFieldForm [&#39;codeToggleText&#39;]" ng-django-field-model="editableCustomField [&#39;codeToggleText&#39;]"
>
<label >
<span class="label-text">
Custom text instead of "Add promo or discount code":
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_code_toggle_text" maxlength="128" name="codeToggleText" ng-model="editableCustomField [&#39;codeToggleText&#39;]" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;codeToggleText&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-if="editableCustomField.type === CustomField.NEW_TRANSPORTATION_TYPE">
<div class="updatecustomfieldform-islodgingroomnumberhidden field-cb "
ng-django-field="updateCustomFieldForm [&#39;isLodgingRoomNumberHidden&#39;]" ng-django-field-model="editableCustomField [&#39;isLodgingRoomNumberHidden&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_lodging_room_number_hidden" name="isLodgingRoomNumberHidden" ng-checkbox-madness="true" ng-model="editableCustomField [&#39;isLodgingRoomNumberHidden&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Hide room number input
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;isLodgingRoomNumberHidden&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-if="CustomField.isDefaultValueAllowed(editableCustomField)">
<ul class="toggle-header-list">
<li>
<a ng-toggle="cfLogicDefault"
ng-toggle-group="cfLogic" ng-toggle-group-closeable
class="flyout-toggle-header small"
ng-class="{ 'active': editableCustomField.isDefaulted }"
>Default value</a>
<div ng-toggled="cfLogicDefault">
<div class="flyout-section flyout-section--no-border">
<div class="hint">
This option will be pre-set when filling out the book form.
<a ng-href="https://fareharbor.com/help/dashboard/custom-fields/default-values/" ng-outbound-link="_blank"
class="hint-help-link"
>Learn more</a>
</div>
</div>
<div class="flyout-section flyout-section--no-border">
<div class="updatecustomfieldform-isdefaulted field-cb "
ng-django-field="updateCustomFieldForm [&#39;isDefaulted&#39;]" ng-django-field-model="editableCustomField [&#39;isDefaulted&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_defaulted" name="isDefaulted" ng-checkbox-madness="true" ng-model="editableCustomField [&#39;isDefaulted&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Set a default value
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;isDefaulted&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="editableCustomField.isDefaulted">
<div ng-with="customFieldPricing = PriceLine.NONE_PRICING"
ng-prices-none
>
<div class="updatecustomfieldform-value "
ng-django-field="updateCustomFieldForm [&#39;value&#39;]" ng-django-field-model="editableCustomField [&#39;value&#39;]"
ng-class="{ 'is-display-only': customField.isDisplayOnly }"
>
<div class="cf-wrap cf-wrap--[! customField.type|css !]
[! CustomField.usesCheckbox(customField) ? 'cf-wrap--checkbox' : '' !]"
ng-class="{
'private-field': customFieldPricing.visibility.isHiddenWhenBooking || customField.isPrivate
}"
>
<span class="private-field-icon test-private-custom-field-indicator"
ng-tip="[[ customField.isPrivate ? T('Only shown to logged in users with permission to see private fields. (That\'s you!)') : T('Will not be shown when booking') ]]"
ng-tip-location=".private-field-lock"
>
<span class="private-field-lock"></span>
</span>
<div ng-if-once="customField.isDisplayOnly">
<div ng-if="customField.type === CustomField.HEADER_TYPE">
<h2>[! customField.title !]</h2>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if="customField.type === CustomField.NOTE_TYPE" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.SHORT_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field test-custom-field-[! customField.name|css !]">
<span class="label-text">[! customField.hint !]</span>
<input id="id_short" maxlength="2048" name="value" ng-model="editableCustomField [&#39;value&#39;]" ng-pseudo-placeholder="True" type="text" />
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.LONG_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="the-field test-custom-field-[! customField.name|css !]">
<textarea cols="40" id="id_long" name="value" ng-model="editableCustomField [&#39;value&#39;]" ng-placeholder="[! customField.hint !]" rows="10">
</textarea>
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.YES_NO_TYPE">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="editableCustomField [&#39;value&#39;]" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
<label ng-if="customField.type === CustomField.COUNT_TYPE && editableCustomField.type !== CustomFieldInstanceCondition.RANGE_TYPE"
class="custom-field-[! customField.type|css !] cf-label table valign-middle table-dont-respond"
ng-init="editableCustomField [&#39;value&#39;] = ((editableCustomField [&#39;value&#39;]|isDefined) ? editableCustomField [&#39;value&#39;] : customField.countMin)"
>
<div class="tr">
<div class="td count-field-select"
ng-hide="customField.countMin === customField.countMax && editableCustomField [&#39;value&#39;] === customField.countMin"
>
<select
ng-model="editableCustomField [&#39;value&#39;]"
ng-options="option for option in customField.countMin|range:(customField.countMax + 1)"
ng-prefix=""
name="value"
></select>
</div>
<div class="td">
<div class="cf-title">
[! customField.title !]<span
ng-if="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)"
><span ng-if="customField.isPricingHidden && bookCtrl.newBookingOptions.totalCosts[&#39;value&#39;] && PriceLine.showRate(customFieldPricing)"
>: <span ng-amount="bookCtrl.newBookingOptions.totalCosts[&#39;value&#39;].price"></span>
</span>
<span ng-if="!customField.isPricingHidden">
<span class="fh-grey">&mdash;</span>
<span ng-price="customFieldPricing"
ng-price-company="customField.company"
ng-price-count="editableCustomField [&#39;value&#39;]"
></span>
</span>
</span>
</div>
<div ng-inline="cf-description"></div>
</div>
</div>
</label>
<div ng-if-once="customField.type === CustomField.EXTENDED_OPTION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-prices-extended-options="editableCustomField [&#39;value&#39;]"
ng-prices-extended-options-field="customField"
ng-prices-extended-options-instance="customFieldInstance"
ng-prices-extended-options-currency="customField"
ng-current-option="editableCustomField [&#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="pricesExtendedOptionsCtrl.options"
ng-current-option-target="currentOption"
>
<div ng-if="pricesExtendedOptionsCtrl.isImpossibleOption" ng-then="impossibleOption">
<div class="cf-title">
<i class="warning-icon"></i> [! customField.title !]
</div>
</div>
<div ng-if="pricesExtendedOptionsCtrl.isForcedOption" ng-then="forcedOption"
ng-init="updateCustomFieldForm.$setDirty()"
class="cf-title"
>
<span ng-if="!customField.isPricingHidden"
ng-with="currentOptionPricing = pricesCtrl.totalPricing(currentOption.extendedOption)"
>
<span ng-price="currentOptionPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && currentOption.extendedOption.isAlwaysPerCustomer">
per person
</span>
<span ng-if="PriceLine.showOffset(currentOptionPricing)"></span>
<span ng-if="currentOption.extendedOption.name && (
PriceLine.showOffset(currentOptionPricing) ||
PriceLine.showRate(currentOptionPricing)
)" class="fh-grey"
>&mdash;</span>
</span>
<span ng-bind="currentOption.extendedOption.name"></span>
</div>
<div ng-else="impossibleOption || forcedOption">
<label class="cf-label">
<div class="cf-title" ng-show="customField.title">
<span ng-bind="customField.title"></span>
</div>
<div class="the-field cf-extended-option-dropdown">
<select ng-model="editableCustomField [&#39;value&#39;]"
ng-options="option.pk as option.label for option in pricesExtendedOptionsCtrl.options"
ng-prefix=""
ng-required=""
name="value"
ng-dropdown
ng-placeholder="[! T('Choose an option') !]"
></select>
<i ng-link="f-req" ng-with="label = T('Choice is required')"></i>
</div>
</label>
</div>
<div ng-show="currentOption">
<div class="option-details md-inline" ng-if="currentOption.extendedOption.description"
ng-bind-html="currentOption.extendedOption.descriptionSafeHtml"
></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-current-option="editableCustomField [&#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="customField.transportationOptions"
ng-current-option-target="currentTransportationOption"
>
<div class="cf-title">
<span ng-bind-once="customField.title"></span>
<span ng-if="!customField.isPricingHidden">
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</div>
<div ng-if="customField.transportationOptions.length === 1" ng-then="fullTransportation"
ng-init="editableCustomField [&#39;value&#39;] = customField.transportationOptions[0].pk"
></div>
<div ng-else="fullTransportation"
class="cf-transportation-dropdown"
>
<select
ng-init="editableCustomField [&#39;value&#39;] = editableCustomField [&#39;value&#39;] || (customField.transportationOptions.length && customField.transportationOptions[0].pk)"
ng-model="editableCustomField [&#39;value&#39;]"
ng-options="transportationOption.pk as transportationOption.location for transportationOption in customField.transportationOptions"
ng-prefix=""
name="value"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-placeholder="[! T('Choose transportation') !]"
>
</select>
</div>
<div class="transportation-details">
<h3 class="pickup-time">
<span ng-if="currentTransportationOption.isSelfTransportation" ng-then="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
Please arrive by [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
Please arrive [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
<span ng-else="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
We'll pick you up at [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
We'll pick you up [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
</h3>
<div class="transportation-note md-inline" ng-if="currentTransportationOption.description"
ng-bind-html="currentTransportationOption.descriptionSafeHtml"></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"></div>
</div>
<div ng-if-once="customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-new-transportation="editableCustomField [&#39;value&#39;]"
ng-mx-form-valid-async
>
<div ng-if="newTransportationCtrl.status === 'loading' || newTransportationCtrl.status === 'error'">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
<div ng-if="newTransportationCtrl.status === 'success'"
ng-mx-form-valid-async-success
>
<div class="table cf-lodging-table">
<div class="tr">
<div class="td">
<label class="cf-label">
<div class="cf-title"
ng-class="{ 'no-title': !customField.title }"
>
[! customField.title || 'none' !]
</div>
<div ng-current-option="newTransportationCtrl.data.lodging"
ng-current-option-collection="newTransportationCtrl.lodgings"
ng-current-option-target="newTransportationCtrl.currentLodging"
></div>
<div ng-if="newTransportationCtrl.lodgings.length"
class="the-field cf-lodging-dropdown"
ng-class="{
'ng-invalid': updateCustomFieldForm[ + '-lodging'].$invalid,
'ng-required': true
}"
>
<select ng-model="newTransportationCtrl.data.lodging"
ng-options="lodging.pk as lodging.effectiveName for lodging in newTransportationCtrl.lodgings"
ng-placeholder="[[ customField.hint || T('Please select where you are staying') ]]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="lodging"
></select>
<i ng-link="f-req"></i>
</div>
</label>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html="customField.descriptionSafeHtml"
></div>
</div>
<div class="td room-number-field"
ng-if="newTransportationCtrl.currentLodging && !newTransportationCtrl.currentLodging.isSelfLodging && !customField.isLodgingRoomNumberHidden"
>
<label class="cf-label">
<div class="cf-title">Room number</div>
<input id="id_lodging_room_number" maxlength="128" name="lodgingRoomNumber" ng-model="newTransportationCtrl.data.lodgingRoomNumber" ng-placeholder="If known" type="text" />
</label>
</div>
</div>
<div class="tr self-lodging-contact-field" ng-if="newTransportationCtrl.currentLodging && newTransportationCtrl.currentLodging.isSelfLodging">
<label class="cf-label">
<textarea cols="40" id="id_self_lodging_address" name="selfLodgingAddress" ng-model="newTransportationCtrl.data.selfLodgingAddress" ng-placeholder="Please let us know how we can contact you" rows="10">
</textarea>
</label>
</div>
</div>
<div class="new-transportation-details"
ng-if="newTransportationCtrl.isTransportationAvailable() || newTransportationCtrl.showSelfTransportation()"
>
<div ng-if="newTransportationCtrl.isTransportationAvailable()">
<div ng-if="newTransportationCtrl.showNeedsTransportation()"
ng-then="showNeedsTransportation"
>
<div class="new-transportation-options-header bold">
[[ newTransportationCtrl.canOverrideTransportation ?
T('Transportation option:') :
T('Transportation to our location is available. Please select an option:') ]]
</div>
<div class="field field-boolean-radio
ng-required
"
ng-class="{ 'ng-invalid': newTransportationCtrl.needsTransportation === undefined }"
ng-radio-flyer
>
<div class="the-field">
<i ng-link="f-req"></i>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="true"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('Needs transportation') : T('Please pick me up') ]]
<span ng-if="newTransportationCtrl.showTransportationPrice()">
&mdash;
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</label>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="false"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('No transportation') : T('I will provide my own transportation') ]]
</label>
</div>
</div>
</div>
<div ng-if="!showNeedsTransportation && newTransportationCtrl.showTransportationPrice()"
class="need-trans-price"
>
<b ng-hide="showNeedsTransportation">Transportation:</b>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</div>
<div ng-if="newTransportationCtrl.needsTransportation">
<div class="cf-rebook-new-transportation"
ng-if="
newTransportationCtrl.needsTransportation && newTransportationCtrl.rebookingTransportation &&
newTransportationCtrl.rebookTransportationOptions.length > 1
"
>
<h2>How should transportation be rebooked?</h2>
<ul class="cf-rebook-options" ng-radio-flyer>
<li ng-repeat="option in newTransportationCtrl.rebookTransportationOptions" class="cf-rebook-option">
<label>
<input type="radio" ng-model="newTransportationCtrl.rebookTransportationOption" ng-value="option">
[[ option.text ]]
<i ng-if="option.tip" ng-tip="[[ option.tip ]]" class="icon-hint"></i>
</label>
</li>
</ul>
</div>
<div class="new-trans-selects-wrap" ng-if="newTransportationCtrl.showRoutes() || newTransportationCtrl.showStops()">
<div class="new-trans-selects">
<div ng-if="newTransportationCtrl.showRoutes()">
<div ng-current-option="newTransportationCtrl.data.route"
ng-current-option-collection="newTransportationCtrl.routes"
ng-current-option-target="newTransportationCtrl.currentRoute"
></div>
<div class="the-field cf-route-dropdown"
ng-class="{
'ng-invalid': updateCustomFieldForm[ + '-route'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.route"
ng-options="routeSelection.route.pk as newTransportationCtrl.routeSelectionText(routeSelection) for routeSelection in newTransportationCtrl.routeSelections"
ng-placeholder="[! T('Choose your route') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="route"
></select>
<i ng-link="f-req"></i>
</div>
</div>
<div ng-current-option="newTransportationCtrl.data.stop"
ng-current-option-collection="newTransportationCtrl.stops"
ng-current-option-target="newTransportationCtrl.currentStop"
></div>
<div ng-if="newTransportationCtrl.showStops()"
class="the-field cf-stop-dropdown"
ng-class="{
'ng-invalid': updateCustomFieldForm[ + '-stop'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.stop"
ng-options="stop.pk as stop.unicode for stop in newTransportationCtrl.stops"
ng-placeholder="[! T('Choose a pickup location') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="stop"
></select>
<i ng-link="f-req"></i>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.needsTransportation && !newTransportationCtrl.currentStop && newTransportationCtrl.stops.length"
class="select-a-stop-note"
>
<span ng-if="newTransportationCtrl.canOverrideTransportation" ng-then="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
Select a pickup location above.
</span>
<span ng-else="required">
Select a pickup location above, or choose &quot;No transportation&quot; instead.
</span>
</span>
<span ng-else="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
Please select a pickup point from the list above.
</span>
<span ng-else="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
If you need transportation, please select a pickup point from the list above.
If you need help, please select &quot;I will provide my own transportation&quot; and call us after completing your booking.
</span>
</span>
</div>
<div ng-if="newTransportationCtrl.currentStop">
<div class="pickup-info">
<h3 class="new-pickup-time">
We'll pick you up at [[ newTransportationCtrl.currentStop.time|time ]] from [[ newTransportationCtrl.currentStop.pickup.name ]]
</h3>
<div class="pickup-notes-toggle" ng-if="newTransportationCtrl.currentStop.pickup.description">
Pickup details will be included in your confirmation email. (<a ng-toggle="showNotes">View details</a>)
</div>
<div ng-toggled="showNotes">
<div ng-if="newTransportationCtrl.currentStop.pickup.description" class="md-inline"
ng-bind-html="newTransportationCtrl.currentStop.pickup.descriptionSafeHtml"
></div>
</div>
</div>
<div ng-toggled="showNotes">
<a ng-href="[[ newTransportationCtrl.currentStop.pickup.mapUrl ]]"
ng-if="newTransportationCtrl.currentStop.pickup.mapUrl"
ng-outbound-link="_blank"
class="pickup-map-link"
>
<b class="map-link-headline">See pickup location on a map</b>
</a>
</div>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.showSelfTransportation()"
class="pickup-info"
>
<h3 class="new-pickup-time">
Please arrive by [[ availability.startAt|dateSubtract:availability.item.noTransportationMinutes:'minutes'|time ]]
</h3>
<div ng-if="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
>
<div class="pickup-notes-toggle">
Directions will be included in your confirmation email. (<a ng-toggle="showSelfNotes">View directions</a>)
</div>
<div class="md-inline"
ng-toggled="showSelfNotes"
ng-bind-html="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
></div>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="editableCustomField [&#39;value&#39;]" ng-prevalidate-custom-field="editableCustomFieldOptions" ng-pseudo-placeholder="True" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div class="cf-admin-note md-inline"
ng-can-list="Code on customField.company"
>
<span class="icon-lock" ng-tip="[! T('Customers booking online don\'t see this note.') !]"></span>
Accepts codes from <a ng-href="[! customField.campaign.$url(urls.dashboard.settings.campaigns.campaign.index) !]"> [! customField.campaign.name !]</a>.
<span ng-show="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)">
Changes price by <span class="option-offset" ng-price="customFieldPricing" ng-price-company="customField.company"></span> when code is valid.
</span>
</div>
<div ng-with="prevalidity = editableCustomFieldOptions.prevalidity[&#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_GENERATOR_TYPE">
<div ng-if="" ng-then="requiredField" ng-init="editableCustomField [&#39;value&#39;] = true;">
<div class="cf-title">
<span ng-if="!customField.isPricingHidden && (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing))">
<span class="option-offset"
ng-price="customFieldPricing"
ng-price-company="customField.company"
></span>
<span ng-if="!!customField.title">&mdash;</span>
</span>
[! customField.title !]
</div>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-else="requiredField">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="editableCustomField [&#39;value&#39;]" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CARD_GENERATOR_TYPE">
<div ng-can-view-amounts="customField.company" ng-then="canViewAmounts"
ng-card-generator="editableCustomField [&#39;value&#39;]"
ng-form="cardGeneratorSubform"
>
<div ng-if="cardGeneratorCtrl.isAlreadyGenerated" ng-then="alreadyGenerated">
<b ng-amount="cardGeneratorCtrl.selectedAmount"
ng-amount-company="customField.company"
></b> <span class="fh-grey">&mdash;</span>
This field has already generated a gift card.
</div>
<div ng-if="!alreadyGenerated && customFieldValue" ng-then="hasValue">
This field cannot be edited from here. Please edit the generated gift card instead.
</div>
<div ng-if="!alreadyGenerated && !hasValue">
<div ng-if="!customFieldPricing.visibility.isRequired"
class="table table-dont-respond valign-middle
cf-checkbox cf-checkbox--no-offset
test-custom-field-[! customField.name|css !]-select
"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input type="checkbox"
class="ng-pristine"
ng-model="cardGeneratorCtrl.isSelected"
ng-checkbox-madness="true"
>
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if-once="customField.title">[! customField.title !]</h2>
</div>
</div>
</label>
</div>
<div ng-if="cardGeneratorCtrl.isSelected">
<div class="cf-title" ng-if="customField.title && customFieldPricing.visibility.isRequired">[[ customField.title ]]</div>
<fieldset>
<legend class="card-generator-header">Choose Amount</legend>
<div class="card-generator-amounts-wrap">
<div class="table table-dont-respond full-width">
<ul ng-radio-flyer
class="card-generator-amounts tr"
ng-class="{ '-custom-amount': toggles.state(cardGeneratorCtrl.toggleValue) }"
>
<li class="td">
<label ng-toggle ng-toggle-value="cardGeneratorCtrl.toggleValue"
ng-toggle-interactive="false"
ng-toggle-default="cardGeneratorCtrl.defaultToOther"
ng-click="toggles.toggle(cardGeneratorCtrl.toggleValue, true)"
>
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]">
<div>Custom</div>
</label>
</li>
<li ng-repeat="suggestedAmount in cardGeneratorCtrl.suggestedAmounts"
class="td"
>
<label ng-click="cardGeneratorCtrl.selectAmount(suggestedAmount)">
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]" ng-checked="!toggles.state(cardGeneratorCtrl.toggleValue) && cardGeneratorCtrl.selectedAmount === suggestedAmount">
<div ng-amount="suggestedAmount" ng-amount-currency="customField" ng-amount-hide-cents></div>
</label>
</li>
</ul>
</div>
</div>
</fieldset>
<div ng-toggled ng-toggled-value="cardGeneratorCtrl.toggleValue"
class="card-generator-custom-amount"
>
<div class="cardgeneratorsubform-selectedamount
field-amount
"
ng-django-field="cardGeneratorSubform [&#39;selectedAmount&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Gift amount:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount" max="999999.99" min="0" name="amount" ng-amount-input="true" ng-amount-input-default="cardGeneratorCtrl.minimumAmount" ng-amount-input-min="cardGeneratorCtrl.minimumAmount" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cardGeneratorSubform [&#39;selectedAmount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="cardGeneratorCtrl.selectedAmount">
<div class="p-t-15 prose"
ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
<fieldset>
<legend class="card-generator-header">Recipient Info</legend>
<p class="p-b-10">
You&#039;ll confirm these details, add an optional note, and send your digital gift card after checkout.
</p>
<div class="m-b-5 test-custom-field-[! customField.name|css !]-name">
<div class="cardgeneratorsubform-name field-person-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;name&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;name&#39;]"
ng-django-field-required="!auth.permissions.can('skipRecipientName', customField)"
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="cardGeneratorCtrl [&#39;name&#39;]" ng-placeholder="Full name" ng-required="!auth.permissions.can('skipRecipientName', customField)" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="cardgeneratorsubform-email field-email-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;email&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;email&#39;]"
ng-django-field-required="false"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="cardGeneratorCtrl [&#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-required="false" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</fieldset>
</div>
</div>
</div>
</div>
<div ng-else="canViewAmounts">
Sorry, you are not authorized to create gift cards.
</div>
</div>
<div ng-if-once="customField.type === CustomField.MULTI_CAMPAIGN_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label ng-toggle ng-toggle-value="'addCampaignCode' + customField.pk"
ng-toggle-default="auth.currentUser.isAuthenticated || customFieldPricing.visibility.isRequired || customField.isCodeInputShownByDefault || !!editableCustomField[&#39;value&#39;]"
class="cf-label hide-when-toggled"
ng-mx-click="click-add-promo-code"
>
<span class="fh-grey underline pointer">[! customField.codeToggleText || T('Add promo or discount code') !]</span>
</label>
<label class="cf-label"
ng-toggled ng-toggled-value="'addCampaignCode' + customField.pk"
>
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="editableCustomField [&#39;value&#39;]" ng-prevalidate-custom-field="editableCustomFieldOptions" ng-pseudo-placeholder="True" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div
ng-with="prevalidity = editableCustomFieldOptions.prevalidity[&#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.WAIVER_TYPE">
<div class="custom-field-[! customField.type|css !]"
ng-can-create="Waiver on customField.company"
ng-can-only-when="customField.connectedWaivers.length"
>
<div class="cf-admin-note md-inline">
<span class="icon-lock" ng-tip="[! T('Only people in your company see this note') !]"></span>
<b ng-show="!!customField.name">[! customField.name !]:</b>
Customers will be asked to sign:
<span ng-repeat="connectedWaiver in customField.connectedWaivers" >
<a ng-href="[! connectedWaiver.waiver.$url(urls.dashboard.settings.waivers.waiver.index) !]">[! connectedWaiver.waiver.name !]</a><span ng-if="!$last">,</span>
</span>
</div>
</div>
</div>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;value&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</li>
</ul>
<br>
</div>
</div>
<div ng-toggled-show="cfFormGiftCard"
ng-toggle-group="updateCustomField"
class="flyout-section"
ng-if="customField.type === CustomField.CARD_GENERATOR_TYPE"
>
<div class="updatecustomfieldform-storedvaluetype "
ng-django-field="updateCustomFieldForm [&#39;storedValueType&#39;]" ng-django-field-model="editableCustomField [&#39;storedValueType&#39;]"
ng-django-field-required=""
>
<div ng-current-option="editableCustomField [&#39;storedValueType&#39;]"
ng-current-option-collection="storedValueTypes"
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
Gift card type to create
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="stored_value_type"
ng-model="editableCustomField [&#39;storedValueType&#39;]"
ng-disabled=""
required="required"
ng-options="option.pk as option.name for option in storedValueTypes"
ng-dropdown
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="updateCustomFieldForm [&#39;storedValueType&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in updateCustomFieldForm [&#39;storedValueType&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="hint">
<p>
When this field is selected, it creates a new <a ng-href="[! company.$url(urls.dashboard.settings.storedValue.storedValueTypes) !]">gift cards</a> of the type you set here.
</p>
</div>
<br>
<div class="updatecustomfieldform-cardsuggestedamount
field-amount
"
ng-django-field="updateCustomFieldForm [&#39;cardSuggestedAmount&#39;]" ng-django-field-model="editableCustomField [&#39;cardSuggestedAmount&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Starting suggested amount
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_card_suggested_amount" max="999999.99" min="0" name="cardSuggestedAmount" ng-amount-input="true" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editableCustomField [&#39;cardSuggestedAmount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateCustomFieldForm [&#39;cardSuggestedAmount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="updateCustomFieldForm [&#39;cardSuggestedAmount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in updateCustomFieldForm [&#39;cardSuggestedAmount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="hint">
<p>
The first suggested amount when customers are buying.
</p>
</div>
</div>
<div ng-toggled-show="cfFormGeneral"
ng-toggle-group="updateCustomField"
>
<div class="flyout-section">
<div class="updatecustomfieldform-name "
ng-django-field="updateCustomFieldForm [&#39;name&#39;]" ng-django-field-model="editableCustomField [&#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Internal name
</span>
<span class="the-field-outer"
ng-class="{ '-is-translatable': company.companyFeatures.isContentTranslationEnabled && auth.permissions.canList(SupportedLanguage, company) && editableCustomField.pk }"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-autofocus="true" ng-model="editableCustomField [&#39;name&#39;]" ng-placeholder="Private, for managing custom fields" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<a class="translation-jump-link"
ng-open-supported-languages-popover="&#39;name&#39;"
ng-open-supported-languages-popover-field-name="name"
ng-open-supported-languages-popover-field-ng-model="editableCustomField"
ng-open-supported-languages-popover-parent-field="null"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableCustomField.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
</a>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="!CustomField.isDisplayOnly(editableCustomField)">
<div class="updatecustomfieldform-shortname "
ng-django-field="updateCustomFieldForm [&#39;shortName&#39;]" ng-django-field-model="editableCustomField [&#39;shortName&#39;]"
>
<label >
<span class="label-text">
SKU
<i class="icon-hint"
ng-tip="[! T('A short or internal name used in your Dashboard') !]"
></i>
</span>
<span class="the-field-outer"
ng-class="{ '-is-translatable': company.companyFeatures.isContentTranslationEnabled && auth.permissions.canList(SupportedLanguage, company) && editableCustomField.pk }"
>
<span class="the-field">
<input data-lpignore="true" id="id_short_name" maxlength="128" name="shortName" ng-model="editableCustomField [&#39;shortName&#39;]" ng-placeholder="Displayed instead of field name in Dashboard" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<a class="translation-jump-link"
ng-open-supported-languages-popover="&#39;short_name&#39;"
ng-open-supported-languages-popover-field-name="short_name"
ng-open-supported-languages-popover-field-ng-model="editableCustomField"
ng-open-supported-languages-popover-parent-field="null"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableCustomField.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
</a>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;shortName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="updatecustomfieldform-isprivate field-cb "
ng-django-field="updateCustomFieldForm [&#39;isPrivate&#39;]" ng-django-field-model="editableCustomField [&#39;isPrivate&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_private" name="isPrivate" ng-checkbox-madness="true" ng-model="editableCustomField [&#39;isPrivate&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
<i class="icon-lock"></i> <b>Private</b>: only show to logged in users who have been given permission to see private fields
<i class="icon-hint" ng-tip="
By default only people who are users of [[ customField.company.name || company.name ]] have permission to view your private fields.
" ></i>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;isPrivate&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="!CustomField.isDisplayOnly(editableCustomField)">
<div class="field field-cb"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="editableCustomField"
disabled
ng-checked="!!customField.isAlwaysPerCustomer"
>
</span>
<span class="label-text">
If priced, change price of all customers on booking
<span class="icon-hint" ng-tip="This cannot be changed after an option has been created"></span>
</span>
</span>
</label>
</div>
</div>
</div>
<div ng-can-admin-update="customField">
<a class="flyout-toggle-header small"
ng-toggle="adminPricing"
><span class="admin-badge">FH</span> Advanced price options</a>
<div ng-toggled="adminPricing" class="flyout-section">
<div class="updatecustomfieldform-ispricinghidden field-cb "
ng-django-field="updateCustomFieldForm [&#39;isPricingHidden&#39;]" ng-django-field-model="editableCustomField [&#39;isPricingHidden&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_pricing_hidden" name="isPricingHidden" ng-checkbox-madness="true" ng-model="editableCustomField [&#39;isPricingHidden&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Hide pricing
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;isPricingHidden&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="updatecustomfieldform-pricingtype "
ng-django-field="updateCustomFieldForm [&#39;pricingType&#39;]" ng-django-field-model="editableCustomField [&#39;pricingType&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Pricing calculation type
<i class="icon-hint" ng-tip="When calculating multiple taxes or priced custom fields, the running cost will:" ></i>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_pricing_type" name="pricingType" ng-model="editableCustomField [&#39;pricingType&#39;]" required="required">
<option value="stack" selected="selected">Compound (default)</option>
<option value="current">Compound running price</option>
<option value="initial">Reset to base</option>
<option value="zero">Reset to $0.00</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateCustomFieldForm [&#39;pricingType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in updateCustomFieldForm [&#39;pricingType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="hint">
<a ng-href="https://fareharbor.com/help/internal/dashboard-guides/pricing-calculation-types/" ng-outbound-link="_blank"
class="hint-help-link"
>Learn more about pricing types</a>
</div>
</div>
</div>
</div>
<div ng-toggled-show="cfFormAdvanced"
ng-toggle-group="updateCustomField"
class="flyout-section"
>
<div ng-if="CustomField.needsBookingNotes(editableCustomField)">
<div class="updatecustomfieldform-bookingnotes field-textarea
field-markdown
"
ng-django-field="updateCustomFieldForm [&#39;bookingNotes&#39;]" ng-django-field-model="editableCustomField [&#39;bookingNotes&#39;]"
>
<label >
<span class="label-text">
Email notes
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_booking_notes" name="bookingNotes" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-parent=".updatecustomfieldform-bookingnotes" ng-markdown-preview=".js-markdown-tb .js-preview-button" ng-markdown-preview-result=".js-markdown-preview-result" ng-model="editableCustomField [&#39;bookingNotes&#39;]" ng-placeholder="Optional notes to include in confirmation email when this field is selected" rows="10">
</textarea>
<span class="field-style-hook"></span>
<div ng-toggled-show class="markdown-preview prose js-markdown-preview-result"
ng-toggled-show-value="'markdownPreview-' + $id"
></div>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;bookingNotes&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb markdown-field-tb tb--shaded js-markdown-tb">
<div class="tb-left"
>
<div class="tb-group">
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
<a class="tb-btn tb-btn--flyout"
ng-open-supported-languages-popover="&#39;booking_notes&#39;"
ng-open-supported-languages-popover-field-name="booking_notes"
ng-open-supported-languages-popover-field-ng-model="editableCustomField"
ng-open-supported-languages-popover-parent-field="null"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableCustomField.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
<abbr>Translations</abbr>
</a>
</div>
</div>
<div class="tb-right">
<div class="tb-group">
<span class="tb-btn js-preview-button" ng-toggle ng-toggle-value="'markdownPreview-' + $id">
Preview Markdown
<a class="icon-hint"
ng-tip="[! T('Markdown lets you format text using a special syntax. Click here to learn more about it.') !]"
ng-href="https://fareharbor.com/help/more/markdown/" ng-outbound-link="_new"
></a>
</span>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="flyout-section flyout-section--shade btns">
<button class="btn-tiny btn-green btn-left" type="submit"
ng-disabled="updateCustomFieldForm.$pristine || updateCustomFieldForm.$invalid || updateCustomFieldForm.$submitting"
>
[[ updateCustomFieldForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn-tiny btn-grey btn-left" type="button"
ng-click="editCtrl.cancel(updateCustomFieldForm)"
ng-disabled="updateCustomFieldForm.$submitting"
ng-shortcut="'esc'"
ng-shortcut-click
title="[! T('Shortcut: escape') !]"
>
Cancel
</button>
</div>
</div>
</div>
<div class="hide">
<div class="updatecustomfieldform-parameters "
ng-django-field="updateCustomFieldForm [&#39;parameters&#39;]" ng-django-field-model="editableCustomField [&#39;parameters&#39;]"
>
<label >
<span class="label-text">
Parameters
</span>
<span class="the-field-outer"
ng-class="{ '-is-translatable': company.companyFeatures.isContentTranslationEnabled && auth.permissions.canList(SupportedLanguage, company) && editableCustomField.pk }"
>
<span class="the-field">
<input data-lpignore="true" id="id_parameters" name="parameters" ng-model="editableCustomField [&#39;parameters&#39;]" type="hidden" value="{}" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<a class="translation-jump-link"
ng-open-supported-languages-popover="&#39;parameters&#39;"
ng-open-supported-languages-popover-field-name="parameters"
ng-open-supported-languages-popover-field-ng-model="editableCustomField"
ng-open-supported-languages-popover-parent-field="null"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableCustomField.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
</a>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;parameters&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="updatecustomfieldform-value "
ng-django-field="updateCustomFieldForm [&#39;value&#39;]" ng-django-field-model="editableCustomField [&#39;value&#39;]"
>
<label >
<span class="label-text">
Value
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_value" name="value" ng-model="editableCustomField [&#39;value&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateCustomFieldForm [&#39;value&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="updateCustomFieldForm.all.$error.span_too_large">Count maximum can only be 10000 greater than minimum</li>
<li ng-if="updateCustomFieldForm.all.$error.unauthorized">Only authorized users can admin update this custom field</li>
<li ng-repeat="error in updateCustomFieldForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</form>
<div ng-link="mobile-flyout-close" ng-with="toggle = toggleValue"></div>
</div>
</div>
<div ng-else="allowed">
</div>
</div>
</script>
<script type="text/ng-template" id="custom-field-value-field-null">
<div class="nullform-nullfield-customfieldpk "
ng-django-field="nullForm [&#39;nullField-&#39; + customField.pk]" ng-django-field-model="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-django-field-required="!!customFieldPricing.visibility.isRequired"
ng-class="{ 'is-display-only': customField.isDisplayOnly }"
>
<div class="cf-wrap cf-wrap--[! customField.type|css !]
[! CustomField.usesCheckbox(customField) ? 'cf-wrap--checkbox' : '' !]"
ng-class="{
'private-field': customFieldPricing.visibility.isHiddenWhenBooking || customField.isPrivate
}"
>
<span class="private-field-icon test-private-custom-field-indicator"
ng-tip="[[ customField.isPrivate ? T('Only shown to logged in users with permission to see private fields. (That\'s you!)') : T('Will not be shown when booking') ]]"
ng-tip-location=".private-field-lock"
>
<span class="private-field-lock"></span>
</span>
<div ng-if-once="customField.isDisplayOnly">
<div ng-if="customField.type === CustomField.HEADER_TYPE">
<h2>[! customField.title !]</h2>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if="customField.type === CustomField.NOTE_TYPE" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.SHORT_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field test-custom-field-[! customField.name|css !]">
<span class="label-text">[! customField.hint !]</span>
<input id="id_short" maxlength="2048" name="value" ng-model="nullModel [&#39;nullField-&#39; + customField.pk]" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" type="text" />
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.LONG_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="the-field test-custom-field-[! customField.name|css !]">
<textarea cols="40" id="id_long" name="value" ng-model="nullModel [&#39;nullField-&#39; + customField.pk]" ng-placeholder="[! customField.hint !]" ng-required="!!customFieldPricing.visibility.isRequired" rows="10">
</textarea>
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.YES_NO_TYPE">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="nullModel [&#39;nullField-&#39; + customField.pk]" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
<label ng-if="customField.type === CustomField.COUNT_TYPE && nullModel.type !== CustomFieldInstanceCondition.RANGE_TYPE"
class="custom-field-[! customField.type|css !] cf-label table valign-middle table-dont-respond"
ng-init="nullModel [&#39;nullField-&#39; + customField.pk] = ((nullModel [&#39;nullField-&#39; + customField.pk]|isDefined) ? nullModel [&#39;nullField-&#39; + customField.pk] : customField.countMin)"
>
<div class="tr">
<div class="td count-field-select"
ng-hide="customField.countMin === customField.countMax && nullModel [&#39;nullField-&#39; + customField.pk] === customField.countMin"
>
<select
ng-model="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-options="option for option in customField.countMin|range:(customField.countMax + 1)"
ng-prefix=""
name="value"
></select>
</div>
<div class="td">
<div class="cf-title">
[! customField.title !]<span
ng-if="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)"
><span ng-if="customField.isPricingHidden && bookCtrl.newBookingOptions.totalCosts[&#39;nullField-&#39; + customField.pk] && PriceLine.showRate(customFieldPricing)"
>: <span ng-amount="bookCtrl.newBookingOptions.totalCosts[&#39;nullField-&#39; + customField.pk].price"></span>
</span>
<span ng-if="!customField.isPricingHidden">
<span class="fh-grey">&mdash;</span>
<span ng-price="customFieldPricing"
ng-price-company="customField.company"
ng-price-count="nullModel [&#39;nullField-&#39; + customField.pk]"
></span>
</span>
</span>
</div>
<div ng-inline="cf-description"></div>
</div>
</div>
</label>
<div ng-if-once="customField.type === CustomField.EXTENDED_OPTION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-prices-extended-options="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-prices-extended-options-field="customField"
ng-prices-extended-options-instance="customFieldInstance"
ng-prices-extended-options-currency="customField"
ng-current-option="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-current-option-key="'pk'"
ng-current-option-collection="pricesExtendedOptionsCtrl.options"
ng-current-option-target="currentOption"
>
<div ng-if="pricesExtendedOptionsCtrl.isImpossibleOption" ng-then="impossibleOption">
<div class="cf-title">
<i class="warning-icon"></i> [! customField.title !]
</div>
</div>
<div ng-if="pricesExtendedOptionsCtrl.isForcedOption" ng-then="forcedOption"
ng-init="nullForm.$setDirty()"
class="cf-title"
>
<span ng-if="!customField.isPricingHidden"
ng-with="currentOptionPricing = pricesCtrl.totalPricing(currentOption.extendedOption)"
>
<span ng-price="currentOptionPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && currentOption.extendedOption.isAlwaysPerCustomer">
per person
</span>
<span ng-if="PriceLine.showOffset(currentOptionPricing)"></span>
<span ng-if="currentOption.extendedOption.name && (
PriceLine.showOffset(currentOptionPricing) ||
PriceLine.showRate(currentOptionPricing)
)" class="fh-grey"
>&mdash;</span>
</span>
<span ng-bind="currentOption.extendedOption.name"></span>
</div>
<div ng-else="impossibleOption || forcedOption">
<label class="cf-label">
<div class="cf-title" ng-show="customField.title">
<span ng-bind="customField.title"></span>
</div>
<div class="the-field cf-extended-option-dropdown">
<select ng-model="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-options="option.pk as option.label for option in pricesExtendedOptionsCtrl.options"
ng-prefix=""
ng-required="!!customFieldPricing.visibility.isRequired"
name="value"
ng-dropdown
ng-placeholder="[! T('Choose an option') !]"
></select>
<i ng-link="f-req" ng-with="label = T('Choice is required')"></i>
</div>
</label>
</div>
<div ng-show="currentOption">
<div class="option-details md-inline" ng-if="currentOption.extendedOption.description"
ng-bind-html="currentOption.extendedOption.descriptionSafeHtml"
></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-current-option="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-current-option-key="'pk'"
ng-current-option-collection="customField.transportationOptions"
ng-current-option-target="currentTransportationOption"
>
<div class="cf-title">
<span ng-bind-once="customField.title"></span>
<span ng-if="!customField.isPricingHidden">
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</div>
<div ng-if="customField.transportationOptions.length === 1" ng-then="fullTransportation"
ng-init="nullModel [&#39;nullField-&#39; + customField.pk] = customField.transportationOptions[0].pk"
></div>
<div ng-else="fullTransportation"
class="cf-transportation-dropdown"
>
<select
ng-init="nullModel [&#39;nullField-&#39; + customField.pk] = nullModel [&#39;nullField-&#39; + customField.pk] || (customField.transportationOptions.length && customField.transportationOptions[0].pk)"
ng-model="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-options="transportationOption.pk as transportationOption.location for transportationOption in customField.transportationOptions"
ng-prefix=""
name="value"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-placeholder="[! T('Choose transportation') !]"
>
</select>
</div>
<div class="transportation-details">
<h3 class="pickup-time">
<span ng-if="currentTransportationOption.isSelfTransportation" ng-then="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
Please arrive by [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
Please arrive [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
<span ng-else="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
We'll pick you up at [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
We'll pick you up [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
</h3>
<div class="transportation-note md-inline" ng-if="currentTransportationOption.description"
ng-bind-html="currentTransportationOption.descriptionSafeHtml"></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"></div>
</div>
<div ng-if-once="customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-new-transportation="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-mx-form-valid-async
>
<div ng-if="newTransportationCtrl.status === 'loading' || newTransportationCtrl.status === 'error'">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
<div ng-if="newTransportationCtrl.status === 'success'"
ng-mx-form-valid-async-success
>
<div class="table cf-lodging-table">
<div class="tr">
<div class="td">
<label class="cf-label">
<div class="cf-title"
ng-class="{ 'no-title': !customField.title }"
>
[! customField.title || 'none' !]
</div>
<div ng-current-option="newTransportationCtrl.data.lodging"
ng-current-option-collection="newTransportationCtrl.lodgings"
ng-current-option-target="newTransportationCtrl.currentLodging"
></div>
<div ng-if="newTransportationCtrl.lodgings.length"
class="the-field cf-lodging-dropdown"
ng-class="{
'ng-invalid': nullForm[ + '-lodging'].$invalid,
'ng-required': true
}"
>
<select ng-model="newTransportationCtrl.data.lodging"
ng-options="lodging.pk as lodging.effectiveName for lodging in newTransportationCtrl.lodgings"
ng-placeholder="[[ customField.hint || T('Please select where you are staying') ]]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="lodging"
></select>
<i ng-link="f-req"></i>
</div>
</label>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html="customField.descriptionSafeHtml"
></div>
</div>
<div class="td room-number-field"
ng-if="newTransportationCtrl.currentLodging && !newTransportationCtrl.currentLodging.isSelfLodging && !customField.isLodgingRoomNumberHidden"
>
<label class="cf-label">
<div class="cf-title">Room number</div>
<input id="id_lodging_room_number" maxlength="128" name="lodgingRoomNumber" ng-model="newTransportationCtrl.data.lodgingRoomNumber" ng-placeholder="If known" type="text" />
</label>
</div>
</div>
<div class="tr self-lodging-contact-field" ng-if="newTransportationCtrl.currentLodging && newTransportationCtrl.currentLodging.isSelfLodging">
<label class="cf-label">
<textarea cols="40" id="id_self_lodging_address" name="selfLodgingAddress" ng-model="newTransportationCtrl.data.selfLodgingAddress" ng-placeholder="Please let us know how we can contact you" rows="10">
</textarea>
</label>
</div>
</div>
<div class="new-transportation-details"
ng-if="newTransportationCtrl.isTransportationAvailable() || newTransportationCtrl.showSelfTransportation()"
>
<div ng-if="newTransportationCtrl.isTransportationAvailable()">
<div ng-if="newTransportationCtrl.showNeedsTransportation()"
ng-then="showNeedsTransportation"
>
<div class="new-transportation-options-header bold">
[[ newTransportationCtrl.canOverrideTransportation ?
T('Transportation option:') :
T('Transportation to our location is available. Please select an option:') ]]
</div>
<div class="field field-boolean-radio
ng-required
"
ng-class="{ 'ng-invalid': newTransportationCtrl.needsTransportation === undefined }"
ng-radio-flyer
>
<div class="the-field">
<i ng-link="f-req"></i>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="true"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('Needs transportation') : T('Please pick me up') ]]
<span ng-if="newTransportationCtrl.showTransportationPrice()">
&mdash;
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</label>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="false"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('No transportation') : T('I will provide my own transportation') ]]
</label>
</div>
</div>
</div>
<div ng-if="!showNeedsTransportation && newTransportationCtrl.showTransportationPrice()"
class="need-trans-price"
>
<b ng-hide="showNeedsTransportation">Transportation:</b>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</div>
<div ng-if="newTransportationCtrl.needsTransportation">
<div class="cf-rebook-new-transportation"
ng-if="
newTransportationCtrl.needsTransportation && newTransportationCtrl.rebookingTransportation &&
newTransportationCtrl.rebookTransportationOptions.length > 1
"
>
<h2>How should transportation be rebooked?</h2>
<ul class="cf-rebook-options" ng-radio-flyer>
<li ng-repeat="option in newTransportationCtrl.rebookTransportationOptions" class="cf-rebook-option">
<label>
<input type="radio" ng-model="newTransportationCtrl.rebookTransportationOption" ng-value="option">
[[ option.text ]]
<i ng-if="option.tip" ng-tip="[[ option.tip ]]" class="icon-hint"></i>
</label>
</li>
</ul>
</div>
<div class="new-trans-selects-wrap" ng-if="newTransportationCtrl.showRoutes() || newTransportationCtrl.showStops()">
<div class="new-trans-selects">
<div ng-if="newTransportationCtrl.showRoutes()">
<div ng-current-option="newTransportationCtrl.data.route"
ng-current-option-collection="newTransportationCtrl.routes"
ng-current-option-target="newTransportationCtrl.currentRoute"
></div>
<div class="the-field cf-route-dropdown"
ng-class="{
'ng-invalid': nullForm[ + '-route'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.route"
ng-options="routeSelection.route.pk as newTransportationCtrl.routeSelectionText(routeSelection) for routeSelection in newTransportationCtrl.routeSelections"
ng-placeholder="[! T('Choose your route') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="route"
></select>
<i ng-link="f-req"></i>
</div>
</div>
<div ng-current-option="newTransportationCtrl.data.stop"
ng-current-option-collection="newTransportationCtrl.stops"
ng-current-option-target="newTransportationCtrl.currentStop"
></div>
<div ng-if="newTransportationCtrl.showStops()"
class="the-field cf-stop-dropdown"
ng-class="{
'ng-invalid': nullForm[ + '-stop'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.stop"
ng-options="stop.pk as stop.unicode for stop in newTransportationCtrl.stops"
ng-placeholder="[! T('Choose a pickup location') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="stop"
></select>
<i ng-link="f-req"></i>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.needsTransportation && !newTransportationCtrl.currentStop && newTransportationCtrl.stops.length"
class="select-a-stop-note"
>
<span ng-if="newTransportationCtrl.canOverrideTransportation" ng-then="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
Select a pickup location above.
</span>
<span ng-else="required">
Select a pickup location above, or choose &quot;No transportation&quot; instead.
</span>
</span>
<span ng-else="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
Please select a pickup point from the list above.
</span>
<span ng-else="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
If you need transportation, please select a pickup point from the list above.
If you need help, please select &quot;I will provide my own transportation&quot; and call us after completing your booking.
</span>
</span>
</div>
<div ng-if="newTransportationCtrl.currentStop">
<div class="pickup-info">
<h3 class="new-pickup-time">
We'll pick you up at [[ newTransportationCtrl.currentStop.time|time ]] from [[ newTransportationCtrl.currentStop.pickup.name ]]
</h3>
<div class="pickup-notes-toggle" ng-if="newTransportationCtrl.currentStop.pickup.description">
Pickup details will be included in your confirmation email. (<a ng-toggle="showNotes">View details</a>)
</div>
<div ng-toggled="showNotes">
<div ng-if="newTransportationCtrl.currentStop.pickup.description" class="md-inline"
ng-bind-html="newTransportationCtrl.currentStop.pickup.descriptionSafeHtml"
></div>
</div>
</div>
<div ng-toggled="showNotes">
<a ng-href="[[ newTransportationCtrl.currentStop.pickup.mapUrl ]]"
ng-if="newTransportationCtrl.currentStop.pickup.mapUrl"
ng-outbound-link="_blank"
class="pickup-map-link"
>
<b class="map-link-headline">See pickup location on a map</b>
</a>
</div>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.showSelfTransportation()"
class="pickup-info"
>
<h3 class="new-pickup-time">
Please arrive by [[ availability.startAt|dateSubtract:availability.item.noTransportationMinutes:'minutes'|time ]]
</h3>
<div ng-if="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
>
<div class="pickup-notes-toggle">
Directions will be included in your confirmation email. (<a ng-toggle="showSelfNotes">View directions</a>)
</div>
<div class="md-inline"
ng-toggled="showSelfNotes"
ng-bind-html="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
></div>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="nullModel [&#39;nullField-&#39; + customField.pk]" ng-prevalidate-custom-field="nullModel" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div class="cf-admin-note md-inline"
ng-can-list="Code on customField.company"
>
<span class="icon-lock" ng-tip="[! T('Customers booking online don\'t see this note.') !]"></span>
Accepts codes from <a ng-href="[! customField.campaign.$url(urls.dashboard.settings.campaigns.campaign.index) !]"> [! customField.campaign.name !]</a>.
<span ng-show="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)">
Changes price by <span class="option-offset" ng-price="customFieldPricing" ng-price-company="customField.company"></span> when code is valid.
</span>
</div>
<div ng-with="prevalidity = nullModel.prevalidity[&#39;nullField-&#39; + customField.pk]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_GENERATOR_TYPE">
<div ng-if="!!customFieldPricing.visibility.isRequired" ng-then="requiredField" ng-init="nullModel [&#39;nullField-&#39; + customField.pk] = true;">
<div class="cf-title">
<span ng-if="!customField.isPricingHidden && (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing))">
<span class="option-offset"
ng-price="customFieldPricing"
ng-price-company="customField.company"
></span>
<span ng-if="!!customField.title">&mdash;</span>
</span>
[! customField.title !]
</div>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-else="requiredField">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="nullModel [&#39;nullField-&#39; + customField.pk]" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CARD_GENERATOR_TYPE">
<div ng-can-view-amounts="customField.company" ng-then="canViewAmounts"
ng-card-generator="nullModel [&#39;nullField-&#39; + customField.pk]"
ng-form="cardGeneratorSubform"
>
<div ng-if="cardGeneratorCtrl.isAlreadyGenerated" ng-then="alreadyGenerated">
<b ng-amount="cardGeneratorCtrl.selectedAmount"
ng-amount-company="customField.company"
></b> <span class="fh-grey">&mdash;</span>
This field has already generated a gift card.
</div>
<div ng-if="!alreadyGenerated && customFieldValue" ng-then="hasValue">
This field cannot be edited from here. Please edit the generated gift card instead.
</div>
<div ng-if="!alreadyGenerated && !hasValue">
<div ng-if="!customFieldPricing.visibility.isRequired"
class="table table-dont-respond valign-middle
cf-checkbox cf-checkbox--no-offset
test-custom-field-[! customField.name|css !]-select
"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input type="checkbox"
class="ng-pristine"
ng-model="cardGeneratorCtrl.isSelected"
ng-checkbox-madness="true"
>
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if-once="customField.title">[! customField.title !]</h2>
</div>
</div>
</label>
</div>
<div ng-if="cardGeneratorCtrl.isSelected">
<div class="cf-title" ng-if="customField.title && customFieldPricing.visibility.isRequired">[[ customField.title ]]</div>
<fieldset>
<legend class="card-generator-header">Choose Amount</legend>
<div class="card-generator-amounts-wrap">
<div class="table table-dont-respond full-width">
<ul ng-radio-flyer
class="card-generator-amounts tr"
ng-class="{ '-custom-amount': toggles.state(cardGeneratorCtrl.toggleValue) }"
>
<li class="td">
<label ng-toggle ng-toggle-value="cardGeneratorCtrl.toggleValue"
ng-toggle-interactive="false"
ng-toggle-default="cardGeneratorCtrl.defaultToOther"
ng-click="toggles.toggle(cardGeneratorCtrl.toggleValue, true)"
>
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]">
<div>Custom</div>
</label>
</li>
<li ng-repeat="suggestedAmount in cardGeneratorCtrl.suggestedAmounts"
class="td"
>
<label ng-click="cardGeneratorCtrl.selectAmount(suggestedAmount)">
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]" ng-checked="!toggles.state(cardGeneratorCtrl.toggleValue) && cardGeneratorCtrl.selectedAmount === suggestedAmount">
<div ng-amount="suggestedAmount" ng-amount-currency="customField" ng-amount-hide-cents></div>
</label>
</li>
</ul>
</div>
</div>
</fieldset>
<div ng-toggled ng-toggled-value="cardGeneratorCtrl.toggleValue"
class="card-generator-custom-amount"
>
<div class="cardgeneratorsubform-selectedamount
field-amount
"
ng-django-field="cardGeneratorSubform [&#39;selectedAmount&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Gift amount:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount" max="999999.99" min="0" name="amount" ng-amount-input="true" ng-amount-input-default="cardGeneratorCtrl.minimumAmount" ng-amount-input-min="cardGeneratorCtrl.minimumAmount" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cardGeneratorSubform [&#39;selectedAmount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="cardGeneratorCtrl.selectedAmount">
<div class="p-t-15 prose"
ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
<fieldset>
<legend class="card-generator-header">Recipient Info</legend>
<p class="p-b-10">
You&#039;ll confirm these details, add an optional note, and send your digital gift card after checkout.
</p>
<div class="m-b-5 test-custom-field-[! customField.name|css !]-name">
<div class="cardgeneratorsubform-name field-person-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;name&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;name&#39;]"
ng-django-field-required="!auth.permissions.can('skipRecipientName', customField)"
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="cardGeneratorCtrl [&#39;name&#39;]" ng-placeholder="Full name" ng-required="!auth.permissions.can('skipRecipientName', customField)" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="cardgeneratorsubform-email field-email-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;email&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;email&#39;]"
ng-django-field-required="false"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="cardGeneratorCtrl [&#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-required="false" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</fieldset>
</div>
</div>
</div>
</div>
<div ng-else="canViewAmounts">
Sorry, you are not authorized to create gift cards.
</div>
</div>
<div ng-if-once="customField.type === CustomField.MULTI_CAMPAIGN_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label ng-toggle ng-toggle-value="'addCampaignCode' + customField.pk"
ng-toggle-default="auth.currentUser.isAuthenticated || customFieldPricing.visibility.isRequired || customField.isCodeInputShownByDefault || !!nullModel[&#39;nullField-&#39; + customField.pk]"
class="cf-label hide-when-toggled"
ng-mx-click="click-add-promo-code"
>
<span class="fh-grey underline pointer">[! customField.codeToggleText || T('Add promo or discount code') !]</span>
</label>
<label class="cf-label"
ng-toggled ng-toggled-value="'addCampaignCode' + customField.pk"
>
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="nullModel [&#39;nullField-&#39; + customField.pk]" ng-prevalidate-custom-field="nullModel" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div
ng-with="prevalidity = nullModel.prevalidity[&#39;nullField-&#39; + customField.pk]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.WAIVER_TYPE">
<div class="custom-field-[! customField.type|css !]"
ng-can-create="Waiver on customField.company"
ng-can-only-when="customField.connectedWaivers.length"
>
<div class="cf-admin-note md-inline">
<span class="icon-lock" ng-tip="[! T('Only people in your company see this note') !]"></span>
<b ng-show="!!customField.name">[! customField.name !]:</b>
Customers will be asked to sign:
<span ng-repeat="connectedWaiver in customField.connectedWaivers" >
<a ng-href="[! connectedWaiver.waiver.$url(urls.dashboard.settings.waivers.waiver.index) !]">[! connectedWaiver.waiver.name !]</a><span ng-if="!$last">,</span>
</span>
</div>
</div>
</div>
<ul class="errors">
<li ng-repeat="error in nullForm [&#39;nullField-&#39; + customField.pk].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</script>
<script type="text/ng-template" id="crew-table">
<table class="spreadsheet spreadsheet--no-margin spreadsheet--no-bottom-border"
ng-class="{ 'spreadsheet--left-pad ': indentCrewTable }"
ng-if="availability.crewMembers.length"
ng-table="availability.crewMembers"
>
<thead class="ss-header ss-header-shade">
<tr>
<td ng-table-header="$row.user.name">Crew name</td>
<td ng-table-header="$row.role.shortName">Role</td>
<td ng-table-header="$row.note">Note</td>
</tr>
</thead>
<tbody ng-repeat="crewMember in $table.collection">
<tr>
<td>[[ crewMember.user.name ]] <span ng-if-once="crewMember.user.isInactive" class="fh-grey"> (deactivated)</span></td>
<td>[[ crewMember.role.shortName ]]</td>
<td>[[ crewMember.note ]]</td>
</tr>
</tbody>
</table>
</script>
<script type="text/ng-template" id="customer-prototype-name">
<span>
[! CustomerPrototype.name(customerPrototype) !]
<span ng-init="suffix = CustomerPrototype.customerTypeSuffix(customerPrototype)">
<span ng-if-once="suffix" class="fh-grey">[! suffix !]</span>
</span>
</span>
</script>
<script type="text/ng-template" id="emv-decline-receipt">
<div class="print-receipt-section">
<ul>
<li ng-if-once="company.imageEmailCdnUrl || company.imageCdnUrl">
<img ng-image="company.imageEmailCdnUrl || company.imageCdnUrl"
ng-image-max-height="250"
alt="[! company.name !]"
class="receipt-logo"
/>
</li>
<li><b>[! company.name !]</b></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul>
<li><b>Authorization Declined</b></li>
</ul>
</div>
<table class="spreadsheet">
<thead>
<tr>
<td colspan="3">[! label !]</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in receipt">
<td>[! detail.key !]</td>
<td>[! detail.value !]</td>
</tr>
</tbody>
</table>
</script>
<script type="text/ng-template" id="field-or-boolean">
<div class="table table-dont-respond flyout-fields-group">
<div class="tr">
<div class="td flyout-fields-title">
<select ng-model="fieldCtrl.type"
ng-disabled="fieldCtrl.isDisabled"
ng-options="type.type as type.label for type in fieldCtrl.types">
</select>
</div>
<div class="td"
ng-if="fieldCtrl.type === 'exact'"
>
<div ng-transclude></div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="waiver-description-hint">
<div class="hint hint-alert">
<p>
<b>Important:</b> The title and description you enter below are only shown on in receipt page and email, asking customers to fill out their waivers.
</p>
<p>
Suggested title: &quot;Next Step: Your Waivers&quot;
</p>
</div>
</script>
<script type="text/ng-template" id="invoice-availability-content">
<ul>
<li class="test-booking-item">
<b>
<i class="[! booking|colorClass:'-swatch inline-swatch' !]"></i>
[! availability.item|name !]</b>
<b ng-if-once="availability.headline">&ndash; [! availability.headline !]</b>
</li>
<li class="test-booking-availability-date">
<span ng-if-once="Availability.isInPast(availability)"
class="badge ghost warning-color"
>Past</span>
[! availability.startAt|datetimeRange:(availability.endAt):'long' !]
</li>
<li ng-if-once="availability.headlinePrivate" class="fh-grey">
[! availability.headlinePrivate !]
</li>
</ul>
</script>
<script type="text/ng-template" id="invoice-availability">
<div ng-controller="dashboard.shared.AvailabilitySmallCtrl">
<a ng-can-view-admin-section="availability.item.company"
ng-can-also-when="navigation.isCurrentCompany(availability.item.company)"
ng-then="linkToAvailability"
ng-href="[! availability.$url(urls.dashboard.overlay.availability.index) !]"
class="the-availability"
ng-link="invoice-availability-content"
></a>
<div ng-else="linkToAvailability">
<a ng-if-once="availability.isBookable" ng-then="bookable"
ng-href="[! availability.$url(urls.company.item.book) !]"
class="the-availability"
ng-link="invoice-availability-content"
></a>
<div ng-else="bookable"
class="the-availability"
ng-link="invoice-availability-content"
></div>
</div>
</div>
</script>
<script type="text/ng-template" id="list-user">
<span title="[! user.username !]">
<span ng-if="user.imageCdnUrl">
<img ng-image="user.imageCdnUrl" class="image-profile-tiny" ng-image-square="60" />
</span>
[! user.name !]
<span ng-if="user.isInactive" class="fh-grey"> (deactivated)</span>
</span>
</script>
<script type="text/ng-template" id="ng-custom-field-manager">
<div class="tb-flyout-wrap"
ng-can-create="CustomFieldInstance on company"
>
<div class="tb-btn tb-btn--flyout"
ng-toggle="manageCustomFieldInstances"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
Edit fields
</div>
<div class="tb-flyout tb-flyout--left tb-flyout--show-overflow"
ng-toggled="manageCustomFieldInstances"
>
<div ng-if="customFieldManagerCtrl.status === 'loading'"
class="flyout-section flyout-section--no-border"
>
<i class="spinner-ticker-css"><span></span></i> Loading custom fields...
</div>
<div ng-if="customFieldManagerCtrl.status === 'success'">
<div class="flyout-section flyout-section--no-border">
<h2>Edit Many Custom Fields</h2>
<div class="hint">
Use this tool to add or remove a custom field from many customers and groups at once. You can also make changes to fields one at a time to the left.
</div>
</div>
<ul class="list-filters flyout-section flyout-section--no-border">
<li
ng-click="customFieldManagerCtrl.data.updateType = 'create'"
ng-class="{ 'toggled': customFieldManagerCtrl.data.updateType == 'create' }"
>
Add fields
</li>
<li
ng-click="customFieldManagerCtrl.data.updateType = 'remove'"
ng-class="{ 'toggled': customFieldManagerCtrl.data.updateType == 'remove' }"
>
Remove fields
</li>
</ul>
<form name="customFieldInstancesForm"
ng-submit="createCtrl.submit(customFieldInstancesForm)"
>
<div class="flyout-scrollable"
ng-style="{ 'max-height': dimensions.height - 325 }"
>
<div class="fields "
>
<div class="flyout-section flyout-section--no-bottom-padding"
ng-show="customFieldManagerCtrl.customFields.length"
ng-with="customFields = customFieldManagerCtrl.customFields"
>
<div class="customfieldinstancesform-customfield "
ng-django-field="customFieldInstancesForm [&#39;customField&#39;]" ng-django-field-model="customFieldManagerCtrl.data [&#39;customField&#39;]"
ng-django-field-required=""
>
<div ng-current-option="customFieldManagerCtrl.data [&#39;customField&#39;]"
ng-current-option-collection="customFields"
ng-current-option-key="'pk'"
ng-current-option-target="customField"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="custom_field"
ng-model="customFieldManagerCtrl.data [&#39;customField&#39;]"
ng-disabled=""
required="required"
ng-options="customField.pk as CustomField.dropdownName(customField) group by (customField.isHidden ? 'Deleted' : '') for customField in customFields"
ng-dropdown
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="customFieldInstancesForm [&#39;customField&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in customFieldInstancesForm [&#39;customField&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div ng-if="customField" class="cf-add-preview">
<div class="cf-add-preview-header">
<span class="badge">Preview</span>
</div>
<div ng-watch="customField" ng-watch-action="nullModel = {}"
ng-with="customFieldPricing = TotalLine.NONE_PRICING; pricesCtrl = pricesCtrl || pricingCtrl;"
ng-null-form
>
<div ng-link="custom-field-value-field-null"></div>
</div>
</div>
</div>
<div ng-show="customFieldManagerCtrl.isAnySelectable()">
<div class="flyout-checklist-header">
[[ customFieldManagerCtrl.data.updateType === 'create' ? T('Add field to:') : T('Remove field from:') ]]
</div>
<a class="flyout-toggle-header small no-border"
ng-toggle="toggleCustomerPrototypes"
>Customer types</a>
<div ng-toggled="toggleCustomerPrototypes">
<div class="flyout-checklist-header minimal-top-padding"
ng-select-all="customFieldManagerCtrl.allCustomerPrototypes"
ng-select-all-model="customFieldManagerCtrl.data['customerPrototype' + $element.pk + 'IsSelected']"
></div>
<ul class="flyout-checklist"
ng-repeat="item in customFieldManagerCtrl.items"
>
<li class="flyout-checklist-header minimal-top-padding"
ng-if="customFieldManagerCtrl.items.length > 1"
ng-select-all="customFieldManagerCtrl.byItem[item.uri].customerPrototypes"
ng-select-all-model="customFieldManagerCtrl.data['customerPrototype' + $element.pk + 'IsSelected']"
ng-select-all-text="[[ item.name ]]"
></li>
<li ng-repeat="customerPrototype in customFieldManagerCtrl.byItem[item.uri].customerPrototypes"
ng-if="customFieldManagerCtrl.isSelectable(customerPrototype)"
>
<div class="customfieldinstancesform-customerprototype-customerprototypepk-isselected "
ng-django-field="customFieldInstancesForm [&#39;customerPrototype&#39; + customerPrototype.pk + &#39;IsSelected&#39;]" ng-django-field-model="customFieldManagerCtrl.data [&#39;customerPrototype&#39; + customerPrototype.pk + &#39;IsSelected&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_selected" name="isSelected" ng-checkbox-madness="true" ng-model="customFieldManagerCtrl.data [&#39;customerPrototype&#39; + customerPrototype.pk + &#39;IsSelected&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
<span ng-inline='customer-prototype-name'></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customFieldInstancesForm [&#39;customerPrototype&#39; + customerPrototype.pk + &#39;IsSelected&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</li>
<li class="flyout-checklist-empty-item"
ng-if="!customFieldManagerCtrl.isSelectable(customFieldManagerCtrl.byItem[item.uri].customerPrototypes)"
>
None available
</li>
</ul>
</div>
<a class="flyout-toggle-header small"
ng-toggle="toggleCustomFieldInstanceGroups"
>Whole-booking fields</a>
<div ng-toggled="toggleCustomFieldInstanceGroups">
<div class="flyout-checklist-header minimal-top-padding"
ng-select-all="customFieldManagerCtrl.allCustomFieldInstanceGroups"
ng-select-all-model="customFieldManagerCtrl.data['customFieldInstanceGroup' + $element.pk + 'IsSelected']"
></div>
<ul class="flyout-checklist"
ng-repeat="item in customFieldManagerCtrl.items"
>
<li class="flyout-checklist-header minimal-top-padding"
ng-if="customFieldManagerCtrl.items.length > 1"
ng-select-all="customFieldManagerCtrl.byItem[item.uri].customFieldInstanceGroups"
ng-select-all-model="customFieldManagerCtrl.data['customFieldInstanceGroup' + $element.pk + 'IsSelected']"
ng-select-all-text="[[ item.name ]]"
></li>
<li ng-repeat="customFieldInstanceGroup in customFieldManagerCtrl.byItem[item.uri].customFieldInstanceGroups"
ng-if="customFieldManagerCtrl.isSelectable(customFieldInstanceGroup)"
>
<div class="customfieldinstancesform-customfieldinstancegroup-customfieldinstancegrouppk-isselected "
ng-django-field="customFieldInstancesForm [&#39;customFieldInstanceGroup&#39; + customFieldInstanceGroup.pk + &#39;IsSelected&#39;]" ng-django-field-model="customFieldManagerCtrl.data [&#39;customFieldInstanceGroup&#39; + customFieldInstanceGroup.pk + &#39;IsSelected&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_selected" name="isSelected" ng-checkbox-madness="true" ng-model="customFieldManagerCtrl.data [&#39;customFieldInstanceGroup&#39; + customFieldInstanceGroup.pk + &#39;IsSelected&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
[[ customFieldInstanceGroup.name ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customFieldInstancesForm [&#39;customFieldInstanceGroup&#39; + customFieldInstanceGroup.pk + &#39;IsSelected&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</li>
<li class="flyout-checklist-empty-item"
ng-if="!customFieldManagerCtrl.isSelectable(customFieldManagerCtrl.byItem[item.uri].customFieldInstanceGroups)"
>
None available
</li>
</ul>
</div>
</div>
<div class="flyout-section"
ng-show="!customFieldManagerCtrl.customFields.length"
>
<div class="hint hint-alert">
<p>No custom fields available</p>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="flyout-errors">
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="customFieldInstancesForm.all.$error.cannot_hide">To remove this custom field, please remove all conditional display logic associated with it.</li>
<li ng-if="customFieldInstancesForm.all.$error.booking_level_transportation">Only booking-level Lodging and Transportation custom fields are allowed.</li>
<li ng-if="customFieldInstancesForm.all.$error.one_transportation">Only one Lodging and Transportation custom field is allowed per group.</li>
<li ng-repeat="error in customFieldInstancesForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="btns flyout-section flyout-section--no-border">
<button class="btn-big btn-wide btn-green" type="submit"
ng-if="customFieldManagerCtrl.data.updateType === 'create'"
ng-disabled="customFieldInstancesForm.$invalid || customFieldInstancesForm.$submitting || !customFieldManagerCtrl.isAnySelected()"
>
[[ customFieldInstancesForm.$submitting ? T('Adding...') : T('Add') ]]
</button>
<button class="btn-big btn-wide btn-red" type="submit"
ng-if="customFieldManagerCtrl.data.updateType === 'remove'"
ng-disabled="customFieldInstancesForm.$invalid || customFieldInstancesForm.$submitting || !customFieldManagerCtrl.isAnySelected()"
>
Remove
</button>
</div>
</form>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-item-manager">
<div class="tb-flyout-wrap"
ng-can-create="CustomerPrototype on company"
>
<div class="tb-btn tb-btn--flyout"
ng-toggle="manageItems"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
Edit customers and groups
</div>
<div class="tb-flyout tb-flyout--left tb-flyout--show-overflow"
ng-toggled="manageItems"
>
<div ng-if="itemManagerCtrl.status === 'loading'"
class="flyout-section flyout-section--no-border"
>
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
<div ng-if="itemManagerCtrl.status === 'success'">
<div class="flyout-section flyout-section--no-border">
<h2>Edit Many Customers & Field Groups</h2>
<div class="hint">
Use this tool to add customer types and field groups for many items at once. You can also make changes to items one at a time on the left.
</div>
</div>
<ul class="list-filters flyout-section flyout-section--no-border">
<li
ng-click="itemManagerCtrl.data.type = CustomerPrototype.cls"
ng-class="{ 'toggled': itemManagerCtrl.data.type === CustomerPrototype.cls }"
>
Add customer types
</li>
<li
ng-click="itemManagerCtrl.data.type = CustomFieldInstanceGroup.cls"
ng-class="{ 'toggled': itemManagerCtrl.data.type === CustomFieldInstanceGroup.cls }"
>
Add field groups
</li>
</ul>
<form ng-if="itemManagerCtrl.data.type === CustomerPrototype.cls"
name="customerPrototypesForm"
ng-submit="createCtrl.submit(customerPrototypesForm)"
>
<div class="fields "
>
<div class="flyout-section flyout-section--no-bottom-padding"
ng-with="customerTypes = itemManagerCtrl.customerTypes"
>
<div class="customerprototypesform-customertype "
ng-django-field="customerPrototypesForm [&#39;customerType&#39;]" ng-django-field-model="itemManagerCtrl.data [&#39;customerType&#39;]"
ng-django-field-required=""
>
<div ng-current-option="itemManagerCtrl.data [&#39;customerType&#39;]"
ng-current-option-collection="customerTypes"
ng-current-option-key="'pk'"
ng-current-option-target="customerType"
>
<label>
<span class="label-text">
Customer type
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="customer_type"
ng-model="itemManagerCtrl.data [&#39;customerType&#39;]"
ng-disabled=""
required="required"
ng-options="ct.pk as (ct.name + (ct.pk ? ' (' + ct.pk + ')' : '')) group by (ct.isHidden ? 'Deleted' : '') for ct in customerTypes"
ng-dropdown
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="customerPrototypesForm [&#39;customerType&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in customerPrototypesForm [&#39;customerType&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="customerprototypesform-isexclusive field-cb "
ng-django-field="customerPrototypesForm [&#39;isExclusive&#39;]" ng-django-field-model="itemManagerCtrl.data [&#39;isExclusive&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_exclusive" name="isExclusive" ng-checkbox-madness="true" ng-model="itemManagerCtrl.data [&#39;isExclusive&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Make exclusive
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customerPrototypesForm [&#39;isExclusive&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="flyout-checklist-header">
Add customer to:
</div>
<div class="flyout-scrollable"
ng-style="{ 'max-height': dimensions.height - 425 }"
>
<ul class="flyout-checklist">
<li class="flyout-checklist-header minimal-top-padding"
ng-select-all="itemManagerCtrl.items"
ng-select-all-model="itemManagerCtrl.data['item' + $element.pk + 'IsSelected']"
ng-select-all-text="[! T('Items') !]"
></li>
<li ng-repeat="item in itemManagerCtrl.items">
<div class="customerprototypesform-item-itempk-isselected "
ng-django-field="customerPrototypesForm [&#39;item&#39; + item.pk + &#39;IsSelected&#39;]" ng-django-field-model="itemManagerCtrl.data [&#39;item&#39; + item.pk + &#39;IsSelected&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_selected" name="isSelected" ng-checkbox-madness="true" ng-model="itemManagerCtrl.data [&#39;item&#39; + item.pk + &#39;IsSelected&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
[! item|name !]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customerPrototypesForm [&#39;item&#39; + item.pk + &#39;IsSelected&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</li>
</ul>
<div class="flyout-section"
ng-if="!itemManagerCtrl.items.length"
>
<div class="hint hint-alert">
<p>No items available</p>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="flyout-errors">
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in customerPrototypesForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div class="btns flyout-section flyout-section--no-border">
<button class="btn-big btn-wide btn-green" type="submit"
ng-disabled="customerPrototypesForm.$invalid || customerPrototypesForm.$submitting || !itemManagerCtrl.isAnySelected()"
>
[[ customerPrototypesForm.$submitting ? T('Adding...') : T('Add') ]]
</button>
</div>
</form>
<form ng-if="itemManagerCtrl.data.type === CustomFieldInstanceGroup.cls"
name="customFieldInstanceGroupsForm"
ng-submit="createCtrl.submit(customFieldInstanceGroupsForm)"
>
<div class="fields "
>
<div class="flyout-section">
<div class="customfieldinstancegroupsform-name "
ng-django-field="customFieldInstanceGroupsForm [&#39;name&#39;]" ng-django-field-model="itemManagerCtrl.data [&#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="itemManagerCtrl.data [&#39;name&#39;]" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customFieldInstanceGroupsForm [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="flyout-checklist-header">
Add field group to:
</div>
<div class="flyout-scrollable"
ng-style="{ 'max-height': dimensions.height - 425 }"
>
<ul class="flyout-checklist">
<li class="flyout-checklist-header minimal-top-padding"
ng-select-all="itemManagerCtrl.items"
ng-select-all-model="itemManagerCtrl.data['item' + $element.pk + 'IsSelected']"
ng-select-all-text="[! T('Items') !]"
></li>
<li ng-repeat="item in itemManagerCtrl.items">
<div class="customfieldinstancegroupsform-item-itempk-isselected "
ng-django-field="customFieldInstanceGroupsForm [&#39;item&#39; + item.pk + &#39;IsSelected&#39;]" ng-django-field-model="itemManagerCtrl.data [&#39;item&#39; + item.pk + &#39;IsSelected&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_selected" name="isSelected" ng-checkbox-madness="true" ng-model="itemManagerCtrl.data [&#39;item&#39; + item.pk + &#39;IsSelected&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
[! item|name !]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customFieldInstanceGroupsForm [&#39;item&#39; + item.pk + &#39;IsSelected&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</li>
</ul>
<div class="flyout-section"
ng-if="!itemManagerCtrl.items.length"
>
<div class="hint hint-alert">
<p>No items available</p>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="flyout-errors">
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in customFieldInstanceGroupsForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div class="btns flyout-section flyout-section--no-border">
<button class="btn-big btn-wide btn-green" type="submit"
ng-disabled="customFieldInstanceGroupsForm.$invalid || customFieldInstanceGroupsForm.$submitting || !itemManagerCtrl.isAnySelected()"
>
[[ customFieldInstanceGroupsForm.$submitting ? T('Adding...') : T('Add') ]]
</button>
</div>
</form>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-colorpicker">
<div class="colorpicker">
<a ng-repeat="color in colorPickerCtrl.colors"
class="swatch-wrap [[ colorPickerCtrl.isSelected(color)|addClassIf:'active' ]]"
ng-click="colorPickerCtrl.select(color)"
ng-tip="[! T('No color') !]"
ng-tip-when="color == 0"
ng-tip-classes="tip-indent"
title="[! color ? interpolate(T('Color: %(count)s'), { count: color }) : T('Color: None') !]"
><i class="swatch [! color|colorClass:'-swatch':'no-color' !]"></i></a>
</div>
</script>
<script type="text/ng-template" id="ngFormFieldErrors">
<ul class="errors"
ng-if="ngFormField && ngFormField['$error'].$server.length"
>
<li ng-repeat="error in ngFormField['$error'].$server">
[[ error ]]
</li>
</ul>
</script>
<script type="text/ng-template" id="ng-flow-node-size-field">
<div class="flow-node-size-field field">
<label class="label-text">Size</label>
<div class="the-field-outer">
<div class="the-field">
<span class="width-1-1 height-3"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_FULL, FlowNode.HEIGHT_3) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_FULL, FlowNode.HEIGHT_3)"
></span>
<span class="width-2-3 height-3"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_TWO_THIRDS, FlowNode.HEIGHT_3) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_TWO_THIRDS, FlowNode.HEIGHT_3)"
></span>
<span class="width-1-2 height-3"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_HALF, FlowNode.HEIGHT_3) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_HALF, FlowNode.HEIGHT_3)"
></span>
<span class="width-1-3 height-3"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_ONE_THIRD, FlowNode.HEIGHT_3) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_ONE_THIRD, FlowNode.HEIGHT_3)"
></span>
<span class="width-1-1 height-2"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_FULL, FlowNode.HEIGHT_2) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_FULL, FlowNode.HEIGHT_2)"
></span>
<span class="width-2-3 height-2"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_TWO_THIRDS, FlowNode.HEIGHT_2) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_TWO_THIRDS, FlowNode.HEIGHT_2)"
></span>
<span class="width-1-2 height-2"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_HALF, FlowNode.HEIGHT_2) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_HALF, FlowNode.HEIGHT_2)"
></span>
<span class="width-1-3 height-2"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_ONE_THIRD, FlowNode.HEIGHT_2) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_ONE_THIRD, FlowNode.HEIGHT_2)"
></span>
<span class="width-1-1 height-1"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_FULL, FlowNode.HEIGHT_1) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_FULL, FlowNode.HEIGHT_1)"
></span>
<span class="width-2-3 height-1"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_TWO_THIRDS, FlowNode.HEIGHT_1) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_TWO_THIRDS, FlowNode.HEIGHT_1)"
></span>
<span class="width-1-2 height-1"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_HALF, FlowNode.HEIGHT_1) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_HALF, FlowNode.HEIGHT_1)"
></span>
<span class="width-1-3 height-1"
ng-class="{ 'selected': flowNodeSizeFieldCtrl.isSize(FlowNode.WIDTH_ONE_THIRD, FlowNode.HEIGHT_1) }"
ng-click="flowNodeSizeFieldCtrl.handleClick(FlowNode.WIDTH_ONE_THIRD, FlowNode.HEIGHT_1)"
></span>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ngMultipleChoiceField">
<ul class="flyout-checklist"
ng-if="multipleChoiceCtrl.showNoneChoice || multipleChoiceCtrl.showAnyChoice"
>
<li ng-if="multipleChoiceCtrl.showNoneChoice">
<label>
<input ng-model="multipleChoiceCtrl.selections[multipleChoiceCtrl.NONE_CHOICE]"
type="checkbox"
ng-change="multipleChoiceCtrl.onChange(multipleChoiceCtrl.NONE_CHOICE)"
/>
<span>None</span>
</label>
</li>
<li ng-if="multipleChoiceCtrl.showAnyChoice">
<label>
<input ng-model="multipleChoiceCtrl.selections[multipleChoiceCtrl.ANY_CHOICE]"
type="checkbox"
ng-change="multipleChoiceCtrl.onChange(multipleChoiceCtrl.ANY_CHOICE)"
/>
<span>Any</span>
</label>
</li>
</ul>
<div ng-if="!multipleChoiceCtrl.selections[multipleChoiceCtrl.ANY_CHOICE]"
ng-transclude
></div>
</script>
<script type="text/ng-template" id="ngMultipleChoiceFieldChoices">
<div ng-data="choicesCtrl.choices.$promise" ng-data-small
class="flyout-ng-data"
>
<div
ng-if="choicesCtrl.choices.length" ng-then="hasChoices"
>
<div ng-if-once="choicesCtrl.header" class="flyout-create-form-header">
<div class="flyout-toggle-header small"
ng-if-once="choicesCtrl.allowToggle"
ng-then="hasToggle"
ng-toggle
ng-toggle-value="choicesCtrl.$id"
ng-toggle-default="true"
>
[! choicesCtrl.header !]
</div>
</div>
<div ng-toggled ng-toggled-value="choicesCtrl.$id" ng-toggled-always-when="!choicesCtrl.allowToggle">
<div ng-if-once="choicesCtrl.showSelectAll" class="flyout-checklist-header"
ng-select-all="choicesCtrl.choices"
ng-select-all-model="multipleChoiceCtrl.selections[choicesCtrl.valueField($element)]"
ng-select-all-defaults="multipleChoiceCtrl.defaults"
ng-select-all-default-field="choicesCtrl.valueField"
ng-select-all-callback="multipleChoiceCtrl.selectAllCallback"
></div>
<ul class="flyout-checklist">
<li ng-repeat="choice in choicesCtrl.choices"
ng-init="value = choicesCtrl.valueField(choice)"
>
<label>
<input ng-model="multipleChoiceCtrl.selections[value]"
ng-change="multipleChoiceCtrl.onChange(value)"
type="checkbox"
/>
<span ng-bind-html="choicesCtrl.nameField(choice)"></span>
</label>
</li>
</ul>
</div>
</div>
<ul class="flyout-checklist"
ng-else="hasChoices">
<li class="flyout-checklist-empty-item">
[! ((choicesCtrl.emptyNote|isDefined) ? choicesCtrl.emptyNote : T('No available options')) !]
</li>
</ul>
</div>
</script>
<script type="text/ng-template" id="ng-nag-content">
<h1>
[!
nagContentCtrl.daysUntilDowntime > 1 ?
interpolate(T('Planned maintenance in %(count)s days'), { count: nagContentCtrl.daysUntilDowntime }) :
T('Planned maintenance soon')
!]
</h1>
<p>
We're going to be doing server maintenance and need to
disable some parts of FareHarbor for about two hours.
</p>
<p>
During this time making new bookings, editing existing bookings (including checking in), and reports will be unavailable.
</p>
<p>
This will happen between <b>2am and 4am US Pacific Time on December 23rd</b>.
<span class="fh-grey">That's [! nagContentCtrl.downtimeStartAt|datetimeRange:(nagContentCtrl.downtimeEndAt):'long' !] in your company's&nbsp;timezone.</span>
</p>
<p ng-if="includeHelpPageLink">
<a class="fh-blue underline"
ng-href="https://fareharbor.com/help/more/december-2018-system-maintenance/"
ng-outbound-link="_blank"
>
More information &rsaquo;
</a>
</p>
</script>
<script type="text/ng-template" id="nag-overlay">
<div ng-if="User.showNag(auth.currentUser, 'downtimeAlert') && !isReadonlyEnabled"
ng-hide="editUserNagCtrl.status === 'saving'"
class="db-theater overlay-on-mobile"
ng-body-class="'hide-body-overflow'"
ng-edit-user-nag="downtimeAlert"
>
<div class="bookings-window-content is-alert fade-in-up">
<div ng-nag-content></div>
<div class="btns">
<button class="btn btn-darkgrey btn-left"
ng-click="editUserNagCtrl.dismiss()"
>
I understand
</button>
<a class="btn btn-grey btn-left"
ng-href="https://fareharbor.com/help/more/december-2018-system-maintenance/"
ng-outbound-link="_blank"
>
More information &rsaquo;
</a>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="lib.shortcutsOverlay">
<div ng-shortcut="'shift+/'"
ng-shortcut-action="shortcutsOverlay.show()"
>
<div class="shortcuts"
ng-if="shortcutsOverlay.isShowing"
ng-shortcut="'esc|shift+/'"
ng-shortcut-action="shortcutsOverlay.hide()"
ng-body-class="'hide-body-overflow'"
>
<div class="table valign-middle shortcuts-inner">
<div class="tr">
<div class="td"
ng-click="shortcutsOverlay.hide()"
ng-click-strict
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="shortcutsOverlay.shouldConfirmClose"
ng-confirm-click-strict
>
<div class="shortcuts-content">
<span class="overlay-close respond-print-hide"
ng-click="shortcutsOverlay.hide()"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="shortcutsOverlay.shouldConfirmClose"
title="[! T('Shortcut: escape') !]"
><span>Close</span></span>
<div class="admin-shortcuts admin-shortcuts--first"
ng-can-admin-view="company"
>
<table class="spreadsheet width-auto">
<tbody>
<tr>
<td><b>Tier</b></td>
<td>
<span ng-if-once="!company.features.tier" class="fh-grey">Not set</span>
<span ng-if-once="company.features.tier">[! company.features.tier !]</span>
</td>
</tr>
<tr>
<td><b>Currency</b></td>
<td>
[! company.processorCurrency|uppercase !]
<span ng-if-once="company.processorCurrency === 'usd'">&#x1F1FA;&#x1F1F8;</span>
</td>
</tr>
<tr>
<td>
<b><a href="[! navigation.currentCompany.$url(urls.dashboard.settings.advanced) !]">Processing Fee</a></b>
</td>
<td>
[! company.processingFeePercentage|percentageFromPercentage:'hidePlus' !]
<span ng-if="company.processingFlatFee !== 0">+ [! company.processingFlatFee|amount:company !]</span>
</td>
</tr>
<tr>
<td><b>Timezone</b></td>
<td>
[! company.timezone !]
<span ng-if-once="company.province">([! company.city !], [! company.province !])</span>
</td>
</tr>
<tr>
<td><b>Joined FareHarbor</b></td>
<td>
<span ng-if-once="!company.liveAt" class="fh-grey">Not live</span>
<span ng-if-once="company.liveAt">[! company.liveAt|month:'long' !]</span>
</td>
</tr>
<tr class="show-links">
<td><b>Website</b></td>
<td>
<a ng-href="[[ company.url ]]" ng-outbound-link="_blank"
ng-if-once="company.url"
>[! company.url|hostname !]</a>
<span ng-if-once="!company.url" class="fh-grey">Not set</span>
</td>
</tr>
<tr>
<td><b>Name</b></td>
<td>[! company.name !]</td>
</tr>
<tr>
<td><b>Shortname</b></td>
<td><code>[! company.shortname !]</code></td>
</tr>
<tr ng-if-once="!!company.salesperson && company.salesperson.username !== 'fareharbor' && auth.isAuthenticatedForAdminCompanyAsDeveloper()">
<td><b>FareHarbor contact</b></td>
<td>
<a ng-href="[! company.salesperson.$url(urls.dashboard.settings.permissions.user.index) !]"
ng-click="shortcutsOverlay.hide()"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="shortcutsOverlay.shouldConfirmClose"
>[! company.salesperson.name !]</a>
</td>
</tr>
</tbody>
</table>
<a ng-href="[! company.$url(urls.dashboard.settings.advanced) !]"
class="btn btn-grey"
ng-click="shortcutsOverlay.hide()"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="shortcutsOverlay.shouldConfirmClose"
>Advanced settings</a>
</div>
<div class="admin-shortcuts"
ng-class="{ 'is-flagged': company.isAdminFlagged && !editCtrl.editing }"
ng-controller="lib.shared.CompanyAdminNotesEditableCtrl"
ng-can-admin-view="company"
>
<div ng-if="!editCtrl.editing">
<div class="prose company-admin-notes"
ng-if-once="company.adminNotes"
ng-bind-html-once="company.adminNotesSafeHtml"
></div>
<div class="btns" ng-can-admin-update="company">
<button class="btn btn-grey"
ng-click="editCtrl.edit()"
>
[! company.adminNotes ? 'Edit' : 'Add' !] notes
</button>
</div>
</div>
<form name="companyAdminNotesForm"
ng-if="editCtrl.editing"
ng-submit="editCtrl.submit(companyAdminNotesForm)"
>
<div class="fields "
>
<div class="companyadminnotesform-adminnotes
field-markdown
"
ng-django-field="companyAdminNotesForm [&#39;adminNotes&#39;]" ng-django-field-model="editableCompany [&#39;adminNotes&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_admin_notes" name="adminNotes" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-parent=".companyadminnotesform-adminnotes" ng-markdown-preview=".js-markdown-tb .js-preview-button" ng-markdown-preview-result=".js-markdown-preview-result" ng-model="editableCompany [&#39;adminNotes&#39;]" rows="10">
</textarea>
<span class="field-style-hook"></span>
<div ng-toggled-show class="markdown-preview prose js-markdown-preview-result"
ng-toggled-show-value="'markdownPreview-' + $id"
></div>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in companyAdminNotesForm [&#39;adminNotes&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb markdown-field-tb tb--shaded js-markdown-tb">
<div class="tb-left"
>
<div class="tb-group">
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
</div>
<div class="tb-right">
<div class="tb-group">
<span class="tb-btn js-preview-button" ng-toggle ng-toggle-value="'markdownPreview-' + $id">
Preview Markdown
<a class="icon-hint"
ng-tip="[! T('Markdown lets you format text using a special syntax. Click here to learn more about it.') !]"
ng-href="https://fareharbor.com/help/more/markdown/" ng-outbound-link="_new"
></a>
</span>
</div>
</div>
</div>
</div>
<div class="companyadminnotesform-isadminflagged field-cb "
ng-django-field="companyAdminNotesForm [&#39;isAdminFlagged&#39;]" ng-django-field-model="editableCompany [&#39;isAdminFlagged&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_admin_flagged" name="isAdminFlagged" ng-checkbox-madness="true" ng-model="editableCompany [&#39;isAdminFlagged&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Flag this company
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in companyAdminNotesForm [&#39;isAdminFlagged&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in companyAdminNotesForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn btn-green"
type="submit"
ng-disabled="companyAdminNotesForm.$invalid || companyAdminNotesForm.$submitting || companyAdminNotesForm.$pristine"
>
[[ companyAdminNotesForm.$submitting ? 'Saving...' : 'Save' ]]
</button>
<button class="btn btn-grey"
type="button"
ng-click="editCtrl.cancel(companyAdminNotesForm)"
ng-disabled="companyAdminNotesForm.$submitting"
>
Cancel
</button>
</div>
</form>
</div>
<div class="flyout-toggle-header large no-border"
ng-can-admin-view="company"
ng-then="isAdmin"
ng-toggle="shortcutsList"
>
Keyboard Shortcuts
</div>
<h2 class="shortcuts-header"
ng-else="isAdmin"
>
Keyboard shortcuts
</h2>
<div ng-if="!isAdmin || toggles.state('shortcutsList')">
<p class="shortcuts-description">
FareHarbor has many keyboard shortcuts you can use to quickly navigate the site. To see if a button has a shortcut, hold your pointer over it for a few seconds. Tip: Try it with the close button of this window.
</p>
<table class="shortcuts-list">
<tbody>
<tr>
<td>Show/hide this screen</td>
<td><span class="sc-button">?</span></td>
</tr>
</tbody>
<tbody>
<tr>
<td colspan="2"><b>General</b></td>
</tr>
<tr ng-can-admin-view="company">
<td>Jump to company</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">j</span></td>
</tr>
<tr>
<td>Stop current action</td>
<td><span class="sc-button">Esc</span></td>
</tr>
<tr>
<td>Go to previous month/day</td>
<td><span class="sc-button">&larr;</span></td>
</tr>
<tr>
<td>Go to next month/day</td>
<td><span class="sc-button">&rarr;</span></td>
</tr>
<tr>
<td>Go to current month/day</td>
<td><span class="sc-button">&uarr;</span></td>
</tr>
<tr>
<td>Start searching</td>
<td><span class="sc-button">/</span></td>
</tr>
</tbody>
<tbody>
<tr>
<td colspan="2"><b>Dashboard</b></td>
</tr>
<tr>
<td>Bookings section</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">b</span></td>
</tr>
<tr>
<td>Manifest section</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">m</span></td>
</tr>
<tr>
<td>Reports section</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">r</span></td>
</tr>
<tr>
<td>Items section</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">i</span></td>
</tr>
<tr>
<td>Settings section</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">e</span></td>
</tr>
<tr ng-can-admin-update="company">
<td>Advanced settings</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">,</span></td>
</tr>
<tr>
<td>Create new booking (if viewing an availability)</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">n</span></td>
</tr>
</tbody>
<tbody>
<tr>
<td colspan="2"><b>Working with bookings</b></td>
</tr>
<tr>
<td>Add or remove customers</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">m</span></td>
</tr>
<tr>
<td>Start rebooking</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">r</span></td>
</tr>
<tr>
<td>Cancel booking</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">x</span></td>
</tr>
<tr>
<td>Add payment</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">+</span></td>
</tr>
<tr>
<td>Refund</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">-</span></td>
</tr>
<tr>
<td>Save card to charge later</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">s</span></td>
</tr>
<tr>
<td>Send email</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">e</span></td>
</tr>
<tr>
<td>Print</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">p</span></td>
</tr>
</tbody>
<tbody>
<tr>
<td colspan="2"><b>Creating bookings</b></td>
</tr>
<tr>
<td>Add corresponding type of customer to booking</td>
<td>
<span class="sc-button">1</span> through <span class="sc-button">9</span></td>
</tr>
<tr>
<td>Remove last customer</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">Backspace</span></td>
</tr>
<tr ng-can="createWithoutCVC on Payment with navigation.currentCompany">
<td>Allow booking without CVC</td>
<td><span class="sc-button">Shift</span> +
<span class="sc-button" ng-tip='[! interpolate(cT("Mac as in Apple computer", "%(optionKey)s on Mac"), { optionKey: "<span class=\"sc-button\">" + cT("Option key on keyboard", "Option") + "</span>" })!]'>Alt</span> +
<span class="sc-button">c</span></td>
</tr>
<tr>
<td>Create booking (form must be valid)</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">Enter</span></td>
</tr>
</tbody>
<tbody>
<tr>
<td colspan="2"><b>Manifest</b></td>
</tr>
<tr>
<td>Show/hide customer information</td>
<td><span class="sc-button">c</span></td>
</tr>
</tbody>
<tbody>
<tr>
<td colspan="2"><b>Items</b></td>
</tr>
<tr>
<td>Preview</td>
<td><span class="sc-button">Shift</span> + <span class="sc-button">p</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-pagination-settings">
<label>
<span class="label-textnowrap"># per page</span>
<div class="field-search-wrap">
<input class="field-search js-disable-shortcuts" type="text"
ng-int-input
ng-int-input-min="1"
ng-int-input-max="paginationCtrl.maxPageSize"
ng-model="paginationCtrl.pageSize"
/>
</div>
</label>
</script>
<script type="text/ng-template" id="ng-pagination-settings-flyout">
<div class="tb-flyout-wrap respond-print-hide">
<div class="tb-btn tb-btn--flyout tb-collapse-on-mobile"
ng-toggle="paginateSettings"
ng-toggle-auto-close
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
>
<i class="tb-icon cog"></i>
<abbr>Pagination options</abbr>
</div>
<div ng-toggled="paginateSettings"
class="tb-flyout tb-flyout--auto-width-narrow"
ng-autofocus
ng-autofocus-open
>
<div class="flyout-section" ng-pagination-settings></div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-pagination-navigation">
<div ng-if="paginationCtrl.pageCount > 1">
<a class="tb-btn [[ addClassIf(paginationCtrl.currentPage <= 0, 'is-disabled') ]] respond-print-hide"
ng-click="paginationCtrl.previousPage()"
>
<span class="tb-icon arrow-left"></span>
<abbr>Previous page</abbr>
</a>
<span class="tb-text pagination">
<span class="respond-print-show">
Page [[ paginationCtrl.currentPage + 1 ]]
</span>
<span class="respond-print-hide">Page</span> <select ng-options="page as page + 1 for page in paginationCtrl.pages" ng-model="paginationCtrl.currentPage" class="respond-print-hide"></select> of [[ paginationCtrl.pageCount ]]
</span>
<a class="tb-btn [[ addClassIf(paginationCtrl.currentPage >= paginationCtrl.pageCount - 1, 'is-disabled') ]] respond-print-hide"
ng-click="paginationCtrl.nextPage()"
>
<span class="tb-icon arrow-right"></span>
<abbr>Next page</abbr>
</a>
</div>
</script>
<script type="text/ng-template" id="ng-pagination-jump">
<div class="tb-flyout-wrap respond-print-hide">
<div class="tb-btn tb-btn--flyout tb-collapse-on-mobile"
ng-toggle="paginateJump"
ng-toggle-auto-close
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
>
<i class="tb-icon search"></i>
Find
</div>
<div ng-toggled="paginateJump"
class="tb-flyout"
ng-autofocus
ng-autofocus-open
>
<div class="flyout-section flyout-section--no-border">
<select ng-model="paginationJumpCtrl.selected"
ng-dropdown
ng-dropdown-remote-options="paginationJumpCtrl.option(element) for element in paginationJumpCtrl.endpoint"
ng-placeholder="[! T('Find...') !]"
></select>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.passwordGenerator">
<div class="field">
<label>
<span class="label-text"></span>
<span class="the-field-outer">
<span class="the-field">
<a class="form-link" ng-click="generatorCtrl.generate()">Generate password</a>
</span>
</span>
</label>
</div>
<div
ng-class="{ 'labels-left-content': !resetPasswordForm }"
>
<div class="generated-password"
ng-if="generatorCtrl.password && generatorCtrl.password === generatorCtrl.model.password"
>
<p>
<b>Here is your randomly-generated password.</b> Make note of it  once you save your changes there will be no way to retrieve it again.
</p>
<input class="field-copy-code" readonly="readonly" ng-model="generatorCtrl.password" ng-autoselect>
</div>
</div>
</script>
<script type="text/ng-template" id="payment-setup-nag">
<a ng-href="[! company.$url(urls.dashboard.settings.payments.index) !]"
class="payment-setup-nag [! isShort ? 'is-short' : '' !] [! isSidebar ? 'settings-wide-with-sidebar' : '' !]"
ng-can="editAccounting on company"
ng-can-only-when="!company.isPaymentSetupComplete && company.isCharter"
>
<i class="warning-icon"></i>
<span ng-if="isShort">
Payments can't be deposited until you complete the <span class="underline">payment setup checklist</span>
&raquo;
</span>
<span ng-else="isShort">
<b>Your payouts are not set up.</b> We can't deposit to your bank account until you complete the <span class="underline">payment setup checklist</span>
&raquo;
</span>
</a>
</script>
<script type="text/ng-template" id="dashboard.portionCalculator">
<p class="hint portion-calculator-hint">
Calculation based on total of [! portionCalculatorCtrl.total|amount:portionCalculatorCtrl.currency !].
</p>
<table class="portion-calculator-table"
ng-autofocus
>
<tr ng-if-once="portionCalculatorCtrl.needsField('percentage')">
<td ng-link="dashboard.portionCalculator.labels.[! portionCalculatorCtrl.labelsKey !].percentage"></td>
<td>
<div class="field field-percent ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
max="100"
min="0"
step="1e-7"
ng-float-input
ng-model="portionCalculatorCtrl.percentage"
ng-pattern="/^(\d*\.?\d+|\d+\.?\d*)$/"
ng-change="portionCalculatorCtrl.updateFromPercentage()"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr ng-if-once="portionCalculatorCtrl.needsField('remaining')">
<td ng-link="dashboard.portionCalculator.labels.[! portionCalculatorCtrl.labelsKey !].remaining"></td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="portionCalculatorCtrl.remaining"
ng-amount-input
ng-amount-input-max="portionCalculatorCtrl.total"
ng-amount-input-min="0"
ng-change="portionCalculatorCtrl.updateFromRemaining()"
data-lpignore="true"
>
<span class="field-style-hook">
[! (portionCalculatorCtrl.currency || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td ng-link="dashboard.portionCalculator.labels.[! portionCalculatorCtrl.labelsKey !].result"></td>
<td>
[[ portionCalculatorCtrl.result|amount:portionCalculatorCtrl.currency ]]
</td>
</tr>
<tr>
<td></td>
<td>
<button class="btn-tiny btn-green"
type="submit"
ng-click="portionCalculatorCtrl.useResult()"
ng-disabled="portionCalculatorCtrl.result <= 0 || portionCalculatorCtrl.result > portionCalculatorCtrl.max"
>Set</button>
</td>
</tr>
</table>
</script>
<script type="text/ng-template" id="dashboard.portionCalculator.labels.refund.percentage">
<span>Refund percent:</span>
</script>
<script type="text/ng-template" id="dashboard.portionCalculator.labels.refund.remaining">
<span>Unrefunded:</span>
</script>
<script type="text/ng-template" id="dashboard.portionCalculator.labels.refund.result">
<span>Refund amount:</span>
</script>
<script type="text/ng-template" id="dashboard.processorIdentifier">
<span class="fh-grey"
ng-can-admin-view="company"
ng-can-only-when="processorIdentifier"
>
<a ng-toggle="showProcessorIdentifier" class="hide-when-toggled respond-print-hide"
ng-tip="[! T('Show processor identifier') !]"
>(ID)</a>
<span ng-toggled="showProcessorIdentifier">&mdash; [! processorIdentifier !] ([! processorType !])</span>
</span>
</script>
<script type="text/ng-template" id="dashboard.ngFormatJson">
<div class="prose prose-section">
<div ng-repeat="(key, value) in data">
<div ng-if-once="isTable(value)"
ng-then="table"
ng-init="columns = keys(value[0])"
>
<b>[! key|humanize !]</b>
<table class="spreadsheet width-auto">
<tbody>
<tr class="ss-header-shade">
<td ng-repeat="column in columns">
<b>[! column|humanize !]</b>
</td>
</tr>
<tr ng-repeat="row in value">
<td ng-repeat="column in columns">
[! row[column] !]
</td>
</tr>
</tbody>
</table>
</div>
<div ng-if-once="!table && isPlainObject(value)"
ng-then="object"
>
<b>[! key|humanize !]</b>
<ul>
<li ng-repeat="(subKey, subValue) in value">
<b>[! subKey|humanize !]: </b>
[! subValue !]
</li>
</ul>
</div>
<div ng-if-once="!table && !object && isList(value)"
ng-then="list"
>
<b>[! key|humanize !]</b>
<ul>
<li ng-repeat="subValue in value">
[! subValue !]
</li>
</ul>
</div>
<div ng-if-once="!table && !object && !list && (m = asMoment(value))"
ng-then="date"
>
<b>[! key|humanize !]:</b>
[! m|datetime !]
</div>
<div ng-else-once="table || object || list || date">
<b>[! key|humanize !]:</b>
[! value !]
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="reports-list-title">
<span ng-if="report.options.presetDateRange"
ng-then="presetDateRange"
ng-init="range = (report.options.presetDateRange|parsePresetDateRange:report.company)"
>
<b> [! report.type === Report.ADVANCED_TYPE ? Report.MODELS[report.options.modelName].name : report.displayType !] </b> for [[ range[0]|dateRange:range[1] ]]
</span>
<span ng-if="!presetDateRange && report.options.startAt && report.options.endAt">
<b> [! report.type === Report.ADVANCED_TYPE ? Report.MODELS[report.options.modelName].name : report.displayType !] </b> for [[ report.options.startAt|dateRange:report.options.endAt ]]
</span>
</script>
<script type="text/ng-template" id="reports-list">
<div class="table activities">
<div ng-repeat="report in reports" class="tr activity [[ report.status ]]"
ng-with="user = report.user; timeStamp = report.modifiedAt; reportPermalink = makePermalink(report);"
>
<div class="td activity-meta" ng-with="">
<span class="activity-admin-only-icon icon-lock respond-print-hide"
ng-if="activity && auth.currentUser.company.isAdmin && Activity.isAdminOnly(activity)"
ng-tip="[! T('This activity is admin-only') !]"
ng-tip-position="right"
></span>
<div class="table valign-top table-dont-respond break-on-print">
<div class="tr">
<div class="td activity-meta-image respond-print-hide" ng-if-once="user.imageCdnUrl">
<a ng-href="[! user.$url(urls.dashboard.settings.permissions.user.index) !]">
<img ng-image="user.imageCdnUrl" ng-image-square="60" class="image-profile-tiny" />
</a>
</div>
<div class="td">
<div class="activity-meta-user" ng-if-once="user">
<a ng-href="[! user.$url(urls.dashboard.settings.permissions.user.index) !]">[! user.name !]</a>
<span class="badge badge-blue" ng-if-once="Company.isAdmin(user.company)"
ng-tip="[! user.name !] is FareHarbor staff"
>FH</span>
</div>
<div class="activity-meta-company respond-print-hide"
ng-if-once="user && !Company.isAdmin(user.company) && user.company !== navigation.currentCompany"
>
[! user.company.name !]
</div>
<div ng-if-once="activity"
ng-activity-flyout
></div>
<div ng-else-once="activity"
ng-interval="60"
title="[[ timeStamp|datetime ]]"
class="activity-meta-date"
>
[[ timeStamp|datetime:'relative':'relative-time' ]]
</div>
</div>
</div>
</div>
</div>
<div class="td activity-content">
<div class="activity-content-inner">
<a ng-if="reportPermalink" ng-href="[[ reportPermalink ]]" ng-then="hasPermalink">
<span ng-inline="reports-list-title"></span>
</a>
<span ng-else="hasPermalink" ng-inline="reports-list-title"></span>
<span ng-if="report.status !== Report.SUCCEEDED_STATUS"
class="fh-grey"
>
<span ng-if="report.isInProgress" ng-then="inProgress">
(Generating  <a ng-advanced-report-cancel ng-click="cancel(report)" class="underline">Cancel</a>)
</span>
<span ng-else="inProgress">
([[ report.status|capitalize ]])
</span>
</span>
</div>
</div>
<a class="td activity-source"
ng-if="reportPermalink"
ng-then="hasPermalink"
ng-href="[[ reportPermalink ]]"
>
&raquo;
</a>
<div class="td activity-source"
ng-else="hasPermalink"
>
</div>
</div>
<div ng-if="!reports.length">
<div class="activities">
<div class="activity-empty">
No recent reports
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.resettableFilter">
<div class="flyout-toggle-header small"
ng-class="{
'invalid': resettableFilterCtrl.isInvalid,
'active': resettableFilterCtrl.isFilterSet(),
'toggled': resettableFilterCtrl.isToggled,
'disabled': resettableFilterCtrl.isRequired
}"
ng-click="resettableFilterCtrl.toggle()"
>
[[ resettableFilterCtrl.name ]]
</div>
<div ng-if="resettableFilterCtrl.isToggled">
<div class="flyout-wrap" ng-transclude></div>
<div class="flyout-wrap" ng-show="resettableFilterCtrl.isFilterSet()">
<a class="fh-grey underline"
ng-click="resettableFilterCtrl.resetFilter()"
>Reset</a>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-select-all">
<span class="select-all">
<span>[[ selectText || T('Select') ]]:</span>
<a ng-click="selectAll()">all</a>,
<a ng-click="selectNone()">none</a>[[ allowDefaults ? ',' : '' ]]
<a ng-if="allowDefaults" ng-click="selectDefaults()">default</a>
</span>
</script>
<script type="text/ng-template" id="ng-hours-before-midnight">
<div class="time-preview">
<span ng-if="hoursBeforeMidnightCtrl.days >= 0" ng-then="beforeDays">
<span ng-if="hoursBeforeMidnightCtrl.days > 0">
[[ interpolate(nT('%(time)s %(count)s day before', '%(time)s %(count)s days before', hoursBeforeMidnightCtrl.days), { time: (hoursBeforeMidnightCtrl.time|time), count: hoursBeforeMidnightCtrl.days }) ]]
</span>
<span ng-if="hoursBeforeMidnightCtrl.days === 0">
[[ hoursBeforeMidnightCtrl.time|time ]] day of
</span>
</span>
<span ng-else="beforeDays">
[[ interpolate(nT('%(time)s %(count)s day after', '%(time)s %(count)s days after', -hoursBeforeMidnightCtrl.days), { time: (hoursBeforeMidnightCtrl.time|time), count: -hoursBeforeMidnightCtrl.days }) ]]
</span>
</div>
</script>
<script type="text/ng-template" id="tableFilter.filter">
<a ng-toggle ng-toggle-value="$id"
class="flyout-toggle-header small [[ addClassIf($tableFilter.isFiltering(), 'active') ]]"
>
[[ $tableFilter.name ]]
</a>
<div ng-toggled ng-toggled-value="$id">
<div ng-table-filter-view></div>
<div class="flyout-wrap" ng-if="$tableFilter.isFiltering()">
<a ng-click="$tableFilter.reset()" class="fh-grey underline">Reset</a>
</div>
</div>
</script>
<script type="text/ng-template" id="tableFilter.filters.string">
<div class="table table-dont-respond flyout-fields-group">
<div class="tr">
<div class="td flyout-fields-title">
Contains:
</div>
<div class="td">
<input type="text" ng-model="$tableFilter.value" ng-autofocus>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="tableFilter.filters.number">
<div class="table table-dont-respond flyout-fields-group">
<div class="tr">
<div class="td flyout-fields-title">
<select ng-options="operation.value as operation.name for operation in $tableFilter.operations"
ng-model="$tableFilter.value.operation"
></select>
</div>
<div class="td">
<input type="text" ng-model="$tableFilter.value.number"
ng-int-input
ng-autofocus
>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="tableFilter.filters.amount">
<div class="table table-dont-respond flyout-fields-group">
<div class="tr">
<div class="td flyout-fields-title">
<select ng-options="operation.value as operation.name for operation in $tableFilter.operations"
ng-model="$tableFilter.value.operation"
></select>
</div>
<div class="td">
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="$tableFilter.value.amount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
ng-autofocus
data-lpignore="true"
>
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="tableFilter.filters.date">
<div class="table table-dont-respond flyout-fields-group">
<div class="tr">
<div class="td flyout-fields-title">
<select ng-options="operation.value as operation.name for operation in $tableFilter.operations"
ng-model="$tableFilter.value.operation"
></select>
</div>
<div class="td">
<input type="text" ng-model="$tableFilter.value.date"
ng-datepicker
ng-datepicker-allow-empty
>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="tableFilter.filters.choices">
<ul class="flyout-checklist flyout-checklist--minimal-top-padding">
<li ng-repeat="choice in $tableFilter.choices">
<label>
<input type="checkbox" ng-model="$tableFilter.value[$tableFilter.choiceValue(choice)]"> [[ $tableFilter.choiceName(choice) ]]
</label>
</li>
</ul>
</script>
<script type="text/ng-template" id="tableFilter.filters.yesno">
<ul ng-radio-flyer="$tableFilter.value" class="flyout-checklist flyout-checklist--minimal-top-padding">
<li>
<label>
<input type="radio" ng-model="$tableFilter.value" ng-value="true">
Yes
</label>
</li>
<li>
<label>
<input type="radio" ng-model="$tableFilter.value" ng-value="false">
No
</label>
</li>
</ul>
</script>
<script type="text/ng-template" id="transportation-lodging-contact">
<div>
<b>[! booking.lodging.name || booking.lodging.hotel.name !]</b>
</div>
<table class="spreadsheet show-links spreadsheet--shade-first-col"
ng-if="
booking.lodging.phone || booking.lodging.hotel.phone ||
booking.lodging.fax || booking.lodging.hotel.fax ||
booking.lodging.address || booking.lodging.hotel.address
"
ng-then="showContactTable"
>
<tbody>
<tr ng-show="booking.lodging.phone || booking.lodging.hotel.phone">
<td><b>Phone</b></td>
<td>[! (booking.lodging.phone || booking.lodging.hotel.phone)|phone !]</td>
</tr>
<tr ng-show="booking.lodging.fax || booking.lodging.hotel.fax">
<td><b>Fax</b></td>
<td>[! (booking.lodging.fax || booking.lodging.hotel.fax)|phone !]</td>
</tr>
<tr ng-show="booking.lodging.address || booking.lodging.hotel.address">
<td><b>Address</b></td>
<td>[! booking.lodging.address || booking.lodging.hotel.address !]</td>
</tr>
<tr ng-show="booking.lodging.url || booking.lodging.hotel.url">
<td><b>URL</b></td>
<td>
<a ng-href="[! booking.lodging.url || booking.lodging.hotel.url !]"
ng-outbound-link="_blank"
>
[! (booking.lodging.url || booking.lodging.hotel.url)|hostname !]
</a>
</td>
</tr>
</tbody>
</table>
<div class="hint"
ng-else="showContactTable"
>
No contact information available
</div>
</script>
<script type="text/ng-template" id="view-deprecated-booking-permalink-pages">
<div ng-controller=
"dashboard.bookings.DeprecatedBookingPermalinkPages"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</script>
<script type="text/ng-template" id="view-deprecated-affiliate-booking-permalink">
<div ng-controller=
"dashboard.bookings.DeprecatedBookingPermalinkPages"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</script>
<script type="text/ng-template" id="view-deprecated-booking-overlay">
<div ng-controller=
"dashboard.bookings.DeprecatedBookingOverlay"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</script>
<script type="text/ng-template" id="view-order">
<div ng-controller=
"dashboard.bookings.ViewOrderCtrl"
ng-body-class="'body-print-overlay'"
ng-scroll-to="top"
ng-scroll-container=".db-theater"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="booking-full-loading fh-grey">
<i class="spinner-ticker-css"><span></span></i> Loading order...
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-title='[[ order.contact.name ]] - [[ interpolate(cT("\"order\" as in sales order", "Order #%(orderId)s"), { orderId: order.identifier }) ]]'
ng-watch="orderTracker.modifiedAt"
>
<div class="booking-full-content">
<div class="clearfix">
<div class="booking-full-actions">
<div class="booking-actions">
<div ng-controller=
"dashboard.bookings.OrderActionsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div
ng-if="actionsCtrl.isSelected(actionsCtrl.NONE)"
ng-body-class="'body-print-booking'"
>
<div class="action-sheet-header respond-print-hide">
<div class="action-sheet-header-content">
<h2>Order actions</h2>
<a ng-href="https://fareharbor.com/help/dashboard/orders/order-actions/"
ng-outbound-link="_blank"
class="hint-help-link"
>Get help with orders &rsaquo;</a>
</div>
</div>
<ul class="buttons-list test-action-buttons">
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.ADD_BOOKING)" ng-then="addButton">
<button type="button"
class="btn-big btn-black btn-wide btn-icon add-booking test-add-booking-to-order-action"
ng-click="plusbook.orderize(order)"
ng-shortcut="'=|shift+n'"
ng-shortcut-click
title="[! T('Shortcut: shift+n') !]"
>
Add new booking to order
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.MOVE_TO_ORDER)" ng-then="moveButton">
<a class="btn-big btn-black btn-wide btn-icon merge-booking"
ng-href="[! contact|contactUrl !]?action=modify&to=[! order.identifier !]"
ng-confirm-click="[! T('You\'ll be taken to the Manage Orders tool under Contact Actions.') !]"
>
Move existing booking to order
</a>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.CANCEL)" ng-then="cancelButton">
<button type="button"
class="btn-big btn-black btn-wide btn-icon cancel test-cancel-action"
ng-click="actionsCtrl.select(actionsCtrl.CANCEL)"
ng-shortcut="'delete|shift+x'"
ng-shortcut-click
title="[! T('Shortcut: shift+x') !]"
>
Cancel bookings
</button>
</li>
<li class="buttons-spacer" ng-if="addButton || moveButton || cancelButton"></li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.ADD_PAYMENT)" ng-then="paymentButton">
<button type="button"
class="btn-big btn-black btn-wide btn-icon add-payment [! order|currencyClass !] test-add-payment-action"
ng-click="actionsCtrl.select(actionsCtrl.ADD_PAYMENT)"
ng-shortcut="'shift+='"
ng-shortcut-click
title="[! T('Shortcut: shift+plus') !]"
>
Add payment
<span class="badge" ng-can-view-amounts="order.company" ng-can-only-when="order.amountDue">
[[ order.amountDue|amount:order ]] Due
</span>
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.REFUND)" ng-then="refundButton">
<button type="button"
class="btn-big btn-black btn-wide btn-icon [! order|currencyClass !] refund test-refund-action"
ng-click="actionsCtrl.select(actionsCtrl.REFUND)"
ng-shortcut="'shift+-'"
ng-shortcut-click
title="[! T('Shortcut: shift+minus') !]"
>
Refund
</button>
</li>
<li class="buttons-spacer" ng-if="paymentButton || refundButton"></li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.NOTIFY_ORDER)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon email"
ng-click="actionsCtrl.select(actionsCtrl.NOTIFY_ORDER)"
>
Send email
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.PRINT_RECEIPT)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon print test-print-receipt-action"
ng-click="actionsCtrl.select(actionsCtrl.PRINT_RECEIPT)"
ng-shortcut="'shift+p'"
ng-shortcut-click
title="[! T('Shortcut: shift+p') !]"
>
Print
</button>
</li>
</ul>
</div>
<div class="action-window">
<div ng-if="actionsCtrl.isSelected(actionsCtrl.NOTIFY_ORDER)">
<div ng-controller=
"dashboard.bookings.OrderNotificationCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
instant
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Sending email...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-show="!submitting">
<form class="form-big-inputs"
name="notificationForm"
ng-confirm-navigate-away
>
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Send email</h2>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="notificationForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="email-form" >
<div class="notificationform-type field-select-full "
ng-django-field="notificationForm [&#39;type&#39;]" ng-django-field-model="data [&#39;type&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select
ng-model="data [&#39;type&#39;]"
ng-prefix=""
ng-options="option.value as option.name for option in notificationTypeOptions"
>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="notificationForm [&#39;type&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in notificationForm [&#39;type&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-emails "
ng-django-field="notificationForm [&#39;emails&#39;]" ng-django-field-model="data [&#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="data [&#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-subject "
ng-django-field="notificationForm [&#39;subject&#39;]" ng-django-field-model="data [&#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="data [&#39;subject&#39;]" ng-placeholder="Email subject" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-note field-textarea
"
ng-django-field="notificationForm [&#39;note&#39;]" ng-django-field-model="data [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".notificationform-note" ng-model="data [&#39;note&#39;]" ng-placeholder="Message (optional)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="notificationForm.all.$error.subject_required">Subject is required</li>
<li ng-if="notificationForm.all.$error.no_eligible_disputes">No eligible disputes.</li>
<li ng-if="notificationForm.all.$error.unauthorized">Only authorized users can send emails</li>
<li ng-repeat="error in notificationForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-disabled="notificationForm.$invalid || notificationForm.$submitting"
ng-click="submit(notificationForm)"
>
Send email
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.ADD_PAYMENT)">
<div ng-controller=
"dashboard.bookings.OrderPaymentsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-show="submitting" ng-link="payment-processing"></div>
<div ng-show="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Add payment to order</h2>
</div>
</div>
<div class="giant-toggle-fluid is-fixed table table-dont-respond valign-middle"
ng-can="createStoredValueCard on Payment with order"
ng-can-only-when="order.company.storedValueCardsCount > 0"
>
<div class="tr">
<div class="td" ng-click="redeem(false)"
ng-class="{ 'toggled': !isRedeeming }"
>
Collect
</div>
<div class="td" ng-click="redeem(true)"
ng-class="{ 'toggled': isRedeeming }"
>
Redeem
</div>
</div>
</div>
<div ng-if="isRedeeming" ng-then="redeeming">
<p class="action-sheet-help">
Pay for this order with a gift card:
</p>
<form name="redeemForm"
ng-confirm-navigate-away
ng-submit="submitRedeem(redeemForm)"
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="redeemForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="labels-above">
<div ng-stored-value-card-search
ng-model="newOrderPayments.storedValueCardNumber"
>
<div class="redeemform-storedvaluecardnumber "
ng-django-field="redeemForm [&#39;storedValueCardNumber&#39;]" ng-django-field-model="newOrderPayments [&#39;storedValueCardNumber&#39;]"
>
<label >
<span class="label-text">
Gift card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_stored_value_card_number" name="storedValueCardNumber" ng-autofocus="true" ng-model="newOrderPayments [&#39;storedValueCardNumber&#39;]" ng-pattern="/^[a-zA-Z0-9\-_\#\%$]+$/" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;storedValueCardNumber&#39;].$error['pattern']">Invalid value</li>
<li ng-repeat="error in redeemForm [&#39;storedValueCardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-if="redeemCtrl.status === 'not-found'"
class="fh-red"
>
Card not found
</div>
<div ng-if="redeemCtrl.status === 'loading'"
class="fh-grey"
>
Loading...
</div>
<div class="chunky-error light-orange" ng-if="redeemCtrl.storedValueCard.pendingBalance < 0">
<div class="chunky-error-inner">
Gift card has pending bookings affecting remaining balance by [[ redeemCtrl.storedValueCard.pendingBalance|amount:company ]]
</div>
</div>
<table ng-if="redeemCtrl.status === 'success' && redeemCtrl.storedValueCard"
class="portion-calculator-table redeem-amount-table"
>
<tr>
<td>Card balance:</td>
<td>
<b>[[ redeemCtrl.storedValueCard.balance|amount:redeemCtrl.storedValueCard ]]</b>
<a ng-href="[! redeemCtrl.storedValueCard.$url(urls.dashboard.settings.storedValue.storedValueCard.index) !]"
ng-can-view="redeemCtrl.storedValueCard"
class="fh-blue underline"
>(Details)</a>
</td>
</tr>
<tr ng-if="redeemCtrl.storedValueCard.balance > 0">
<td>Amount to use:</td>
<td ng-can="createPartial on Payment with company" ng-then="canCreatePartial">
<div class="redeemform-gross field-partial-payment-gross
field-amount
"
ng-django-field="redeemForm [&#39;gross&#39;]" ng-django-field-model="redeemCtrl [&#39;gross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-max="redeemCtrl.max()" ng-amount-input-min="redeemCtrl.min()" ng-amount-input-positive="true" ng-autofocus="true" ng-autofocus-select="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="redeemCtrl [&#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="redeemForm [&#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in redeemForm [&#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
<td ng-else="canCreatePartial">
Pay in full ([[ redeemCtrl.amountDue()|amount:company ]])
</td>
</tr>
</table>
<div ng-can-create="Notification on company">
<div class="redeemform-sendnotification field-cb-email "
ng-django-field="redeemForm [&#39;sendNotification&#39;]" ng-django-field-model="newOrderPayments [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="newOrderPayments [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Email receipt
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="newOrderPayments.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="redeemform-notification-emails "
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-notification-subject "
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-notification-note field-textarea
"
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".redeemform-notification-note" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div class="redeemform-processortype "
ng-django-field="redeemForm [&#39;processorType&#39;]" ng-django-field-model="newOrderPayments [&#39;processorType&#39;]"
>
<label >
<span class="label-text">
Processor type
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_processor_type" name="processorType" ng-model="newOrderPayments [&#39;processorType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;processorType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;processorType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-isdemo "
ng-django-field="redeemForm [&#39;isDemo&#39;]" ng-django-field-model="newOrderPayments [&#39;isDemo&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_demo" name="isDemo" ng-model="newOrderPayments [&#39;isDemo&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;isDemo&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-cardtype "
ng-django-field="redeemForm [&#39;cardType&#39;]" ng-django-field-model="newOrderPayments [&#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="newOrderPayments [&#39;cardType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-cardlast4 "
ng-django-field="redeemForm [&#39;cardLast4&#39;]" ng-django-field-model="newOrderPayments [&#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="newOrderPayments [&#39;cardLast4&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripetoken "
ng-django-field="redeemForm [&#39;stripeToken&#39;]" ng-django-field-model="newOrderPayments [&#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="newOrderPayments [&#39;stripeToken&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripechargeid "
ng-django-field="redeemForm [&#39;stripeChargeId&#39;]" ng-django-field-model="newOrderPayments [&#39;stripeChargeId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_charge_id" name="stripeChargeId" ng-model="newOrderPayments [&#39;stripeChargeId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeChargeId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripepaymentintentid "
ng-django-field="redeemForm [&#39;stripePaymentIntentId&#39;]" ng-django-field-model="newOrderPayments [&#39;stripePaymentIntentId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_payment_intent_id" name="stripePaymentIntentId" ng-model="newOrderPayments [&#39;stripePaymentIntentId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripePaymentIntentId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripesetupintentid "
ng-django-field="redeemForm [&#39;stripeSetupIntentId&#39;]" ng-django-field-model="newOrderPayments [&#39;stripeSetupIntentId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_setup_intent_id" name="stripeSetupIntentId" ng-model="newOrderPayments [&#39;stripeSetupIntentId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeSetupIntentId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-tokenizationtype "
ng-django-field="redeemForm [&#39;tokenizationType&#39;]" ng-django-field-model="newOrderPayments [&#39;tokenizationType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_tokenization_type" name="tokenizationType" ng-model="newOrderPayments [&#39;tokenizationType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;tokenizationType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;tokenizationType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="redeemForm.all.$error.invalid_emv_provider">Payment device provider not recognized. Please contact FareHarbor Support.</li>
<li ng-if="redeemForm.all.$error.tokenization_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.booking_affiliation_required">An affiliate must be selected.</li>
<li ng-if="redeemForm.all.$error.is_demo_does_not_match">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.stored_value_card_not_found">Gift card not found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.ideal_not_enabled">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_affiliate_payments">Cannot create affiliate payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_stored_value_card_payments">Sorry, your account is not authorized to redeem gift cards.</li>
<li ng-if="redeemForm.all.$error.cannot_add_payment_to_demo_booking">Demo mode must be enabled to add payments to demo bookings.</li>
<li ng-if="redeemForm.all.$error.missing_in_store_payment_note">&#39;%(payment_note)s&#39; cannot be empty. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.card_not_found">Card not found.</li>
<li ng-if="redeemForm.all.$error.stripe_ideal_bank_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.charge_amount_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-HIGH)</li>
<li ng-if="redeemForm.all.$error.booking_fee_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-LOW)</li>
<li ng-if="redeemForm.all.$error.gross_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-LOW)</li>
<li ng-if="redeemForm.all.$error.cannot_create_demo_card_on_file_payment">Cannot create a payment for a saved card when demo mode is enabled.</li>
<li ng-if="redeemForm.all.$error.invalid_processor_type">Outdated payment processor. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.non_affiliate_collected_by_affiliate">Only payments collected by affiliates may be marked as such. Please contact FareHarbor Support. (A-2)</li>
<li ng-if="redeemForm.all.$error.booking_fee_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-HIGH)</li>
<li ng-if="redeemForm.all.$error.invalid_option">Invalid payment option. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.ideal_option_requires_pending_bookings">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cardholders_name_not_specified">Payment could not be processed. Cardholder's name is required.</li>
<li ng-if="redeemForm.all.$error.cant_create_credit_card_payment">Cannot create credit card payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.affiliate_not_collected_by_affiliate">Payments collected by affiliates must be marked as such. Please contact FareHarbor Support. (A-1)</li>
<li ng-if="redeemForm.all.$error.cant_skip_payment">Cannot skip payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.unauthorized_card_access">Unable to use card for payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_valid">Cannot create in-store payment, selection not valid. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.country_code_not_specified">Payment could not be processed. Billing country is required. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_in_store_payments">Cannot create in-store payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.charge_amount_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.cannot_add_payment_to_non_demo_booking">Demo mode must be disabled to add payments to non-demo bookings.</li>
<li ng-if="redeemForm.all.$error.no_relevant_bookings">Cannot create payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cannot_create_demo_ideal_payment">Cannot pay with iDEAL when demo mode is enabled.</li>
<li ng-if="redeemForm.all.$error.gross_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-HIGH)</li>
<li ng-if="redeemForm.all.$error.booking_fee_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.cant_defer_payment">Cannot save card. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.invalid_processor">No processor found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_found">Cannot create in-store payment, type not found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.gross_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.charge_amount_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-LOW)</li>
<li ng-if="redeemForm.all.$error.booking_rebooked">This booking has been rebooked. Please refresh the page.</li>
<li ng-if="redeemForm.all.$error.cant_charge_card">Cannot charge that card. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.postal_code_not_specified">Payment could not be processed. Billing postal (zip) code is required. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_authorized">Sorry, you are not authorized to create in-store payments. Please refresh the page and try again.</li>
<li ng-repeat="error in redeemForm.all.$error.$server">[[ error ]]</li>
</ul>
<div class="form-error" ng-if="redeemCtrl.isBalanceInsufficientDueToPermissions()">
You don&#039;t have permission to redeem an amount that is less than the amount due.
</div>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-disabled="redeemForm.$invalid || redeemForm.$submitting || !redeemCtrl.isValid()"
>
Redeem Gift Card
</button>
</div>
</form>
</div>
<div ng-else="redeeming">
<form name="orderPaymentsForm"
ng-confirm-navigate-away
ng-submit="submit(orderPaymentsForm)"
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="orderPaymentsForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div ng-if="!paymentCtrl.isAnonymous">
<div class="orderpaymentsform-payment-kind "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;kind&#39;]"
ng-django-field-required=""
>
<ul ng-radio-flyer
class="field-radio-group field-radio-group--large"
>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.PARTIAL_KIND)"
class="test-payment-kind-partial-action"
>
<label class="has-child">
<input type="radio" name="kind"
ng-value="paymentCtrl.PARTIAL_KIND"
ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payment'" ng-required="required"
>
[[ paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND ? T('Partial payment:') : T('Partial payment') ]]
</label>
</li>
<li ng-if="paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND">
<div class="radio-content">
<ul class="order-partial-payments"
ng-autofocus ng-autofocus-select
>
<li ng-repeat="booking in order.contributingBookings" ng-if="booking.amountDue > 0">
<div class="fields "
>
<div class="table table-dont-respond full-width valign-middle">
<div class="tr">
<div class="td">
<ul>
<li><b ng-amount="booking.amountDue" ng-click="maxPaymentsForBooking(booking)" class="fh-red"></b> &mdash; #[! booking.pk !]</li>
<li class="fh-grey text-small">[! booking.availability.item|name !] &bull; [! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !] &bull; [! booking.customerBreakdownShort !]</li>
</ul>
</div>
<div class="td text-right">
<div class="orderpaymentsform-order-payment-for-booking-bookingpk-gross
field-amount
"
ng-django-field="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;]" ng-django-field-model="newOrderPayments [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-default="paymentCtrl.defaultOrderBookingGross(booking)" ng-amount-input-max="booking.amountDue" ng-amount-input-min="paymentCtrl.orderAmountMin()" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="newOrderPayments [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'order-payment-for-booking-' + booking.pk" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="orderpaymentsform-order-payment-for-booking-bookingpk-amountdue "
ng-django-field="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;]" ng-django-field-model="newOrderPayments [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount_due" max="999999.99" min="0" name="amountDue" ng-amount-input="true" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="newOrderPayments [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'order-payment-for-booking-' + booking.pk" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;].$error['pattern']">Invalid value</li>
<li ng-if="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
<li class="text-right">
<b>[[ paymentCtrl.amount()|amount: order ]]</b>
</li>
</ul>
</div>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.FULL_KIND)"
class="test-payment-kind-full-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.FULL_KIND"
ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payment'" ng-required="required"
>
[[ paymentCtrl.isDefaultAmountInvoicePrice() ? T('Invoice amount') : T('Pay in full') ]]
</label>
</li>
<li ng-if="!paymentCtrl.isAnyKindValid()"
class="form-error"
>
<b>No available payment options.</b> Please contact your administrator.
</li>
</ul>
</div>
<div ng-if="paymentCtrl.affiliation() && paymentCtrl.needsPayment()">
<div class="orderpaymentsform-payment-iscollectedbyaffiliate "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]"
>
<div class="affiliate-form-header">Collected By</div>
<ul ng-radio-flyer
class="test-payment-collected-by-field-indicator field field-radio-group field-radio-group--large"
>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(false)"
class="test-collected-by-affiliate-false-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="false"
ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>[[ paymentCtrl.company|name ]]</b>
</span>
</label>
</li>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(true)"
class="test-collected-by-affiliate-true-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="true"
ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>[[ paymentCtrl.affiliation().affiliateCompany|name ]]</b>
</span>
</label>
</li>
</ul>
</div>
</div>
<div ng-if="paymentCtrl.needsPayment() && !paymentCtrl.isCollectedByAffiliate()">
<div class="orderpaymentsform-optionandextras "
ng-django-field="orderPaymentsForm [&#39;optionAndExtras&#39;]" ng-django-field-model="paymentCtrl [&#39;optionAndExtras&#39;]"
>
<div class="affiliate-form-header">Payment Type</div>
<ul ng-radio-flyer
class="field-radio-group field-radio-group--large
"
>
<li class="field-radio-inline-header fh-green">
Pay [[ paymentCtrl.amount()|amount:order ]] with:
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IN_STORE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.inStorePaymentTypes"
class="test-payment-action-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="orderpaymentsform-payment-instorepaymentnote "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.AFFILIATE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.affiliateInStorePaymentTypes"
class="test-payment-action-affiliate-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="orderpaymentsform-payment-instorepaymentnote "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.FILE_OPTION)" ng-repeat="payment in paymentCtrl.cardPayments"
class="test-payment-action-file field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="payment"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge <b>[[ payment.displayProcessorBasedType ]]</b> <b>[[ payment.processorBasedIdentifier ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CARD_ON_FILE_OPTION)" ng-repeat="cardOnFile in paymentCtrl.cardsOnFile"
class="test-payment-action-card-on-file field-radio-icon--cc"
>
<label class="[! addClassIf(paymentCtrl.company.isDemoModeEnabled, 'is-disabled') !]">
<input type="radio" name=""
ng-value="cardOnFile"
ng-disabled="paymentCtrl.company.isDemoModeEnabled"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge company card <b>[[ cardOnFile.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CHARGE_OPTION)"
class="test-payment-action-charge field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.CHARGE_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge card
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.EMV_OPTION)"
class="test-payment-action-emv field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.EMV_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge with <b>[[ emv.currentDevice.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IDEAL_OPTION)"
class="test-payment-action-ideal"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.IDEAL_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
iDEAL
<i ng-svg="svg-ideal"></i>
</label>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.SOFORT_OPTION)"
class="test-payment-action-sofort"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.SOFORT_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Sofort
<i ng-svg="svg-sofort"></i>
</label>
</li>
<li ng-if="!paymentCtrl.isAnyOptionValid()">
No valid payment options
</li>
</ul>
</div>
</div>
</div>
<div ng-if="paymentCtrl.needsCharge()">
<div class="form-error" ng-if="paymentCtrl.isAmountTooLow()">
<span ng-if="!auth.currentUser.isAuthenticated" ng-then="isAnonUser">
Sorry, payment cannot be taken at this time.
<a href="https://fareharbor.com/help/submit/">Please contact FareHarbor.</a>
(Error code LH-[! Payment.MIN_CHARGE_AMOUNT !].)
</span>
<span ng-else="isAnonUser">
<span ng-if="paymentCtrl.needsCharge()" ng-then="chargeTooLow">
Sorry, cards cannot be charged for amounts less than [! Payment.MIN_CHARGE_AMOUNT|amount:order !].
</span>
<span ng-else="chargeTooLow">
Sorry, payments cannot be created for [! 0|amount:order !].
</span>
</span>
</div>
</div>
<div ng-if="paymentCtrl.needsCardFields() && !paymentCtrl.isAmountTooLow()">
<div class="card-fields card-type-[[ paymentCtrl.cardTypeAbbreviation() ]]"
ng-class="{ 'test-cards-only': paymentCtrl.company.isDemoModeEnabled }"
>
<div class="card-fields-inner">
<div ng-if="paymentCtrl.company.isDemoModeEnabled" ng-then="demoCardForm"
class="card-fields-demo"
>
Demo mode
<i class="help-icon"
ng-tip="[! T('You can only use test credit card numbers while demo mode is on') !]"
></i>
</div>
<div ng-else="demoCardForm"
class="card-fields-secure"
>
<i class="icon-lock-green"></i> Secure and encrypted
<i class="icon-hint"
ng-hide="auth.currentUser.isAuthenticated"
ng-tip="[! interpolate(T('%(companyName)s will only be able to see the last 4 digits of your card number'), { companyName: paymentCtrl.company.name }) !]"
ng-tip-classes="tip-indent"
ng-tip-touch="true"
></i>
</div>
<div class="native-swiped-container"
ng-if="paymentCtrl.swiped && native.isNative"
ng-then="nativeSwiped"
>
<div>
<span class="badge badge-green">Swiped successfully</span>
</div>
<span class="card-number">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardLast4() ]]"
ng-model="newOrderPayments"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</span>
<div class="card-name">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardholdersName() ]]"
ng-model="newOrderPayments"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<a ng-click="paymentCtrl.stopSwiping()" class="btn btn-grey">
Enter different card
</a>
</div>
<div ng-else="nativeSwiped">
<span class="card-type-logo"></span>
<span class="card-number" ng-if-once="clientOptions.isKioskModeEnabled" ng-then="kioskMode">
<div class="orderpaymentsform-payment-cardnumber hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payment'" ng-required="true" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span class="card-number" ng-else-once="kioskMode">
<div class="orderpaymentsform-payment-cardnumber hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payment'" ng-required="true" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="card-name">
<span ng-if-once="kioskMode">
<div class="orderpaymentsform-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderpaymentsform-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Cardholder\'s name must match the name printed on the card') !]"
ng-tip-touch="true"
></div>
</div>
<div class="card-expiry">
<div class="card-form-header">Expiration date</div>
<div class="exp-month">
<div class="orderpaymentsform-payment-cardexpirymonth
pseudo-select
"
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName()" ng-then="hasValuecardMonth">
[[ KioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName() ]]
</span>
<span ng-else="hasValuecardMonth" class="exp-placeholder">
Month
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_month" name="cardExpiryMonth" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-prefix="'payment'" required="required">
<option value="1">01 - January</option>
<option value="2">02 - February</option>
<option value="3">03 - March</option>
<option value="4">04 - April</option>
<option value="5">05 - May</option>
<option value="6">06 - June</option>
<option value="7">07 - July</option>
<option value="8">08 - August</option>
<option value="9">09 - September</option>
<option value="10">10 - October</option>
<option value="11">11 - November</option>
<option value="12">12 - December</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="exp-year">
<div class="orderpaymentsform-payment-cardexpiryyear
pseudo-select
"
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year()" ng-then="hasValuecardYear">
[[ KioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year() ]]
</span>
<span ng-else="hasValuecardYear" class="exp-placeholder">
Year
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_year" name="cardExpiryYear" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-prefix="'payment'" required="required">
<option value="2019">2019</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
<option value="2028">2028</option>
<option value="2029">2029</option>
<option value="2030">2030</option>
<option value="2031">2031</option>
<option value="2032">2032</option>
<option value="2033">2033</option>
<option value="2034">2034</option>
<option value="2035">2035</option>
<option value="2036">2036</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="card-country-code">
<div class="orderpaymentsform-payment-countrycode field-select-full "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
>
<label >
<span class="label-text">
Country/Region
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_country_code" name="countryCode" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-prefix="'payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]">
<option value="" selected="selected"></option>
<option value="US">USA</option>
<option value="AF">Afghanistan</option>
<option value="AL">Albania</option>
<option value="DZ">Algeria</option>
<option value="AS">American Samoa</option>
<option value="AD">Andorra</option>
<option value="AO">Angola</option>
<option value="AI">Anguilla</option>
<option value="AQ">Antarctica</option>
<option value="AG">Antigua & Barbuda</option>
<option value="AR">Argentina</option>
<option value="AM">Armenia</option>
<option value="AW">Aruba</option>
<option value="AU">Australia</option>
<option value="AT">Austria</option>
<option value="AZ">Azerbaijan</option>
<option value="BS">Bahama</option>
<option value="BH">Bahrain</option>
<option value="BD">Bangladesh</option>
<option value="BB">Barbados</option>
<option value="BY">Belarus</option>
<option value="BE">Belgium</option>
<option value="BZ">Belize</option>
<option value="BJ">Benin</option>
<option value="BM">Bermuda</option>
<option value="BT">Bhutan</option>
<option value="BO">Bolivia</option>
<option value="BA">Bosnia and Herzegovina</option>
<option value="BW">Botswana</option>
<option value="BV">Bouvet Island</option>
<option value="BR">Brazil</option>
<option value="IO">British Indian Ocean Territory</option>
<option value="VG">British Virgin Islands</option>
<option value="BN">Brunei Darussalam</option>
<option value="BG">Bulgaria</option>
<option value="BF">Burkina Faso</option>
<option value="BI">Burundi</option>
<option value="KH">Cambodia</option>
<option value="CM">Cameroon</option>
<option value="CA">Canada</option>
<option value="CV">Cape Verde</option>
<option value="KY">Cayman Islands</option>
<option value="CF">Central African Republic</option>
<option value="TD">Chad</option>
<option value="CL">Chile</option>
<option value="CN">China</option>
<option value="CX">Christmas Island</option>
<option value="CC">Cocos (Keeling) Islands</option>
<option value="CO">Colombia</option>
<option value="KM">Comoros</option>
<option value="CG">Congo</option>
<option value="CK">Cook Iislands</option>
<option value="CR">Costa Rica</option>
<option value="HR">Croatia</option>
<option value="CU">Cuba</option>
<option value="CY">Cyprus</option>
<option value="CZ">Czech Republic</option>
<option value="DK">Denmark</option>
<option value="DJ">Djibouti</option>
<option value="DM">Dominica</option>
<option value="DO">Dominican Republic</option>
<option value="TP">East Timor</option>
<option value="EC">Ecuador</option>
<option value="EG">Egypt</option>
<option value="SV">El Salvador</option>
<option value="GQ">Equatorial Guinea</option>
<option value="ER">Eritrea</option>
<option value="EE">Estonia</option>
<option value="ET">Ethiopia</option>
<option value="FK">Falkland Islands (Malvinas)</option>
<option value="FO">Faroe Islands</option>
<option value="FJ">Fiji</option>
<option value="FI">Finland</option>
<option value="FR">France</option>
<option value="FX">France, Metropolitan</option>
<option value="GF">French Guiana</option>
<option value="PF">French Polynesia</option>
<option value="TF">French Southern Territories</option>
<option value="GA">Gabon</option>
<option value="GM">Gambia</option>
<option value="GE">Georgia</option>
<option value="DE">Germany</option>
<option value="GH">Ghana</option>
<option value="GI">Gibraltar</option>
<option value="GR">Greece</option>
<option value="GL">Greenland</option>
<option value="GD">Grenada</option>
<option value="GP">Guadeloupe</option>
<option value="GU">Guam</option>
<option value="GT">Guatemala</option>
<option value="GN">Guinea</option>
<option value="GW">Guinea-Bissau</option>
<option value="GY">Guyana</option>
<option value="HT">Haiti</option>
<option value="HM">Heard & McDonald Islands</option>
<option value="HN">Honduras</option>
<option value="HK">Hong Kong</option>
<option value="HU">Hungary</option>
<option value="IS">Iceland</option>
<option value="IN">India</option>
<option value="ID">Indonesia</option>
<option value="IQ">Iraq</option>
<option value="IE">Ireland</option>
<option value="IR">Islamic Republic of Iran</option>
<option value="IL">Israel</option>
<option value="IT">Italy</option>
<option value="CI">Ivory Coast</option>
<option value="JM">Jamaica</option>
<option value="JP">Japan</option>
<option value="JO">Jordan</option>
<option value="KZ">Kazakhstan</option>
<option value="KE">Kenya</option>
<option value="KI">Kiribati</option>
<option value="KP">Korea, Democratic People's Republic of</option>
<option value="KR">Korea, Republic of</option>
<option value="KW">Kuwait</option>
<option value="KG">Kyrgyzstan</option>
<option value="LA">Lao People's Democratic Republic</option>
<option value="LV">Latvia</option>
<option value="LB">Lebanon</option>
<option value="LS">Lesotho</option>
<option value="LR">Liberia</option>
<option value="LY">Libyan Arab Jamahiriya</option>
<option value="LI">Liechtenstein</option>
<option value="LT">Lithuania</option>
<option value="LU">Luxembourg</option>
<option value="MO">Macau</option>
<option value="MG">Madagascar</option>
<option value="MW">Malawi</option>
<option value="MY">Malaysia</option>
<option value="MV">Maldives</option>
<option value="ML">Mali</option>
<option value="MT">Malta</option>
<option value="MH">Marshall Islands</option>
<option value="MQ">Martinique</option>
<option value="MR">Mauritania</option>
<option value="MU">Mauritius</option>
<option value="YT">Mayotte</option>
<option value="MX">Mexico</option>
<option value="FM">Micronesia</option>
<option value="MD">Moldova, Republic of</option>
<option value="MC">Monaco</option>
<option value="MN">Mongolia</option>
<option value="MS">Monserrat</option>
<option value="MA">Morocco</option>
<option value="MZ">Mozambique</option>
<option value="MM">Myanmar</option>
<option value="NA">Namibia</option>
<option value="NR">Nauru</option>
<option value="NP">Nepal</option>
<option value="NL">Netherlands</option>
<option value="AN">Netherlands Antilles</option>
<option value="NC">New Caledonia</option>
<option value="NZ">New Zealand</option>
<option value="NI">Nicaragua</option>
<option value="NE">Niger</option>
<option value="NG">Nigeria</option>
<option value="NU">Niue</option>
<option value="NF">Norfolk Island</option>
<option value="MP">Northern Mariana Islands</option>
<option value="NO">Norway</option>
<option value="OM">Oman</option>
<option value="PK">Pakistan</option>
<option value="PW">Palau</option>
<option value="PA">Panama</option>
<option value="PG">Papua New Guinea</option>
<option value="PY">Paraguay</option>
<option value="PE">Peru</option>
<option value="PH">Philippines</option>
<option value="PN">Pitcairn</option>
<option value="PL">Poland</option>
<option value="PT">Portugal</option>
<option value="PR">Puerto Rico</option>
<option value="QA">Qatar</option>
<option value="RE">Reunion</option>
<option value="RO">Romania</option>
<option value="RU">Russian Federation</option>
<option value="RW">Rwanda</option>
<option value="LC">Saint Lucia</option>
<option value="WS">Samoa</option>
<option value="SM">San Marino</option>
<option value="ST">Sao Tome & Principe</option>
<option value="SA">Saudi Arabia</option>
<option value="SN">Senegal</option>
<option value="RS">Serbia</option>
<option value="SC">Seychelles</option>
<option value="SL">Sierra Leone</option>
<option value="SG">Singapore</option>
<option value="SK">Slovakia</option>
<option value="SI">Slovenia</option>
<option value="SB">Solomon Islands</option>
<option value="SO">Somalia</option>
<option value="ZA">South Africa</option>
<option value="GS">South Georgia and the South Sandwich Islands</option>
<option value="ES">Spain</option>
<option value="LK">Sri Lanka</option>
<option value="SH">St. Helena</option>
<option value="KN">St. Kitts and Nevis</option>
<option value="PM">St. Pierre & Miquelon</option>
<option value="VC">St. Vincent & the Grenadines</option>
<option value="SD">Sudan</option>
<option value="SR">Suriname</option>
<option value="SJ">Svalbard & Jan Mayen Islands</option>
<option value="SZ">Swaziland</option>
<option value="SE">Sweden</option>
<option value="CH">Switzerland</option>
<option value="SY">Syrian Arab Republic</option>
<option value="TW">Taiwan</option>
<option value="TJ">Tajikistan</option>
<option value="TZ">Tanzania, United Republic of</option>
<option value="TH">Thailand</option>
<option value="TG">Togo</option>
<option value="TK">Tokelau</option>
<option value="TO">Tonga</option>
<option value="TT">Trinidad & Tobago</option>
<option value="TN">Tunisia</option>
<option value="TR">Turkey</option>
<option value="TM">Turkmenistan</option>
<option value="TC">Turks & Caicos Islands</option>
<option value="TV">Tuvalu</option>
<option value="UG">Uganda</option>
<option value="UA">Ukraine</option>
<option value="AE">United Arab Emirates</option>
<option value="GB">United Kingdom (Great Britain)</option>
<option value="UM">United States Minor Outlying Islands</option>
<option value="VI">United States Virgin Islands</option>
<option value="US">USA</option>
<option value="ZZ">Unknown or unspecified country</option>
<option value="UY">Uruguay</option>
<option value="UZ">Uzbekistan</option>
<option value="VU">Vanuatu</option>
<option value="VA">Vatican City State (Holy See)</option>
<option value="VE">Venezuela</option>
<option value="VN">Viet Nam</option>
<option value="WF">Wallis & Futuna Islands</option>
<option value="EH">Western Sahara</option>
<option value="YE">Yemen</option>
<option value="YU">Yugoslavia</option>
<option value="ZR">Zaire</option>
<option value="ZM">Zambia</option>
<option value="ZW">Zimbabwe</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="card-cvc-postal">
<div class="card-cvc"
ng-shortcut="'shift+alt+c'"
ng-shortcut-action="auth.permissions.can('createWithoutCVC', Payment, paymentCtrl.company) && paymentCtrl.overrideCvc()"
>
<span ng-if-once="kioskMode">
<div class="orderpaymentsform-payment-cardcvc hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderpaymentsform-payment-cardcvc hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="<span class='cvc-icon'></span> [! T('Your card\'s three or four digit verification number, usually on the back') !]"
ng-tip-classes="tip-text-left"
ng-tip-touch="true"
></div>
</div>
<div class="card-postal"
ng-if="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;] && Payment.needsPostalCode(newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;])"
>
<span ng-if-once="kioskMode">
<div class="orderpaymentsform-payment-postalcode field-location-icon hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderpaymentsform-payment-postalcode field-location-icon hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Please enter your billing postal code (zip code) for verification') !]"
ng-tip-touch="true"
></div>
</div>
</div>
</div>
<a class="card-swipe"
ng-click="paymentCtrl.startSwiping()"
ng-if="paymentCtrl.showingSwipe && !paymentCtrl.cardTypeAbbreviation()"
ng-tip="[! T('Swipe card') !]"
ng-tip-classes="tip-indent"
>
Swipe card
</a>
<div class="swiping" ng-if="paymentCtrl.swiping">
<input class="swipe-input" type="text" ng-swipe="paymentCtrl.swipeComplete" />
<div class="swiping-inner">
<div><img ng-src="//dp58aslhmbcib.cloudfront.net/static/images/card-swipe.gif?99774cb15b0528a7a2caeeb2a01921cc3e14532e" /></div>
Ready to swipe card...
</div>
</div>
</div>
<div class="amex-note"
ng-if="auth.currentUser.isAuthenticated && !newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
>
<b>Note:</b> It is strongly recommended that you enter the country for American Express cards, or the charge will fail.
</div>
<div ng-if="!company.isDemoModeEnabled"
ng-link="payment-setup-nag"
ng-init="isShort = true"
></div>
</div>
</div>
<div ng-if="!paymentCtrl.isAnonymous && paymentCtrl.isAnyKindValid() && paymentCtrl.kind() !== paymentCtrl.SKIP_KIND"
class="payment-comment"
>
<a ng-toggle="paymentComment" class="form-link-subtle hide-when-toggled">Add comment to payment</a>
<div ng-toggled="paymentComment">
<div class="orderpaymentsform-payment-note "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Payment comment (not visible to customer)" ng-prefix="'payment'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-can-create="Notification on company">
<div class="orderpaymentsform-sendnotification field-cb-email "
ng-django-field="orderPaymentsForm [&#39;sendNotification&#39;]" ng-django-field-model="newOrderPayments [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="newOrderPayments [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Email receipt
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="newOrderPayments.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="orderpaymentsform-notification-emails "
ng-django-field="orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderpaymentsform-notification-subject "
ng-django-field="orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderpaymentsform-notification-note field-textarea
"
ng-django-field="orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".orderpaymentsform-notification-note" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div ng-if="paymentCtrl.needsCardFields()">
<div class="orderpaymentsform-payment-stripetoken "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-prefix="'payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderpaymentsform-payment-cardlast4 "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-prefix="'payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderpaymentsform-payment-cardtype "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-prefix="'payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="orderPaymentsForm.all.$error.invalid_emv_provider">Payment device provider not recognized. Please contact FareHarbor Support.</li>
<li ng-if="orderPaymentsForm.all.$error.tokenization_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.booking_affiliation_required">An affiliate must be selected.</li>
<li ng-if="orderPaymentsForm.all.$error.is_demo_does_not_match">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.stored_value_card_not_found">Gift card not found. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.ideal_not_enabled">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_create_affiliate_payments">Cannot create affiliate payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_create_stored_value_card_payments">Sorry, your account is not authorized to redeem gift cards.</li>
<li ng-if="orderPaymentsForm.all.$error.cannot_add_payment_to_demo_booking">Demo mode must be enabled to add payments to demo bookings.</li>
<li ng-if="orderPaymentsForm.all.$error.missing_in_store_payment_note">&#39;%(payment_note)s&#39; cannot be empty. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.card_not_found">Card not found.</li>
<li ng-if="orderPaymentsForm.all.$error.stripe_ideal_bank_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.charge_amount_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-HIGH)</li>
<li ng-if="orderPaymentsForm.all.$error.booking_fee_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-LOW)</li>
<li ng-if="orderPaymentsForm.all.$error.gross_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-LOW)</li>
<li ng-if="orderPaymentsForm.all.$error.cannot_create_demo_card_on_file_payment">Cannot create a payment for a saved card when demo mode is enabled.</li>
<li ng-if="orderPaymentsForm.all.$error.invalid_processor_type">Outdated payment processor. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.non_affiliate_collected_by_affiliate">Only payments collected by affiliates may be marked as such. Please contact FareHarbor Support. (A-2)</li>
<li ng-if="orderPaymentsForm.all.$error.booking_fee_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-HIGH)</li>
<li ng-if="orderPaymentsForm.all.$error.invalid_option">Invalid payment option. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.ideal_option_requires_pending_bookings">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cardholders_name_not_specified">Payment could not be processed. Cardholder's name is required.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_create_credit_card_payment">Cannot create credit card payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.affiliate_not_collected_by_affiliate">Payments collected by affiliates must be marked as such. Please contact FareHarbor Support. (A-1)</li>
<li ng-if="orderPaymentsForm.all.$error.cant_skip_payment">Cannot skip payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.unauthorized_card_access">Unable to use card for payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.in_store_payment_type_not_valid">Cannot create in-store payment, selection not valid. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.country_code_not_specified">Payment could not be processed. Billing country is required. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_create_in_store_payments">Cannot create in-store payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.charge_amount_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-UNSPECIFIED)</li>
<li ng-if="orderPaymentsForm.all.$error.cannot_add_payment_to_non_demo_booking">Demo mode must be disabled to add payments to non-demo bookings.</li>
<li ng-if="orderPaymentsForm.all.$error.no_relevant_bookings">Cannot create payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cannot_create_demo_ideal_payment">Cannot pay with iDEAL when demo mode is enabled.</li>
<li ng-if="orderPaymentsForm.all.$error.gross_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-HIGH)</li>
<li ng-if="orderPaymentsForm.all.$error.booking_fee_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-UNSPECIFIED)</li>
<li ng-if="orderPaymentsForm.all.$error.cant_defer_payment">Cannot save card. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.invalid_processor">No processor found. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.in_store_payment_type_not_found">Cannot create in-store payment, type not found. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.gross_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-UNSPECIFIED)</li>
<li ng-if="orderPaymentsForm.all.$error.charge_amount_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-LOW)</li>
<li ng-if="orderPaymentsForm.all.$error.booking_rebooked">This booking has been rebooked. Please refresh the page.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_charge_card">Cannot charge that card. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.postal_code_not_specified">Payment could not be processed. Billing postal (zip) code is required. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.in_store_payment_type_not_authorized">Sorry, you are not authorized to create in-store payments. Please refresh the page and try again.</li>
<li ng-repeat="error in orderPaymentsForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="orderPaymentsForm.all.$error.$tokenization">
<li ng-repeat="error in orderPaymentsForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
<div ng-if="(emv.isDebugging || orderPaymentsForm.all.$error.$providerDeclined) && emv.lastDecline()">
<ul class="errors test-provider-error-indicator respond-print-hide">
<li>
Authorization for this charge was declined.
<div>
<a ng-toggle="printDecline">Print decline receipt</a>
</div>
</li>
</ul>
<div ng-toggled="printDecline">
<button type="button"
ng-print
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide "
>
Print
</button>
<div class="native-receipt">
<div ng-link="emv-decline-receipt"
class="print-receipt"
ng-init="
receipt = emv.lastDecline().merchantReceipt;
label = T('Merchant Receipt')
"
></div>
<div ng-link="emv-decline-receipt"
class="print-receipt"
ng-init="
receipt = emv.lastDecline().customerReceipt;
label = T('Customer Receipt')
"
></div>
</div>
</div>
</div>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green test-submit-payment-form-action"
ng-disabled="
orderPaymentsForm.$invalid ||
orderPaymentsForm.$submitting ||
!paymentCtrl.isCurrentKindValid() ||
!paymentCtrl.isCurrentOptionValid() ||
paymentCtrl.isAmountTooLow()
"
>
Add payment
</button>
</div>
</form>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.REFUND)">
<div ng-controller=
"dashboard.bookings.OrderRefundsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Refunding...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-if="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Refund payments</h2>
</div>
</div>
<form name="refundPaymentsForm" ng-confirm-navigate-away ng-autofocus>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="refundPaymentsForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<span class="select-all">
Select:
<a ng-click="actionsCtrl.selectFullRefunds(editablePayments, orderPayments)"
>all</a>,
<a ng-click="actionsCtrl.unselectPayments(editablePayments, orderPayments)"
>none</a>
</span>
<div ng-repeat="booking in bookingsWithRefundablePayments">
<div class="order-refund-booking">
<div class="order-refund-booking-pk">
Booking #[! booking.pk !]
</div>
<div class="order-refund-booking-ava">
[! booking.availability.item|name !] &bull;
[! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !] &bull;
[! booking.customerBreakdownShort !]
</div>
</div>
<p class="action-sheet-help">
<span class="select-all">
Select:
<a ng-click="actionsCtrl.selectFullRefunds(editablePayments, booking.payments)"
ng-can-create="Refund on booking"
>all</a>,
<a ng-click="actionsCtrl.unselectPayments(editablePayments, booking.payments)"
ng-can-create="Refund on booking"
>none</a>
</span>
</p>
<ul ng-can-create="Refund on booking" class="test-refunds-list-indicator">
<li ng-repeat="payment in booking.payments"
class="refund-form-block"
ng-if="payment.isRefundable == true"
ng-class="{ 'is-selected': actionsCtrl.isPaymentSelected(editablePayments, payment) }"
>
<div class="fields "
>
<div ng-if="Payment.isLegacyProcessorBasedType(payment)" ng-link="dashboard.bookings.paymentLegacyFlag"></div>
<div class="overview-payment"
ng-link="payment-and-refunds"
ng-with="showTotals = true"
></div>
<div ng-if="Payment.isDisputedAndNonRefundable(payment)" ng-then="notSelectable"
class="refund-type-select-wrap"
>
<div class="refund-not-selectable">
Cannot be refunded right now.
<a ng-href="https://fareharbor.com/help/payments/disputes/refunding-a-disputed-charge/" ng-outbound-link="_blank">Learn more</a>
</div>
</div>
<div ng-else="notSelectable"
class="refund-type-select-wrap"
>
<div class="table full-width refund-type-select table-dont-respond valign-middle">
<div class="tr"
ng-with="isPartialRefundSelected = actionsCtrl.isPartialRefundSelected(editablePayments, payment);
isFullRefundSelected = actionsCtrl.isFullRefundSelected(editablePayments, payment)"
>
<div class="td option-dont-refund"
ng-class="{ toggled: !isPartialRefundSelected && !isFullRefundSelected }"
ng-click="actionsCtrl.unselectPayment(editablePayments, payment)"
>
Don&#039;t refund
</div>
<div class="td"
ng-if="Payment.isPartialRefundAllowed(payment)"
ng-class="{ toggled: isPartialRefundSelected }"
ng-click="actionsCtrl.selectPartialRefund(editablePayments, payment)"
>
Partial refund
</div>
<div class="td test-full-refund-indicator"
ng-class="{ toggled: isFullRefundSelected }"
ng-click="actionsCtrl.selectFullRefund(editablePayments, payment)"
>
Full refund
</div>
</div>
</div>
</div>
<fieldset class="refund-choose-amount"
ng-if="actionsCtrl.isPartialRefundSelected(editablePayments, payment)"
>
<div ng-if="payment.receipt.gross">
<table class="refund-amount-table"
ng-autofocus
>
<tr>
<td>
Refund amount:
</td>
<td>
<div class="refundpaymentform-payment-paymentpk-refundgross
field-amount
"
ng-django-field="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-django-field-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-amount-input-max="payment.receipt.gross" ng-amount-input-min="1" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'payment-' + payment.pk " required="required" step="any" type="text" />
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
</tr>
</table>
<div class="tb tb-calculate-refund-flyout"
ng-with="toggleValue = 'refundCalculator-' + payment.pk"
>
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="toggleValue"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate refund amount') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate refund amount</abbr>
</div>
<div class="tb-flyout tb-flyout--left"
ng-toggled ng-toggled-value="toggleValue"
>
<div class="flyout-section flyout-section--no-border">
<h2>
Calculate refund amount
</h2>
<div ng-portion-calculator="payment.receipt.total"
ng-portion-calculator-currency="payment"
ng-portion-calculator-max="payment.receipt.gross"
ng-portion-calculator-model="editablePayments['payment-' + payment.pk + '-' + 'refundGross']"
ng-portion-calculator-labels-for="refund"
ng-portion-calculator-toggle-value="toggleValue"
></div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = toggleValue"></div>
</div>
</div>
</div>
</div>
</fieldset>
<div ng-repeat="error in refundErrors[payment.pk]" class="form-error">
[[ error ]]
</div>
</div>
<div class="hide">
<div class="refundpaymentform-payment-paymentpk-note "
ng-django-field="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" name="note" ng-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-prefix="'payment-' + payment.pk " type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
</ul>
<div class="hint hint-alert"
ng-can-list="Account on booking.company"
ng-can-only-when="booking.company.isDefaultProcessorDefaultBankAccountReadyForUpload && isUploadPossible()"
>
<p>
<b ng-if="refundingCount() === 1" ng-then="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover this refund.
</b>
<b ng-else="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover these refunds.
</b>
Your bank account will be automatically debited.
</p>
<p>
<a ng-href="/help/payments/refunds/">Learn about refunds in FareHarbor &raquo;</a>
</p>
</div>
</div>
<div ng-can-create="Notification on company"
class="refund-email-form"
>
<div class="refundpaymentsform-sendnotification field-cb-email "
ng-django-field="refundPaymentsForm [&#39;sendNotification&#39;]" ng-django-field-model="editablePayments [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="editablePayments [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Send refunded email
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="editablePayments.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="refundpaymentsform-notification-emails "
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="refundpaymentsform-notification-subject "
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="refundpaymentsform-notification-note field-textarea
"
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".refundpaymentsform-notification-note" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
<div ng-if="refundErrors.all">
<ul>
<li ng-repeat="error in refundErrors.all"
class="form-error"
>
[[ error ]]
</li>
</ul>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in refundPaymentsForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green test-refund-order-payments-action"
ng-with="refundTotal = actionsCtrl.refundTotal(editablePayments, orderPayments)"
ng-disabled="refundPaymentsForm.$invalid || refundPaymentsForm.$submitting || !refundTotal"
ng-click="submit(refundPaymentsForm)"
ng-confirm-click="[! T('Refund these payments? There is no undo.') !]"
>
<span ng-if="refundTotal" ng-then="noTotal">
Refund <span ng-amount="refundTotal"></span>
</span>
<span ng-else="noTotal">Refund payments</span>
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.CANCEL)">
<div ng-controller=
"dashboard.bookings.CancelOrderCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Cancelling bookings...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-if="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Cancel bookings</h2>
</div>
</div>
<form class="test-cancel-booking-view-indicator"
name="cancelOrderBookingsForm"
ng-confirm-navigate-away
ng-autofocus
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="cancelOrderBookingsForm.$dirty"
>Close</button>
</span>
<p class="action-sheet-help">
<span class="select-all">
Cancel:
<a ng-click="selectAllBookings()">all</a>,
<a ng-click="unselectAllBookings()">none</a>
</span>
</p>
<div ng-repeat="booking in nonCancelledContributingBookings">
<div class="field field-cb test-select-booking-action"
ng-class="{ 'ng-disabled': (isCompanyCancelEligible && !Booking.isEligibleForCancellation(booking, auth.currentUser)) || !canCancelBooking(booking) }"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="initializeBookingsSelected[booking.pk]"
ng-disabled="(isCompanyCancelEligible && !Booking.isEligibleForCancellation(booking, auth.currentUser)) || !canCancelBooking(booking)"
ng-checked="initializeBookingsSelected[booking.pk]"
>
</span>
<span class="label-text">
Booking #[! booking.pk !]<div class="fh-grey text-small">[! booking.availability.item|name !] &bull; [! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !] &bull; [! booking.customerBreakdownShort !]</div>
</span>
</span>
</label>
</div>
<div ng-can-create="Refund on booking"
ng-can-only-when="getPaymentsFromBooking(booking).length && initializeBookingsSelected[booking.pk]"
ng-then="canDoRefunds"
>
<div ng-if="initializeBookingsSelected[booking.pk] && getPaymentsFromBooking(booking).length">
<p class="action-sheet-help">
<span class="select-all">
Refund:
<a ng-click="actionsCtrl.selectFullRefunds(editablePayments, getPaymentsFromBooking(booking))"
ng-can-create="Refund on booking"
>all</a>,
<a ng-click="actionsCtrl.unselectPayments(editablePayments, getPaymentsFromBooking(booking))"
ng-can-create="Refund on booking"
>none</a>
</span>
</p>
<ul ng-can-create="Refund on booking"
class="test-refunds-list-indicator"
>
<li ng-repeat="payment in getPaymentsFromBooking(booking)"
class="refund-form-block"
ng-if="payment.isRefundable"
ng-class="{ 'is-selected': actionsCtrl.isPaymentSelected(editablePayments, payment) }"
ng-with="refundErrors=bookingRefundErrors[booking.pk]"
>
<div class="fields "
>
<div ng-if="Payment.isLegacyProcessorBasedType(payment)" ng-link="dashboard.bookings.paymentLegacyFlag"></div>
<div class="overview-payment"
ng-link="payment-and-refunds"
ng-with="showTotals = true"
></div>
<div ng-if="Payment.isDisputedAndNonRefundable(payment)" ng-then="notSelectable"
class="refund-type-select-wrap"
>
<div class="refund-not-selectable">
Cannot be refunded right now.
<a ng-href="https://fareharbor.com/help/payments/disputes/refunding-a-disputed-charge/" ng-outbound-link="_blank">Learn more</a>
</div>
</div>
<div ng-else="notSelectable"
class="refund-type-select-wrap"
>
<div class="table full-width refund-type-select table-dont-respond valign-middle">
<div class="tr"
ng-with="isPartialRefundSelected = actionsCtrl.isPartialRefundSelected(editablePayments, payment);
isFullRefundSelected = actionsCtrl.isFullRefundSelected(editablePayments, payment)"
>
<div class="td option-dont-refund"
ng-class="{ toggled: !isPartialRefundSelected && !isFullRefundSelected }"
ng-click="actionsCtrl.unselectPayment(editablePayments, payment)"
>
Don&#039;t refund
</div>
<div class="td"
ng-if="Payment.isPartialRefundAllowed(payment)"
ng-class="{ toggled: isPartialRefundSelected }"
ng-click="actionsCtrl.selectPartialRefund(editablePayments, payment)"
>
Partial refund
</div>
<div class="td test-full-refund-indicator"
ng-class="{ toggled: isFullRefundSelected }"
ng-click="actionsCtrl.selectFullRefund(editablePayments, payment)"
>
Full refund
</div>
</div>
</div>
</div>
<fieldset class="refund-choose-amount"
ng-if="actionsCtrl.isPartialRefundSelected(editablePayments, payment)"
>
<div ng-if="payment.receipt.gross">
<table class="refund-amount-table"
ng-autofocus
>
<tr>
<td>
Refund amount:
</td>
<td>
<div class="refundpaymentform-refund-payments-for-booking-paymentbookingpk-payment-paymentpk-refundgross
field-amount
"
ng-django-field="refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-django-field-model="editablePayments [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-amount-input-max="payment.receipt.gross" ng-amount-input-min="1" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editablePayments [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'refund-payments-for-booking-' + payment.booking.pk + '-payment-' + payment.pk " required="required" step="any" type="text" />
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
</tr>
</table>
<div class="tb tb-calculate-refund-flyout"
ng-with="toggleValue = 'refundCalculator-' + payment.pk"
>
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="toggleValue"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate refund amount') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate refund amount</abbr>
</div>
<div class="tb-flyout tb-flyout--left"
ng-toggled ng-toggled-value="toggleValue"
>
<div class="flyout-section flyout-section--no-border">
<h2>
Calculate refund amount
</h2>
<div ng-portion-calculator="payment.receipt.total"
ng-portion-calculator-currency="payment"
ng-portion-calculator-max="payment.receipt.gross"
ng-portion-calculator-model="editablePayments['payment-' + payment.pk + '-' + 'refundGross']"
ng-portion-calculator-labels-for="refund"
ng-portion-calculator-toggle-value="toggleValue"
></div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = toggleValue"></div>
</div>
</div>
</div>
</div>
</fieldset>
<div ng-repeat="error in refundErrors[payment.pk]" class="form-error">
[[ error ]]
</div>
</div>
<div class="hide">
<div class="refundpaymentform-refund-payments-for-booking-paymentbookingpk-payment-paymentpk-note "
ng-django-field="refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" name="note" ng-model="editablePayments [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-prefix="'refund-payments-for-booking-' + payment.booking.pk + '-payment-' + payment.pk " type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
</ul>
</div>
<div ng-if="!canDoRefunds && getPaymentsFromBooking(booking).length" class="form-error">
This booking has un-refunded payments but you are not allowed to refund them. You <i>are</i> still allowed to cancel the booking.
</div>
</div>
<div ng-if="nonZeroGeneratedStoredValueCards(booking).length" class="form-error">
This booking has unused gift cards; cancelling this booking <i>will not</i> cancel the gift cards.
</div>
<div ng-if="!!cancelErrors[booking.pk]">
<ul>
<li ng-repeat="error in cancelErrors[booking.pk]"
class="form-error"
>
[[ error ]]
</li>
</ul>
</div>
</div>
<div class="hint hint-alert"
ng-can-list="Account on order.company"
ng-can-only-when="order.company.isDefaultProcessorDefaultBankAccountReadyForUpload && isUploadPossible()"
>
<p>
<b ng-if="refundingCount() === 1" ng-then="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover this refund.
</b>
<b ng-else="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover these refunds.
</b>
Your bank account will be automatically debited.
</p>
<p>
<a ng-href="/help/payments/refunds/">Learn about refunds in FareHarbor &raquo;</a>
</p>
</div>
<br>
<div class="fields "
>
<div class="cancelorderbookingsform-note field-textarea "
ng-django-field="cancelOrderBookingsForm [&#39;note&#39;]" ng-django-field-model="cancelOrderData [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-model="cancelOrderData [&#39;note&#39;]" ng-placeholder="Note about why you are cancelling (optional, not visible to customer)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-can-create="Notification on company">
<div class="cancelorderbookingsform-sendnotification field-cb-email "
ng-django-field="cancelOrderBookingsForm [&#39;sendNotification&#39;]" ng-django-field-model="cancelOrderData [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="cancelOrderData [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Send cancellation email
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="cancelOrderData.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="cancelorderbookingsform-notification-emails "
ng-django-field="cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelorderbookingsform-notification-subject "
ng-django-field="cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelorderbookingsform-notification-note field-textarea
"
ng-django-field="cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".cancelorderbookingsform-notification-note" ng-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div class="cancelorderbookingsform-refundgross "
ng-django-field="cancelOrderBookingsForm [&#39;refundGross&#39;]" ng-django-field-model="cancelOrderData [&#39;refundGross&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cancelOrderData [&#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cancelOrderBookingsForm [&#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cancelOrderBookingsForm [&#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cancelOrderBookingsForm [&#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelorderbookingsform-iscanceleligible "
ng-django-field="cancelOrderBookingsForm [&#39;isCancelEligible&#39;]" ng-django-field-model="cancelOrderData [&#39;isCancelEligible&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_cancel_eligible" name="isCancelEligible" ng-model="cancelOrderData [&#39;isCancelEligible&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;isCancelEligible&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelorderbookingsform-isonline "
ng-django-field="cancelOrderBookingsForm [&#39;isOnline&#39;]" ng-django-field-model="cancelOrderData [&#39;isOnline&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_online" name="isOnline" ng-model="cancelOrderData [&#39;isOnline&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;isOnline&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="btns">
<button class="btn-big btn-red btn-wide test-cancel-booking-action"
ng-with="refundTotal = actionsCtrl.refundTotal(editablePayments, orderPayments)"
ng-disabled="!isAnyEligibleBookingSelected() || (cancelOrderBookingsForm.$invalid || cancelOrderBookingsForm.$submitting)"
ng-click="submit(cancelOrderBookingsForm)"
ng-confirm-click="[! T('Cancel this booking and refund payments? There is no undo.') !]"
ng-confirm-click-when="refundTotal || isCancelEligiblePaymentsInSelectedBookings()"
>
<span ng-if="refundTotal || isCancelEligiblePaymentsInSelectedBookings()" ng-then="refundHasTotals">
<span ng-if="isCancelEligiblePaymentsInSelectedBookings()">
Cancel bookings and refund payments
</span>
<span ng-else="isCancelEligiblePaymentsInSelectedBookings()">
Cancel bookings and refund <span ng-amount="refundTotal" ng-amount-currency="order"></span>
</span>
</span>
<span ng-else="refundHasTotals">Cancel bookings</span>
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.PRINT_RECEIPT)">
<div ng-controller="dashboard.bookings.ReceiptsCtrl as receiptsCtrl"
ng-init="receiptsCtrl.paymentsSet = null;"
>
<div class="action-sheet-header respond-print-hide">
<div class="action-sheet-header-content">
<h2>
<a ng-if="!toggles.state('receiptsMenu')"
class="btn-back"
ng-toggle="receiptsMenu"
ng-toggle-group="receipts"
>Back</a>
Print
</h2>
<a ng-href="https://fareharbor.com/help/dashboard/receipts-and-tickets/printing/"
ng-outbound-link="_blank"
class="hint-help-link"
ng-if="toggles.state('receiptsMenu')"
>Get help with printing &rsaquo;</a>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
>Close</button>
</span>
<div class="respond-print-hide"
ng-show="toggles.state('receiptsMenu')"
>
<div ng-toggle="receiptsMenu"
ng-toggle-group="receipts"
ng-toggle-default="!receiptsCtrl.isPreselecting"
></div>
<div ng-toggled="receiptsMenu" ng-body-class="'body-print-booking'"></div>
<ul class="list-filters list-filters--with-spacing"
ng-show="company.isBocaEnabled || company.isReceiptsEnabled"
>
<li ng-toggle="bocaFormat"
ng-toggle-default="receiptsCtrl.preferredPrintFormat === TicketLayout.BOCA_PRINT_FORMAT"
ng-toggle-group="ticketFormats"
ng-click="receiptsCtrl.savePreferredPrintFormat(TicketLayout.BOCA_PRINT_FORMAT)"
ng-if-once="company.isBocaEnabled"
>
Boca Format
</li>
<li ng-toggle="receiptFormat"
ng-toggle-default="receiptsCtrl.preferredPrintFormat === TicketLayout.RECEIPT_PRINT_FORMAT"
ng-toggle-group="ticketFormats"
ng-click="receiptsCtrl.savePreferredPrintFormat(TicketLayout.RECEIPT_PRINT_FORMAT)"
ng-if-once="company.isReceiptsEnabled"
>
Receipt Format
</li>
<li ng-toggle="otherOptions"
ng-toggle-default="!company.isBocaEnabled && !company.isReceiptsEnabled"
ng-toggle-group="ticketFormats"
>
Other Options
</li>
</ul>
<div ng-if-once="company.isBocaEnabled">
<div ng-toggled="bocaFormat">
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showWholeParty: true })"
class="table-nav-item is-tall with-chevron"
>
All whole party tickets
</div>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true })"
class="table-nav-item is-tall with-chevron"
>
All individual tickets
</div>
<div ng-can-view-amounts="order.company"
ng-can-only-when="Payment.printablePayments(order.aggregatedPayments).length"
>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-if-once="order.aggregatedPayments"
ng-click="receiptsCtrl.preparePrinting({ showWholeParty: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
All whole party tickets + payment receipts
</div>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-if-once="order.aggregatedPayments"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
All individual tickets + payment receipts
</div>
<div ng-repeat="payment in Payment.sortByCreatedAt(order.aggregatedPayments)"
ng-toggle="bocaDisplay"
ng-click="receiptsCtrl.preparePrinting({ activePayment: payment })"
ng-toggle-group="receipts"
ng-init="receiptsCtrl.isPreselecting && $first && receiptsCtrl.preparePrinting({ activePayment: payment, toggle: 'bocaDisplay' })"
>
<div ng-if="!payment.isDeferred && payment.type !== Payment.AFFILIATE_TYPE"
class="table-nav-item is-tall with-chevron"
>
<ul>
<li ng-amount="payment.initialReceipt.gross + payment.initialReceipt.bookingFee"
ng-amount-company="payment.company"
class="bold"
></li>
<li ng-if-once="payment.isCardOnFile" ng-then="isCardOnFile">
<span class="fh-grey">From company card:</span> <b>[! payment.cardName !]</b>
</li>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<span class="fh-grey">From:</span> [! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]
</span>
<li ng-if-once="!ccPayment && !isCardOnFile">
<span class="fh-grey">Type:</span> [! payment.displayType !]
</li>
<li>
<span ng-if-once="payment.isRefunded" class="badge nowrap">
Refunded
</span>
<span class="fh-grey">
[! payment.createdAt|datetime !]
</span>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="company.isReceiptsEnabled">
<div ng-toggled="receiptFormat">
<div ng-toggle="orderReceipt"
ng-toggle-group="receipts"
class="table-nav-item is-tall with-chevron"
>
Order receipt
</div>
<div ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true })"
class="table-nav-item is-tall with-chevron"
>
All tickets
</div>
<div ng-can-view-amounts="order.company">
<div ng-if-once="Payment.printablePayments(order.aggregatedPayments).length">
<div ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-if-once="order.aggregatedPayments"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
All tickets + payment receipts
</div>
<div ng-repeat="payment in Payment.sortByCreatedAt(order.aggregatedPayments)"
ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ activePayment: payment })"
ng-init="receiptsCtrl.isPreselecting && $first && receiptsCtrl.preparePrinting({ activePayment: payment, toggle: 'receiptDisplay' })"
>
<div ng-if="!payment.isDeferred && payment.type !== Payment.AFFILIATE_TYPE"
class="table-nav-item is-tall with-chevron"
>
<ul>
<li ng-amount="payment.initialReceipt.gross + payment.initialReceipt.bookingFee"
ng-amount-company="payment.company"
class="bold"
></li>
<li ng-if-once="payment.isCardOnFile" ng-then="isCardOnFile">
<span class="fh-grey">From company card:</span> <b>[! payment.cardName !]</b>
</li>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<span class="fh-grey">From:</span> [! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]
</span>
<li ng-if-once="!ccPayment && !isCardOnFile">
<span class="fh-grey">Type:</span> [! payment.displayType !]
</li>
<li>
<span ng-if-once="payment.isRefunded" class="badge nowrap">
Refunded
</span>
<span class="fh-grey">
[! payment.createdAt|datetime !]
</span>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-toggled="otherOptions">
<a class="table-nav-item is-tall with-chevron"
ng-print
>Print this page</a>
<a ng-href="[! order.$url(urls.company.order.index) !]"
class="table-nav-item is-tall with-chevron"
>Customer confirmation page</a>
</div>
</div>
<div ng-toggled="bocaDisplay">
<div ng-controller=
"dashboard.settings.ticketLayouts.TicketLayoutViewCtrl as ticketLayoutViewCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<ul class="buttons-list respond-print-hide">
<li>
<div class="btns btns--combo">
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide [[ addClassIf(ticketLayoutViewCtrl.needsPrintSettings(), 'btn-segment-left') ]]"
>
Print
</button>
<div class="btn-segment-right-wrap" ng-if="ticketLayoutViewCtrl.needsPrintSettings()">
<div class="btn-big btn-black btn-flyout btn-segment-right active-when-toggled"
ng-toggle="ticketOptionsForm" ng-toggle-auto-close
ng-tip="[! T('Print settings') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon cog-white"></i>
</div>
<div ng-toggled="ticketOptionsForm"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-inner">
<div ng-if-once="ticketLayoutViewCtrl.ticketLayouts.length > 0">
<div class="field "
>
<label>
<span class="label-text">
Ticket layout
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="ticketLayout.pk as ticketLayout.name for ticketLayout in ticketLayoutViewCtrl.ticketLayouts"
ng-model="ticketLayoutViewCtrl.selectedTicketLayoutPk"
ng-change="ticketLayoutViewCtrl.changeTicketLayout()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<div ng-if="!!activePayment && (activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment.isProcessorBasedType)">
<div class="field "
>
<label>
<span class="label-text">
Credit card receipt copies
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="receiptCopyType.id as receiptCopyType.display for receiptCopyType in ticketLayoutViewCtrl.receiptCopyTypes"
ng-model="ticketLayoutViewCtrl.selectedReceiptCopyType"
ng-change="ticketLayoutViewCtrl.changeReceiptCopyType()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
</li>
</ul>
<div ng-init="ticketLayoutViewCtrl.printType = TicketLayout.BOCA_PRINT_FORMAT"></div>
<div ng-boca-styles-for-layout="ticketLayoutViewCtrl.selectedTicketLayout"></div>
<div class="native-receipt">
<div ng-if="showWholeParty">
<div ng-repeat="booking in order.contributingBookings">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
[! booking.customerBreakdown !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
<div class="boca-main">
<div class="table boca-main-content-wrapper full-width">
<div class="tr">
<div class="td boca-main-content">
<div class="table full-width">
<div class="tr">
<div class="td boca-qr"
ng-qr-code="[[ booking.customers[0]|checkinUrl ]]"
ng-if-once="booking.item.isScanningEnabled"
></div>
<div class="td boca-main-text">
<div ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.isCompanyInformationIncluded">
<h2 class="boca-header-large">[! booking.company.name !]</h2>
<div class="boca-section">
<span ng-if="booking.company.phone">[! booking.company.phone !]</span>
<span ng-if="booking.company.phone && booking.company.url">&bull;</span>
<span ng-if="booking.company.url">[! booking.company.url|hostname !]</span>
</div>
</div>
<h3 class="boca-header-med">
[! booking.item.name !]
<span ng-bind="!!booking.availability.headline ? ' &mdash; ' + booking.availability.headline : ''"></span>
</h3>
<h3 class="boca-header-med">
<b>
[! booking.customerBreakdown !]
</b>
&mdash; [! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</h3>
<div>
Booking #[! booking.pk !] &bull; <b>Name:</b> [! booking.contact.name !]
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tr"
ng-if-once="booking.item.receiptFooterSafeHtml"
>
<div class="td boca-fine-print md-inline"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
[! booking.customerBreakdown !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
</div>
</div>
</div>
</div>
</div>
<div ng-if="showTickets">
<div ng-repeat="booking in order.contributingBookings">
<div ng-repeat="customer in booking.customers">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
1 [! customer.name !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
<div class="boca-main">
<div class="table boca-main-content-wrapper full-width">
<div class="tr">
<div class="td boca-main-content">
<div class="table full-width">
<div class="tr">
<div class="td boca-qr"
ng-qr-code="[[ customer|checkinUrl ]]"
ng-if-once="booking.item.isScanningEnabled"
></div>
<div class="td boca-main-text">
<div ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.isCompanyInformationIncluded">
<h2 class="boca-header-large">[! booking.company.name !]</h2>
<div class="boca-section">
<span ng-if="booking.company.phone">[! booking.company.phone !]</span>
<span ng-if="booking.company.phone && booking.company.url">&bull;</span>
<span ng-if="booking.company.url">[! booking.company.url|hostname !]</span>
</div>
</div>
<h3 class="boca-header-med">
[! booking.item.name !]
<span ng-bind="!!booking.availability.headline ? ' &mdash; ' + booking.availability.headline : ''"></span>
</h3>
<h3 class="boca-header-med">
<b>
1 [! customer.name !]
</b>
&mdash; [! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</h3>
<div>
Booking #[! booking.pk !] &bull; <b>Name:</b> [! booking.contact.name !]
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tr"
ng-if-once="booking.item.receiptFooterSafeHtml"
>
<div class="td boca-fine-print md-inline"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
1 [! customer.name !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-repeat="payment in Payment.printablePayments(order.aggregatedPayments)"
ng-if="activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment === payment"
>
<div ng-if="payment.isProcessorBasedType && (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.MERCHANT_COPY
)">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
boca-ticket--receipt
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
<div class="boca-main">
<div class="boca-receipt-company-info"
ng-if="!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
<div class="boca-receipt-summary-container"
ng-class="{ 'boca-receipt-summary-container--with-company-info':
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub }
">
<div class="boca-receipt-summary">
<div class="boca-section">
<ul ng-if-once="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="hasMultipleContributingBooking"
>
<li><b>[! payment.company.name !]</b></li>
<li ng-if-once="Payment.order(payment)">
Order #[! Payment.order(payment).identifier !]
</li>
</ul>
<ul ng-else-once="hasMultipleContributingBooking"
ng-init="booking = payment.booking || payment.bookings[0]"
>
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if-once="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</li>
<li>
Booking #[! booking.pk !]
</li>
</ul>
</div>
<div class="boca-section">
<table class="boca-receipt-charges">
<tbody>
<tr>
<td>
<span ng-if-once="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if-once="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<span class="boca-ticket-small-text">
([! payment.createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="payment.initialReceipt.total"></td>
</tr>
</tbody>
<tbody ng-if-once="payment.refundCount > 0">
<tr>
<td>
[! nT('Refund', 'Refunds', payment.refundCount) !]
<span class="boca-ticket-small-text" ng-if-once="payment.refundCount === 1">
([! payment.refunds[0].createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="-(payment.refunds|summary:'receipt.total')"></td>
</tr>
<tr>
<td class="bold">Paid</td>
<td class="text-right" ng-amount="payment.receipt.total"></td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-signature">
<p class="print-receipt-text">
Cardholder will pay above amount to card issuer pursuant to cardholder agreement. Cardholder signature:
</p>
<div class="print-receipt-signature-line">x</div>
</div>
</div>
<div class="boca-receipt-emv-details"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Merchant Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
</div>
</div>
</div>
</div>
<div ng-if="!payment.isProcessorBasedType || (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.CUSTOMER_COPY
)">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
boca-ticket--receipt
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
<div class="boca-main">
<div class="boca-receipt-company-info"
ng-if="!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
<div class="boca-receipt-summary-container"
ng-class="{ 'boca-receipt-summary-container--with-company-info':
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub }
">
<div class="boca-receipt-summary">
<div class="boca-section">
<ul ng-if-once="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="hasMultipleContributingBooking"
>
<li><b>[! payment.company.name !]</b></li>
<li ng-if-once="Payment.order(payment)">
Order #[! Payment.order(payment).identifier !]
</li>
</ul>
<ul ng-else-once="hasMultipleContributingBooking"
ng-init="booking = payment.booking || payment.bookings[0]"
>
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if-once="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</li>
<li>
Booking #[! booking.pk !]
</li>
</ul>
</div>
<div class="boca-section">
<table class="boca-receipt-charges">
<tbody>
<tr>
<td>
<span ng-if-once="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if-once="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<span class="boca-ticket-small-text">
([! payment.createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="payment.initialReceipt.total"></td>
</tr>
</tbody>
<tbody ng-if-once="payment.refundCount > 0">
<tr>
<td>
[! nT('Refund', 'Refunds', payment.refundCount) !]
<span class="boca-ticket-small-text" ng-if-once="payment.refundCount === 1">
([! payment.refunds[0].createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="-(payment.refunds|summary:'receipt.total')"></td>
</tr>
<tr>
<td class="bold">Paid</td>
<td class="text-right" ng-amount="payment.receipt.total"></td>
</tr>
</tbody>
</table>
</div>
<div class="md-inline"
ng-if-once="booking.item.receiptFooterSafeHtml"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
<div class="boca-receipt-emv-details"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Customer Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-toggled="receiptDisplay">
<div ng-controller=
"dashboard.settings.ticketLayouts.TicketLayoutViewCtrl as ticketLayoutViewCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<ul class="buttons-list respond-print-hide">
<li>
<div class="btns btns--combo">
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide [[ addClassIf(ticketLayoutViewCtrl.needsPrintSettings(), 'btn-segment-left') ]]"
>
Print
</button>
<div class="btn-segment-right-wrap" ng-if="ticketLayoutViewCtrl.needsPrintSettings()">
<div class="btn-big btn-black btn-flyout btn-segment-right active-when-toggled"
ng-toggle="ticketOptionsForm" ng-toggle-auto-close
ng-tip="[! T('Print settings') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon cog-white"></i>
</div>
<div ng-toggled="ticketOptionsForm"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-inner">
<div ng-if="!!activePayment && (activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment.isProcessorBasedType)">
<div class="field "
>
<label>
<span class="label-text">
Credit card receipt copies
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="receiptCopyType.id as receiptCopyType.display for receiptCopyType in ticketLayoutViewCtrl.receiptCopyTypes"
ng-model="ticketLayoutViewCtrl.selectedReceiptCopyType"
ng-change="ticketLayoutViewCtrl.changeReceiptCopyType()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
</li>
</ul>
<div class="native-receipt">
<div ng-if="showWholeParty">
</div>
<div ng-if="showTickets">
<div ng-repeat="booking in order.contributingBookings">
<div ng-repeat="customer in booking.customers">
<div class="print-receipt">
<div class="print-receipt-section" ng-init="company = booking.company">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>
Booking #[! booking.pk !]</b></li>
<li>[! booking.contact.name !]</li>
<li>Total passengers: <b>[! booking.customerCount !]</b>
</ul>
<ul class="print-receipt-list">
<li>
<b>[[ booking.item.name ]]</b>
<span ng-if="availability.headline">&mdash; [[ availability.headline ]]</span>
</li>
<li>
[[ booking.availability.startAt|datetime:(booking.availability.endAt) ]]
</li>
<li>[! customer.name !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-link="receipt-customer-with-custom-field-values"
></table>
</div>
<div class="print-receipt-section text-center md-inline"
ng-if-once="booking.item.receiptFooterSafeHtml"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
</div>
<div ng-repeat="payment in Payment.printablePayments(order.aggregatedPayments)"
ng-if="activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment === payment"
>
<div ng-if="payment.isProcessorBasedType && (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.MERCHANT_COPY
)">
<div class="print-receipt">
<div class="print-receipt-section">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="Payment.isEmv(payment)"
ng-with="addressObject = company.primaryLocation || company"
ng-link="physical-address"
></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>[! contact.name !]</b></li>
<li ng-if="contact.phone">[! contact|contactPhone !]</li>
<li ng-if="contact.email">[! contact.email !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-init="
payments = [ payment ];
taxByType = Payment.taxByType(payment);
"
>
<tbody ng-repeat="payment in payments|orderBy:'createdAt'">
<tr>
<td>
<ul class="print-receipt-list">
<li>
<span ng-if="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
</li>
<li>
[! payment.createdAt|datetime !]
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="payment.initialReceipt.total"
ng-amount-company="payment.company"
></td>
</tr>
<tr ng-repeat="refund in payment.refunds|orderBy:'createdAt'">
<td class="left-indent">
<ul class="print-receipt-list">
<li>Refund</li>
<li>[! refund.createdAt|datetime !]</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="-refund.receipt.total"
ng-amount-company="refund.payment.company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium">
<tr>
<td class="bold text-right">Paid</td>
<td class="print-receipt-amount text-right"
ng-amount="payments|summary:'receipt.total'"
ng-amount-company="company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium"
ng-if="taxByType"
>
<tr ng-repeat="taxType in taxTypes"
ng-if="taxByType[taxType.pk]"
>
<td class="text-right"><b>[! taxType.name !]</b></td>
<td class="print-receipt-amount text-right"
ng-amount="taxByType[taxType.pk]"
ng-amount-currency="payment"
></td>
</tr>
</tbody>
<tbody class="spreadsheet-text-medium">
<tr>
<td colspan="2">
<div ng-if="Payment.isGratuityEnabled(payment)" ng-then="isGratuityEnabled">
<div>
<p class="print-receipt-text">
Thank you! Tip is not included. If you would like to add gratuity please note it here:
</p>
<div class="receipt-tip">
<table>
<tr>
<td>Tip:</td>
<td></td>
</tr>
<tr class="receipt-tip-total">
<td>Total:</td>
<td></td>
</tr>
</table>
</div>
</div>
</div>
<div ng-if="payment.isProcessorBasedType" ng-then="isProcessorBasedType">
<p ng-if="!Payment.isGratuityEnabled(payment)" class="print-receipt-text">
Thank you!
</p>
<div class="print-receipt-signature">
<p class="print-receipt-text">
Cardholder will pay above amount to card issuer pursuant to cardholder agreement. Cardholder signature:
</p>
<div class="print-receipt-signature-line">x</div>
</div>
</div>
<span ng-else="isProcessorBasedType || isGratuityEnabled">
&nbsp;
</span>
</td>
</tr>
</tbody>
<tbody>
<tr class="spreadsheet-text-small">
<td colspan="2">
<aside ng-if="Payment.hasMultipleVisibleContributingBookings(payment)">
Order #[! Payment.order(payment).identifier !]
</aside>
<h3 ng-if="payment.isRefunded" ng-then="paymentIsRefunded">
Original payment for:
</h3>
<h3 ng-else="paymentIsRefunded">
Payment for:
</h3>
</td>
</tr>
</tbody>
<tbody ng-if="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="paymentHasMultipleVisibleContributingBookings"
>
<tr ng-repeat="subPayment in payment.payments">
<td ng-init="booking = subPayment.booking"
colspan="[! payment.isRefunded ? 2 : 1 !]"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="subPayment.receipt.total"
ng-amount-company="subPayment.company"
></td>
</tr>
<tr ng-if="payment.invisibleBookingCount">
<td colspan="[! payment.isRefunded ? 2 : 1 !]">
[! interpolate(nT('%(count)s other booking', '%(count)s other bookings', payment.invisibleBookingCount), { count: payment.invisibleBookingCount }) !]
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="payment.invisibleReceipt.total"
ng-amount-company="order.company"
></td>
</tr>
</tbody>
<tbody ng-else="paymentHasMultipleVisibleContributingBookings">
<tr>
<td ng-if="payment.bookings" ng-then="paymentIsAggregated"
ng-init="booking = payment.bookings[0]"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-else="paymentIsAggregated"
ng-init="booking = payment.booking"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-if="Payment.receiptFooters(payment).length > 0" ng-then="receiptFooters"
class="print-receipt-section item-receipt-footer"
>
<div ng-repeat="item in Payment.items(payment)">
<div ng-if="item.receiptFooter">
<div class="print-receipt-text text-center md-inline"
ng-if-once="item.receiptFooterSafeHtml"
ng-bind-html-once="item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<div ng-else="receiptFooters">
<div ng-if="!Payment.isGratuityEnabled(payment) && !payment.isProcessorBasedType"
class="print-receipt-section item-receipt-footer"
>
<p class="print-receipt-text text-center">
Thanks for your payment!
</p>
</div>
</div>
<div class="print-receipt-section"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Merchant Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-footer">
[[ Receipt.printedAt()|datetime ]]
</div>
</div>
</div>
<div ng-if="!payment.isProcessorBasedType || (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.CUSTOMER_COPY
)">
<div class="print-receipt">
<div class="print-receipt-section">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="Payment.isEmv(payment)"
ng-with="addressObject = company.primaryLocation || company"
ng-link="physical-address"
></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>[! contact.name !]</b></li>
<li ng-if="contact.phone">[! contact|contactPhone !]</li>
<li ng-if="contact.email">[! contact.email !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-init="
payments = [ payment ];
taxByType = Payment.taxByType(payment);
"
>
<tbody ng-repeat="payment in payments|orderBy:'createdAt'">
<tr>
<td>
<ul class="print-receipt-list">
<li>
<span ng-if="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
</li>
<li>
[! payment.createdAt|datetime !]
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="payment.initialReceipt.total"
ng-amount-company="payment.company"
></td>
</tr>
<tr ng-repeat="refund in payment.refunds|orderBy:'createdAt'">
<td class="left-indent">
<ul class="print-receipt-list">
<li>Refund</li>
<li>[! refund.createdAt|datetime !]</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="-refund.receipt.total"
ng-amount-company="refund.payment.company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium">
<tr>
<td class="bold text-right">Paid</td>
<td class="print-receipt-amount text-right"
ng-amount="payments|summary:'receipt.total'"
ng-amount-company="company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium"
ng-if="taxByType"
>
<tr ng-repeat="taxType in taxTypes"
ng-if="taxByType[taxType.pk]"
>
<td class="text-right"><b>[! taxType.name !]</b></td>
<td class="print-receipt-amount text-right"
ng-amount="taxByType[taxType.pk]"
ng-amount-currency="payment"
></td>
</tr>
</tbody>
<tbody class="spreadsheet-text-medium">
<tr>
<td colspan="2">
<div ng-if="Payment.isGratuityEnabled(payment)" ng-then="isGratuityEnabled">
<div>
<p class="print-receipt-text">
Thank you! Tip is not included. If you would like to add gratuity please note it here:
</p>
<div class="receipt-tip">
<table>
<tr>
<td>Tip:</td>
<td></td>
</tr>
<tr class="receipt-tip-total">
<td>Total:</td>
<td></td>
</tr>
</table>
</div>
</div>
</div>
<div ng-if="payment.isProcessorBasedType" ng-then="isProcessorBasedType">
<p ng-if="!Payment.isGratuityEnabled(payment)" class="print-receipt-text">
Thank you!
</p>
</div>
<span ng-else="isProcessorBasedType || isGratuityEnabled">
&nbsp;
</span>
</td>
</tr>
</tbody>
<tbody>
<tr class="spreadsheet-text-small">
<td colspan="2">
<aside ng-if="Payment.hasMultipleVisibleContributingBookings(payment)">
Order #[! Payment.order(payment).identifier !]
</aside>
<h3 ng-if="payment.isRefunded" ng-then="paymentIsRefunded">
Original payment for:
</h3>
<h3 ng-else="paymentIsRefunded">
Payment for:
</h3>
</td>
</tr>
</tbody>
<tbody ng-if="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="paymentHasMultipleVisibleContributingBookings"
>
<tr ng-repeat="subPayment in payment.payments">
<td ng-init="booking = subPayment.booking"
colspan="[! payment.isRefunded ? 2 : 1 !]"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="subPayment.receipt.total"
ng-amount-company="subPayment.company"
></td>
</tr>
<tr ng-if="payment.invisibleBookingCount">
<td colspan="[! payment.isRefunded ? 2 : 1 !]">
[! interpolate(nT('%(count)s other booking', '%(count)s other bookings', payment.invisibleBookingCount), { count: payment.invisibleBookingCount }) !]
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="payment.invisibleReceipt.total"
ng-amount-company="order.company"
></td>
</tr>
</tbody>
<tbody ng-else="paymentHasMultipleVisibleContributingBookings">
<tr>
<td ng-if="payment.bookings" ng-then="paymentIsAggregated"
ng-init="booking = payment.bookings[0]"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-else="paymentIsAggregated"
ng-init="booking = payment.booking"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-if="Payment.receiptFooters(payment).length > 0" ng-then="receiptFooters"
class="print-receipt-section item-receipt-footer"
>
<div ng-repeat="item in Payment.items(payment)">
<div ng-if="item.receiptFooter">
<div class="print-receipt-text text-center md-inline"
ng-if-once="item.receiptFooterSafeHtml"
ng-bind-html-once="item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<div ng-else="receiptFooters">
<div ng-if="!Payment.isGratuityEnabled(payment) && !payment.isProcessorBasedType"
class="print-receipt-section item-receipt-footer"
>
<p class="print-receipt-text text-center">
Thanks for your payment!
</p>
</div>
</div>
<div class="print-receipt-section"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Customer Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-footer">
[[ Receipt.printedAt()|datetime ]]
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-toggled="orderReceipt"
ng-toggle-group="receipts"
>
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide "
>
Print
</button>
<div class="print-receipt native-receipt">
<div class="print-receipt-section" ng-init="company = order.company">
<ul>
<li ng-if-once="company.imageEmailCdnUrl || company.imageCdnUrl">
<img ng-image="company.imageEmailCdnUrl || company.imageCdnUrl"
ng-image-max-height="250"
alt="[! company.name !]"
class="receipt-logo"
/>
</li>
<li><b>[! company.name !]</b></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>
Order #[! order.identifier !]</b></li>
<li>[! order.contact.name !]</li>
<li ng-if="order.contact.phone">[! order.contact|contactPhone !]</li>
<li ng-if="order.contact.email">[! order.contact.email !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet" ng-init="payments = order.aggregatedPayments">
<tbody>
<tr ng-repeat="booking in order.allBookings">
<td>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="booking.isContributing ? (booking.costs.totalCost.price || 0) : 0"
ng-amount-company="booking.company"
></td>
</tr>
<tr ng-if="order.invisibleBookingCount">
<td>
[! interpolate(nT('%(count)s other booking', '%(count)s other bookings', order.invisibleBookingCount), { count: order.invisibleBookingCount }) !]
</td>
<td class="print-receipt-amount text-right"
ng-amount="order.invisibleBookingCosts.totalCost.price"
ng-amount-company="order.company"
></td>
</tr>
</tbody>
<tbody
ng-init="
hasExplicitGross = false;
costs = order.contributingBookingCosts;
fee = order.receipt.bookingFee;
company = order.company;
showTaxByType = Order.showTaxByType(order);
showZeroTax = !Order.isNoTax(order);
"
ng-inline="receipt-subtotal-total"
>
</tbody>
<tbody>
<tr><td colspan="2">&nbsp;</td></tr>
</tbody>
<tbody ng-repeat="payment in payments|orderBy:'createdAt'">
<tr>
<td>
<ul class="print-receipt-list">
<li>
<span ng-if="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
</li>
<li>
[! payment.createdAt|datetime !]
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="payment.initialReceipt.total"
ng-amount-company="payment.company"
></td>
</tr>
<tr ng-repeat="refund in payment.refunds|orderBy:'createdAt'">
<td class="left-indent">
<ul class="print-receipt-list">
<li>Refund</li>
<li>[! refund.createdAt|datetime !]</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="-refund.receipt.total"
ng-amount-company="refund.payment.company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium">
<tr>
<td class="bold text-right">Paid</td>
<td class="print-receipt-amount text-right"
ng-amount="payments|summary:'receipt.total'"
ng-amount-company="company"
></td>
</tr>
</tbody>
<tbody ng-if="order.company.features.isAmountDueOnReceiptsEnabled && order.amountDue" ng-then="isOrderAmountDue">
<tr>
<td colspan="100">&nbsp;</td>
</tr>
</tbody>
<tbody ng-if="isOrderAmountDue"
ng-inline="order-receipt-amount-due"
></tbody>
</table>
</div>
<div class="print-receipt-section item-receipt-footer">
<div class="print-receipt-text text-center">
[! Order.receiptFooter(order) !]
</div>
</div>
<div class="print-receipt-footer">
[[ Receipt.printedAt()|datetime ]]
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
</div>
<div class="booking-full-invoice">
<div class="invoice-booking-info has-bottom-padding has-bottom-border">
<h2 class="booking-info-pk" title='[! interpolate(cT("\"ID\" is abbreviation of \"Identifier\"", "ID: %(orderId)s"), { orderId: order.pk }) !]'>
<i class="icon-order-large"></i>
Order #[! order.identifier !]
</h2>
<span class="booked-at [! order.originalUser ? 'fh-grey' : 'booked-at-online' !]">
[! order.originalUser ? interpolate(T('Originally created by %(personName)s'), { personName: order.originalUser.name }) : T('Originally created by online customer') !]
<span ng-if-once="!!order.originalUser && !navigation.isCurrentCompany(order.originalUser.company)">
([! order.originalUser.company.name !])
</span>
</span>
</div>
<div class="invoice-stats" ng-can-view-amounts="order.company"
ng-can-only-when="order.contributingBookingCount > 0"
>
<div class="invoice-stats-inner">
<table class="booking-full-stats">
<tr class="stats-labels">
<td>Order total</td>
<td>Payments</td>
<td ng-if="order.amountOverpaid || order.amountDue" ng-then="showAmountDue">
<span ng-if="order.amountDue" class="badge badge-unpaid test-amount-due-indicator">Due</span>
<span ng-if="order.amountOverpaid" class="badge badge-overpaid">Overpaid by</span>
</td>
<td ng-else="showAmountDue" rowspan="2">
<span class="badge badge-paid test-paid-in-full-indicator">Paid in Full</span>
</td>
</tr>
<tr class="stats-numbers">
<td class="test-order-total"
ng-amount="order.contributingBookingCosts.totalCost.total"
ng-amount-company="order.company"
></td>
<td class="test-order-paid"
ng-amount="order.receipt.gross"
ng-amount-company="order.company"
></td>
<td ng-if="showAmountDue"
ng-amount="order.amountDue || order.amountOverpaid"
ng-amount-company="order.company"
></td>
</tr>
</table>
</div>
</div>
<div class="table valign-middle booking-full-invoice-customers"
ng-if="order.contributingBookingCount > 0"
>
<div class="tr">
<div class="td booking-full-customer-breakdown">
[[
interpolate(nT('%(count)s booking', '%(count)s bookings', order.contributingBookingCount), { count: order.contributingBookingCount })
]]
</div>
</div>
</div>
<div class="order-invoice-bookings">
<div ng-repeat="booking in order.contributingBookings"
ng-link="order-invoice-bookings"
></div>
<div class="table valign-middle booking-full-invoice-customers test-no-contributing-bookings-indicator"
ng-if="!order.contributingBookings.length && !order.invisibleBookingCount"
>
<div class="tr">
<div class="td booking-full-customer-breakdown ng-binding">
<div class="hint hint-alert">
This order has 0 uncancelled bookings with payment.
</div>
</div>
</div>
</div>
<table class="invoice-table test-invisible-bookings-indicator"
ng-if="order.invisibleBookingCount > 0"
>
<tbody>
<tr class="invoice-table--row is-shaded is-tall">
<td class="itable-content" colspan="2">
<div>
<b>
[[
interpolate(nT('%(count)s other booking', '%(count)s other bookings', order.invisibleBookingCount ), { count: order.invisibleBookingCount })
]]
</b>
</div>
<div class="fh-grey text-small">You don&#039;t have access to see these bookings.</div>
</td>
<td class="itable-amount">
<span ng-can-view-amounts="order.company"
ng-amount="order.invisibleBookingCosts.totalCost.total"
ng-amount-company="order.company"
></span>
</td>
</tr>
</tbody>
</table>
<div ng-if="order.nonContributingBookings.length">
<br>
<ul class="toggle-header-list">
<li class="flyout-toggle-header test-non-contributing-bookings-indicator" ng-toggle="showCancelled"
ng-toggle-default="!order.contributingBookings.length"
>
[[
interpolate(nT('%(count)s cancelled + refunded booking', '%(count)s cancelled + refunded bookings', order.nonContributingBookings.length ), { count: order.nonContributingBookings.length })
]]
</li>
</ul>
<div ng-toggled="showCancelled">
<div class="table valign-middle booking-full-invoice-customers">
<div class="tr">
<div class="td booking-full-customer-breakdown ng-binding">
<div class="hint hint-alert">
Bookings that have been cancelled and fully refunded won&#039;t count towards the order total.
</div>
</div>
</div>
</div>
<div ng-repeat="booking in order.nonContributingBookings"
ng-link="order-invoice-bookings"
></div>
</div>
</div>
</div>
<table class="invoice-table has-top-margin print-break-avoid"
ng-can-view-amounts="order.company"
>
<tbody>
<tr class="invoice-table--row is-tall">
<td class="text-right"><b>Subtotal</b></td>
<td class="itable-amount" ng-amount="order.contributingBookingCosts.totalCost.price || 0"></td>
</tr>
</tbody>
<tbody ng-if="Order.showTaxByType(order)"
ng-then="showTaxByType"
>
<tr class="invoice-table--row is-tall"
ng-repeat="taxType in taxTypes"
ng-if="(order.contributingBookingCosts.totalCost.taxByType[taxType.pk]|isDefined) && (order.contributingBookingCosts.totalCost.taxByType[taxType.pk] || !Order.isNoTax(order))"
>
<td class="text-right"><b>[! taxType|name !]</b></td>
<td class="itable-amount" ng-amount="order.contributingBookingCosts.totalCost.taxByType[taxType.pk]"></td>
</tr>
</tbody>
<tbody ng-if="!showTaxByType && (order.contributingBookingCosts.totalCost.tax || !Order.isNoTax(order))">
<tr class="invoice-table--row is-tall">
<td class="text-right"><b>[! Company.taxDisplayName(order.company) !]</b></td>
<td class="itable-amount" ng-amount="order.contributingBookingCosts.totalCost.tax"></td>
</tr>
</tbody>
<tbody>
<tr class="invoice-table--row is-tall is-shaded no-border">
<td class="text-right"><b>Total</b></td>
<td class="itable-amount" ng-amount="order.contributingBookingCosts.totalCost.total"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="booking-full-activities"
ng-activities="order"
ng-activities-note
ng-activities-header='[! cT("\"order\" as in sales order", "Order activity:") !]'
></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</script>
<script type="text/ng-template" id="view-contact">
<div ng-controller=
"dashboard.bookings.ContactCtrl"
ng-body-class="'body-print-overlay [! addClassIf(isPermalink, 'db-shade-body') !]'"
class="[[ dataCtrl.status|css ]]
booking-full test-dashboard-booking-view-indicator
[[ isPermalink ? 'booking-full-permalink' : 'booking-full-overlay' ]]
"
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div class="print-header with-margin respond-print-show booking-print-header">
<div class="print-header-date">
<b>[! navigation.currentCompany.name !]</b>
</div>
</div>
<div class="company-container-back respond-print-hide" ng-if="isPermalink">
<a ng-href="[! company.$url(urls.dashboard.bookings.index) !]" class="btn-back test-back-action">Bookings</a>
</div>
<a ng-href="[! company.$url(urls.dashboard.overlay.close) !]"
class="overlay-close respond-print-hide"
ng-shortcut="'esc'"
ng-shortcut-click
title="[! T('Shortcut: escape') !]"
ng-else="isPermalink"
><span>Close</span></a>
<div ng-watch="contactTracker.modifiedAt">
<div ng-controller=
"dashboard.shared.ContactEditableCtrl"
class="
contact-header
" >
<div
ng-can-view="contact"
ng-then="allowed">
<form class="contact-header-inner form-big-inputs" ng-autofocus
name="contactForm"
ng-submit="editCtrl.submit(contactForm)"
ng-sonar-pause="contact when updated"
ng-can-update="contact"
ng-can-only-when="editCtrl.editing"
>
<div class="fields "
>
<div class="contactform-name field-person-icon hide-label-text "
ng-django-field="contactForm [&#39;name&#39;]" ng-django-field-model="editableContact [&#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="editableContact [&#39;name&#39;]" ng-placeholder="Full name" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in contactForm [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if-once="contact ? contact.company.companyFeatures.isContentTranslationEnabled : company.companyFeatures.isContentTranslationEnabled">
<a ng-toggle="contactLanguageDropdown" class="form-link-subtle hide-when-toggled contact-language-toggle"
ng-toggle-default="contact.language"
>
Change contact language
</a>
<div ng-toggled="contactLanguageDropdown">
<div class="contactform-language
field-globe-icon
"
ng-django-field="contactForm [&#39;language&#39;]" ng-django-field-model="editableContact [&#39;language&#39;]"
ng-language-dropdown
>
<div ng-current-option="editableContact [&#39;language&#39;]"
ng-current-option-collection=""
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="language"
ng-model="editableContact [&#39;language&#39;]"
ng-disabled="languageDropdownCtrl.isLoading"
ng-options="lang.code as lang.display group by lang.group for lang in languageDropdownCtrl.languageChoices"
ng-dropdown
ng-placeholder="[! T('Select a language') !]"
ng-dropdown-allow-clear="false"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="contactForm [&#39;language&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in contactForm [&#39;language&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="contactform-phone field-phone-icon hide-label-text
international-phone-field
"
ng-django-field="contactForm [&#39;phone&#39;]" ng-django-field-model="editableContact [&#39;phone&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Phone number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone" maxlength="32" name="phone" ng-international-phone-field="true" ng-international-phone-field-countries="Contact.COUNTRIES" ng-international-phone-field-phone-country-model="editableContact [&#39;phoneCountry&#39;]" ng-model="editableContact [&#39;phone&#39;]" ng-pattern="/^[^a-zA-Z]{5,32}$/" ng-placeholder="Phone number" ng-required="!auth.currentUser.isAuthenticated" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in contactForm [&#39;phone&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="
company.isSmsEnabled &&
SmsNotification.isEligiblePhoneNumber(
editableContact[ + '-phone'],
editableContact[ + '-phoneCountry'],
company
)
">
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value="false"
class="ng-pristine"
ng-model="editableContact.isSmsEnabled"
>
</span>
<span class="label-text">
Opt-in to text messages
<span class="icon-hint" ng-tip="[[ company.features.isInternationalSmsEnabled ? T('Customer may pay fees to their carrier') : T('Customer may pay fees to their carrier, US numbers only') ]]"></span>
</span>
</span>
</label>
</div>
</div>
<div class="contactform-email field-email-icon hide-label-text "
ng-django-field="contactForm [&#39;email&#39;]" ng-django-field-model="editableContact [&#39;email&#39;]"
ng-django-field-required="!auth.currentUser.isAuthenticated"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="editableContact [&#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-required="!auth.currentUser.isAuthenticated" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<span ng-mailcheck="editableContact [&#39;email&#39;]"
class="mailcheck-suggestion"
></span>
<ul class="errors">
<li ng-repeat="error in contactForm [&#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-show="(auth.currentUser.isAuthenticated && (newBooking['contact-email'] || editableContact.email)) || !auth.currentUser.isAuthenticated">
<div ng-if="auth.currentUser.isAuthenticated" ng-then="internalSubscribe">
<div class="contactform-issubscribed field-cb-light "
ng-django-field="contactForm [&#39;isSubscribed&#39;]" ng-django-field-model="editableContact [&#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="editableContact [&#39;isSubscribed&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Subscribe to company email list
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in contactForm [&#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-else="internalSubscribe">
<div class="contactform-issubscribed field-cb-light "
ng-django-field="contactForm [&#39;isSubscribed&#39;]" ng-django-field-model="editableContact [&#39;isSubscribed&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_subscribed" name="isSubscribed" ng-checkbox-madness="true" ng-model="editableContact [&#39;isSubscribed&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Get future email updates from [[ company.name ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in contactForm [&#39;isSubscribed&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="contactform-phonecountry "
ng-django-field="contactForm [&#39;phoneCountry&#39;]" ng-django-field-model="editableContact [&#39;phoneCountry&#39;]"
>
<label >
<span class="label-text">
Phone country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone_country" name="phoneCountry" ng-model="editableContact [&#39;phoneCountry&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="contactForm [&#39;phoneCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in contactForm [&#39;phoneCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="contactForm.all.$error.contact-info-permissions">Contact email and phone are required.</li>
<li ng-repeat="error in contactForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn btn-green btn-left" type="submit"
ng-disabled="contactForm.$pristine || contactForm.$invalid || contactForm.$submitting"
>
[[ contactForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn btn-grey btn-left" type="button"
ng-click="editCtrl.cancel(contactForm)"
ng-shortcut="'esc'"
ng-shortcut-click
title="[! T('Shortcut: escape') !]"
ng-sonar-unpause="contact when updated"
ng-disabled="contactForm.$submitting"
>
Cancel
</button>
</div>
</form>
<div ng-if="!editCtrl.editing">
<div class="contact-header-inner is-display">
<h1 class="booking-full-name">[! contact.name !]</h1>
<p class="preferred-language text-normal"
ng-if-once="contact.language && contact.language !== company.language"
>
<span class="fh-grey">Language:</span>
[! SupportedLanguage.display(contact.language) !]
</p>
<div>
<a ng-href="tel:[! contact.normalizedPhone !]"
ng-if-once="contact.phone"
>[! contact|contactPhone !]</a>
<span ng-if-once="contact.phone && contact.email">&bull;</span>
<a ng-href="mailto:[! contact.email !]"
ng-if-once="contact.email"
>[! contact.email !]</a>
</div>
</div>
</div>
<div class="contact-header-tb respond-print-hide">
<div class="tb tb--inset-mobile">
<div class="tb-left">
<div class="tb-group"
ng-can-update="contact"
>
<a class="tb-btn [[ addClassIf(editCtrl.editing, 'is-disabled') ]]"
ng-click="editCtrl.edit()"
ng-shortcut="'shift+c'"
ng-shortcut-action="editCtrl.edit()"
title="[! T('Shortcut: shift+c') !]"
>
<i class="tb-icon pencil"></i> [[ editCtrl.editing ? T('Editing...') : T('Edit contact') ]]
</a>
</div>
<div class="tb-group">
<div class="tb-btn tb-btn--flyout"
ng-toggle="contactBookings"
ng-toggle-default="contact.relatedBookings.length > 1 || contact.relatedOrders.length > 0"
>
<span class="respond-handhelds-show">
<i class="tb-icon hamburger "></i>
</span>
[[ interpolate(nT('%(count)s booking', '%(count)s bookings', contact.relatedBookings.length), { count: contact.relatedBookings.length }) ]]
</div>
<div class="tb-btn test-plusbook-contact-action"
ng-if="auth.permissions.canCreate(Booking, contact.company)"
ng-click="plusbook.plusbook(contact, currentBooking())"
ng-shortcut="'=|shift+n'"
ng-shortcut-click
title="[! T('Shortcut: shift+n') !]"
>
<i class="tb-icon plus"></i> New booking for contact
</div>
</div>
</div>
<div class="tb-right">
<div class="tb-data" ng-presence="[! contact.uri !]"
ng-presence-tip="[! T('Also viewing') !]"
ng-presence-icon="eye"
ng-presence-company="contact.company"
></div>
<div class="tb-data" ng-link="contact-actions-menu"></div>
</div>
</div>
</div>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
<div ng-toggled-show="contactBookings"
class="contact-bookings respond-print-hide test-contact-bookings-indicator"
>
<div class="contact-bookings-inner">
<div ng-repeat="order in contact.relatedOrders"
class="contact-order"
>
<div class="table valign-middle full-width">
<a ng-href="[! order|orderUrl !]" ng-navigation-active
class="tr test-contact-order-indicator"
>
<div class="td">
<i class="tb-icon stack"></i>
<b>
Order #[! order.identifier !]
</b>
<span class="fh-grey contact-booking-meta" ng-if="order.contributingBookingCount > 0">
[[ interpolate(nT('%(count)s booking', '%(count)s bookings', order.contributingBookingCount), { count: order.contributingBookingCount }) ]]
</span>
</div>
<div class="td contact-booking-meta"></div>
</a>
</div>
<div class="contact-bookings-indent">
<div class="table valign-middle full-width">
<a ng-repeat="booking in order.allBookings"
ng-href="[! booking|bookingUrl !]" ng-navigation-active
class="tr test-order-booking-indicator"
ng-link="contact-booking-row"
></a>
</div>
</div>
</div>
<div class="table valign-middle full-width"
ng-if="contact.standAloneBookings.length"
>
<a ng-repeat="booking in contact.standAloneBookings"
ng-href="[! booking|bookingUrl !]" ng-navigation-active
class="tr test-contact-standalone-booking-indicator"
ng-link="contact-booking-row"
></a>
</div>
</div>
</div>
<div ng-scroll-static="a.current"
ng-scroll-static-container=".contact-bookings"
ng-scroll-static-padding="40"
ng-toggled="contactBookings"
></div>
<div ng-shortcut="'left|up'" ng-shortcut-action="selectPrevious()"></div>
<div ng-shortcut="'right|down'" ng-shortcut-action="selectNext()"></div>
</div>
<div ng-navigation-spec="[
['path', urls.dashboard.bookings.contact.order ],
['path', urls.dashboard.overlay.contact.order ],
['path', urls.dashboard.bookings.contact.affiliateOrderPermalink ]]"
ng-then="orderPath"
>
<div ng-controller=
"dashboard.bookings.ViewOrderCtrl"
ng-body-class="'body-print-overlay'"
ng-scroll-to="top"
ng-scroll-container=".db-theater"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="booking-full-loading fh-grey">
<i class="spinner-ticker-css"><span></span></i> Loading order...
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-title='[[ order.contact.name ]] - [[ interpolate(cT("\"order\" as in sales order", "Order #%(orderId)s"), { orderId: order.identifier }) ]]'
ng-watch="orderTracker.modifiedAt"
>
<div class="booking-full-content">
<div class="clearfix">
<div class="booking-full-actions">
<div class="booking-actions">
<div ng-controller=
"dashboard.bookings.OrderActionsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div
ng-if="actionsCtrl.isSelected(actionsCtrl.NONE)"
ng-body-class="'body-print-booking'"
>
<div class="action-sheet-header respond-print-hide">
<div class="action-sheet-header-content">
<h2>Order actions</h2>
<a ng-href="https://fareharbor.com/help/dashboard/orders/order-actions/"
ng-outbound-link="_blank"
class="hint-help-link"
>Get help with orders &rsaquo;</a>
</div>
</div>
<ul class="buttons-list test-action-buttons">
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.ADD_BOOKING)" ng-then="addButton">
<button type="button"
class="btn-big btn-black btn-wide btn-icon add-booking test-add-booking-to-order-action"
ng-click="plusbook.orderize(order)"
ng-shortcut="'=|shift+n'"
ng-shortcut-click
title="[! T('Shortcut: shift+n') !]"
>
Add new booking to order
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.MOVE_TO_ORDER)" ng-then="moveButton">
<a class="btn-big btn-black btn-wide btn-icon merge-booking"
ng-href="[! contact|contactUrl !]?action=modify&to=[! order.identifier !]"
ng-confirm-click="[! T('You\'ll be taken to the Manage Orders tool under Contact Actions.') !]"
>
Move existing booking to order
</a>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.CANCEL)" ng-then="cancelButton">
<button type="button"
class="btn-big btn-black btn-wide btn-icon cancel test-cancel-action"
ng-click="actionsCtrl.select(actionsCtrl.CANCEL)"
ng-shortcut="'delete|shift+x'"
ng-shortcut-click
title="[! T('Shortcut: shift+x') !]"
>
Cancel bookings
</button>
</li>
<li class="buttons-spacer" ng-if="addButton || moveButton || cancelButton"></li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.ADD_PAYMENT)" ng-then="paymentButton">
<button type="button"
class="btn-big btn-black btn-wide btn-icon add-payment [! order|currencyClass !] test-add-payment-action"
ng-click="actionsCtrl.select(actionsCtrl.ADD_PAYMENT)"
ng-shortcut="'shift+='"
ng-shortcut-click
title="[! T('Shortcut: shift+plus') !]"
>
Add payment
<span class="badge" ng-can-view-amounts="order.company" ng-can-only-when="order.amountDue">
[[ order.amountDue|amount:order ]] Due
</span>
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.REFUND)" ng-then="refundButton">
<button type="button"
class="btn-big btn-black btn-wide btn-icon [! order|currencyClass !] refund test-refund-action"
ng-click="actionsCtrl.select(actionsCtrl.REFUND)"
ng-shortcut="'shift+-'"
ng-shortcut-click
title="[! T('Shortcut: shift+minus') !]"
>
Refund
</button>
</li>
<li class="buttons-spacer" ng-if="paymentButton || refundButton"></li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.NOTIFY_ORDER)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon email"
ng-click="actionsCtrl.select(actionsCtrl.NOTIFY_ORDER)"
>
Send email
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.PRINT_RECEIPT)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon print test-print-receipt-action"
ng-click="actionsCtrl.select(actionsCtrl.PRINT_RECEIPT)"
ng-shortcut="'shift+p'"
ng-shortcut-click
title="[! T('Shortcut: shift+p') !]"
>
Print
</button>
</li>
</ul>
</div>
<div class="action-window">
<div ng-if="actionsCtrl.isSelected(actionsCtrl.NOTIFY_ORDER)">
<div ng-controller=
"dashboard.bookings.OrderNotificationCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
instant
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Sending email...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-show="!submitting">
<form class="form-big-inputs"
name="notificationForm"
ng-confirm-navigate-away
>
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Send email</h2>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="notificationForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="email-form" >
<div class="notificationform-type field-select-full "
ng-django-field="notificationForm [&#39;type&#39;]" ng-django-field-model="data [&#39;type&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select
ng-model="data [&#39;type&#39;]"
ng-prefix=""
ng-options="option.value as option.name for option in notificationTypeOptions"
>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="notificationForm [&#39;type&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in notificationForm [&#39;type&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-emails "
ng-django-field="notificationForm [&#39;emails&#39;]" ng-django-field-model="data [&#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="data [&#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-subject "
ng-django-field="notificationForm [&#39;subject&#39;]" ng-django-field-model="data [&#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="data [&#39;subject&#39;]" ng-placeholder="Email subject" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-note field-textarea
"
ng-django-field="notificationForm [&#39;note&#39;]" ng-django-field-model="data [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".notificationform-note" ng-model="data [&#39;note&#39;]" ng-placeholder="Message (optional)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="notificationForm.all.$error.subject_required">Subject is required</li>
<li ng-if="notificationForm.all.$error.no_eligible_disputes">No eligible disputes.</li>
<li ng-if="notificationForm.all.$error.unauthorized">Only authorized users can send emails</li>
<li ng-repeat="error in notificationForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-disabled="notificationForm.$invalid || notificationForm.$submitting"
ng-click="submit(notificationForm)"
>
Send email
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.ADD_PAYMENT)">
<div ng-controller=
"dashboard.bookings.OrderPaymentsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-show="submitting" ng-link="payment-processing"></div>
<div ng-show="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Add payment to order</h2>
</div>
</div>
<div class="giant-toggle-fluid is-fixed table table-dont-respond valign-middle"
ng-can="createStoredValueCard on Payment with order"
ng-can-only-when="order.company.storedValueCardsCount > 0"
>
<div class="tr">
<div class="td" ng-click="redeem(false)"
ng-class="{ 'toggled': !isRedeeming }"
>
Collect
</div>
<div class="td" ng-click="redeem(true)"
ng-class="{ 'toggled': isRedeeming }"
>
Redeem
</div>
</div>
</div>
<div ng-if="isRedeeming" ng-then="redeeming">
<p class="action-sheet-help">
Pay for this order with a gift card:
</p>
<form name="redeemForm"
ng-confirm-navigate-away
ng-submit="submitRedeem(redeemForm)"
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="redeemForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="labels-above">
<div ng-stored-value-card-search
ng-model="newOrderPayments.storedValueCardNumber"
>
<div class="redeemform-storedvaluecardnumber "
ng-django-field="redeemForm [&#39;storedValueCardNumber&#39;]" ng-django-field-model="newOrderPayments [&#39;storedValueCardNumber&#39;]"
>
<label >
<span class="label-text">
Gift card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_stored_value_card_number" name="storedValueCardNumber" ng-autofocus="true" ng-model="newOrderPayments [&#39;storedValueCardNumber&#39;]" ng-pattern="/^[a-zA-Z0-9\-_\#\%$]+$/" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;storedValueCardNumber&#39;].$error['pattern']">Invalid value</li>
<li ng-repeat="error in redeemForm [&#39;storedValueCardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-if="redeemCtrl.status === 'not-found'"
class="fh-red"
>
Card not found
</div>
<div ng-if="redeemCtrl.status === 'loading'"
class="fh-grey"
>
Loading...
</div>
<div class="chunky-error light-orange" ng-if="redeemCtrl.storedValueCard.pendingBalance < 0">
<div class="chunky-error-inner">
Gift card has pending bookings affecting remaining balance by [[ redeemCtrl.storedValueCard.pendingBalance|amount:company ]]
</div>
</div>
<table ng-if="redeemCtrl.status === 'success' && redeemCtrl.storedValueCard"
class="portion-calculator-table redeem-amount-table"
>
<tr>
<td>Card balance:</td>
<td>
<b>[[ redeemCtrl.storedValueCard.balance|amount:redeemCtrl.storedValueCard ]]</b>
<a ng-href="[! redeemCtrl.storedValueCard.$url(urls.dashboard.settings.storedValue.storedValueCard.index) !]"
ng-can-view="redeemCtrl.storedValueCard"
class="fh-blue underline"
>(Details)</a>
</td>
</tr>
<tr ng-if="redeemCtrl.storedValueCard.balance > 0">
<td>Amount to use:</td>
<td ng-can="createPartial on Payment with company" ng-then="canCreatePartial">
<div class="redeemform-gross field-partial-payment-gross
field-amount
"
ng-django-field="redeemForm [&#39;gross&#39;]" ng-django-field-model="redeemCtrl [&#39;gross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-max="redeemCtrl.max()" ng-amount-input-min="redeemCtrl.min()" ng-amount-input-positive="true" ng-autofocus="true" ng-autofocus-select="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="redeemCtrl [&#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="redeemForm [&#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in redeemForm [&#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
<td ng-else="canCreatePartial">
Pay in full ([[ redeemCtrl.amountDue()|amount:company ]])
</td>
</tr>
</table>
<div ng-can-create="Notification on company">
<div class="redeemform-sendnotification field-cb-email "
ng-django-field="redeemForm [&#39;sendNotification&#39;]" ng-django-field-model="newOrderPayments [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="newOrderPayments [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Email receipt
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="newOrderPayments.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="redeemform-notification-emails "
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-notification-subject "
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-notification-note field-textarea
"
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".redeemform-notification-note" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div class="redeemform-processortype "
ng-django-field="redeemForm [&#39;processorType&#39;]" ng-django-field-model="newOrderPayments [&#39;processorType&#39;]"
>
<label >
<span class="label-text">
Processor type
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_processor_type" name="processorType" ng-model="newOrderPayments [&#39;processorType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;processorType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;processorType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-isdemo "
ng-django-field="redeemForm [&#39;isDemo&#39;]" ng-django-field-model="newOrderPayments [&#39;isDemo&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_demo" name="isDemo" ng-model="newOrderPayments [&#39;isDemo&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;isDemo&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-cardtype "
ng-django-field="redeemForm [&#39;cardType&#39;]" ng-django-field-model="newOrderPayments [&#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="newOrderPayments [&#39;cardType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-cardlast4 "
ng-django-field="redeemForm [&#39;cardLast4&#39;]" ng-django-field-model="newOrderPayments [&#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="newOrderPayments [&#39;cardLast4&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripetoken "
ng-django-field="redeemForm [&#39;stripeToken&#39;]" ng-django-field-model="newOrderPayments [&#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="newOrderPayments [&#39;stripeToken&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripechargeid "
ng-django-field="redeemForm [&#39;stripeChargeId&#39;]" ng-django-field-model="newOrderPayments [&#39;stripeChargeId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_charge_id" name="stripeChargeId" ng-model="newOrderPayments [&#39;stripeChargeId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeChargeId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripepaymentintentid "
ng-django-field="redeemForm [&#39;stripePaymentIntentId&#39;]" ng-django-field-model="newOrderPayments [&#39;stripePaymentIntentId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_payment_intent_id" name="stripePaymentIntentId" ng-model="newOrderPayments [&#39;stripePaymentIntentId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripePaymentIntentId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripesetupintentid "
ng-django-field="redeemForm [&#39;stripeSetupIntentId&#39;]" ng-django-field-model="newOrderPayments [&#39;stripeSetupIntentId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_setup_intent_id" name="stripeSetupIntentId" ng-model="newOrderPayments [&#39;stripeSetupIntentId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeSetupIntentId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-tokenizationtype "
ng-django-field="redeemForm [&#39;tokenizationType&#39;]" ng-django-field-model="newOrderPayments [&#39;tokenizationType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_tokenization_type" name="tokenizationType" ng-model="newOrderPayments [&#39;tokenizationType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;tokenizationType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;tokenizationType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="redeemForm.all.$error.invalid_emv_provider">Payment device provider not recognized. Please contact FareHarbor Support.</li>
<li ng-if="redeemForm.all.$error.tokenization_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.booking_affiliation_required">An affiliate must be selected.</li>
<li ng-if="redeemForm.all.$error.is_demo_does_not_match">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.stored_value_card_not_found">Gift card not found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.ideal_not_enabled">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_affiliate_payments">Cannot create affiliate payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_stored_value_card_payments">Sorry, your account is not authorized to redeem gift cards.</li>
<li ng-if="redeemForm.all.$error.cannot_add_payment_to_demo_booking">Demo mode must be enabled to add payments to demo bookings.</li>
<li ng-if="redeemForm.all.$error.missing_in_store_payment_note">&#39;%(payment_note)s&#39; cannot be empty. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.card_not_found">Card not found.</li>
<li ng-if="redeemForm.all.$error.stripe_ideal_bank_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.charge_amount_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-HIGH)</li>
<li ng-if="redeemForm.all.$error.booking_fee_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-LOW)</li>
<li ng-if="redeemForm.all.$error.gross_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-LOW)</li>
<li ng-if="redeemForm.all.$error.cannot_create_demo_card_on_file_payment">Cannot create a payment for a saved card when demo mode is enabled.</li>
<li ng-if="redeemForm.all.$error.invalid_processor_type">Outdated payment processor. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.non_affiliate_collected_by_affiliate">Only payments collected by affiliates may be marked as such. Please contact FareHarbor Support. (A-2)</li>
<li ng-if="redeemForm.all.$error.booking_fee_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-HIGH)</li>
<li ng-if="redeemForm.all.$error.invalid_option">Invalid payment option. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.ideal_option_requires_pending_bookings">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cardholders_name_not_specified">Payment could not be processed. Cardholder's name is required.</li>
<li ng-if="redeemForm.all.$error.cant_create_credit_card_payment">Cannot create credit card payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.affiliate_not_collected_by_affiliate">Payments collected by affiliates must be marked as such. Please contact FareHarbor Support. (A-1)</li>
<li ng-if="redeemForm.all.$error.cant_skip_payment">Cannot skip payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.unauthorized_card_access">Unable to use card for payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_valid">Cannot create in-store payment, selection not valid. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.country_code_not_specified">Payment could not be processed. Billing country is required. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_in_store_payments">Cannot create in-store payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.charge_amount_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.cannot_add_payment_to_non_demo_booking">Demo mode must be disabled to add payments to non-demo bookings.</li>
<li ng-if="redeemForm.all.$error.no_relevant_bookings">Cannot create payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cannot_create_demo_ideal_payment">Cannot pay with iDEAL when demo mode is enabled.</li>
<li ng-if="redeemForm.all.$error.gross_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-HIGH)</li>
<li ng-if="redeemForm.all.$error.booking_fee_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.cant_defer_payment">Cannot save card. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.invalid_processor">No processor found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_found">Cannot create in-store payment, type not found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.gross_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.charge_amount_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-LOW)</li>
<li ng-if="redeemForm.all.$error.booking_rebooked">This booking has been rebooked. Please refresh the page.</li>
<li ng-if="redeemForm.all.$error.cant_charge_card">Cannot charge that card. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.postal_code_not_specified">Payment could not be processed. Billing postal (zip) code is required. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_authorized">Sorry, you are not authorized to create in-store payments. Please refresh the page and try again.</li>
<li ng-repeat="error in redeemForm.all.$error.$server">[[ error ]]</li>
</ul>
<div class="form-error" ng-if="redeemCtrl.isBalanceInsufficientDueToPermissions()">
You don&#039;t have permission to redeem an amount that is less than the amount due.
</div>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-disabled="redeemForm.$invalid || redeemForm.$submitting || !redeemCtrl.isValid()"
>
Redeem Gift Card
</button>
</div>
</form>
</div>
<div ng-else="redeeming">
<form name="orderPaymentsForm"
ng-confirm-navigate-away
ng-submit="submit(orderPaymentsForm)"
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="orderPaymentsForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div ng-if="!paymentCtrl.isAnonymous">
<div class="orderpaymentsform-payment-kind "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;kind&#39;]"
ng-django-field-required=""
>
<ul ng-radio-flyer
class="field-radio-group field-radio-group--large"
>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.PARTIAL_KIND)"
class="test-payment-kind-partial-action"
>
<label class="has-child">
<input type="radio" name="kind"
ng-value="paymentCtrl.PARTIAL_KIND"
ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payment'" ng-required="required"
>
[[ paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND ? T('Partial payment:') : T('Partial payment') ]]
</label>
</li>
<li ng-if="paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND">
<div class="radio-content">
<ul class="order-partial-payments"
ng-autofocus ng-autofocus-select
>
<li ng-repeat="booking in order.contributingBookings" ng-if="booking.amountDue > 0">
<div class="fields "
>
<div class="table table-dont-respond full-width valign-middle">
<div class="tr">
<div class="td">
<ul>
<li><b ng-amount="booking.amountDue" ng-click="maxPaymentsForBooking(booking)" class="fh-red"></b> &mdash; #[! booking.pk !]</li>
<li class="fh-grey text-small">[! booking.availability.item|name !] &bull; [! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !] &bull; [! booking.customerBreakdownShort !]</li>
</ul>
</div>
<div class="td text-right">
<div class="orderpaymentsform-order-payment-for-booking-bookingpk-gross
field-amount
"
ng-django-field="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;]" ng-django-field-model="newOrderPayments [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-default="paymentCtrl.defaultOrderBookingGross(booking)" ng-amount-input-max="booking.amountDue" ng-amount-input-min="paymentCtrl.orderAmountMin()" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="newOrderPayments [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'order-payment-for-booking-' + booking.pk" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="orderpaymentsform-order-payment-for-booking-bookingpk-amountdue "
ng-django-field="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;]" ng-django-field-model="newOrderPayments [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount_due" max="999999.99" min="0" name="amountDue" ng-amount-input="true" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="newOrderPayments [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'order-payment-for-booking-' + booking.pk" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;].$error['pattern']">Invalid value</li>
<li ng-if="orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;order-payment-for-booking-&#39; + booking.pk + &#39;-&#39; + &#39;amountDue&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
<li class="text-right">
<b>[[ paymentCtrl.amount()|amount: order ]]</b>
</li>
</ul>
</div>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.FULL_KIND)"
class="test-payment-kind-full-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.FULL_KIND"
ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;kind&#39;]" ng-prefix="'payment'" ng-required="required"
>
[[ paymentCtrl.isDefaultAmountInvoicePrice() ? T('Invoice amount') : T('Pay in full') ]]
</label>
</li>
<li ng-if="!paymentCtrl.isAnyKindValid()"
class="form-error"
>
<b>No available payment options.</b> Please contact your administrator.
</li>
</ul>
</div>
<div ng-if="paymentCtrl.affiliation() && paymentCtrl.needsPayment()">
<div class="orderpaymentsform-payment-iscollectedbyaffiliate "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]"
>
<div class="affiliate-form-header">Collected By</div>
<ul ng-radio-flyer
class="test-payment-collected-by-field-indicator field field-radio-group field-radio-group--large"
>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(false)"
class="test-collected-by-affiliate-false-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="false"
ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>[[ paymentCtrl.company|name ]]</b>
</span>
</label>
</li>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(true)"
class="test-collected-by-affiliate-true-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="true"
ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;isCollectedByAffiliate&#39;]" ng-prefix="'payment'" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>[[ paymentCtrl.affiliation().affiliateCompany|name ]]</b>
</span>
</label>
</li>
</ul>
</div>
</div>
<div ng-if="paymentCtrl.needsPayment() && !paymentCtrl.isCollectedByAffiliate()">
<div class="orderpaymentsform-optionandextras "
ng-django-field="orderPaymentsForm [&#39;optionAndExtras&#39;]" ng-django-field-model="paymentCtrl [&#39;optionAndExtras&#39;]"
>
<div class="affiliate-form-header">Payment Type</div>
<ul ng-radio-flyer
class="field-radio-group field-radio-group--large
"
>
<li class="field-radio-inline-header fh-green">
Pay [[ paymentCtrl.amount()|amount:order ]] with:
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IN_STORE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.inStorePaymentTypes"
class="test-payment-action-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="orderpaymentsform-payment-instorepaymentnote "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.AFFILIATE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.affiliateInStorePaymentTypes"
class="test-payment-action-affiliate-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="orderpaymentsform-payment-instorepaymentnote "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-prefix="'payment'" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.FILE_OPTION)" ng-repeat="payment in paymentCtrl.cardPayments"
class="test-payment-action-file field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="payment"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge <b>[[ payment.displayProcessorBasedType ]]</b> <b>[[ payment.processorBasedIdentifier ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CARD_ON_FILE_OPTION)" ng-repeat="cardOnFile in paymentCtrl.cardsOnFile"
class="test-payment-action-card-on-file field-radio-icon--cc"
>
<label class="[! addClassIf(paymentCtrl.company.isDemoModeEnabled, 'is-disabled') !]">
<input type="radio" name=""
ng-value="cardOnFile"
ng-disabled="paymentCtrl.company.isDemoModeEnabled"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge company card <b>[[ cardOnFile.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CHARGE_OPTION)"
class="test-payment-action-charge field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.CHARGE_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge card
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.EMV_OPTION)"
class="test-payment-action-emv field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.EMV_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge with <b>[[ emv.currentDevice.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IDEAL_OPTION)"
class="test-payment-action-ideal"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.IDEAL_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
iDEAL
<i ng-svg="svg-ideal"></i>
</label>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.SOFORT_OPTION)"
class="test-payment-action-sofort"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.SOFORT_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Sofort
<i ng-svg="svg-sofort"></i>
</label>
</li>
<li ng-if="!paymentCtrl.isAnyOptionValid()">
No valid payment options
</li>
</ul>
</div>
</div>
</div>
<div ng-if="paymentCtrl.needsCharge()">
<div class="form-error" ng-if="paymentCtrl.isAmountTooLow()">
<span ng-if="!auth.currentUser.isAuthenticated" ng-then="isAnonUser">
Sorry, payment cannot be taken at this time.
<a href="https://fareharbor.com/help/submit/">Please contact FareHarbor.</a>
(Error code LH-[! Payment.MIN_CHARGE_AMOUNT !].)
</span>
<span ng-else="isAnonUser">
<span ng-if="paymentCtrl.needsCharge()" ng-then="chargeTooLow">
Sorry, cards cannot be charged for amounts less than [! Payment.MIN_CHARGE_AMOUNT|amount:order !].
</span>
<span ng-else="chargeTooLow">
Sorry, payments cannot be created for [! 0|amount:order !].
</span>
</span>
</div>
</div>
<div ng-if="paymentCtrl.needsCardFields() && !paymentCtrl.isAmountTooLow()">
<div class="card-fields card-type-[[ paymentCtrl.cardTypeAbbreviation() ]]"
ng-class="{ 'test-cards-only': paymentCtrl.company.isDemoModeEnabled }"
>
<div class="card-fields-inner">
<div ng-if="paymentCtrl.company.isDemoModeEnabled" ng-then="demoCardForm"
class="card-fields-demo"
>
Demo mode
<i class="help-icon"
ng-tip="[! T('You can only use test credit card numbers while demo mode is on') !]"
></i>
</div>
<div ng-else="demoCardForm"
class="card-fields-secure"
>
<i class="icon-lock-green"></i> Secure and encrypted
<i class="icon-hint"
ng-hide="auth.currentUser.isAuthenticated"
ng-tip="[! interpolate(T('%(companyName)s will only be able to see the last 4 digits of your card number'), { companyName: paymentCtrl.company.name }) !]"
ng-tip-classes="tip-indent"
ng-tip-touch="true"
></i>
</div>
<div class="native-swiped-container"
ng-if="paymentCtrl.swiped && native.isNative"
ng-then="nativeSwiped"
>
<div>
<span class="badge badge-green">Swiped successfully</span>
</div>
<span class="card-number">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardLast4() ]]"
ng-model="newOrderPayments"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</span>
<div class="card-name">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardholdersName() ]]"
ng-model="newOrderPayments"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<a ng-click="paymentCtrl.stopSwiping()" class="btn btn-grey">
Enter different card
</a>
</div>
<div ng-else="nativeSwiped">
<span class="card-type-logo"></span>
<span class="card-number" ng-if-once="clientOptions.isKioskModeEnabled" ng-then="kioskMode">
<div class="orderpaymentsform-payment-cardnumber hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payment'" ng-required="true" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span class="card-number" ng-else-once="kioskMode">
<div class="orderpaymentsform-payment-cardnumber hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-prefix="'payment'" ng-required="true" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="card-name">
<span ng-if-once="kioskMode">
<div class="orderpaymentsform-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderpaymentsform-payment-cardholdersname field-person-icon hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-prefix="'payment'" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Cardholder\'s name must match the name printed on the card') !]"
ng-tip-touch="true"
></div>
</div>
<div class="card-expiry">
<div class="card-form-header">Expiration date</div>
<div class="exp-month">
<div class="orderpaymentsform-payment-cardexpirymonth
pseudo-select
"
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName()" ng-then="hasValuecardMonth">
[[ KioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName() ]]
</span>
<span ng-else="hasValuecardMonth" class="exp-placeholder">
Month
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_month" name="cardExpiryMonth" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;]" ng-prefix="'payment'" required="required">
<option value="1">01 - January</option>
<option value="2">02 - February</option>
<option value="3">03 - March</option>
<option value="4">04 - April</option>
<option value="5">05 - May</option>
<option value="6">06 - June</option>
<option value="7">07 - July</option>
<option value="8">08 - August</option>
<option value="9">09 - September</option>
<option value="10">10 - October</option>
<option value="11">11 - November</option>
<option value="12">12 - December</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryMonth&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="exp-year">
<div class="orderpaymentsform-payment-cardexpiryyear
pseudo-select
"
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year()" ng-then="hasValuecardYear">
[[ KioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year() ]]
</span>
<span ng-else="hasValuecardYear" class="exp-placeholder">
Year
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_year" name="cardExpiryYear" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;]" ng-prefix="'payment'" required="required">
<option value="2019">2019</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
<option value="2028">2028</option>
<option value="2029">2029</option>
<option value="2030">2030</option>
<option value="2031">2031</option>
<option value="2032">2032</option>
<option value="2033">2033</option>
<option value="2034">2034</option>
<option value="2035">2035</option>
<option value="2036">2036</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardExpiryYear&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="card-country-code">
<div class="orderpaymentsform-payment-countrycode field-select-full "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
>
<label >
<span class="label-text">
Country/Region
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_country_code" name="countryCode" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]" ng-prefix="'payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]">
<option value="" selected="selected"></option>
<option value="US">USA</option>
<option value="AF">Afghanistan</option>
<option value="AL">Albania</option>
<option value="DZ">Algeria</option>
<option value="AS">American Samoa</option>
<option value="AD">Andorra</option>
<option value="AO">Angola</option>
<option value="AI">Anguilla</option>
<option value="AQ">Antarctica</option>
<option value="AG">Antigua & Barbuda</option>
<option value="AR">Argentina</option>
<option value="AM">Armenia</option>
<option value="AW">Aruba</option>
<option value="AU">Australia</option>
<option value="AT">Austria</option>
<option value="AZ">Azerbaijan</option>
<option value="BS">Bahama</option>
<option value="BH">Bahrain</option>
<option value="BD">Bangladesh</option>
<option value="BB">Barbados</option>
<option value="BY">Belarus</option>
<option value="BE">Belgium</option>
<option value="BZ">Belize</option>
<option value="BJ">Benin</option>
<option value="BM">Bermuda</option>
<option value="BT">Bhutan</option>
<option value="BO">Bolivia</option>
<option value="BA">Bosnia and Herzegovina</option>
<option value="BW">Botswana</option>
<option value="BV">Bouvet Island</option>
<option value="BR">Brazil</option>
<option value="IO">British Indian Ocean Territory</option>
<option value="VG">British Virgin Islands</option>
<option value="BN">Brunei Darussalam</option>
<option value="BG">Bulgaria</option>
<option value="BF">Burkina Faso</option>
<option value="BI">Burundi</option>
<option value="KH">Cambodia</option>
<option value="CM">Cameroon</option>
<option value="CA">Canada</option>
<option value="CV">Cape Verde</option>
<option value="KY">Cayman Islands</option>
<option value="CF">Central African Republic</option>
<option value="TD">Chad</option>
<option value="CL">Chile</option>
<option value="CN">China</option>
<option value="CX">Christmas Island</option>
<option value="CC">Cocos (Keeling) Islands</option>
<option value="CO">Colombia</option>
<option value="KM">Comoros</option>
<option value="CG">Congo</option>
<option value="CK">Cook Iislands</option>
<option value="CR">Costa Rica</option>
<option value="HR">Croatia</option>
<option value="CU">Cuba</option>
<option value="CY">Cyprus</option>
<option value="CZ">Czech Republic</option>
<option value="DK">Denmark</option>
<option value="DJ">Djibouti</option>
<option value="DM">Dominica</option>
<option value="DO">Dominican Republic</option>
<option value="TP">East Timor</option>
<option value="EC">Ecuador</option>
<option value="EG">Egypt</option>
<option value="SV">El Salvador</option>
<option value="GQ">Equatorial Guinea</option>
<option value="ER">Eritrea</option>
<option value="EE">Estonia</option>
<option value="ET">Ethiopia</option>
<option value="FK">Falkland Islands (Malvinas)</option>
<option value="FO">Faroe Islands</option>
<option value="FJ">Fiji</option>
<option value="FI">Finland</option>
<option value="FR">France</option>
<option value="FX">France, Metropolitan</option>
<option value="GF">French Guiana</option>
<option value="PF">French Polynesia</option>
<option value="TF">French Southern Territories</option>
<option value="GA">Gabon</option>
<option value="GM">Gambia</option>
<option value="GE">Georgia</option>
<option value="DE">Germany</option>
<option value="GH">Ghana</option>
<option value="GI">Gibraltar</option>
<option value="GR">Greece</option>
<option value="GL">Greenland</option>
<option value="GD">Grenada</option>
<option value="GP">Guadeloupe</option>
<option value="GU">Guam</option>
<option value="GT">Guatemala</option>
<option value="GN">Guinea</option>
<option value="GW">Guinea-Bissau</option>
<option value="GY">Guyana</option>
<option value="HT">Haiti</option>
<option value="HM">Heard & McDonald Islands</option>
<option value="HN">Honduras</option>
<option value="HK">Hong Kong</option>
<option value="HU">Hungary</option>
<option value="IS">Iceland</option>
<option value="IN">India</option>
<option value="ID">Indonesia</option>
<option value="IQ">Iraq</option>
<option value="IE">Ireland</option>
<option value="IR">Islamic Republic of Iran</option>
<option value="IL">Israel</option>
<option value="IT">Italy</option>
<option value="CI">Ivory Coast</option>
<option value="JM">Jamaica</option>
<option value="JP">Japan</option>
<option value="JO">Jordan</option>
<option value="KZ">Kazakhstan</option>
<option value="KE">Kenya</option>
<option value="KI">Kiribati</option>
<option value="KP">Korea, Democratic People's Republic of</option>
<option value="KR">Korea, Republic of</option>
<option value="KW">Kuwait</option>
<option value="KG">Kyrgyzstan</option>
<option value="LA">Lao People's Democratic Republic</option>
<option value="LV">Latvia</option>
<option value="LB">Lebanon</option>
<option value="LS">Lesotho</option>
<option value="LR">Liberia</option>
<option value="LY">Libyan Arab Jamahiriya</option>
<option value="LI">Liechtenstein</option>
<option value="LT">Lithuania</option>
<option value="LU">Luxembourg</option>
<option value="MO">Macau</option>
<option value="MG">Madagascar</option>
<option value="MW">Malawi</option>
<option value="MY">Malaysia</option>
<option value="MV">Maldives</option>
<option value="ML">Mali</option>
<option value="MT">Malta</option>
<option value="MH">Marshall Islands</option>
<option value="MQ">Martinique</option>
<option value="MR">Mauritania</option>
<option value="MU">Mauritius</option>
<option value="YT">Mayotte</option>
<option value="MX">Mexico</option>
<option value="FM">Micronesia</option>
<option value="MD">Moldova, Republic of</option>
<option value="MC">Monaco</option>
<option value="MN">Mongolia</option>
<option value="MS">Monserrat</option>
<option value="MA">Morocco</option>
<option value="MZ">Mozambique</option>
<option value="MM">Myanmar</option>
<option value="NA">Namibia</option>
<option value="NR">Nauru</option>
<option value="NP">Nepal</option>
<option value="NL">Netherlands</option>
<option value="AN">Netherlands Antilles</option>
<option value="NC">New Caledonia</option>
<option value="NZ">New Zealand</option>
<option value="NI">Nicaragua</option>
<option value="NE">Niger</option>
<option value="NG">Nigeria</option>
<option value="NU">Niue</option>
<option value="NF">Norfolk Island</option>
<option value="MP">Northern Mariana Islands</option>
<option value="NO">Norway</option>
<option value="OM">Oman</option>
<option value="PK">Pakistan</option>
<option value="PW">Palau</option>
<option value="PA">Panama</option>
<option value="PG">Papua New Guinea</option>
<option value="PY">Paraguay</option>
<option value="PE">Peru</option>
<option value="PH">Philippines</option>
<option value="PN">Pitcairn</option>
<option value="PL">Poland</option>
<option value="PT">Portugal</option>
<option value="PR">Puerto Rico</option>
<option value="QA">Qatar</option>
<option value="RE">Reunion</option>
<option value="RO">Romania</option>
<option value="RU">Russian Federation</option>
<option value="RW">Rwanda</option>
<option value="LC">Saint Lucia</option>
<option value="WS">Samoa</option>
<option value="SM">San Marino</option>
<option value="ST">Sao Tome & Principe</option>
<option value="SA">Saudi Arabia</option>
<option value="SN">Senegal</option>
<option value="RS">Serbia</option>
<option value="SC">Seychelles</option>
<option value="SL">Sierra Leone</option>
<option value="SG">Singapore</option>
<option value="SK">Slovakia</option>
<option value="SI">Slovenia</option>
<option value="SB">Solomon Islands</option>
<option value="SO">Somalia</option>
<option value="ZA">South Africa</option>
<option value="GS">South Georgia and the South Sandwich Islands</option>
<option value="ES">Spain</option>
<option value="LK">Sri Lanka</option>
<option value="SH">St. Helena</option>
<option value="KN">St. Kitts and Nevis</option>
<option value="PM">St. Pierre & Miquelon</option>
<option value="VC">St. Vincent & the Grenadines</option>
<option value="SD">Sudan</option>
<option value="SR">Suriname</option>
<option value="SJ">Svalbard & Jan Mayen Islands</option>
<option value="SZ">Swaziland</option>
<option value="SE">Sweden</option>
<option value="CH">Switzerland</option>
<option value="SY">Syrian Arab Republic</option>
<option value="TW">Taiwan</option>
<option value="TJ">Tajikistan</option>
<option value="TZ">Tanzania, United Republic of</option>
<option value="TH">Thailand</option>
<option value="TG">Togo</option>
<option value="TK">Tokelau</option>
<option value="TO">Tonga</option>
<option value="TT">Trinidad & Tobago</option>
<option value="TN">Tunisia</option>
<option value="TR">Turkey</option>
<option value="TM">Turkmenistan</option>
<option value="TC">Turks & Caicos Islands</option>
<option value="TV">Tuvalu</option>
<option value="UG">Uganda</option>
<option value="UA">Ukraine</option>
<option value="AE">United Arab Emirates</option>
<option value="GB">United Kingdom (Great Britain)</option>
<option value="UM">United States Minor Outlying Islands</option>
<option value="VI">United States Virgin Islands</option>
<option value="US">USA</option>
<option value="ZZ">Unknown or unspecified country</option>
<option value="UY">Uruguay</option>
<option value="UZ">Uzbekistan</option>
<option value="VU">Vanuatu</option>
<option value="VA">Vatican City State (Holy See)</option>
<option value="VE">Venezuela</option>
<option value="VN">Viet Nam</option>
<option value="WF">Wallis & Futuna Islands</option>
<option value="EH">Western Sahara</option>
<option value="YE">Yemen</option>
<option value="YU">Yugoslavia</option>
<option value="ZR">Zaire</option>
<option value="ZM">Zambia</option>
<option value="ZW">Zimbabwe</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="card-cvc-postal">
<div class="card-cvc"
ng-shortcut="'shift+alt+c'"
ng-shortcut-action="auth.permissions.can('createWithoutCVC', Payment, paymentCtrl.company) && paymentCtrl.overrideCvc()"
>
<span ng-if-once="kioskMode">
<div class="orderpaymentsform-payment-cardcvc hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderpaymentsform-payment-cardcvc hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-prefix="'payment'" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="<span class='cvc-icon'></span> [! T('Your card\'s three or four digit verification number, usually on the back') !]"
ng-tip-classes="tip-text-left"
ng-tip-touch="true"
></div>
</div>
<div class="card-postal"
ng-if="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;] && Payment.needsPostalCode(newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;])"
>
<span ng-if-once="kioskMode">
<div class="orderpaymentsform-payment-postalcode field-location-icon hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="orderpaymentsform-payment-postalcode field-location-icon hide-label-text "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-prefix="'payment'" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Please enter your billing postal code (zip code) for verification') !]"
ng-tip-touch="true"
></div>
</div>
</div>
</div>
<a class="card-swipe"
ng-click="paymentCtrl.startSwiping()"
ng-if="paymentCtrl.showingSwipe && !paymentCtrl.cardTypeAbbreviation()"
ng-tip="[! T('Swipe card') !]"
ng-tip-classes="tip-indent"
>
Swipe card
</a>
<div class="swiping" ng-if="paymentCtrl.swiping">
<input class="swipe-input" type="text" ng-swipe="paymentCtrl.swipeComplete" />
<div class="swiping-inner">
<div><img ng-src="//dp58aslhmbcib.cloudfront.net/static/images/card-swipe.gif?99774cb15b0528a7a2caeeb2a01921cc3e14532e" /></div>
Ready to swipe card...
</div>
</div>
</div>
<div class="amex-note"
ng-if="auth.currentUser.isAuthenticated && !newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;countryCode&#39;]"
>
<b>Note:</b> It is strongly recommended that you enter the country for American Express cards, or the charge will fail.
</div>
<div ng-if="!company.isDemoModeEnabled"
ng-link="payment-setup-nag"
ng-init="isShort = true"
></div>
</div>
</div>
<div ng-if="!paymentCtrl.isAnonymous && paymentCtrl.isAnyKindValid() && paymentCtrl.kind() !== paymentCtrl.SKIP_KIND"
class="payment-comment"
>
<a ng-toggle="paymentComment" class="form-link-subtle hide-when-toggled">Add comment to payment</a>
<div ng-toggled="paymentComment">
<div class="orderpaymentsform-payment-note "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Payment comment (not visible to customer)" ng-prefix="'payment'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-can-create="Notification on company">
<div class="orderpaymentsform-sendnotification field-cb-email "
ng-django-field="orderPaymentsForm [&#39;sendNotification&#39;]" ng-django-field-model="newOrderPayments [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="newOrderPayments [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Email receipt
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="newOrderPayments.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="orderpaymentsform-notification-emails "
ng-django-field="orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderpaymentsform-notification-subject "
ng-django-field="orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderpaymentsform-notification-note field-textarea
"
ng-django-field="orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".orderpaymentsform-notification-note" ng-model="newOrderPayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div ng-if="paymentCtrl.needsCardFields()">
<div class="orderpaymentsform-payment-stripetoken "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;]" ng-prefix="'payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderpaymentsform-payment-cardlast4 "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;]" ng-prefix="'payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="orderpaymentsform-payment-cardtype "
ng-django-field="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-django-field-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="newOrderPayments [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;]" ng-prefix="'payment'" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in orderPaymentsForm [&#39;payment&#39; + &#39;-&#39; + &#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="orderPaymentsForm.all.$error.invalid_emv_provider">Payment device provider not recognized. Please contact FareHarbor Support.</li>
<li ng-if="orderPaymentsForm.all.$error.tokenization_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.booking_affiliation_required">An affiliate must be selected.</li>
<li ng-if="orderPaymentsForm.all.$error.is_demo_does_not_match">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.stored_value_card_not_found">Gift card not found. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.ideal_not_enabled">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_create_affiliate_payments">Cannot create affiliate payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_create_stored_value_card_payments">Sorry, your account is not authorized to redeem gift cards.</li>
<li ng-if="orderPaymentsForm.all.$error.cannot_add_payment_to_demo_booking">Demo mode must be enabled to add payments to demo bookings.</li>
<li ng-if="orderPaymentsForm.all.$error.missing_in_store_payment_note">&#39;%(payment_note)s&#39; cannot be empty. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.card_not_found">Card not found.</li>
<li ng-if="orderPaymentsForm.all.$error.stripe_ideal_bank_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.charge_amount_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-HIGH)</li>
<li ng-if="orderPaymentsForm.all.$error.booking_fee_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-LOW)</li>
<li ng-if="orderPaymentsForm.all.$error.gross_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-LOW)</li>
<li ng-if="orderPaymentsForm.all.$error.cannot_create_demo_card_on_file_payment">Cannot create a payment for a saved card when demo mode is enabled.</li>
<li ng-if="orderPaymentsForm.all.$error.invalid_processor_type">Outdated payment processor. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.non_affiliate_collected_by_affiliate">Only payments collected by affiliates may be marked as such. Please contact FareHarbor Support. (A-2)</li>
<li ng-if="orderPaymentsForm.all.$error.booking_fee_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-HIGH)</li>
<li ng-if="orderPaymentsForm.all.$error.invalid_option">Invalid payment option. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.ideal_option_requires_pending_bookings">Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cardholders_name_not_specified">Payment could not be processed. Cardholder's name is required.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_create_credit_card_payment">Cannot create credit card payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.affiliate_not_collected_by_affiliate">Payments collected by affiliates must be marked as such. Please contact FareHarbor Support. (A-1)</li>
<li ng-if="orderPaymentsForm.all.$error.cant_skip_payment">Cannot skip payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.unauthorized_card_access">Unable to use card for payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.in_store_payment_type_not_valid">Cannot create in-store payment, selection not valid. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.country_code_not_specified">Payment could not be processed. Billing country is required. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_create_in_store_payments">Cannot create in-store payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.charge_amount_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-UNSPECIFIED)</li>
<li ng-if="orderPaymentsForm.all.$error.cannot_add_payment_to_non_demo_booking">Demo mode must be disabled to add payments to non-demo bookings.</li>
<li ng-if="orderPaymentsForm.all.$error.no_relevant_bookings">Cannot create payment. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.cannot_create_demo_ideal_payment">Cannot pay with iDEAL when demo mode is enabled.</li>
<li ng-if="orderPaymentsForm.all.$error.gross_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-HIGH)</li>
<li ng-if="orderPaymentsForm.all.$error.booking_fee_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-UNSPECIFIED)</li>
<li ng-if="orderPaymentsForm.all.$error.cant_defer_payment">Cannot save card. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.invalid_processor">No processor found. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.in_store_payment_type_not_found">Cannot create in-store payment, type not found. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.gross_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-UNSPECIFIED)</li>
<li ng-if="orderPaymentsForm.all.$error.charge_amount_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-LOW)</li>
<li ng-if="orderPaymentsForm.all.$error.booking_rebooked">This booking has been rebooked. Please refresh the page.</li>
<li ng-if="orderPaymentsForm.all.$error.cant_charge_card">Cannot charge that card. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.postal_code_not_specified">Payment could not be processed. Billing postal (zip) code is required. Please refresh the page and try again.</li>
<li ng-if="orderPaymentsForm.all.$error.in_store_payment_type_not_authorized">Sorry, you are not authorized to create in-store payments. Please refresh the page and try again.</li>
<li ng-repeat="error in orderPaymentsForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="orderPaymentsForm.all.$error.$tokenization">
<li ng-repeat="error in orderPaymentsForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
<div ng-if="(emv.isDebugging || orderPaymentsForm.all.$error.$providerDeclined) && emv.lastDecline()">
<ul class="errors test-provider-error-indicator respond-print-hide">
<li>
Authorization for this charge was declined.
<div>
<a ng-toggle="printDecline">Print decline receipt</a>
</div>
</li>
</ul>
<div ng-toggled="printDecline">
<button type="button"
ng-print
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide "
>
Print
</button>
<div class="native-receipt">
<div ng-link="emv-decline-receipt"
class="print-receipt"
ng-init="
receipt = emv.lastDecline().merchantReceipt;
label = T('Merchant Receipt')
"
></div>
<div ng-link="emv-decline-receipt"
class="print-receipt"
ng-init="
receipt = emv.lastDecline().customerReceipt;
label = T('Customer Receipt')
"
></div>
</div>
</div>
</div>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green test-submit-payment-form-action"
ng-disabled="
orderPaymentsForm.$invalid ||
orderPaymentsForm.$submitting ||
!paymentCtrl.isCurrentKindValid() ||
!paymentCtrl.isCurrentOptionValid() ||
paymentCtrl.isAmountTooLow()
"
>
Add payment
</button>
</div>
</form>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.REFUND)">
<div ng-controller=
"dashboard.bookings.OrderRefundsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Refunding...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-if="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Refund payments</h2>
</div>
</div>
<form name="refundPaymentsForm" ng-confirm-navigate-away ng-autofocus>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="refundPaymentsForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<span class="select-all">
Select:
<a ng-click="actionsCtrl.selectFullRefunds(editablePayments, orderPayments)"
>all</a>,
<a ng-click="actionsCtrl.unselectPayments(editablePayments, orderPayments)"
>none</a>
</span>
<div ng-repeat="booking in bookingsWithRefundablePayments">
<div class="order-refund-booking">
<div class="order-refund-booking-pk">
Booking #[! booking.pk !]
</div>
<div class="order-refund-booking-ava">
[! booking.availability.item|name !] &bull;
[! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !] &bull;
[! booking.customerBreakdownShort !]
</div>
</div>
<p class="action-sheet-help">
<span class="select-all">
Select:
<a ng-click="actionsCtrl.selectFullRefunds(editablePayments, booking.payments)"
ng-can-create="Refund on booking"
>all</a>,
<a ng-click="actionsCtrl.unselectPayments(editablePayments, booking.payments)"
ng-can-create="Refund on booking"
>none</a>
</span>
</p>
<ul ng-can-create="Refund on booking" class="test-refunds-list-indicator">
<li ng-repeat="payment in booking.payments"
class="refund-form-block"
ng-if="payment.isRefundable == true"
ng-class="{ 'is-selected': actionsCtrl.isPaymentSelected(editablePayments, payment) }"
>
<div class="fields "
>
<div ng-if="Payment.isLegacyProcessorBasedType(payment)" ng-link="dashboard.bookings.paymentLegacyFlag"></div>
<div class="overview-payment"
ng-link="payment-and-refunds"
ng-with="showTotals = true"
></div>
<div ng-if="Payment.isDisputedAndNonRefundable(payment)" ng-then="notSelectable"
class="refund-type-select-wrap"
>
<div class="refund-not-selectable">
Cannot be refunded right now.
<a ng-href="https://fareharbor.com/help/payments/disputes/refunding-a-disputed-charge/" ng-outbound-link="_blank">Learn more</a>
</div>
</div>
<div ng-else="notSelectable"
class="refund-type-select-wrap"
>
<div class="table full-width refund-type-select table-dont-respond valign-middle">
<div class="tr"
ng-with="isPartialRefundSelected = actionsCtrl.isPartialRefundSelected(editablePayments, payment);
isFullRefundSelected = actionsCtrl.isFullRefundSelected(editablePayments, payment)"
>
<div class="td option-dont-refund"
ng-class="{ toggled: !isPartialRefundSelected && !isFullRefundSelected }"
ng-click="actionsCtrl.unselectPayment(editablePayments, payment)"
>
Don&#039;t refund
</div>
<div class="td"
ng-if="Payment.isPartialRefundAllowed(payment)"
ng-class="{ toggled: isPartialRefundSelected }"
ng-click="actionsCtrl.selectPartialRefund(editablePayments, payment)"
>
Partial refund
</div>
<div class="td test-full-refund-indicator"
ng-class="{ toggled: isFullRefundSelected }"
ng-click="actionsCtrl.selectFullRefund(editablePayments, payment)"
>
Full refund
</div>
</div>
</div>
</div>
<fieldset class="refund-choose-amount"
ng-if="actionsCtrl.isPartialRefundSelected(editablePayments, payment)"
>
<div ng-if="payment.receipt.gross">
<table class="refund-amount-table"
ng-autofocus
>
<tr>
<td>
Refund amount:
</td>
<td>
<div class="refundpaymentform-payment-paymentpk-refundgross
field-amount
"
ng-django-field="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-django-field-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-amount-input-max="payment.receipt.gross" ng-amount-input-min="1" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'payment-' + payment.pk " required="required" step="any" type="text" />
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
</tr>
</table>
<div class="tb tb-calculate-refund-flyout"
ng-with="toggleValue = 'refundCalculator-' + payment.pk"
>
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="toggleValue"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate refund amount') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate refund amount</abbr>
</div>
<div class="tb-flyout tb-flyout--left"
ng-toggled ng-toggled-value="toggleValue"
>
<div class="flyout-section flyout-section--no-border">
<h2>
Calculate refund amount
</h2>
<div ng-portion-calculator="payment.receipt.total"
ng-portion-calculator-currency="payment"
ng-portion-calculator-max="payment.receipt.gross"
ng-portion-calculator-model="editablePayments['payment-' + payment.pk + '-' + 'refundGross']"
ng-portion-calculator-labels-for="refund"
ng-portion-calculator-toggle-value="toggleValue"
></div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = toggleValue"></div>
</div>
</div>
</div>
</div>
</fieldset>
<div ng-repeat="error in refundErrors[payment.pk]" class="form-error">
[[ error ]]
</div>
</div>
<div class="hide">
<div class="refundpaymentform-payment-paymentpk-note "
ng-django-field="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" name="note" ng-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-prefix="'payment-' + payment.pk " type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
</ul>
<div class="hint hint-alert"
ng-can-list="Account on booking.company"
ng-can-only-when="booking.company.isDefaultProcessorDefaultBankAccountReadyForUpload && isUploadPossible()"
>
<p>
<b ng-if="refundingCount() === 1" ng-then="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover this refund.
</b>
<b ng-else="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover these refunds.
</b>
Your bank account will be automatically debited.
</p>
<p>
<a ng-href="/help/payments/refunds/">Learn about refunds in FareHarbor &raquo;</a>
</p>
</div>
</div>
<div ng-can-create="Notification on company"
class="refund-email-form"
>
<div class="refundpaymentsform-sendnotification field-cb-email "
ng-django-field="refundPaymentsForm [&#39;sendNotification&#39;]" ng-django-field-model="editablePayments [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="editablePayments [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Send refunded email
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="editablePayments.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="refundpaymentsform-notification-emails "
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="refundpaymentsform-notification-subject "
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="refundpaymentsform-notification-note field-textarea
"
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".refundpaymentsform-notification-note" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
<div ng-if="refundErrors.all">
<ul>
<li ng-repeat="error in refundErrors.all"
class="form-error"
>
[[ error ]]
</li>
</ul>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in refundPaymentsForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green test-refund-order-payments-action"
ng-with="refundTotal = actionsCtrl.refundTotal(editablePayments, orderPayments)"
ng-disabled="refundPaymentsForm.$invalid || refundPaymentsForm.$submitting || !refundTotal"
ng-click="submit(refundPaymentsForm)"
ng-confirm-click="[! T('Refund these payments? There is no undo.') !]"
>
<span ng-if="refundTotal" ng-then="noTotal">
Refund <span ng-amount="refundTotal"></span>
</span>
<span ng-else="noTotal">Refund payments</span>
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.CANCEL)">
<div ng-controller=
"dashboard.bookings.CancelOrderCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Cancelling bookings...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-if="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Cancel bookings</h2>
</div>
</div>
<form class="test-cancel-booking-view-indicator"
name="cancelOrderBookingsForm"
ng-confirm-navigate-away
ng-autofocus
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="cancelOrderBookingsForm.$dirty"
>Close</button>
</span>
<p class="action-sheet-help">
<span class="select-all">
Cancel:
<a ng-click="selectAllBookings()">all</a>,
<a ng-click="unselectAllBookings()">none</a>
</span>
</p>
<div ng-repeat="booking in nonCancelledContributingBookings">
<div class="field field-cb test-select-booking-action"
ng-class="{ 'ng-disabled': (isCompanyCancelEligible && !Booking.isEligibleForCancellation(booking, auth.currentUser)) || !canCancelBooking(booking) }"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="initializeBookingsSelected[booking.pk]"
ng-disabled="(isCompanyCancelEligible && !Booking.isEligibleForCancellation(booking, auth.currentUser)) || !canCancelBooking(booking)"
ng-checked="initializeBookingsSelected[booking.pk]"
>
</span>
<span class="label-text">
Booking #[! booking.pk !]<div class="fh-grey text-small">[! booking.availability.item|name !] &bull; [! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !] &bull; [! booking.customerBreakdownShort !]</div>
</span>
</span>
</label>
</div>
<div ng-can-create="Refund on booking"
ng-can-only-when="getPaymentsFromBooking(booking).length && initializeBookingsSelected[booking.pk]"
ng-then="canDoRefunds"
>
<div ng-if="initializeBookingsSelected[booking.pk] && getPaymentsFromBooking(booking).length">
<p class="action-sheet-help">
<span class="select-all">
Refund:
<a ng-click="actionsCtrl.selectFullRefunds(editablePayments, getPaymentsFromBooking(booking))"
ng-can-create="Refund on booking"
>all</a>,
<a ng-click="actionsCtrl.unselectPayments(editablePayments, getPaymentsFromBooking(booking))"
ng-can-create="Refund on booking"
>none</a>
</span>
</p>
<ul ng-can-create="Refund on booking"
class="test-refunds-list-indicator"
>
<li ng-repeat="payment in getPaymentsFromBooking(booking)"
class="refund-form-block"
ng-if="payment.isRefundable"
ng-class="{ 'is-selected': actionsCtrl.isPaymentSelected(editablePayments, payment) }"
ng-with="refundErrors=bookingRefundErrors[booking.pk]"
>
<div class="fields "
>
<div ng-if="Payment.isLegacyProcessorBasedType(payment)" ng-link="dashboard.bookings.paymentLegacyFlag"></div>
<div class="overview-payment"
ng-link="payment-and-refunds"
ng-with="showTotals = true"
></div>
<div ng-if="Payment.isDisputedAndNonRefundable(payment)" ng-then="notSelectable"
class="refund-type-select-wrap"
>
<div class="refund-not-selectable">
Cannot be refunded right now.
<a ng-href="https://fareharbor.com/help/payments/disputes/refunding-a-disputed-charge/" ng-outbound-link="_blank">Learn more</a>
</div>
</div>
<div ng-else="notSelectable"
class="refund-type-select-wrap"
>
<div class="table full-width refund-type-select table-dont-respond valign-middle">
<div class="tr"
ng-with="isPartialRefundSelected = actionsCtrl.isPartialRefundSelected(editablePayments, payment);
isFullRefundSelected = actionsCtrl.isFullRefundSelected(editablePayments, payment)"
>
<div class="td option-dont-refund"
ng-class="{ toggled: !isPartialRefundSelected && !isFullRefundSelected }"
ng-click="actionsCtrl.unselectPayment(editablePayments, payment)"
>
Don&#039;t refund
</div>
<div class="td"
ng-if="Payment.isPartialRefundAllowed(payment)"
ng-class="{ toggled: isPartialRefundSelected }"
ng-click="actionsCtrl.selectPartialRefund(editablePayments, payment)"
>
Partial refund
</div>
<div class="td test-full-refund-indicator"
ng-class="{ toggled: isFullRefundSelected }"
ng-click="actionsCtrl.selectFullRefund(editablePayments, payment)"
>
Full refund
</div>
</div>
</div>
</div>
<fieldset class="refund-choose-amount"
ng-if="actionsCtrl.isPartialRefundSelected(editablePayments, payment)"
>
<div ng-if="payment.receipt.gross">
<table class="refund-amount-table"
ng-autofocus
>
<tr>
<td>
Refund amount:
</td>
<td>
<div class="refundpaymentform-refund-payments-for-booking-paymentbookingpk-payment-paymentpk-refundgross
field-amount
"
ng-django-field="refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-django-field-model="editablePayments [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-amount-input-max="payment.receipt.gross" ng-amount-input-min="1" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editablePayments [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'refund-payments-for-booking-' + payment.booking.pk + '-payment-' + payment.pk " required="required" step="any" type="text" />
<span class="field-style-hook">
[! (order || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
</tr>
</table>
<div class="tb tb-calculate-refund-flyout"
ng-with="toggleValue = 'refundCalculator-' + payment.pk"
>
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="toggleValue"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate refund amount') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate refund amount</abbr>
</div>
<div class="tb-flyout tb-flyout--left"
ng-toggled ng-toggled-value="toggleValue"
>
<div class="flyout-section flyout-section--no-border">
<h2>
Calculate refund amount
</h2>
<div ng-portion-calculator="payment.receipt.total"
ng-portion-calculator-currency="payment"
ng-portion-calculator-max="payment.receipt.gross"
ng-portion-calculator-model="editablePayments['payment-' + payment.pk + '-' + 'refundGross']"
ng-portion-calculator-labels-for="refund"
ng-portion-calculator-toggle-value="toggleValue"
></div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = toggleValue"></div>
</div>
</div>
</div>
</div>
</fieldset>
<div ng-repeat="error in refundErrors[payment.pk]" class="form-error">
[[ error ]]
</div>
</div>
<div class="hide">
<div class="refundpaymentform-refund-payments-for-booking-paymentbookingpk-payment-paymentpk-note "
ng-django-field="refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" name="note" ng-model="editablePayments [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-prefix="'refund-payments-for-booking-' + payment.booking.pk + '-payment-' + payment.pk " type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentForm [&#39;refund-payments-for-booking-&#39; + payment.booking.pk + &#39;-payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
</ul>
</div>
<div ng-if="!canDoRefunds && getPaymentsFromBooking(booking).length" class="form-error">
This booking has un-refunded payments but you are not allowed to refund them. You <i>are</i> still allowed to cancel the booking.
</div>
</div>
<div ng-if="nonZeroGeneratedStoredValueCards(booking).length" class="form-error">
This booking has unused gift cards; cancelling this booking <i>will not</i> cancel the gift cards.
</div>
<div ng-if="!!cancelErrors[booking.pk]">
<ul>
<li ng-repeat="error in cancelErrors[booking.pk]"
class="form-error"
>
[[ error ]]
</li>
</ul>
</div>
</div>
<div class="hint hint-alert"
ng-can-list="Account on order.company"
ng-can-only-when="order.company.isDefaultProcessorDefaultBankAccountReadyForUpload && isUploadPossible()"
>
<p>
<b ng-if="refundingCount() === 1" ng-then="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover this refund.
</b>
<b ng-else="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover these refunds.
</b>
Your bank account will be automatically debited.
</p>
<p>
<a ng-href="/help/payments/refunds/">Learn about refunds in FareHarbor &raquo;</a>
</p>
</div>
<br>
<div class="fields "
>
<div class="cancelorderbookingsform-note field-textarea "
ng-django-field="cancelOrderBookingsForm [&#39;note&#39;]" ng-django-field-model="cancelOrderData [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-model="cancelOrderData [&#39;note&#39;]" ng-placeholder="Note about why you are cancelling (optional, not visible to customer)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-can-create="Notification on company">
<div class="cancelorderbookingsform-sendnotification field-cb-email "
ng-django-field="cancelOrderBookingsForm [&#39;sendNotification&#39;]" ng-django-field-model="cancelOrderData [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="cancelOrderData [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Send cancellation email
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="cancelOrderData.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="cancelorderbookingsform-notification-emails "
ng-django-field="cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelorderbookingsform-notification-subject "
ng-django-field="cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelorderbookingsform-notification-note field-textarea
"
ng-django-field="cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".cancelorderbookingsform-notification-note" ng-model="cancelOrderData [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div class="cancelorderbookingsform-refundgross "
ng-django-field="cancelOrderBookingsForm [&#39;refundGross&#39;]" ng-django-field-model="cancelOrderData [&#39;refundGross&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cancelOrderData [&#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cancelOrderBookingsForm [&#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cancelOrderBookingsForm [&#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cancelOrderBookingsForm [&#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelorderbookingsform-iscanceleligible "
ng-django-field="cancelOrderBookingsForm [&#39;isCancelEligible&#39;]" ng-django-field-model="cancelOrderData [&#39;isCancelEligible&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_cancel_eligible" name="isCancelEligible" ng-model="cancelOrderData [&#39;isCancelEligible&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;isCancelEligible&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelorderbookingsform-isonline "
ng-django-field="cancelOrderBookingsForm [&#39;isOnline&#39;]" ng-django-field-model="cancelOrderData [&#39;isOnline&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_online" name="isOnline" ng-model="cancelOrderData [&#39;isOnline&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelOrderBookingsForm [&#39;isOnline&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="btns">
<button class="btn-big btn-red btn-wide test-cancel-booking-action"
ng-with="refundTotal = actionsCtrl.refundTotal(editablePayments, orderPayments)"
ng-disabled="!isAnyEligibleBookingSelected() || (cancelOrderBookingsForm.$invalid || cancelOrderBookingsForm.$submitting)"
ng-click="submit(cancelOrderBookingsForm)"
ng-confirm-click="[! T('Cancel this booking and refund payments? There is no undo.') !]"
ng-confirm-click-when="refundTotal || isCancelEligiblePaymentsInSelectedBookings()"
>
<span ng-if="refundTotal || isCancelEligiblePaymentsInSelectedBookings()" ng-then="refundHasTotals">
<span ng-if="isCancelEligiblePaymentsInSelectedBookings()">
Cancel bookings and refund payments
</span>
<span ng-else="isCancelEligiblePaymentsInSelectedBookings()">
Cancel bookings and refund <span ng-amount="refundTotal" ng-amount-currency="order"></span>
</span>
</span>
<span ng-else="refundHasTotals">Cancel bookings</span>
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.PRINT_RECEIPT)">
<div ng-controller="dashboard.bookings.ReceiptsCtrl as receiptsCtrl"
ng-init="receiptsCtrl.paymentsSet = null;"
>
<div class="action-sheet-header respond-print-hide">
<div class="action-sheet-header-content">
<h2>
<a ng-if="!toggles.state('receiptsMenu')"
class="btn-back"
ng-toggle="receiptsMenu"
ng-toggle-group="receipts"
>Back</a>
Print
</h2>
<a ng-href="https://fareharbor.com/help/dashboard/receipts-and-tickets/printing/"
ng-outbound-link="_blank"
class="hint-help-link"
ng-if="toggles.state('receiptsMenu')"
>Get help with printing &rsaquo;</a>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
>Close</button>
</span>
<div class="respond-print-hide"
ng-show="toggles.state('receiptsMenu')"
>
<div ng-toggle="receiptsMenu"
ng-toggle-group="receipts"
ng-toggle-default="!receiptsCtrl.isPreselecting"
></div>
<div ng-toggled="receiptsMenu" ng-body-class="'body-print-booking'"></div>
<ul class="list-filters list-filters--with-spacing"
ng-show="company.isBocaEnabled || company.isReceiptsEnabled"
>
<li ng-toggle="bocaFormat"
ng-toggle-default="receiptsCtrl.preferredPrintFormat === TicketLayout.BOCA_PRINT_FORMAT"
ng-toggle-group="ticketFormats"
ng-click="receiptsCtrl.savePreferredPrintFormat(TicketLayout.BOCA_PRINT_FORMAT)"
ng-if-once="company.isBocaEnabled"
>
Boca Format
</li>
<li ng-toggle="receiptFormat"
ng-toggle-default="receiptsCtrl.preferredPrintFormat === TicketLayout.RECEIPT_PRINT_FORMAT"
ng-toggle-group="ticketFormats"
ng-click="receiptsCtrl.savePreferredPrintFormat(TicketLayout.RECEIPT_PRINT_FORMAT)"
ng-if-once="company.isReceiptsEnabled"
>
Receipt Format
</li>
<li ng-toggle="otherOptions"
ng-toggle-default="!company.isBocaEnabled && !company.isReceiptsEnabled"
ng-toggle-group="ticketFormats"
>
Other Options
</li>
</ul>
<div ng-if-once="company.isBocaEnabled">
<div ng-toggled="bocaFormat">
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showWholeParty: true })"
class="table-nav-item is-tall with-chevron"
>
All whole party tickets
</div>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true })"
class="table-nav-item is-tall with-chevron"
>
All individual tickets
</div>
<div ng-can-view-amounts="order.company"
ng-can-only-when="Payment.printablePayments(order.aggregatedPayments).length"
>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-if-once="order.aggregatedPayments"
ng-click="receiptsCtrl.preparePrinting({ showWholeParty: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
All whole party tickets + payment receipts
</div>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-if-once="order.aggregatedPayments"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
All individual tickets + payment receipts
</div>
<div ng-repeat="payment in Payment.sortByCreatedAt(order.aggregatedPayments)"
ng-toggle="bocaDisplay"
ng-click="receiptsCtrl.preparePrinting({ activePayment: payment })"
ng-toggle-group="receipts"
ng-init="receiptsCtrl.isPreselecting && $first && receiptsCtrl.preparePrinting({ activePayment: payment, toggle: 'bocaDisplay' })"
>
<div ng-if="!payment.isDeferred && payment.type !== Payment.AFFILIATE_TYPE"
class="table-nav-item is-tall with-chevron"
>
<ul>
<li ng-amount="payment.initialReceipt.gross + payment.initialReceipt.bookingFee"
ng-amount-company="payment.company"
class="bold"
></li>
<li ng-if-once="payment.isCardOnFile" ng-then="isCardOnFile">
<span class="fh-grey">From company card:</span> <b>[! payment.cardName !]</b>
</li>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<span class="fh-grey">From:</span> [! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]
</span>
<li ng-if-once="!ccPayment && !isCardOnFile">
<span class="fh-grey">Type:</span> [! payment.displayType !]
</li>
<li>
<span ng-if-once="payment.isRefunded" class="badge nowrap">
Refunded
</span>
<span class="fh-grey">
[! payment.createdAt|datetime !]
</span>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="company.isReceiptsEnabled">
<div ng-toggled="receiptFormat">
<div ng-toggle="orderReceipt"
ng-toggle-group="receipts"
class="table-nav-item is-tall with-chevron"
>
Order receipt
</div>
<div ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true })"
class="table-nav-item is-tall with-chevron"
>
All tickets
</div>
<div ng-can-view-amounts="order.company">
<div ng-if-once="Payment.printablePayments(order.aggregatedPayments).length">
<div ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-if-once="order.aggregatedPayments"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
All tickets + payment receipts
</div>
<div ng-repeat="payment in Payment.sortByCreatedAt(order.aggregatedPayments)"
ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ activePayment: payment })"
ng-init="receiptsCtrl.isPreselecting && $first && receiptsCtrl.preparePrinting({ activePayment: payment, toggle: 'receiptDisplay' })"
>
<div ng-if="!payment.isDeferred && payment.type !== Payment.AFFILIATE_TYPE"
class="table-nav-item is-tall with-chevron"
>
<ul>
<li ng-amount="payment.initialReceipt.gross + payment.initialReceipt.bookingFee"
ng-amount-company="payment.company"
class="bold"
></li>
<li ng-if-once="payment.isCardOnFile" ng-then="isCardOnFile">
<span class="fh-grey">From company card:</span> <b>[! payment.cardName !]</b>
</li>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<span class="fh-grey">From:</span> [! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]
</span>
<li ng-if-once="!ccPayment && !isCardOnFile">
<span class="fh-grey">Type:</span> [! payment.displayType !]
</li>
<li>
<span ng-if-once="payment.isRefunded" class="badge nowrap">
Refunded
</span>
<span class="fh-grey">
[! payment.createdAt|datetime !]
</span>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-toggled="otherOptions">
<a class="table-nav-item is-tall with-chevron"
ng-print
>Print this page</a>
<a ng-href="[! order.$url(urls.company.order.index) !]"
class="table-nav-item is-tall with-chevron"
>Customer confirmation page</a>
</div>
</div>
<div ng-toggled="bocaDisplay">
<div ng-controller=
"dashboard.settings.ticketLayouts.TicketLayoutViewCtrl as ticketLayoutViewCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<ul class="buttons-list respond-print-hide">
<li>
<div class="btns btns--combo">
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide [[ addClassIf(ticketLayoutViewCtrl.needsPrintSettings(), 'btn-segment-left') ]]"
>
Print
</button>
<div class="btn-segment-right-wrap" ng-if="ticketLayoutViewCtrl.needsPrintSettings()">
<div class="btn-big btn-black btn-flyout btn-segment-right active-when-toggled"
ng-toggle="ticketOptionsForm" ng-toggle-auto-close
ng-tip="[! T('Print settings') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon cog-white"></i>
</div>
<div ng-toggled="ticketOptionsForm"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-inner">
<div ng-if-once="ticketLayoutViewCtrl.ticketLayouts.length > 0">
<div class="field "
>
<label>
<span class="label-text">
Ticket layout
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="ticketLayout.pk as ticketLayout.name for ticketLayout in ticketLayoutViewCtrl.ticketLayouts"
ng-model="ticketLayoutViewCtrl.selectedTicketLayoutPk"
ng-change="ticketLayoutViewCtrl.changeTicketLayout()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<div ng-if="!!activePayment && (activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment.isProcessorBasedType)">
<div class="field "
>
<label>
<span class="label-text">
Credit card receipt copies
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="receiptCopyType.id as receiptCopyType.display for receiptCopyType in ticketLayoutViewCtrl.receiptCopyTypes"
ng-model="ticketLayoutViewCtrl.selectedReceiptCopyType"
ng-change="ticketLayoutViewCtrl.changeReceiptCopyType()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
</li>
</ul>
<div ng-init="ticketLayoutViewCtrl.printType = TicketLayout.BOCA_PRINT_FORMAT"></div>
<div ng-boca-styles-for-layout="ticketLayoutViewCtrl.selectedTicketLayout"></div>
<div class="native-receipt">
<div ng-if="showWholeParty">
<div ng-repeat="booking in order.contributingBookings">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
[! booking.customerBreakdown !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
<div class="boca-main">
<div class="table boca-main-content-wrapper full-width">
<div class="tr">
<div class="td boca-main-content">
<div class="table full-width">
<div class="tr">
<div class="td boca-qr"
ng-qr-code="[[ booking.customers[0]|checkinUrl ]]"
ng-if-once="booking.item.isScanningEnabled"
></div>
<div class="td boca-main-text">
<div ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.isCompanyInformationIncluded">
<h2 class="boca-header-large">[! booking.company.name !]</h2>
<div class="boca-section">
<span ng-if="booking.company.phone">[! booking.company.phone !]</span>
<span ng-if="booking.company.phone && booking.company.url">&bull;</span>
<span ng-if="booking.company.url">[! booking.company.url|hostname !]</span>
</div>
</div>
<h3 class="boca-header-med">
[! booking.item.name !]
<span ng-bind="!!booking.availability.headline ? ' &mdash; ' + booking.availability.headline : ''"></span>
</h3>
<h3 class="boca-header-med">
<b>
[! booking.customerBreakdown !]
</b>
&mdash; [! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</h3>
<div>
Booking #[! booking.pk !] &bull; <b>Name:</b> [! booking.contact.name !]
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tr"
ng-if-once="booking.item.receiptFooterSafeHtml"
>
<div class="td boca-fine-print md-inline"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
[! booking.customerBreakdown !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
</div>
</div>
</div>
</div>
</div>
<div ng-if="showTickets">
<div ng-repeat="booking in order.contributingBookings">
<div ng-repeat="customer in booking.customers">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
1 [! customer.name !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
<div class="boca-main">
<div class="table boca-main-content-wrapper full-width">
<div class="tr">
<div class="td boca-main-content">
<div class="table full-width">
<div class="tr">
<div class="td boca-qr"
ng-qr-code="[[ customer|checkinUrl ]]"
ng-if-once="booking.item.isScanningEnabled"
></div>
<div class="td boca-main-text">
<div ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.isCompanyInformationIncluded">
<h2 class="boca-header-large">[! booking.company.name !]</h2>
<div class="boca-section">
<span ng-if="booking.company.phone">[! booking.company.phone !]</span>
<span ng-if="booking.company.phone && booking.company.url">&bull;</span>
<span ng-if="booking.company.url">[! booking.company.url|hostname !]</span>
</div>
</div>
<h3 class="boca-header-med">
[! booking.item.name !]
<span ng-bind="!!booking.availability.headline ? ' &mdash; ' + booking.availability.headline : ''"></span>
</h3>
<h3 class="boca-header-med">
<b>
1 [! customer.name !]
</b>
&mdash; [! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</h3>
<div>
Booking #[! booking.pk !] &bull; <b>Name:</b> [! booking.contact.name !]
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tr"
ng-if-once="booking.item.receiptFooterSafeHtml"
>
<div class="td boca-fine-print md-inline"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
1 [! customer.name !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-repeat="payment in Payment.printablePayments(order.aggregatedPayments)"
ng-if="activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment === payment"
>
<div ng-if="payment.isProcessorBasedType && (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.MERCHANT_COPY
)">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
boca-ticket--receipt
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
<div class="boca-main">
<div class="boca-receipt-company-info"
ng-if="!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
<div class="boca-receipt-summary-container"
ng-class="{ 'boca-receipt-summary-container--with-company-info':
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub }
">
<div class="boca-receipt-summary">
<div class="boca-section">
<ul ng-if-once="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="hasMultipleContributingBooking"
>
<li><b>[! payment.company.name !]</b></li>
<li ng-if-once="Payment.order(payment)">
Order #[! Payment.order(payment).identifier !]
</li>
</ul>
<ul ng-else-once="hasMultipleContributingBooking"
ng-init="booking = payment.booking || payment.bookings[0]"
>
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if-once="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</li>
<li>
Booking #[! booking.pk !]
</li>
</ul>
</div>
<div class="boca-section">
<table class="boca-receipt-charges">
<tbody>
<tr>
<td>
<span ng-if-once="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if-once="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<span class="boca-ticket-small-text">
([! payment.createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="payment.initialReceipt.total"></td>
</tr>
</tbody>
<tbody ng-if-once="payment.refundCount > 0">
<tr>
<td>
[! nT('Refund', 'Refunds', payment.refundCount) !]
<span class="boca-ticket-small-text" ng-if-once="payment.refundCount === 1">
([! payment.refunds[0].createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="-(payment.refunds|summary:'receipt.total')"></td>
</tr>
<tr>
<td class="bold">Paid</td>
<td class="text-right" ng-amount="payment.receipt.total"></td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-signature">
<p class="print-receipt-text">
Cardholder will pay above amount to card issuer pursuant to cardholder agreement. Cardholder signature:
</p>
<div class="print-receipt-signature-line">x</div>
</div>
</div>
<div class="boca-receipt-emv-details"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Merchant Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
</div>
</div>
</div>
</div>
<div ng-if="!payment.isProcessorBasedType || (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.CUSTOMER_COPY
)">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
boca-ticket--receipt
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
<div class="boca-main">
<div class="boca-receipt-company-info"
ng-if="!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
<div class="boca-receipt-summary-container"
ng-class="{ 'boca-receipt-summary-container--with-company-info':
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub }
">
<div class="boca-receipt-summary">
<div class="boca-section">
<ul ng-if-once="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="hasMultipleContributingBooking"
>
<li><b>[! payment.company.name !]</b></li>
<li ng-if-once="Payment.order(payment)">
Order #[! Payment.order(payment).identifier !]
</li>
</ul>
<ul ng-else-once="hasMultipleContributingBooking"
ng-init="booking = payment.booking || payment.bookings[0]"
>
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if-once="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</li>
<li>
Booking #[! booking.pk !]
</li>
</ul>
</div>
<div class="boca-section">
<table class="boca-receipt-charges">
<tbody>
<tr>
<td>
<span ng-if-once="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if-once="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<span class="boca-ticket-small-text">
([! payment.createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="payment.initialReceipt.total"></td>
</tr>
</tbody>
<tbody ng-if-once="payment.refundCount > 0">
<tr>
<td>
[! nT('Refund', 'Refunds', payment.refundCount) !]
<span class="boca-ticket-small-text" ng-if-once="payment.refundCount === 1">
([! payment.refunds[0].createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="-(payment.refunds|summary:'receipt.total')"></td>
</tr>
<tr>
<td class="bold">Paid</td>
<td class="text-right" ng-amount="payment.receipt.total"></td>
</tr>
</tbody>
</table>
</div>
<div class="md-inline"
ng-if-once="booking.item.receiptFooterSafeHtml"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
<div class="boca-receipt-emv-details"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Customer Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-toggled="receiptDisplay">
<div ng-controller=
"dashboard.settings.ticketLayouts.TicketLayoutViewCtrl as ticketLayoutViewCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<ul class="buttons-list respond-print-hide">
<li>
<div class="btns btns--combo">
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide [[ addClassIf(ticketLayoutViewCtrl.needsPrintSettings(), 'btn-segment-left') ]]"
>
Print
</button>
<div class="btn-segment-right-wrap" ng-if="ticketLayoutViewCtrl.needsPrintSettings()">
<div class="btn-big btn-black btn-flyout btn-segment-right active-when-toggled"
ng-toggle="ticketOptionsForm" ng-toggle-auto-close
ng-tip="[! T('Print settings') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon cog-white"></i>
</div>
<div ng-toggled="ticketOptionsForm"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-inner">
<div ng-if="!!activePayment && (activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment.isProcessorBasedType)">
<div class="field "
>
<label>
<span class="label-text">
Credit card receipt copies
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="receiptCopyType.id as receiptCopyType.display for receiptCopyType in ticketLayoutViewCtrl.receiptCopyTypes"
ng-model="ticketLayoutViewCtrl.selectedReceiptCopyType"
ng-change="ticketLayoutViewCtrl.changeReceiptCopyType()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
</li>
</ul>
<div class="native-receipt">
<div ng-if="showWholeParty">
</div>
<div ng-if="showTickets">
<div ng-repeat="booking in order.contributingBookings">
<div ng-repeat="customer in booking.customers">
<div class="print-receipt">
<div class="print-receipt-section" ng-init="company = booking.company">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>
Booking #[! booking.pk !]</b></li>
<li>[! booking.contact.name !]</li>
<li>Total passengers: <b>[! booking.customerCount !]</b>
</ul>
<ul class="print-receipt-list">
<li>
<b>[[ booking.item.name ]]</b>
<span ng-if="availability.headline">&mdash; [[ availability.headline ]]</span>
</li>
<li>
[[ booking.availability.startAt|datetime:(booking.availability.endAt) ]]
</li>
<li>[! customer.name !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-link="receipt-customer-with-custom-field-values"
></table>
</div>
<div class="print-receipt-section text-center md-inline"
ng-if-once="booking.item.receiptFooterSafeHtml"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
</div>
<div ng-repeat="payment in Payment.printablePayments(order.aggregatedPayments)"
ng-if="activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment === payment"
>
<div ng-if="payment.isProcessorBasedType && (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.MERCHANT_COPY
)">
<div class="print-receipt">
<div class="print-receipt-section">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="Payment.isEmv(payment)"
ng-with="addressObject = company.primaryLocation || company"
ng-link="physical-address"
></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>[! contact.name !]</b></li>
<li ng-if="contact.phone">[! contact|contactPhone !]</li>
<li ng-if="contact.email">[! contact.email !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-init="
payments = [ payment ];
taxByType = Payment.taxByType(payment);
"
>
<tbody ng-repeat="payment in payments|orderBy:'createdAt'">
<tr>
<td>
<ul class="print-receipt-list">
<li>
<span ng-if="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
</li>
<li>
[! payment.createdAt|datetime !]
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="payment.initialReceipt.total"
ng-amount-company="payment.company"
></td>
</tr>
<tr ng-repeat="refund in payment.refunds|orderBy:'createdAt'">
<td class="left-indent">
<ul class="print-receipt-list">
<li>Refund</li>
<li>[! refund.createdAt|datetime !]</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="-refund.receipt.total"
ng-amount-company="refund.payment.company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium">
<tr>
<td class="bold text-right">Paid</td>
<td class="print-receipt-amount text-right"
ng-amount="payments|summary:'receipt.total'"
ng-amount-company="company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium"
ng-if="taxByType"
>
<tr ng-repeat="taxType in taxTypes"
ng-if="taxByType[taxType.pk]"
>
<td class="text-right"><b>[! taxType.name !]</b></td>
<td class="print-receipt-amount text-right"
ng-amount="taxByType[taxType.pk]"
ng-amount-currency="payment"
></td>
</tr>
</tbody>
<tbody class="spreadsheet-text-medium">
<tr>
<td colspan="2">
<div ng-if="Payment.isGratuityEnabled(payment)" ng-then="isGratuityEnabled">
<div>
<p class="print-receipt-text">
Thank you! Tip is not included. If you would like to add gratuity please note it here:
</p>
<div class="receipt-tip">
<table>
<tr>
<td>Tip:</td>
<td></td>
</tr>
<tr class="receipt-tip-total">
<td>Total:</td>
<td></td>
</tr>
</table>
</div>
</div>
</div>
<div ng-if="payment.isProcessorBasedType" ng-then="isProcessorBasedType">
<p ng-if="!Payment.isGratuityEnabled(payment)" class="print-receipt-text">
Thank you!
</p>
<div class="print-receipt-signature">
<p class="print-receipt-text">
Cardholder will pay above amount to card issuer pursuant to cardholder agreement. Cardholder signature:
</p>
<div class="print-receipt-signature-line">x</div>
</div>
</div>
<span ng-else="isProcessorBasedType || isGratuityEnabled">
&nbsp;
</span>
</td>
</tr>
</tbody>
<tbody>
<tr class="spreadsheet-text-small">
<td colspan="2">
<aside ng-if="Payment.hasMultipleVisibleContributingBookings(payment)">
Order #[! Payment.order(payment).identifier !]
</aside>
<h3 ng-if="payment.isRefunded" ng-then="paymentIsRefunded">
Original payment for:
</h3>
<h3 ng-else="paymentIsRefunded">
Payment for:
</h3>
</td>
</tr>
</tbody>
<tbody ng-if="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="paymentHasMultipleVisibleContributingBookings"
>
<tr ng-repeat="subPayment in payment.payments">
<td ng-init="booking = subPayment.booking"
colspan="[! payment.isRefunded ? 2 : 1 !]"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="subPayment.receipt.total"
ng-amount-company="subPayment.company"
></td>
</tr>
<tr ng-if="payment.invisibleBookingCount">
<td colspan="[! payment.isRefunded ? 2 : 1 !]">
[! interpolate(nT('%(count)s other booking', '%(count)s other bookings', payment.invisibleBookingCount), { count: payment.invisibleBookingCount }) !]
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="payment.invisibleReceipt.total"
ng-amount-company="order.company"
></td>
</tr>
</tbody>
<tbody ng-else="paymentHasMultipleVisibleContributingBookings">
<tr>
<td ng-if="payment.bookings" ng-then="paymentIsAggregated"
ng-init="booking = payment.bookings[0]"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-else="paymentIsAggregated"
ng-init="booking = payment.booking"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-if="Payment.receiptFooters(payment).length > 0" ng-then="receiptFooters"
class="print-receipt-section item-receipt-footer"
>
<div ng-repeat="item in Payment.items(payment)">
<div ng-if="item.receiptFooter">
<div class="print-receipt-text text-center md-inline"
ng-if-once="item.receiptFooterSafeHtml"
ng-bind-html-once="item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<div ng-else="receiptFooters">
<div ng-if="!Payment.isGratuityEnabled(payment) && !payment.isProcessorBasedType"
class="print-receipt-section item-receipt-footer"
>
<p class="print-receipt-text text-center">
Thanks for your payment!
</p>
</div>
</div>
<div class="print-receipt-section"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Merchant Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-footer">
[[ Receipt.printedAt()|datetime ]]
</div>
</div>
</div>
<div ng-if="!payment.isProcessorBasedType || (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.CUSTOMER_COPY
)">
<div class="print-receipt">
<div class="print-receipt-section">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="Payment.isEmv(payment)"
ng-with="addressObject = company.primaryLocation || company"
ng-link="physical-address"
></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>[! contact.name !]</b></li>
<li ng-if="contact.phone">[! contact|contactPhone !]</li>
<li ng-if="contact.email">[! contact.email !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-init="
payments = [ payment ];
taxByType = Payment.taxByType(payment);
"
>
<tbody ng-repeat="payment in payments|orderBy:'createdAt'">
<tr>
<td>
<ul class="print-receipt-list">
<li>
<span ng-if="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
</li>
<li>
[! payment.createdAt|datetime !]
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="payment.initialReceipt.total"
ng-amount-company="payment.company"
></td>
</tr>
<tr ng-repeat="refund in payment.refunds|orderBy:'createdAt'">
<td class="left-indent">
<ul class="print-receipt-list">
<li>Refund</li>
<li>[! refund.createdAt|datetime !]</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="-refund.receipt.total"
ng-amount-company="refund.payment.company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium">
<tr>
<td class="bold text-right">Paid</td>
<td class="print-receipt-amount text-right"
ng-amount="payments|summary:'receipt.total'"
ng-amount-company="company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium"
ng-if="taxByType"
>
<tr ng-repeat="taxType in taxTypes"
ng-if="taxByType[taxType.pk]"
>
<td class="text-right"><b>[! taxType.name !]</b></td>
<td class="print-receipt-amount text-right"
ng-amount="taxByType[taxType.pk]"
ng-amount-currency="payment"
></td>
</tr>
</tbody>
<tbody class="spreadsheet-text-medium">
<tr>
<td colspan="2">
<div ng-if="Payment.isGratuityEnabled(payment)" ng-then="isGratuityEnabled">
<div>
<p class="print-receipt-text">
Thank you! Tip is not included. If you would like to add gratuity please note it here:
</p>
<div class="receipt-tip">
<table>
<tr>
<td>Tip:</td>
<td></td>
</tr>
<tr class="receipt-tip-total">
<td>Total:</td>
<td></td>
</tr>
</table>
</div>
</div>
</div>
<div ng-if="payment.isProcessorBasedType" ng-then="isProcessorBasedType">
<p ng-if="!Payment.isGratuityEnabled(payment)" class="print-receipt-text">
Thank you!
</p>
</div>
<span ng-else="isProcessorBasedType || isGratuityEnabled">
&nbsp;
</span>
</td>
</tr>
</tbody>
<tbody>
<tr class="spreadsheet-text-small">
<td colspan="2">
<aside ng-if="Payment.hasMultipleVisibleContributingBookings(payment)">
Order #[! Payment.order(payment).identifier !]
</aside>
<h3 ng-if="payment.isRefunded" ng-then="paymentIsRefunded">
Original payment for:
</h3>
<h3 ng-else="paymentIsRefunded">
Payment for:
</h3>
</td>
</tr>
</tbody>
<tbody ng-if="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="paymentHasMultipleVisibleContributingBookings"
>
<tr ng-repeat="subPayment in payment.payments">
<td ng-init="booking = subPayment.booking"
colspan="[! payment.isRefunded ? 2 : 1 !]"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="subPayment.receipt.total"
ng-amount-company="subPayment.company"
></td>
</tr>
<tr ng-if="payment.invisibleBookingCount">
<td colspan="[! payment.isRefunded ? 2 : 1 !]">
[! interpolate(nT('%(count)s other booking', '%(count)s other bookings', payment.invisibleBookingCount), { count: payment.invisibleBookingCount }) !]
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="payment.invisibleReceipt.total"
ng-amount-company="order.company"
></td>
</tr>
</tbody>
<tbody ng-else="paymentHasMultipleVisibleContributingBookings">
<tr>
<td ng-if="payment.bookings" ng-then="paymentIsAggregated"
ng-init="booking = payment.bookings[0]"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-else="paymentIsAggregated"
ng-init="booking = payment.booking"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-if="Payment.receiptFooters(payment).length > 0" ng-then="receiptFooters"
class="print-receipt-section item-receipt-footer"
>
<div ng-repeat="item in Payment.items(payment)">
<div ng-if="item.receiptFooter">
<div class="print-receipt-text text-center md-inline"
ng-if-once="item.receiptFooterSafeHtml"
ng-bind-html-once="item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<div ng-else="receiptFooters">
<div ng-if="!Payment.isGratuityEnabled(payment) && !payment.isProcessorBasedType"
class="print-receipt-section item-receipt-footer"
>
<p class="print-receipt-text text-center">
Thanks for your payment!
</p>
</div>
</div>
<div class="print-receipt-section"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Customer Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-footer">
[[ Receipt.printedAt()|datetime ]]
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-toggled="orderReceipt"
ng-toggle-group="receipts"
>
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide "
>
Print
</button>
<div class="print-receipt native-receipt">
<div class="print-receipt-section" ng-init="company = order.company">
<ul>
<li ng-if-once="company.imageEmailCdnUrl || company.imageCdnUrl">
<img ng-image="company.imageEmailCdnUrl || company.imageCdnUrl"
ng-image-max-height="250"
alt="[! company.name !]"
class="receipt-logo"
/>
</li>
<li><b>[! company.name !]</b></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>
Order #[! order.identifier !]</b></li>
<li>[! order.contact.name !]</li>
<li ng-if="order.contact.phone">[! order.contact|contactPhone !]</li>
<li ng-if="order.contact.email">[! order.contact.email !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet" ng-init="payments = order.aggregatedPayments">
<tbody>
<tr ng-repeat="booking in order.allBookings">
<td>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="booking.isContributing ? (booking.costs.totalCost.price || 0) : 0"
ng-amount-company="booking.company"
></td>
</tr>
<tr ng-if="order.invisibleBookingCount">
<td>
[! interpolate(nT('%(count)s other booking', '%(count)s other bookings', order.invisibleBookingCount), { count: order.invisibleBookingCount }) !]
</td>
<td class="print-receipt-amount text-right"
ng-amount="order.invisibleBookingCosts.totalCost.price"
ng-amount-company="order.company"
></td>
</tr>
</tbody>
<tbody
ng-init="
hasExplicitGross = false;
costs = order.contributingBookingCosts;
fee = order.receipt.bookingFee;
company = order.company;
showTaxByType = Order.showTaxByType(order);
showZeroTax = !Order.isNoTax(order);
"
ng-inline="receipt-subtotal-total"
>
</tbody>
<tbody>
<tr><td colspan="2">&nbsp;</td></tr>
</tbody>
<tbody ng-repeat="payment in payments|orderBy:'createdAt'">
<tr>
<td>
<ul class="print-receipt-list">
<li>
<span ng-if="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
</li>
<li>
[! payment.createdAt|datetime !]
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="payment.initialReceipt.total"
ng-amount-company="payment.company"
></td>
</tr>
<tr ng-repeat="refund in payment.refunds|orderBy:'createdAt'">
<td class="left-indent">
<ul class="print-receipt-list">
<li>Refund</li>
<li>[! refund.createdAt|datetime !]</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="-refund.receipt.total"
ng-amount-company="refund.payment.company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium">
<tr>
<td class="bold text-right">Paid</td>
<td class="print-receipt-amount text-right"
ng-amount="payments|summary:'receipt.total'"
ng-amount-company="company"
></td>
</tr>
</tbody>
<tbody ng-if="order.company.features.isAmountDueOnReceiptsEnabled && order.amountDue" ng-then="isOrderAmountDue">
<tr>
<td colspan="100">&nbsp;</td>
</tr>
</tbody>
<tbody ng-if="isOrderAmountDue"
ng-inline="order-receipt-amount-due"
></tbody>
</table>
</div>
<div class="print-receipt-section item-receipt-footer">
<div class="print-receipt-text text-center">
[! Order.receiptFooter(order) !]
</div>
</div>
<div class="print-receipt-footer">
[[ Receipt.printedAt()|datetime ]]
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
</div>
<div class="booking-full-invoice">
<div class="invoice-booking-info has-bottom-padding has-bottom-border">
<h2 class="booking-info-pk" title='[! interpolate(cT("\"ID\" is abbreviation of \"Identifier\"", "ID: %(orderId)s"), { orderId: order.pk }) !]'>
<i class="icon-order-large"></i>
Order #[! order.identifier !]
</h2>
<span class="booked-at [! order.originalUser ? 'fh-grey' : 'booked-at-online' !]">
[! order.originalUser ? interpolate(T('Originally created by %(personName)s'), { personName: order.originalUser.name }) : T('Originally created by online customer') !]
<span ng-if-once="!!order.originalUser && !navigation.isCurrentCompany(order.originalUser.company)">
([! order.originalUser.company.name !])
</span>
</span>
</div>
<div class="invoice-stats" ng-can-view-amounts="order.company"
ng-can-only-when="order.contributingBookingCount > 0"
>
<div class="invoice-stats-inner">
<table class="booking-full-stats">
<tr class="stats-labels">
<td>Order total</td>
<td>Payments</td>
<td ng-if="order.amountOverpaid || order.amountDue" ng-then="showAmountDue">
<span ng-if="order.amountDue" class="badge badge-unpaid test-amount-due-indicator">Due</span>
<span ng-if="order.amountOverpaid" class="badge badge-overpaid">Overpaid by</span>
</td>
<td ng-else="showAmountDue" rowspan="2">
<span class="badge badge-paid test-paid-in-full-indicator">Paid in Full</span>
</td>
</tr>
<tr class="stats-numbers">
<td class="test-order-total"
ng-amount="order.contributingBookingCosts.totalCost.total"
ng-amount-company="order.company"
></td>
<td class="test-order-paid"
ng-amount="order.receipt.gross"
ng-amount-company="order.company"
></td>
<td ng-if="showAmountDue"
ng-amount="order.amountDue || order.amountOverpaid"
ng-amount-company="order.company"
></td>
</tr>
</table>
</div>
</div>
<div class="table valign-middle booking-full-invoice-customers"
ng-if="order.contributingBookingCount > 0"
>
<div class="tr">
<div class="td booking-full-customer-breakdown">
[[
interpolate(nT('%(count)s booking', '%(count)s bookings', order.contributingBookingCount), { count: order.contributingBookingCount })
]]
</div>
</div>
</div>
<div class="order-invoice-bookings">
<div ng-repeat="booking in order.contributingBookings"
ng-link="order-invoice-bookings"
></div>
<div class="table valign-middle booking-full-invoice-customers test-no-contributing-bookings-indicator"
ng-if="!order.contributingBookings.length && !order.invisibleBookingCount"
>
<div class="tr">
<div class="td booking-full-customer-breakdown ng-binding">
<div class="hint hint-alert">
This order has 0 uncancelled bookings with payment.
</div>
</div>
</div>
</div>
<table class="invoice-table test-invisible-bookings-indicator"
ng-if="order.invisibleBookingCount > 0"
>
<tbody>
<tr class="invoice-table--row is-shaded is-tall">
<td class="itable-content" colspan="2">
<div>
<b>
[[
interpolate(nT('%(count)s other booking', '%(count)s other bookings', order.invisibleBookingCount ), { count: order.invisibleBookingCount })
]]
</b>
</div>
<div class="fh-grey text-small">You don&#039;t have access to see these bookings.</div>
</td>
<td class="itable-amount">
<span ng-can-view-amounts="order.company"
ng-amount="order.invisibleBookingCosts.totalCost.total"
ng-amount-company="order.company"
></span>
</td>
</tr>
</tbody>
</table>
<div ng-if="order.nonContributingBookings.length">
<br>
<ul class="toggle-header-list">
<li class="flyout-toggle-header test-non-contributing-bookings-indicator" ng-toggle="showCancelled"
ng-toggle-default="!order.contributingBookings.length"
>
[[
interpolate(nT('%(count)s cancelled + refunded booking', '%(count)s cancelled + refunded bookings', order.nonContributingBookings.length ), { count: order.nonContributingBookings.length })
]]
</li>
</ul>
<div ng-toggled="showCancelled">
<div class="table valign-middle booking-full-invoice-customers">
<div class="tr">
<div class="td booking-full-customer-breakdown ng-binding">
<div class="hint hint-alert">
Bookings that have been cancelled and fully refunded won&#039;t count towards the order total.
</div>
</div>
</div>
</div>
<div ng-repeat="booking in order.nonContributingBookings"
ng-link="order-invoice-bookings"
></div>
</div>
</div>
</div>
<table class="invoice-table has-top-margin print-break-avoid"
ng-can-view-amounts="order.company"
>
<tbody>
<tr class="invoice-table--row is-tall">
<td class="text-right"><b>Subtotal</b></td>
<td class="itable-amount" ng-amount="order.contributingBookingCosts.totalCost.price || 0"></td>
</tr>
</tbody>
<tbody ng-if="Order.showTaxByType(order)"
ng-then="showTaxByType"
>
<tr class="invoice-table--row is-tall"
ng-repeat="taxType in taxTypes"
ng-if="(order.contributingBookingCosts.totalCost.taxByType[taxType.pk]|isDefined) && (order.contributingBookingCosts.totalCost.taxByType[taxType.pk] || !Order.isNoTax(order))"
>
<td class="text-right"><b>[! taxType|name !]</b></td>
<td class="itable-amount" ng-amount="order.contributingBookingCosts.totalCost.taxByType[taxType.pk]"></td>
</tr>
</tbody>
<tbody ng-if="!showTaxByType && (order.contributingBookingCosts.totalCost.tax || !Order.isNoTax(order))">
<tr class="invoice-table--row is-tall">
<td class="text-right"><b>[! Company.taxDisplayName(order.company) !]</b></td>
<td class="itable-amount" ng-amount="order.contributingBookingCosts.totalCost.tax"></td>
</tr>
</tbody>
<tbody>
<tr class="invoice-table--row is-tall is-shaded no-border">
<td class="text-right"><b>Total</b></td>
<td class="itable-amount" ng-amount="order.contributingBookingCosts.totalCost.total"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="booking-full-activities"
ng-activities="order"
ng-activities-note
ng-activities-header='[! cT("\"order\" as in sales order", "Order activity:") !]'
></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-navigation-spec="[
['path', urls.dashboard.bookings.contact.booking ],
['path', urls.dashboard.overlay.contact.booking ],
['path', urls.dashboard.bookings.contact.affiliateBookingPermalink ]]"
ng-then="bookingPath"
>
<div ng-controller=
"dashboard.bookings.ViewBookingCtrl"
ng-body-class="'body-print-overlay'"
ng-scroll-to="top"
ng-scroll-container=".db-theater"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="booking-full-loading fh-grey">
<i class="spinner-ticker-css"><span></span></i> Loading booking...
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-title="[[ booking.contact.name ]] - #[[ booking.pk ]]">
<div class="booking-full-mobile-toggle respond-handhelds-show">
<div class="giant-toggle-fluid is-fixed table table-dont-respond valign-middle">
<div class="tr">
<div class="td" ng-toggle="mobileView"
ng-toggle-group="mobileBookingView"
ng-toggle-default="true"
>
View
</div>
<div class="td" ng-toggle="mobileActions"
ng-toggle-group="mobileBookingView"
>
Actions
</div>
<div class="td" ng-toggle="mobileActivity"
ng-toggle-group="mobileBookingView"
>
Activity
</div>
</div>
</div>
</div>
<div class="booking-full-content clearfix">
<div class="booking-full-actions is-mobile-toggled"
ng-class="{ 'toggled': toggles.state('mobileActions') }"
>
<div class="booking-actions">
<div ng-controller=
"dashboard.bookings.BookingActionsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div class="respond-print-hide"
ng-if="actionsCtrl.isSelected(actionsCtrl.NONE)"
ng-body-class="'body-print-booking'"
>
<div ng-if="booking.isUnprocessed" ng-then="isUnprocessed">
<div ng-if="booking.isUnpriced" ng-then="isUnpriced">
<div class="prose prose-section">
<h1>This booking is unpriced</h1>
<p ng-if="actionsCtrl.isSelectable(actionsCtrl.REPRICE)" ng-then="canReprice">
Click the button below, then click &quot;Reprice booking&quot; to calculate its price now.
</p>
<p ng-else="canReprice">
If you need help, please <a ng-href="https://fareharbor.com/help/submit/" ng-outbound-link="_blank">contact Support</a>.
</p>
</div>
<a class="btn-big btn-black btn-wide btn-icon rebook"
ng-click="actionsCtrl.select(actionsCtrl.REPRICE)"
ng-if="actionsCtrl.isSelectable(actionsCtrl.REPRICE)"
>Price booking now</a>
</div>
<div ng-else="isUnpriced">
<div class="prose prose-section">
<h1>This booking has not yet been updated</h1>
<p>
This booking is in line to be updated as part of occasional FareHarbor maintenance.
<span ng-if="actionsCtrl.isSelectable(actionsCtrl.PROCESS)" ng-then="canProcess">
Click the button below to update it now.
</span>
<span ng-else="canProcess">
If you need help, please <a ng-href="https://fareharbor.com/help/submit/" ng-outbound-link="_blank">contact Support</a>.
</span>
</p>
</div>
<a class="btn-big btn-black btn-wide btn-icon rebook"
ng-click="actionsCtrl.select(actionsCtrl.PROCESS)"
ng-if="actionsCtrl.isSelectable(actionsCtrl.PROCESS)"
>Update now
</a>
</div>
</div>
<div ng-else="isUnprocessed">
<div class="action-sheet-header respond-print-hide">
<div class="action-sheet-header-content">
<h2>Booking actions</h2>
</div>
</div>
<ul class="buttons-list test-action-buttons-indicator">
<li ng-if="!!booking.rebookedTo">
<a class="btn-big btn-black btn-wide btn-icon arrow-right"
ng-href="[! booking.rebookedTo|bookingUrl !]"
ng-shortcut="'shift+.'"
ng-shortcut-click
title="[! T('Shortcut: shift+&gt;') !]"
>
Rebooked to #[! booking.rebookedTo.pk !]</a>
</li>
<li ng-if="!!booking.rebookedFrom && !!booking.rebookedTo">
<a class="btn-big btn-black btn-wide btn-icon arrow-left"
ng-href="[! booking.rebookedFrom|bookingUrl !]"
ng-shortcut="'shift+.'"
ng-shortcut-click
title="[! T('Shortcut: shift+&lt;') !]"
>
Rebooked from #[! booking.rebookedFrom.pk !]</a>
</li>
<li class="buttons-spacer"
ng-if="!!booking.rebookedTo || (!!booking.rebookedFrom && !!booking.rebookedTo)"
></li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.REBOOK)">
<div class="btns btns--combo">
<button type="button"
class="btn-big btn-black btn-wide btn-icon add-person btn-segment-left"
ng-click="actionsCtrl.select(actionsCtrl.MODIFY)"
ng-shortcut="'m|shift+m'"
ng-shortcut-click
title="[! T('Shortcut: shift+m') !]"
ng-start-booking
>
Add or remove customers
</button>
<div class="btn-segment-right-wrap">
<button ng-toggle="addRemoveHelp"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
class="btn-big btn-black btn-flyout active-when-toggled btn-segment-right"
ng-tip="[! T('Help') !]"
ng-tip-classes="tip-indent"
></button>
<div ng-toggled="addRemoveHelp"
class="tb-flyout tb-flyout--floated"
>
<div class="flyout-section text-medium flyout-section--no-border">
Change the number of customers on this booking.
<a ng-href="https://fareharbor.com/help/dashboard/bookings/adding-removing-customers/"
ng-outbound-link="_blank"
class="hint-help-link nowrap"
>Watch the video &rsaquo;</a>
</div>
</div>
</div>
</div>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.REBOOK)">
<div class="btns btns--combo">
<button type="button"
class="btn-big btn-black btn-wide btn-icon rebook btn-segment-left test-rebook-action"
ng-click="actionsCtrl.select(actionsCtrl.REBOOK)"
ng-shortcut="'r|shift+r'"
ng-shortcut-click
title="[! T('Shortcut: shift+r') !]"
>
Rebook
</button>
<div class="btn-segment-right-wrap">
<button ng-toggle="rebookHelp"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
class="btn-big btn-black btn-flyout active-when-toggled btn-segment-right"
ng-tip="[! T('Help') !]"
ng-tip-classes="tip-indent"
></button>
<div ng-toggled="rebookHelp"
class="tb-flyout tb-flyout--floated"
>
<div class="flyout-section text-medium flyout-section--no-border">
Change the date and time of this booking.
<br>
<a ng-href="https://fareharbor.com/help/dashboard/bookings/rebooking/"
ng-outbound-link="_blank"
class="hint-help-link nowrap"
>Get help with rebooking &rsaquo;</a>
</div>
</div>
</div>
</div>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.CANCEL)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon cancel test-cancel-action"
ng-click="actionsCtrl.select(actionsCtrl.CANCEL)"
ng-shortcut="'delete|shift+x'"
ng-shortcut-click
title="[! T('Shortcut: shift+x') !]"
>
Cancel booking
</button>
</li>
<li class="buttons-spacer"
ng-if="actionsCtrl.isSelectable(actionsCtrl.REBOOK) || actionsCtrl.isSelectable(actionsCtrl.CANCEL)"
></li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.CHECK_IN)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon check-in"
ng-click="actionsCtrl.select(actionsCtrl.CHECK_IN)"
ng-shortcut="'shift+i'"
ng-shortcut-click
title="[! T('Shortcut: shift+i') !]"
>
Set check-in for all customers
</button>
</li>
<li class="buttons-spacer"
ng-if="actionsCtrl.isSelectable(actionsCtrl.CHECK_IN)"
></li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.ADD)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon add-payment [! booking|currencyClass !] test-add-payment-action"
ng-click="actionsCtrl.select(actionsCtrl.ADD)"
ng-shortcut="'shift+='"
ng-shortcut-click
title="[! T('Shortcut: shift+plus') !]"
>
Add payment
<span class="badge" ng-can-view-amounts="booking.company" ng-can-only-when="booking.amountDue">
[[ booking.amountDue|amount:booking ]] Due
</span>
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.DEFER)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon cc-save test-defer-action"
ng-click="actionsCtrl.select(actionsCtrl.DEFER)"
ng-shortcut="'shift+s'"
ng-shortcut-click
title="[! T('Shortcut: shift+s') !]"
>
Save card to charge later
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.REFUND)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon refund [! booking|currencyClass !] test-refund-action"
ng-click="actionsCtrl.select(actionsCtrl.REFUND)"
ng-shortcut="'shift+-'"
ng-shortcut-click
title="[! T('Shortcut: shift+minus') !]"
>
Refund
</button>
</li>
<li class="buttons-spacer"
ng-if="actionsCtrl.isSelectable(actionsCtrl.ADD) || actionsCtrl.isSelectable(actionsCtrl.DEFER) || actionsCtrl.isSelectable(actionsCtrl.REFUND)"
></li>
<li class="respond-handhelds-show"
ng-if="booking.contact.phone"
>
<a class="btn-big btn-black btn-wide btn-icon phone"
ng-href="tel:[[ booking.contact.normalizedPhone ]]"
>
Call [[ booking.contact|contactPhone ]]</a>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.NOTIFY) || actionsCtrl.isSelectable(actionsCtrl.NOTIFY_SMS) || actionsCtrl.isSelectable(actionsCtrl.AUTOMATIC_NOTIFICATION_OPTIONS)">
<div class="btns btns--combo">
<button type="button" ng-if="actionsCtrl.isSelectable(actionsCtrl.NOTIFY)" ng-then="canEmail"
class="btn-big btn-black btn-wide btn-icon email test-send-notification-action"
ng-class="{ 'btn-segment-left': isEligibleForAutomaticNotifications() }"
ng-click="actionsCtrl.select(actionsCtrl.NOTIFY)"
ng-shortcut="'shift+e'"
ng-shortcut-click
title="[! T('Shortcut: shift+e') !]"
>
[[ actionsCtrl.isSelectable(actionsCtrl.NOTIFY_SMS) ? T('Send email or text') : T('Send email') ]]
</button>
<button type="button"
ng-if="!canEmail && actionsCtrl.isSelectable(actionsCtrl.NOTIFY_SMS)" ng-then="canSms"
class="btn-big btn-black btn-wide btn-icon phone test-send-notification-action"
ng-class="{ 'btn-segment-left': isEligibleForAutomaticNotifications() }"
ng-click="actionsCtrl.select(actionsCtrl.NOTIFY_SMS)"
ng-shortcut="'shift+e'"
ng-shortcut-click
title="[! T('Shortcut: shift+e') !]"
>
Send text message
</button>
<div ng-if="canEmail || canSms" ng-then="hasNotificationButton"></div>
<div class="btn-segment-right-wrap"
ng-if="isEligibleForAutomaticNotifications()"
>
<button class="btn-big btn-black btn-flyout active-when-toggled [! hasNotificationButton ? 'btn-segment-right' : 'btn-wide btn-icon email' !]"
ng-toggle="notificationOptionsForm"
ng-toggle-auto-close
ng-tip="[! T('Auto message options') !]"
ng-tip-when="hasNotificationButton"
ng-tip-classes="tip-indent"
>
<i class="tb-icon cog-white"
ng-if-once="hasNotificationButton"
></i>
<span ng-else="hasNotificationButton">Notification options</span>
</button>
<div ng-toggled="notificationOptionsForm"
class="tb-flyout tb-flyout--floated"
>
<div ng-controller=
"dashboard.bookings.NotificationOptionsEditableCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div
ng-if="isEligibleForAutomaticNotifications()"
ng-then="allowed">
<form name="updateBookingNotificationOptionsForm"
ng-submit="editCtrl.submit(updateBookingNotificationOptionsForm)"
>
<div class="fields "
>
<div class="flyout-checklist-header">Automatic messages for this booking:</div>
<ul class="flyout-checklist">
<li ng-can-create="Notification on booking"
ng-can-only-when="Booking.isEligibleForAutoFollowUpEmail(booking)">
<div class="updatebookingnotificationoptionsform-isfollowupdisabled "
ng-django-field="updateBookingNotificationOptionsForm [&#39;isFollowUpDisabled&#39;]" ng-django-field-model="editableBooking [&#39;isFollowUpDisabled&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_follow_up_disabled" name="isFollowUpDisabled" ng-checkbox-madness="true" ng-model="editableBooking [&#39;isFollowUpDisabled&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Disable follow-up email
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateBookingNotificationOptionsForm [&#39;isFollowUpDisabled&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</li>
<li ng-can-create="Notification on booking"
ng-can-only-when="Booking.isEligibleForAutoReminderEmail(booking)">
<div class="updatebookingnotificationoptionsform-isreminderdisabled "
ng-django-field="updateBookingNotificationOptionsForm [&#39;isReminderDisabled&#39;]" ng-django-field-model="editableBooking [&#39;isReminderDisabled&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_reminder_disabled" name="isReminderDisabled" ng-checkbox-madness="true" ng-model="editableBooking [&#39;isReminderDisabled&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Disable reminder email
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateBookingNotificationOptionsForm [&#39;isReminderDisabled&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</li>
<li ng-can-create="SmsNotification on booking"
ng-can-only-when="Booking.isEligibleForAutoReminderSms(booking)">
<div class="updatebookingnotificationoptionsform-issmsreminderdisabled "
ng-django-field="updateBookingNotificationOptionsForm [&#39;isSmsReminderDisabled&#39;]" ng-django-field-model="editableBooking [&#39;isSmsReminderDisabled&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input checked="checked" data-lpignore="true" id="id_is_sms_reminder_disabled" name="isSmsReminderDisabled" ng-checkbox-madness="true" ng-model="editableBooking [&#39;isSmsReminderDisabled&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Disable reminder text message
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateBookingNotificationOptionsForm [&#39;isSmsReminderDisabled&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</li>
<li ng-can-create="ReviewExpressNotification on booking"
ng-can-only-when="Booking.isEligibleForReviewExpress(booking)">
<div class="updatebookingnotificationoptionsform-isreviewexpressdisabled "
ng-django-field="updateBookingNotificationOptionsForm [&#39;isReviewExpressDisabled&#39;]" ng-django-field-model="editableBooking [&#39;isReviewExpressDisabled&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_review_express_disabled" name="isReviewExpressDisabled" ng-checkbox-madness="true" ng-model="editableBooking [&#39;isReviewExpressDisabled&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Review Express: mark as no-show
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateBookingNotificationOptionsForm [&#39;isReviewExpressDisabled&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</li>
</ul>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="updateBookingNotificationOptionsForm.all.$error.review_express_not_enabled">Review Express is not enabled for the associated item.</li>
<li ng-if="updateBookingNotificationOptionsForm.all.$error.unauthorized">Only authorized users can update notification options.</li>
<li ng-repeat="error in updateBookingNotificationOptionsForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="flyout-section flyout-section--shade">
<button class="btn-tiny btn-green" type="submit"
ng-disabled="
updateBookingNotificationOptionsForm.$pristine ||
updateBookingNotificationOptionsForm.$invalid ||
updateBookingNotificationOptionsForm.$submitting
"
>
[[ updateBookingNotificationOptionsForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
</div>
</form>
</div>
<div ng-else="allowed">
<div ng-inline="forbidden"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
</div>
</div>
</li>
<li ng-if="actionsCtrl.isSelectable(actions.PRINT_RECEIPT)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon print test-print-receipt-action"
ng-click="actionsCtrl.select(actionsCtrl.PRINT_RECEIPT)"
ng-shortcut="'shift+p'"
ng-shortcut-click
title="[! T('Shortcut: shift+p') !]"
>
Print
</button>
</li>
</ul>
</div>
<div class="tb tb--inset-mobile no-margin action-sheet-header-tb"
ng-if="!isUnprocessed && (actionsCtrl.isSelectable(actionsCtrl.CUSTOM_REFUND) || actionsCtrl.isSelectable(actionsCtrl.REPRICE))"
>
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="bookingAdvancedMenu"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<span class="respond-handhelds-show">
<i class="tb-icon hamburger"></i>
</span>
Advanced
</div>
<div class="tb-flyout tb-flyout--auto-width-narrow tb-flyout--left"
ng-toggled="bookingAdvancedMenu"
>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'bookingAdvancedMenu'"></div>
<div ng-controller="dashboard.bookings.AdvancedBookingActionsCtrl"
ng-data="availability.$promise"
>
<ul class="flyout-menu-items">
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.CUSTOM_REFUND)">
<a ng-click="actionsCtrl.select(actionsCtrl.CUSTOM_REFUND)">Custom refund</a>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.REPRICE)">
<a ng-click="actionsCtrl.select(actionsCtrl.REPRICE)">Reprice booking</a>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.REAPPLY_RESOURCE_USES)">
<a ng-click="actionsCtrl.select(actionsCtrl.REAPPLY_RESOURCE_USES)">Reapply resources</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="action-window">
<div ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)"
ng-sonar-pause="booking when updated"
>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.CANCEL)">
<div ng-controller=
"dashboard.bookings.CancelBookingCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<form class="test-cancel-booking-view-indicator"
name="cancelBookingForm"
ng-confirm-navigate-away
ng-autofocus
>
<div ng-if="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Cancelling booking...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-if="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Cancel booking</h2>
<a ng-href="https://fareharbor.com/help/dashboard/bookings/cancelling/"
ng-outbound-link="_blank"
class="hint-help-link"
>Working with cancelled bookings &rsaquo;</a>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="cancelBookingForm.$dirty"
>Close</button>
</span>
<div ng-if="isCancelEligible && cancelEligiblePayments.length"
ng-link="dashboard.bookings.cancelEligiblePayments"
></div>
<div ng-else="isCancelEligible">
<div ng-can-create="Refund on booking"
ng-can-only-when="payments.length"
ng-then="canDoRefunds"
>
<p class="action-sheet-help">
<span class="select-all">
Optional: Select any payments you would like to refund when cancelling:
<a ng-click="actionsCtrl.selectFullRefunds(editablePayments, payments)"
ng-can-create="Refund on booking"
>all</a>,
<a ng-click="actionsCtrl.unselectPayments(editablePayments, payments)"
ng-can-create="Refund on booking"
>none</a>
</span>
</p>
<div class="fields "
>
<ul ng-can-create="Refund on booking" class="test-refunds-list-indicator">
<li ng-repeat="payment in payments" class="refund-form-block"
ng-class="{ 'is-selected': actionsCtrl.isPaymentSelected(editablePayments, payment) }"
>
<div class="fields "
>
<div ng-if="Payment.isLegacyProcessorBasedType(payment)" ng-link="dashboard.bookings.paymentLegacyFlag"></div>
<div class="overview-payment"
ng-link="payment-and-refunds"
ng-with="showTotals = true"
></div>
<div ng-if="Payment.isDisputedAndNonRefundable(payment)" ng-then="notSelectable"
class="refund-type-select-wrap"
>
<div class="refund-not-selectable">
Cannot be refunded right now.
<a ng-href="https://fareharbor.com/help/payments/disputes/refunding-a-disputed-charge/" ng-outbound-link="_blank">Learn more</a>
</div>
</div>
<div ng-else="notSelectable"
class="refund-type-select-wrap"
>
<div class="table full-width refund-type-select table-dont-respond valign-middle">
<div class="tr"
ng-with="isPartialRefundSelected = actionsCtrl.isPartialRefundSelected(editablePayments, payment);
isFullRefundSelected = actionsCtrl.isFullRefundSelected(editablePayments, payment)"
>
<div class="td option-dont-refund"
ng-class="{ toggled: !isPartialRefundSelected && !isFullRefundSelected }"
ng-click="actionsCtrl.unselectPayment(editablePayments, payment)"
>
Don&#039;t refund
</div>
<div class="td"
ng-if="Payment.isPartialRefundAllowed(payment)"
ng-class="{ toggled: isPartialRefundSelected }"
ng-click="actionsCtrl.selectPartialRefund(editablePayments, payment)"
>
Partial refund
</div>
<div class="td test-full-refund-indicator"
ng-class="{ toggled: isFullRefundSelected }"
ng-click="actionsCtrl.selectFullRefund(editablePayments, payment)"
>
Full refund
</div>
</div>
</div>
</div>
<fieldset class="refund-choose-amount"
ng-if="actionsCtrl.isPartialRefundSelected(editablePayments, payment)"
>
<div ng-if="payment.receipt.gross">
<table class="refund-amount-table"
ng-autofocus
>
<tr>
<td>
Refund amount:
</td>
<td>
<div class="refundpaymentform-payment-paymentpk-refundgross
field-amount
"
ng-django-field="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-django-field-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-amount-input-max="payment.receipt.gross" ng-amount-input-min="1" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'payment-' + payment.pk " required="required" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
</tr>
</table>
<div class="tb tb-calculate-refund-flyout"
ng-with="toggleValue = 'refundCalculator-' + payment.pk"
>
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="toggleValue"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate refund amount') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate refund amount</abbr>
</div>
<div class="tb-flyout tb-flyout--left"
ng-toggled ng-toggled-value="toggleValue"
>
<div class="flyout-section flyout-section--no-border">
<h2>
Calculate refund amount
</h2>
<div ng-portion-calculator="payment.receipt.total"
ng-portion-calculator-currency="payment"
ng-portion-calculator-max="payment.receipt.gross"
ng-portion-calculator-model="editablePayments['payment-' + payment.pk + '-' + 'refundGross']"
ng-portion-calculator-labels-for="refund"
ng-portion-calculator-toggle-value="toggleValue"
></div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = toggleValue"></div>
</div>
</div>
</div>
</div>
</fieldset>
<div ng-repeat="error in refundErrors[payment.pk]" class="form-error">
[[ error ]]
</div>
</div>
<div class="hide">
<div class="refundpaymentform-payment-paymentpk-note "
ng-django-field="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" name="note" ng-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-prefix="'payment-' + payment.pk " type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
</ul>
<div class="hint hint-alert"
ng-can-list="Account on booking.company"
ng-can-only-when="booking.company.isDefaultProcessorDefaultBankAccountReadyForUpload && isUploadPossible()"
>
<p>
<b ng-if="refundingCount === 1" ng-then="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover this refund.
</b>
<b ng-else="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover these refunds.
</b>
Your bank account will be automatically debited.
</p>
<p>
<a ng-href="/help/payments/refunds/">Learn about refunds in FareHarbor &raquo;</a>
</p>
</div>
<div ng-if="refundErrors.all">
<ul>
<li ng-repeat="error in refundErrors.all"
class="form-error"
>
[[ error ]]
</li>
</ul>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in refundPaymentsForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div ng-if="!canDoRefunds && payments.length" class="form-error">
This booking has un-refunded payments but you are not allowed to refund them. You <i>are</i> still allowed to cancel the booking.
</div>
</div>
<div ng-if="nonZeroGeneratedStoredValueCards.length" class="form-error">
This booking has unused gift cards; cancelling this booking <i>will not</i> cancel the gift cards.
</div>
<div class="fields "
>
<div class="cancelbookingform-note field-textarea "
ng-django-field="cancelBookingForm [&#39;note&#39;]" ng-django-field-model="cancelBookingData [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-model="cancelBookingData [&#39;note&#39;]" ng-placeholder="Note about why you are cancelling (optional, not visible to customer)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-can-create="Notification on company">
<div class="cancelbookingform-sendnotification field-cb-email "
ng-django-field="cancelBookingForm [&#39;sendNotification&#39;]" ng-django-field-model="cancelBookingData [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="cancelBookingData [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Send cancellation email
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="cancelBookingData.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="cancelbookingform-notification-emails "
ng-django-field="cancelBookingForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="cancelBookingData [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="cancelBookingData [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelbookingform-notification-subject "
ng-django-field="cancelBookingForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="cancelBookingData [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="cancelBookingData [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelbookingform-notification-note field-textarea
"
ng-django-field="cancelBookingForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="cancelBookingData [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".cancelbookingform-notification-note" ng-model="cancelBookingData [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div class="cancelbookingform-refundgross "
ng-django-field="cancelBookingForm [&#39;refundGross&#39;]" ng-django-field-model="cancelBookingData [&#39;refundGross&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cancelBookingData [&#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cancelBookingForm [&#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cancelBookingForm [&#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cancelBookingForm [&#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelbookingform-iscanceleligible "
ng-django-field="cancelBookingForm [&#39;isCancelEligible&#39;]" ng-django-field-model="cancelBookingData [&#39;isCancelEligible&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_cancel_eligible" name="isCancelEligible" ng-model="cancelBookingData [&#39;isCancelEligible&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;isCancelEligible&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="cancelbookingform-isonline "
ng-django-field="cancelBookingForm [&#39;isOnline&#39;]" ng-django-field-model="cancelBookingData [&#39;isOnline&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_online" name="isOnline" ng-model="cancelBookingData [&#39;isOnline&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cancelBookingForm [&#39;isOnline&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="cancelBookingForm.all.$error.refund_failure">unable to cancel due to refund failure</li>
<li ng-repeat="error in cancelBookingForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-red btn-wide test-cancel-booking-action"
ng-with="refundTotal = actionsCtrl.refundTotal(editablePayments, payments)"
ng-disabled="cancelBookingForm.$invalid || cancelBookingForm.$submitting"
ng-click="submit(cancelBookingForm)"
ng-confirm-click="[! T('Cancel this booking and refund payments? There is no undo.') !]"
ng-confirm-click-when="refundTotal || cancelEligiblePayments.length"
>
<span ng-if="refundTotal || cancelEligiblePayments.length" ng-then="hasRefund">
<span ng-if="cancelEligiblePayments.length">Cancel booking and refund payments</span>
<span ng-else="cancelEligiblePayments.length">
Cancel booking and refund <span ng-amount="refundTotal" ng-amount-currency="booking"></span>
</span>
</span>
<span ng-else="hasRefund">Cancel booking</span>
</button>
</div>
</div>
</form>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.ADD)">
<div ng-controller=
"dashboard.bookings.PaymentsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-show="submitting" ng-link="payment-processing"></div>
<div ng-show="!submitting">
<div class="action-sheet-header respond-print-hide">
<div class="action-sheet-header-content">
<h2>Add payment to booking</h2>
</div>
</div>
<div class="giant-toggle-fluid is-fixed table table-dont-respond valign-middle respond-print-hide"
ng-can="createStoredValueCard on Payment with booking"
ng-can-only-when="booking.company.storedValueCardsCount > 0"
>
<div class="tr">
<div class="td" ng-click="redeem(false)"
ng-class="{ 'toggled': !isRedeeming }"
>
Collect
</div>
<div class="td" ng-click="redeem(true)"
ng-class="{ 'toggled': isRedeeming }"
>
Redeem
</div>
</div>
</div>
<div ng-if="isRedeeming" ng-then="redeeming">
<p class="action-sheet-help">
Pay for this booking with a gift card:
</p>
<form name="redeemForm"
ng-confirm-navigate-away
ng-submit="submitRedeem(redeemForm)"
ng-sonar-pause="booking when updated"
ng-sonar-pause-action="actionsCtrl.reset()"
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="redeemForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="labels-above">
<div ng-stored-value-card-search
ng-model="newPayment.storedValueCardNumber"
>
<div class="redeemform-storedvaluecardnumber "
ng-django-field="redeemForm [&#39;storedValueCardNumber&#39;]" ng-django-field-model="newPayment [&#39;storedValueCardNumber&#39;]"
>
<label >
<span class="label-text">
Gift card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_stored_value_card_number" name="storedValueCardNumber" ng-autofocus="true" ng-model="newPayment [&#39;storedValueCardNumber&#39;]" ng-pattern="/^[a-zA-Z0-9\-_\#\%$]+$/" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;storedValueCardNumber&#39;].$error['pattern']">Invalid value</li>
<li ng-repeat="error in redeemForm [&#39;storedValueCardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-if="redeemCtrl.status === 'not-found'"
class="fh-red"
>
Card not found
</div>
<div ng-if="redeemCtrl.status === 'loading'"
class="fh-grey"
>
Loading...
</div>
<div class="chunky-error light-orange" ng-if="redeemCtrl.storedValueCard.pendingBalance < 0">
<div class="chunky-error-inner">
Gift card has pending bookings affecting remaining balance by [[ redeemCtrl.storedValueCard.pendingBalance|amount:company ]]
</div>
</div>
<table ng-if="redeemCtrl.status === 'success' && redeemCtrl.storedValueCard"
class="portion-calculator-table redeem-amount-table"
>
<tr>
<td>Card balance:</td>
<td>
<b>[[ redeemCtrl.storedValueCard.balance|amount:redeemCtrl.storedValueCard ]]</b>
<a ng-href="[! redeemCtrl.storedValueCard.$url(urls.dashboard.settings.storedValue.storedValueCard.index) !]"
ng-can-view="redeemCtrl.storedValueCard"
class="fh-blue underline"
>(Details)</a>
</td>
</tr>
<tr ng-if="redeemCtrl.storedValueCard.balance > 0">
<td>Amount to use:</td>
<td ng-can="createPartial on Payment with company" ng-then="canCreatePartial">
<div class="redeemform-gross field-partial-payment-gross
field-amount
"
ng-django-field="redeemForm [&#39;gross&#39;]" ng-django-field-model="redeemCtrl [&#39;gross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-max="redeemCtrl.max()" ng-amount-input-min="redeemCtrl.min()" ng-amount-input-positive="true" ng-autofocus="true" ng-autofocus-select="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="redeemCtrl [&#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="redeemForm [&#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in redeemForm [&#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
<td ng-else="canCreatePartial">
Pay in full ([[ redeemCtrl.amountDue()|amount:company ]])
</td>
</tr>
</table>
<div ng-can-create="Notification on company">
<div class="redeemform-sendnotification field-cb-email "
ng-django-field="redeemForm [&#39;sendNotification&#39;]" ng-django-field-model="newPayment [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="newPayment [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Email receipt
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="newPayment.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="redeemform-notification-emails "
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-notification-subject "
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-notification-note field-textarea
"
ng-django-field="redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".redeemform-notification-note" ng-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div class="redeemform-processortype "
ng-django-field="redeemForm [&#39;processorType&#39;]" ng-django-field-model="newPayment [&#39;processorType&#39;]"
>
<label >
<span class="label-text">
Processor type
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_processor_type" name="processorType" ng-model="newPayment [&#39;processorType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;processorType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;processorType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-isdemo "
ng-django-field="redeemForm [&#39;isDemo&#39;]" ng-django-field-model="newPayment [&#39;isDemo&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_demo" name="isDemo" ng-model="newPayment [&#39;isDemo&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;isDemo&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-cardtype "
ng-django-field="redeemForm [&#39;cardType&#39;]" ng-django-field-model="newPayment [&#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="newPayment [&#39;cardType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-cardlast4 "
ng-django-field="redeemForm [&#39;cardLast4&#39;]" ng-django-field-model="newPayment [&#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="newPayment [&#39;cardLast4&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripetoken "
ng-django-field="redeemForm [&#39;stripeToken&#39;]" ng-django-field-model="newPayment [&#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="newPayment [&#39;stripeToken&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripechargeid "
ng-django-field="redeemForm [&#39;stripeChargeId&#39;]" ng-django-field-model="newPayment [&#39;stripeChargeId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_charge_id" name="stripeChargeId" ng-model="newPayment [&#39;stripeChargeId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeChargeId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripepaymentintentid "
ng-django-field="redeemForm [&#39;stripePaymentIntentId&#39;]" ng-django-field-model="newPayment [&#39;stripePaymentIntentId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_payment_intent_id" name="stripePaymentIntentId" ng-model="newPayment [&#39;stripePaymentIntentId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripePaymentIntentId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-stripesetupintentid "
ng-django-field="redeemForm [&#39;stripeSetupIntentId&#39;]" ng-django-field-model="newPayment [&#39;stripeSetupIntentId&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_setup_intent_id" name="stripeSetupIntentId" ng-model="newPayment [&#39;stripeSetupIntentId&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in redeemForm [&#39;stripeSetupIntentId&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="redeemform-tokenizationtype "
ng-django-field="redeemForm [&#39;tokenizationType&#39;]" ng-django-field-model="newPayment [&#39;tokenizationType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_tokenization_type" name="tokenizationType" ng-model="newPayment [&#39;tokenizationType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="redeemForm [&#39;tokenizationType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in redeemForm [&#39;tokenizationType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="redeemForm.all.$error.invalid_emv_provider">Payment device provider not recognized. Please contact FareHarbor Support.</li>
<li ng-if="redeemForm.all.$error.tokenization_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.booking_affiliation_required">An affiliate must be selected.</li>
<li ng-if="redeemForm.all.$error.is_demo_does_not_match">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.stored_value_card_not_found">Gift card not found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.ideal_not_enabled">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_affiliate_payments">Cannot create affiliate payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_stored_value_card_payments">Sorry, your account is not authorized to redeem gift cards.</li>
<li ng-if="redeemForm.all.$error.cannot_add_payment_to_demo_booking">Demo mode must be enabled to add payments to demo bookings.</li>
<li ng-if="redeemForm.all.$error.missing_in_store_payment_note">&#39;%(payment_note)s&#39; cannot be empty. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.card_not_found">Card not found.</li>
<li ng-if="redeemForm.all.$error.stripe_ideal_bank_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.charge_amount_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-HIGH)</li>
<li ng-if="redeemForm.all.$error.booking_fee_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-LOW)</li>
<li ng-if="redeemForm.all.$error.gross_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-LOW)</li>
<li ng-if="redeemForm.all.$error.cannot_create_demo_card_on_file_payment">Cannot create a payment for a saved card when demo mode is enabled.</li>
<li ng-if="redeemForm.all.$error.invalid_processor_type">Outdated payment processor. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.non_affiliate_collected_by_affiliate">Only payments collected by affiliates may be marked as such. Please contact FareHarbor Support. (A-2)</li>
<li ng-if="redeemForm.all.$error.booking_fee_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-HIGH)</li>
<li ng-if="redeemForm.all.$error.invalid_option">Invalid payment option. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.ideal_option_requires_pending_bookings">Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cardholders_name_not_specified">Payment could not be processed. Cardholder's name is required.</li>
<li ng-if="redeemForm.all.$error.cant_create_credit_card_payment">Cannot create credit card payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.affiliate_not_collected_by_affiliate">Payments collected by affiliates must be marked as such. Please contact FareHarbor Support. (A-1)</li>
<li ng-if="redeemForm.all.$error.cant_skip_payment">Cannot skip payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.unauthorized_card_access">Unable to use card for payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_valid">Cannot create in-store payment, selection not valid. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.country_code_not_specified">Payment could not be processed. Billing country is required. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cant_create_in_store_payments">Cannot create in-store payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.charge_amount_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.cannot_add_payment_to_non_demo_booking">Demo mode must be disabled to add payments to non-demo bookings.</li>
<li ng-if="redeemForm.all.$error.no_relevant_bookings">Cannot create payment. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.cannot_create_demo_ideal_payment">Cannot pay with iDEAL when demo mode is enabled.</li>
<li ng-if="redeemForm.all.$error.gross_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-HIGH)</li>
<li ng-if="redeemForm.all.$error.booking_fee_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.cant_defer_payment">Cannot save card. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.invalid_processor">No processor found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_found">Cannot create in-store payment, type not found. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.gross_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-UNSPECIFIED)</li>
<li ng-if="redeemForm.all.$error.charge_amount_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-LOW)</li>
<li ng-if="redeemForm.all.$error.booking_rebooked">This booking has been rebooked. Please refresh the page.</li>
<li ng-if="redeemForm.all.$error.cant_charge_card">Cannot charge that card. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.postal_code_not_specified">Payment could not be processed. Billing postal (zip) code is required. Please refresh the page and try again.</li>
<li ng-if="redeemForm.all.$error.in_store_payment_type_not_authorized">Sorry, you are not authorized to create in-store payments. Please refresh the page and try again.</li>
<li ng-repeat="error in redeemForm.all.$error.$server">[[ error ]]</li>
</ul>
<div class="form-error" ng-if="redeemCtrl.isBalanceInsufficientDueToPermissions()">
You don&#039;t have permission to redeem an amount that is less than the amount due.
</div>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-disabled="redeemForm.$invalid || redeemForm.$submitting || !redeemCtrl.isValid()"
>
Redeem Gift Card
</button>
</div>
</form>
</div>
<form ng-else="redeeming"
name="paymentForm"
ng-confirm-navigate-away
ng-submit="submit(paymentForm)"
ng-sonar-pause="booking when updated"
ng-sonar-pause-action="actionsCtrl.reset()"
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="paymentForm.$dirty"
>Close</button>
</span>
<div class="fields
respond-print-hide
"
>
<div ng-if="!paymentCtrl.isAnonymous">
<div class="paymentform-kind "
ng-django-field="paymentForm [&#39;kind&#39;]" ng-django-field-model="newPayment [&#39;kind&#39;]"
ng-django-field-required=""
>
<ul ng-radio-flyer
class="field-radio-group field-radio-group--large"
>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.SKIP_KIND)"
class="test-payment-kind-skip-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.SKIP_KIND"
ng-model="newPayment [&#39;kind&#39;]" ng-prefix="" ng-required="required"
>
Don&#039;t add payment now
</label>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.DEFER_KIND)"
class="test-payment-kind-defer-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.DEFER_KIND"
ng-model="newPayment [&#39;kind&#39;]" ng-prefix="" ng-required="required"
>
Save card to charge later
</label>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.PARTIAL_KIND)"
class="test-payment-kind-partial-action"
>
<label class="has-child">
<input type="radio" name="kind"
ng-value="paymentCtrl.PARTIAL_KIND"
ng-model="newPayment [&#39;kind&#39;]" ng-prefix="" ng-required="required"
>
[[ paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND ? T('Partial payment:') : T('Partial payment') ]]
</label>
</li>
<li ng-if="paymentCtrl.kind() === paymentCtrl.PARTIAL_KIND">
<div class="radio-content">
<div class="paymentform-gross field-partial-payment-gross
field-amount
"
ng-django-field="paymentForm [&#39;gross&#39;]" ng-django-field-model="newPayment [&#39;gross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="999999.99" min="0" name="gross" ng-amount-input="true" ng-amount-input-default="paymentCtrl.defaultGross()" ng-amount-input-max="paymentCtrl.amountMax()" ng-amount-input-min="paymentCtrl.amountMin()" ng-amount-input-positive="true" ng-autofocus="true" ng-autofocus-select="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="newPayment [&#39;gross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (booking || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="paymentForm [&#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in paymentForm [&#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="tb tb--inset-mobile" ng-if="!!splitPaymentCtrl">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="splitPaymentCalc"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate split payment') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate split payment</abbr>
</div>
<div ng-toggled="splitPaymentCalc"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-section flyout-section--no-border">
<h2>Calculate split payment</h2>
<div class="hint">
Divide the booking total after taxes ([[ splitPaymentCtrl.amount|amount:booking ]]) into equal amounts.
</div>
<table class="split-payment-table">
<tr>
<td class="text-right">
Split into:
</td>
<td>
<div class="field people-field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
ng-model="splitPaymentCtrl.divideByPeople"
ng-pattern="/^\d+$/"
ng-int-input
ng-int-input-min="1"
>
</span>
<div class="people-label">[[ nT('payment', 'payments', splitPaymentCtrl.divideByPeople) ]]</div>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td class="text-right">
Apply:
</td>
<td ng-autofocus>
<div class="field people-field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
autocomplete="off"
ng-model="splitPaymentCtrl.payForPeople"
ng-pattern="/^\d+$/"
ng-int-input
ng-int-input-min="1"
ng-int-input-max="splitPaymentCtrl.divideByPeople"
>
</span>
<div class="people-label">[[ nT('payment', 'payments', splitPaymentCtrl.payForPeople) ]]</div>
</span>
</label>
</div>
</td>
</tr>
<tr>
<td class="text-right">
Cost:
</td>
<td>
[[ splitPaymentCtrl.splitAmount|amount:booking ]]
</td>
</tr>
<tr class="split-payment-set">
<td></td>
<td>
<button type="submit"
ng-click="splitPaymentCtrl.useSplitAmount()"
class="btn-tiny btn-green"
ng-disabled="splitPaymentCtrl.splitAmount <= 0"
>Set</button>
</td>
</tr>
</table>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'splitPaymentCalc'"></div>
</div>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isKindValid(paymentCtrl.FULL_KIND)"
class="test-payment-kind-full-action"
>
<label >
<input type="radio" name="kind"
ng-value="paymentCtrl.FULL_KIND"
ng-model="newPayment [&#39;kind&#39;]" ng-prefix="" ng-required="required"
>
[[ paymentCtrl.isDefaultAmountInvoicePrice() ? T('Invoice amount') : T('Pay in full') ]]
</label>
</li>
<li ng-if="!paymentCtrl.isAnyKindValid()"
class="form-error"
>
<b>No available payment options.</b> Please contact your administrator.
</li>
</ul>
</div>
<div ng-if="paymentCtrl.affiliation() && paymentCtrl.needsPayment()">
<div class="paymentform-iscollectedbyaffiliate "
ng-django-field="paymentForm [&#39;isCollectedByAffiliate&#39;]" ng-django-field-model="newPayment [&#39;isCollectedByAffiliate&#39;]"
>
<div class="affiliate-form-header">Collected By</div>
<ul ng-radio-flyer
class="test-payment-collected-by-field-indicator field field-radio-group field-radio-group--large"
>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(false)"
class="test-collected-by-affiliate-false-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="false"
ng-model="newPayment [&#39;isCollectedByAffiliate&#39;]" ng-prefix="" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.company)">
Collected by <b>[[ paymentCtrl.company|name ]]</b>
</span>
</label>
</li>
<li ng-if="paymentCtrl.isCollectedByAffiliateValid(true)"
class="test-collected-by-affiliate-true-action"
>
<label >
<input type="radio" name="is_collected_by_affiliate"
ng-value="true"
ng-model="newPayment [&#39;isCollectedByAffiliate&#39;]" ng-prefix="" ng-required="required"
>
<span ng-if="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>you</b>
</span>
<span ng-else="auth.isCompanyUser(paymentCtrl.affiliation().affiliateCompany)">
Collected by <b>[[ paymentCtrl.affiliation().affiliateCompany|name ]]</b>
</span>
</label>
</li>
</ul>
</div>
</div>
</div>
<div ng-if="paymentCtrl.needsPayment() && paymentCtrl.needsOption()">
<div class="paymentform-optionandextras "
ng-django-field="paymentForm [&#39;optionAndExtras&#39;]" ng-django-field-model="paymentCtrl [&#39;optionAndExtras&#39;]"
>
<div class="affiliate-form-header">Payment Type</div>
<ul ng-radio-flyer
class="field-radio-group field-radio-group--large
"
>
<li class="field-radio-inline-header fh-green">
Pay [[ paymentCtrl.amount()|amount:booking ]] with:
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IN_STORE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.inStorePaymentTypes"
class="test-payment-action-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (booking || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="paymentform-instorepaymentnote "
ng-django-field="paymentForm [&#39;inStorePaymentNote&#39;]" ng-django-field-model="newPayment [&#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="newPayment [&#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.AFFILIATE_OPTION)"
ng-repeat="inStorePaymentType in paymentCtrl.affiliateInStorePaymentTypes"
class="test-payment-action-affiliate-in-store test-in-store-payment-type-[! inStorePaymentType.name|css !]"
>
<label class="[[ addClassIf(paymentCtrl.needsChange(inStorePaymentType), 'has-child') ]]">
<input type="radio" name=""
ng-value="inStorePaymentType"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType) || paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="radio-content"
>
<div ng-if="paymentCtrl.needsChange(inStorePaymentType)">
<table class="changedue-table"
ng-autofocus
>
<tr>
<td>
Calculate change: <span class="icon-hint" ng-tip="[! T('Optional. Leave this empty if you don\'t need to calculate change.') !]" class="respond-handhelds-hide"></span>
</td>
<td>
<div class="field field-amount ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input
type="text"
placeholder="0.00"
autocomplete="off"
step="any"
ng-float-input
ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/"
ng-model="paymentCtrl.takenAmount"
ng-amount-input
ng-amount-input-max="99999999"
ng-amount-input-min="-99999999"
data-lpignore="true"
>
<span class="field-style-hook">
[! (booking || 'usd')|currencySymbol:'short' !]
</span>
</span>
</span>
</label>
</div>
</td>
</tr>
<tr class="with-padding fh-blue changedue-total" ng-if="paymentCtrl.takenAmount">
<td>
<b>Change due</b>
</td>
<td>
<b ng-amount="paymentCtrl.takenAmount - paymentCtrl.amount()" ng-show="paymentCtrl.takenAmount"></b>
</td>
</tr>
</table>
</div>
<div ng-if="paymentCtrl.needsInStorePaymentNote(inStorePaymentType)"
class="in-store-payment-note"
>
<div class="paymentform-instorepaymentnote "
ng-django-field="paymentForm [&#39;inStorePaymentNote&#39;]" ng-django-field-model="newPayment [&#39;inStorePaymentNote&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_in_store_payment_note" maxlength="128" name="inStorePaymentNote" ng-model="newPayment [&#39;inStorePaymentNote&#39;]" ng-placeholder="[! paymentCtrl.optionAndExtras.noteLabel || T('Required payment information') !]" ng-required="true" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;inStorePaymentNote&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.FILE_OPTION)" ng-repeat="payment in paymentCtrl.cardPayments"
class="test-payment-action-file field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="payment"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge <b>[[ payment.displayProcessorBasedType ]]</b> <b>[[ payment.processorBasedIdentifier ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CARD_ON_FILE_OPTION)" ng-repeat="cardOnFile in paymentCtrl.cardsOnFile"
class="test-payment-action-card-on-file field-radio-icon--cc"
>
<label class="[! addClassIf(paymentCtrl.company.isDemoModeEnabled, 'is-disabled') !]">
<input type="radio" name=""
ng-value="cardOnFile"
ng-disabled="paymentCtrl.company.isDemoModeEnabled"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge company card <b>[[ cardOnFile.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.CHARGE_OPTION)"
class="test-payment-action-charge field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.CHARGE_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge card
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.EMV_OPTION)"
class="test-payment-action-emv field-radio-icon--cc"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.EMV_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Charge with <b>[[ emv.currentDevice.name ]]</b>
</label>
<i class="cc-icon"></i>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.IDEAL_OPTION)"
class="test-payment-action-ideal"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.IDEAL_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
iDEAL
<i ng-svg="svg-ideal"></i>
</label>
</li>
<li ng-if="paymentCtrl.isOptionValid(paymentCtrl.SOFORT_OPTION)"
class="test-payment-action-sofort"
>
<label >
<input type="radio" name=""
ng-value="paymentCtrl.SOFORT_OPTION"
ng-model="paymentCtrl [&#39;optionAndExtras&#39;]" ng-prefix="" ng-required="required"
>
Sofort
<i ng-svg="svg-sofort"></i>
</label>
</li>
<li ng-if="!paymentCtrl.isAnyOptionValid()">
No valid payment options
</li>
</ul>
</div>
</div>
<div ng-if="paymentCtrl.option() === paymentCtrl.IDEAL_OPTION"
class="labels-above"
>
<div class="paymentform-stripeidealbanktype "
ng-django-field="paymentForm [&#39;stripeIdealBankType&#39;]" ng-django-field-model="newPayment [&#39;stripeIdealBankType&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Please select your bank
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_stripe_ideal_bank_type" name="stripeIdealBankType" ng-dropdown="true" ng-model="newPayment [&#39;stripeIdealBankType&#39;]" ng-options="choice[0] as choice[1] for choice in Payment.IDEAL_BANK_TYPE_CHOICES" ng-placeholder="Bank name" ng-required="true">
<option value="abn_amro">ABN AMRO</option>
<option value="asn_bank">ASN Bank</option>
<option value="bunq">bunq</option>
<option value="handelsbanken">Handelsbanken</option>
<option value="ing">ING</option>
<option value="knab">Knab</option>
<option value="moneyou">Moneyou</option>
<option value="rabobank">Rabobank</option>
<option value="regiobank">RegioBank</option>
<option value="sns_bank">De Volksbank (SNS Bank)</option>
<option value="triodos_bank">Triodos Bank</option>
<option value="van_lanschot">Van Lanschot</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;stripeIdealBankType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;stripeIdealBankType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="paymentCtrl.option() === paymentCtrl.SOFORT_OPTION"
class="labels-above"
>
<div class="paymentform-stripesofortcountry "
ng-django-field="paymentForm [&#39;stripeSofortCountry&#39;]" ng-django-field-model="newPayment [&#39;stripeSofortCountry&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Please select your country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_stripe_sofort_country" name="stripeSofortCountry" ng-dropdown="true" ng-model="newPayment [&#39;stripeSofortCountry&#39;]" ng-options="choice[0] as choice[1] for choice in Payment.SOFORT_COUNTRY_CHOICES" ng-placeholder="Country name" ng-required="true">
<option value="AT">Austria</option>
<option value="BE">Belgium</option>
<option value="DE">Germany</option>
<option value="IT">Italy</option>
<option value="NL">Netherlands</option>
<option value="ES">Spain</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;stripeSofortCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;stripeSofortCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="paymentCtrl.needsCharge()">
<div class="form-error" ng-if="paymentCtrl.isAmountTooLow()">
<span ng-if="!auth.currentUser.isAuthenticated" ng-then="isAnonUser">
Sorry, payment cannot be taken at this time.
<a href="https://fareharbor.com/help/submit/">Please contact FareHarbor.</a>
(Error code LH-[! Payment.MIN_CHARGE_AMOUNT !].)
</span>
<span ng-else="isAnonUser">
<span ng-if="paymentCtrl.needsCharge()" ng-then="chargeTooLow">
Sorry, cards cannot be charged for amounts less than [! Payment.MIN_CHARGE_AMOUNT|amount:booking !].
</span>
<span ng-else="chargeTooLow">
Sorry, payments cannot be created for [! 0|amount:booking !].
</span>
</span>
</div>
</div>
<div ng-if="paymentCtrl.needsCardFields() && !paymentCtrl.isAmountTooLow()">
<div class="card-fields card-type-[[ paymentCtrl.cardTypeAbbreviation() ]]"
ng-class="{ 'test-cards-only': paymentCtrl.company.isDemoModeEnabled }"
>
<div class="card-fields-inner">
<div ng-if="paymentCtrl.company.isDemoModeEnabled" ng-then="demoCardForm"
class="card-fields-demo"
>
Demo mode
<i class="help-icon"
ng-tip="[! T('You can only use test credit card numbers while demo mode is on') !]"
></i>
</div>
<div ng-else="demoCardForm"
class="card-fields-secure"
>
<i class="icon-lock-green"></i> Secure and encrypted
<i class="icon-hint"
ng-hide="auth.currentUser.isAuthenticated"
ng-tip="[! interpolate(T('%(companyName)s will only be able to see the last 4 digits of your card number'), { companyName: paymentCtrl.company.name }) !]"
ng-tip-classes="tip-indent"
ng-tip-touch="true"
></i>
</div>
<div class="native-swiped-container"
ng-if="paymentCtrl.swiped && native.isNative"
ng-then="nativeSwiped"
>
<div>
<span class="badge badge-green">Swiped successfully</span>
</div>
<span class="card-number">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardLast4() ]]"
ng-model="newPayment"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</span>
<div class="card-name">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardholdersName() ]]"
ng-model="newPayment"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<a ng-click="paymentCtrl.stopSwiping()" class="btn btn-grey">
Enter different card
</a>
</div>
<div ng-else="nativeSwiped">
<span class="card-type-logo"></span>
<span class="card-number" ng-if-once="clientOptions.isKioskModeEnabled" ng-then="kioskMode">
<div class="paymentform-cardnumber hide-label-text "
ng-django-field="paymentForm [&#39;cardNumber&#39;]" ng-django-field-model="newPayment [&#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="newPayment [&#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-required="true" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span class="card-number" ng-else-once="kioskMode">
<div class="paymentform-cardnumber hide-label-text "
ng-django-field="paymentForm [&#39;cardNumber&#39;]" ng-django-field-model="newPayment [&#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="newPayment [&#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-required="true" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="card-name">
<span ng-if-once="kioskMode">
<div class="paymentform-cardholdersname field-person-icon hide-label-text "
ng-django-field="paymentForm [&#39;cardholdersName&#39;]" ng-django-field-model="newPayment [&#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="newPayment [&#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="paymentform-cardholdersname field-person-icon hide-label-text "
ng-django-field="paymentForm [&#39;cardholdersName&#39;]" ng-django-field-model="newPayment [&#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="newPayment [&#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Cardholder\'s name must match the name printed on the card') !]"
ng-tip-touch="true"
></div>
</div>
<div class="card-expiry">
<div class="card-form-header">Expiration date</div>
<div class="exp-month">
<div class="paymentform-cardexpirymonth
pseudo-select
"
ng-django-field="paymentForm [&#39;cardExpiryMonth&#39;]" ng-django-field-model="newPayment [&#39;cardExpiryMonth&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName()" ng-then="hasValuecardMonth">
[[ KioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName() ]]
</span>
<span ng-else="hasValuecardMonth" class="exp-placeholder">
Month
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_month" name="cardExpiryMonth" ng-model="newPayment [&#39;cardExpiryMonth&#39;]" required="required">
<option value="1">01 - January</option>
<option value="2">02 - February</option>
<option value="3">03 - March</option>
<option value="4">04 - April</option>
<option value="5">05 - May</option>
<option value="6">06 - June</option>
<option value="7">07 - July</option>
<option value="8">08 - August</option>
<option value="9">09 - September</option>
<option value="10">10 - October</option>
<option value="11">11 - November</option>
<option value="12">12 - December</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;cardExpiryMonth&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;cardExpiryMonth&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="exp-year">
<div class="paymentform-cardexpiryyear
pseudo-select
"
ng-django-field="paymentForm [&#39;cardExpiryYear&#39;]" ng-django-field-model="newPayment [&#39;cardExpiryYear&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year()" ng-then="hasValuecardYear">
[[ KioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year() ]]
</span>
<span ng-else="hasValuecardYear" class="exp-placeholder">
Year
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_year" name="cardExpiryYear" ng-model="newPayment [&#39;cardExpiryYear&#39;]" required="required">
<option value="2019">2019</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
<option value="2028">2028</option>
<option value="2029">2029</option>
<option value="2030">2030</option>
<option value="2031">2031</option>
<option value="2032">2032</option>
<option value="2033">2033</option>
<option value="2034">2034</option>
<option value="2035">2035</option>
<option value="2036">2036</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;cardExpiryYear&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;cardExpiryYear&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="card-country-code">
<div class="paymentform-countrycode field-select-full "
ng-django-field="paymentForm [&#39;countryCode&#39;]" ng-django-field-model="newPayment [&#39;countryCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || newPayment [&#39;postalCode&#39;]"
>
<label >
<span class="label-text">
Country/Region
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_country_code" name="countryCode" ng-model="newPayment [&#39;countryCode&#39;]" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || newPayment [&#39;postalCode&#39;]">
<option value="" selected="selected"></option>
<option value="US">USA</option>
<option value="AF">Afghanistan</option>
<option value="AL">Albania</option>
<option value="DZ">Algeria</option>
<option value="AS">American Samoa</option>
<option value="AD">Andorra</option>
<option value="AO">Angola</option>
<option value="AI">Anguilla</option>
<option value="AQ">Antarctica</option>
<option value="AG">Antigua & Barbuda</option>
<option value="AR">Argentina</option>
<option value="AM">Armenia</option>
<option value="AW">Aruba</option>
<option value="AU">Australia</option>
<option value="AT">Austria</option>
<option value="AZ">Azerbaijan</option>
<option value="BS">Bahama</option>
<option value="BH">Bahrain</option>
<option value="BD">Bangladesh</option>
<option value="BB">Barbados</option>
<option value="BY">Belarus</option>
<option value="BE">Belgium</option>
<option value="BZ">Belize</option>
<option value="BJ">Benin</option>
<option value="BM">Bermuda</option>
<option value="BT">Bhutan</option>
<option value="BO">Bolivia</option>
<option value="BA">Bosnia and Herzegovina</option>
<option value="BW">Botswana</option>
<option value="BV">Bouvet Island</option>
<option value="BR">Brazil</option>
<option value="IO">British Indian Ocean Territory</option>
<option value="VG">British Virgin Islands</option>
<option value="BN">Brunei Darussalam</option>
<option value="BG">Bulgaria</option>
<option value="BF">Burkina Faso</option>
<option value="BI">Burundi</option>
<option value="KH">Cambodia</option>
<option value="CM">Cameroon</option>
<option value="CA">Canada</option>
<option value="CV">Cape Verde</option>
<option value="KY">Cayman Islands</option>
<option value="CF">Central African Republic</option>
<option value="TD">Chad</option>
<option value="CL">Chile</option>
<option value="CN">China</option>
<option value="CX">Christmas Island</option>
<option value="CC">Cocos (Keeling) Islands</option>
<option value="CO">Colombia</option>
<option value="KM">Comoros</option>
<option value="CG">Congo</option>
<option value="CK">Cook Iislands</option>
<option value="CR">Costa Rica</option>
<option value="HR">Croatia</option>
<option value="CU">Cuba</option>
<option value="CY">Cyprus</option>
<option value="CZ">Czech Republic</option>
<option value="DK">Denmark</option>
<option value="DJ">Djibouti</option>
<option value="DM">Dominica</option>
<option value="DO">Dominican Republic</option>
<option value="TP">East Timor</option>
<option value="EC">Ecuador</option>
<option value="EG">Egypt</option>
<option value="SV">El Salvador</option>
<option value="GQ">Equatorial Guinea</option>
<option value="ER">Eritrea</option>
<option value="EE">Estonia</option>
<option value="ET">Ethiopia</option>
<option value="FK">Falkland Islands (Malvinas)</option>
<option value="FO">Faroe Islands</option>
<option value="FJ">Fiji</option>
<option value="FI">Finland</option>
<option value="FR">France</option>
<option value="FX">France, Metropolitan</option>
<option value="GF">French Guiana</option>
<option value="PF">French Polynesia</option>
<option value="TF">French Southern Territories</option>
<option value="GA">Gabon</option>
<option value="GM">Gambia</option>
<option value="GE">Georgia</option>
<option value="DE">Germany</option>
<option value="GH">Ghana</option>
<option value="GI">Gibraltar</option>
<option value="GR">Greece</option>
<option value="GL">Greenland</option>
<option value="GD">Grenada</option>
<option value="GP">Guadeloupe</option>
<option value="GU">Guam</option>
<option value="GT">Guatemala</option>
<option value="GN">Guinea</option>
<option value="GW">Guinea-Bissau</option>
<option value="GY">Guyana</option>
<option value="HT">Haiti</option>
<option value="HM">Heard & McDonald Islands</option>
<option value="HN">Honduras</option>
<option value="HK">Hong Kong</option>
<option value="HU">Hungary</option>
<option value="IS">Iceland</option>
<option value="IN">India</option>
<option value="ID">Indonesia</option>
<option value="IQ">Iraq</option>
<option value="IE">Ireland</option>
<option value="IR">Islamic Republic of Iran</option>
<option value="IL">Israel</option>
<option value="IT">Italy</option>
<option value="CI">Ivory Coast</option>
<option value="JM">Jamaica</option>
<option value="JP">Japan</option>
<option value="JO">Jordan</option>
<option value="KZ">Kazakhstan</option>
<option value="KE">Kenya</option>
<option value="KI">Kiribati</option>
<option value="KP">Korea, Democratic People's Republic of</option>
<option value="KR">Korea, Republic of</option>
<option value="KW">Kuwait</option>
<option value="KG">Kyrgyzstan</option>
<option value="LA">Lao People's Democratic Republic</option>
<option value="LV">Latvia</option>
<option value="LB">Lebanon</option>
<option value="LS">Lesotho</option>
<option value="LR">Liberia</option>
<option value="LY">Libyan Arab Jamahiriya</option>
<option value="LI">Liechtenstein</option>
<option value="LT">Lithuania</option>
<option value="LU">Luxembourg</option>
<option value="MO">Macau</option>
<option value="MG">Madagascar</option>
<option value="MW">Malawi</option>
<option value="MY">Malaysia</option>
<option value="MV">Maldives</option>
<option value="ML">Mali</option>
<option value="MT">Malta</option>
<option value="MH">Marshall Islands</option>
<option value="MQ">Martinique</option>
<option value="MR">Mauritania</option>
<option value="MU">Mauritius</option>
<option value="YT">Mayotte</option>
<option value="MX">Mexico</option>
<option value="FM">Micronesia</option>
<option value="MD">Moldova, Republic of</option>
<option value="MC">Monaco</option>
<option value="MN">Mongolia</option>
<option value="MS">Monserrat</option>
<option value="MA">Morocco</option>
<option value="MZ">Mozambique</option>
<option value="MM">Myanmar</option>
<option value="NA">Namibia</option>
<option value="NR">Nauru</option>
<option value="NP">Nepal</option>
<option value="NL">Netherlands</option>
<option value="AN">Netherlands Antilles</option>
<option value="NC">New Caledonia</option>
<option value="NZ">New Zealand</option>
<option value="NI">Nicaragua</option>
<option value="NE">Niger</option>
<option value="NG">Nigeria</option>
<option value="NU">Niue</option>
<option value="NF">Norfolk Island</option>
<option value="MP">Northern Mariana Islands</option>
<option value="NO">Norway</option>
<option value="OM">Oman</option>
<option value="PK">Pakistan</option>
<option value="PW">Palau</option>
<option value="PA">Panama</option>
<option value="PG">Papua New Guinea</option>
<option value="PY">Paraguay</option>
<option value="PE">Peru</option>
<option value="PH">Philippines</option>
<option value="PN">Pitcairn</option>
<option value="PL">Poland</option>
<option value="PT">Portugal</option>
<option value="PR">Puerto Rico</option>
<option value="QA">Qatar</option>
<option value="RE">Reunion</option>
<option value="RO">Romania</option>
<option value="RU">Russian Federation</option>
<option value="RW">Rwanda</option>
<option value="LC">Saint Lucia</option>
<option value="WS">Samoa</option>
<option value="SM">San Marino</option>
<option value="ST">Sao Tome & Principe</option>
<option value="SA">Saudi Arabia</option>
<option value="SN">Senegal</option>
<option value="RS">Serbia</option>
<option value="SC">Seychelles</option>
<option value="SL">Sierra Leone</option>
<option value="SG">Singapore</option>
<option value="SK">Slovakia</option>
<option value="SI">Slovenia</option>
<option value="SB">Solomon Islands</option>
<option value="SO">Somalia</option>
<option value="ZA">South Africa</option>
<option value="GS">South Georgia and the South Sandwich Islands</option>
<option value="ES">Spain</option>
<option value="LK">Sri Lanka</option>
<option value="SH">St. Helena</option>
<option value="KN">St. Kitts and Nevis</option>
<option value="PM">St. Pierre & Miquelon</option>
<option value="VC">St. Vincent & the Grenadines</option>
<option value="SD">Sudan</option>
<option value="SR">Suriname</option>
<option value="SJ">Svalbard & Jan Mayen Islands</option>
<option value="SZ">Swaziland</option>
<option value="SE">Sweden</option>
<option value="CH">Switzerland</option>
<option value="SY">Syrian Arab Republic</option>
<option value="TW">Taiwan</option>
<option value="TJ">Tajikistan</option>
<option value="TZ">Tanzania, United Republic of</option>
<option value="TH">Thailand</option>
<option value="TG">Togo</option>
<option value="TK">Tokelau</option>
<option value="TO">Tonga</option>
<option value="TT">Trinidad & Tobago</option>
<option value="TN">Tunisia</option>
<option value="TR">Turkey</option>
<option value="TM">Turkmenistan</option>
<option value="TC">Turks & Caicos Islands</option>
<option value="TV">Tuvalu</option>
<option value="UG">Uganda</option>
<option value="UA">Ukraine</option>
<option value="AE">United Arab Emirates</option>
<option value="GB">United Kingdom (Great Britain)</option>
<option value="UM">United States Minor Outlying Islands</option>
<option value="VI">United States Virgin Islands</option>
<option value="US">USA</option>
<option value="ZZ">Unknown or unspecified country</option>
<option value="UY">Uruguay</option>
<option value="UZ">Uzbekistan</option>
<option value="VU">Vanuatu</option>
<option value="VA">Vatican City State (Holy See)</option>
<option value="VE">Venezuela</option>
<option value="VN">Viet Nam</option>
<option value="WF">Wallis & Futuna Islands</option>
<option value="EH">Western Sahara</option>
<option value="YE">Yemen</option>
<option value="YU">Yugoslavia</option>
<option value="ZR">Zaire</option>
<option value="ZM">Zambia</option>
<option value="ZW">Zimbabwe</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;countryCode&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;countryCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="card-cvc-postal">
<div class="card-cvc"
ng-shortcut="'shift+alt+c'"
ng-shortcut-action="auth.permissions.can('createWithoutCVC', Payment, paymentCtrl.company) && paymentCtrl.overrideCvc()"
>
<span ng-if-once="kioskMode">
<div class="paymentform-cardcvc hide-label-text "
ng-django-field="paymentForm [&#39;cardCvc&#39;]" ng-django-field-model="newPayment [&#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="newPayment [&#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="paymentform-cardcvc hide-label-text "
ng-django-field="paymentForm [&#39;cardCvc&#39;]" ng-django-field-model="newPayment [&#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="newPayment [&#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="<span class='cvc-icon'></span> [! T('Your card\'s three or four digit verification number, usually on the back') !]"
ng-tip-classes="tip-text-left"
ng-tip-touch="true"
></div>
</div>
<div class="card-postal"
ng-if="newPayment [&#39;countryCode&#39;] && Payment.needsPostalCode(newPayment [&#39;countryCode&#39;])"
>
<span ng-if-once="kioskMode">
<div class="paymentform-postalcode field-location-icon hide-label-text "
ng-django-field="paymentForm [&#39;postalCode&#39;]" ng-django-field-model="newPayment [&#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="newPayment [&#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="paymentform-postalcode field-location-icon hide-label-text "
ng-django-field="paymentForm [&#39;postalCode&#39;]" ng-django-field-model="newPayment [&#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="newPayment [&#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Please enter your billing postal code (zip code) for verification') !]"
ng-tip-touch="true"
></div>
</div>
</div>
</div>
<a class="card-swipe"
ng-click="paymentCtrl.startSwiping()"
ng-if="paymentCtrl.showingSwipe && !paymentCtrl.cardTypeAbbreviation()"
ng-tip="[! T('Swipe card') !]"
ng-tip-classes="tip-indent"
>
Swipe card
</a>
<div class="swiping" ng-if="paymentCtrl.swiping">
<input class="swipe-input" type="text" ng-swipe="paymentCtrl.swipeComplete" />
<div class="swiping-inner">
<div><img ng-src="//dp58aslhmbcib.cloudfront.net/static/images/card-swipe.gif?99774cb15b0528a7a2caeeb2a01921cc3e14532e" /></div>
Ready to swipe card...
</div>
</div>
</div>
<div class="amex-note"
ng-if="auth.currentUser.isAuthenticated && !newPayment [&#39;countryCode&#39;]"
>
<b>Note:</b> It is strongly recommended that you enter the country for American Express cards, or the charge will fail.
</div>
<div ng-if="!company.isDemoModeEnabled"
ng-link="payment-setup-nag"
ng-init="isShort = true"
></div>
</div>
</div>
<div ng-if="!paymentCtrl.isAnonymous && paymentCtrl.isAnyKindValid() && paymentCtrl.kind() !== paymentCtrl.SKIP_KIND"
class="payment-comment"
>
<a ng-toggle="paymentComment" class="form-link-subtle hide-when-toggled">Add comment to payment</a>
<div ng-toggled="paymentComment">
<div class="paymentform-note "
ng-django-field="paymentForm [&#39;note&#39;]" ng-django-field-model="newPayment [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-autofocus="true" ng-model="newPayment [&#39;note&#39;]" ng-placeholder="Payment comment (not visible to customer)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-can-create="Notification on company">
<div class="paymentform-sendnotification field-cb-email "
ng-django-field="paymentForm [&#39;sendNotification&#39;]" ng-django-field-model="newPayment [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="newPayment [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Email receipt
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="newPayment.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="paymentform-notification-emails "
ng-django-field="paymentForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="paymentform-notification-subject "
ng-django-field="paymentForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="paymentform-notification-note field-textarea
"
ng-django-field="paymentForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".paymentform-notification-note" ng-model="newPayment [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
</div>
<div class="hide">
<div ng-if="paymentCtrl.needsCardFields()">
<div class="paymentform-stripetoken "
ng-django-field="paymentForm [&#39;stripeToken&#39;]" ng-django-field-model="newPayment [&#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="newPayment [&#39;stripeToken&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="paymentform-cardlast4 "
ng-django-field="paymentForm [&#39;cardLast4&#39;]" ng-django-field-model="newPayment [&#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="newPayment [&#39;cardLast4&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="paymentform-cardtype "
ng-django-field="paymentForm [&#39;cardType&#39;]" ng-django-field-model="newPayment [&#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="newPayment [&#39;cardType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="paymentForm.all.$error.invalid_emv_provider">Payment device provider not recognized. Please contact FareHarbor Support.</li>
<li ng-if="paymentForm.all.$error.tokenization_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.booking_affiliation_required">An affiliate must be selected.</li>
<li ng-if="paymentForm.all.$error.is_demo_does_not_match">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.stored_value_card_not_found">Gift card not found. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.ideal_not_enabled">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cant_create_affiliate_payments">Cannot create affiliate payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cant_create_stored_value_card_payments">Sorry, your account is not authorized to redeem gift cards.</li>
<li ng-if="paymentForm.all.$error.cannot_add_payment_to_demo_booking">Demo mode must be enabled to add payments to demo bookings.</li>
<li ng-if="paymentForm.all.$error.missing_in_store_payment_note">&#39;%(payment_note)s&#39; cannot be empty. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.card_not_found">Card not found.</li>
<li ng-if="paymentForm.all.$error.stripe_ideal_bank_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.charge_amount_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-HIGH)</li>
<li ng-if="paymentForm.all.$error.booking_fee_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-LOW)</li>
<li ng-if="paymentForm.all.$error.gross_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-LOW)</li>
<li ng-if="paymentForm.all.$error.cannot_create_demo_card_on_file_payment">Cannot create a payment for a saved card when demo mode is enabled.</li>
<li ng-if="paymentForm.all.$error.invalid_processor_type">Outdated payment processor. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.non_affiliate_collected_by_affiliate">Only payments collected by affiliates may be marked as such. Please contact FareHarbor Support. (A-2)</li>
<li ng-if="paymentForm.all.$error.booking_fee_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-HIGH)</li>
<li ng-if="paymentForm.all.$error.invalid_option">Invalid payment option. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.ideal_option_requires_pending_bookings">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cardholders_name_not_specified">Payment could not be processed. Cardholder's name is required.</li>
<li ng-if="paymentForm.all.$error.cant_create_credit_card_payment">Cannot create credit card payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.affiliate_not_collected_by_affiliate">Payments collected by affiliates must be marked as such. Please contact FareHarbor Support. (A-1)</li>
<li ng-if="paymentForm.all.$error.cant_skip_payment">Cannot skip payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.unauthorized_card_access">Unable to use card for payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.in_store_payment_type_not_valid">Cannot create in-store payment, selection not valid. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.country_code_not_specified">Payment could not be processed. Billing country is required. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cant_create_in_store_payments">Cannot create in-store payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.charge_amount_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-UNSPECIFIED)</li>
<li ng-if="paymentForm.all.$error.cannot_add_payment_to_non_demo_booking">Demo mode must be disabled to add payments to non-demo bookings.</li>
<li ng-if="paymentForm.all.$error.no_relevant_bookings">Cannot create payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cannot_create_demo_ideal_payment">Cannot pay with iDEAL when demo mode is enabled.</li>
<li ng-if="paymentForm.all.$error.gross_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-HIGH)</li>
<li ng-if="paymentForm.all.$error.booking_fee_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-UNSPECIFIED)</li>
<li ng-if="paymentForm.all.$error.cant_defer_payment">Cannot save card. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.invalid_processor">No processor found. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.in_store_payment_type_not_found">Cannot create in-store payment, type not found. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.gross_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-UNSPECIFIED)</li>
<li ng-if="paymentForm.all.$error.charge_amount_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-LOW)</li>
<li ng-if="paymentForm.all.$error.booking_rebooked">This booking has been rebooked. Please refresh the page.</li>
<li ng-if="paymentForm.all.$error.cant_charge_card">Cannot charge that card. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.postal_code_not_specified">Payment could not be processed. Billing postal (zip) code is required. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.in_store_payment_type_not_authorized">Sorry, you are not authorized to create in-store payments. Please refresh the page and try again.</li>
<li ng-repeat="error in paymentForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="paymentForm.all.$error.$tokenization">
<li ng-repeat="error in paymentForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
<div ng-if="(emv.isDebugging || paymentForm.all.$error.$providerDeclined) && emv.lastDecline()">
<ul class="errors test-provider-error-indicator respond-print-hide">
<li>
Authorization for this charge was declined.
<div>
<a ng-toggle="printDecline">Print decline receipt</a>
</div>
</li>
</ul>
<div ng-toggled="printDecline">
<button type="button"
ng-print
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide "
>
Print
</button>
<div class="native-receipt">
<div ng-link="emv-decline-receipt"
class="print-receipt"
ng-init="
receipt = emv.lastDecline().merchantReceipt;
label = T('Merchant Receipt')
"
></div>
<div ng-link="emv-decline-receipt"
class="print-receipt"
ng-init="
receipt = emv.lastDecline().customerReceipt;
label = T('Customer Receipt')
"
></div>
</div>
</div>
</div>
</div>
<div class="btns respond-print-hide"
ng-init="paymentCtrl.form(paymentForm)"
>
<button class="btn-big btn-wide btn-green test-submit-payment-form-action"
ng-disabled="
paymentForm.$invalid ||
paymentForm.$submitting ||
!paymentCtrl.isCurrentKindValid() ||
!paymentCtrl.isCurrentOptionValid() ||
paymentCtrl.isAmountTooLow()
"
>
Add payment
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.DEFER)">
<div ng-controller=
"dashboard.bookings.DeferredPaymentCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-show="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Saving card...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-show="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Save card to charge later</h2>
<a ng-href="https://fareharbor.com/help/payments/credit-card/saving-a-card/"
ng-outbound-link="_blank"
class="hint-help-link"
>How to use saved cards &rsaquo;</a>
</div>
</div>
<p class="action-sheet-help">
Enter a card to verify and save it to charge later:
</p>
<form name="paymentForm"
ng-confirm-navigate-away
ng-submit="submit(paymentForm)"
ng-autofocus
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="paymentsForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="card-fields card-type-[[ paymentCtrl.cardTypeAbbreviation() ]]"
ng-class="{ 'test-cards-only': paymentCtrl.company.isDemoModeEnabled }"
>
<div class="card-fields-inner">
<div ng-if="paymentCtrl.company.isDemoModeEnabled" ng-then="demoCardForm"
class="card-fields-demo"
>
Demo mode
<i class="help-icon"
ng-tip="[! T('You can only use test credit card numbers while demo mode is on') !]"
></i>
</div>
<div ng-else="demoCardForm"
class="card-fields-secure"
>
<i class="icon-lock-green"></i> Secure and encrypted
<i class="icon-hint"
ng-hide="auth.currentUser.isAuthenticated"
ng-tip="[! interpolate(T('%(companyName)s will only be able to see the last 4 digits of your card number'), { companyName: paymentCtrl.company.name }) !]"
ng-tip-classes="tip-indent"
ng-tip-touch="true"
></i>
</div>
<div class="native-swiped-container"
ng-if="paymentCtrl.swiped && native.isNative"
ng-then="nativeSwiped"
>
<div>
<span class="badge badge-green">Swiped successfully</span>
</div>
<span class="card-number">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardLast4() ]]"
ng-model="newPayment"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</span>
<div class="card-name">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
value="[[ paymentCtrl.cardholdersName() ]]"
ng-model="newPayment"
disabled
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<a ng-click="paymentCtrl.stopSwiping()" class="btn btn-grey">
Enter different card
</a>
</div>
<div ng-else="nativeSwiped">
<span class="card-type-logo"></span>
<span class="card-number" ng-if-once="clientOptions.isKioskModeEnabled" ng-then="kioskMode">
<div class="paymentform-cardnumber hide-label-text "
ng-django-field="paymentForm [&#39;cardNumber&#39;]" ng-django-field-model="newPayment [&#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="newPayment [&#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-required="true" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span class="card-number" ng-else-once="kioskMode">
<div class="paymentform-cardnumber hide-label-text "
ng-django-field="paymentForm [&#39;cardNumber&#39;]" ng-django-field-model="newPayment [&#39;cardNumber&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Card number
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_number" maxlength="16" name="cardNumber" ng-model="newPayment [&#39;cardNumber&#39;]" ng-pattern="/^[23456]\d{13,15}$/" ng-placeholder="Card number" ng-required="true" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="card-name">
<span ng-if-once="kioskMode">
<div class="paymentform-cardholdersname field-person-icon hide-label-text "
ng-django-field="paymentForm [&#39;cardholdersName&#39;]" ng-django-field-model="newPayment [&#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="newPayment [&#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="paymentform-cardholdersname field-person-icon hide-label-text "
ng-django-field="paymentForm [&#39;cardholdersName&#39;]" ng-django-field-model="newPayment [&#39;cardholdersName&#39;]"
ng-django-field-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Name printed on card
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_cardholders_name" maxlength="64" name="cardholdersName" ng-model="newPayment [&#39;cardholdersName&#39;]" ng-placeholder="Name printed on card" ng-required="!auth.permissions.can('createWithoutCardholdersName', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardholdersName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Cardholder\'s name must match the name printed on the card') !]"
ng-tip-touch="true"
></div>
</div>
<div class="card-expiry">
<div class="card-form-header">Expiration date</div>
<div class="exp-month">
<div class="paymentform-cardexpirymonth
pseudo-select
"
ng-django-field="paymentForm [&#39;cardExpiryMonth&#39;]" ng-django-field-model="newPayment [&#39;cardExpiryMonth&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName()" ng-then="hasValuecardMonth">
[[ KioskMode && !!paymentCtrl.monthName() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.monthName() ]]
</span>
<span ng-else="hasValuecardMonth" class="exp-placeholder">
Month
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_month" name="cardExpiryMonth" ng-model="newPayment [&#39;cardExpiryMonth&#39;]" required="required">
<option value="1">01 - January</option>
<option value="2">02 - February</option>
<option value="3">03 - March</option>
<option value="4">04 - April</option>
<option value="5">05 - May</option>
<option value="6">06 - June</option>
<option value="7">07 - July</option>
<option value="8">08 - August</option>
<option value="9">09 - September</option>
<option value="10">10 - October</option>
<option value="11">11 - November</option>
<option value="12">12 - December</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;cardExpiryMonth&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;cardExpiryMonth&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="exp-year">
<div class="paymentform-cardexpiryyear
pseudo-select
"
ng-django-field="paymentForm [&#39;cardExpiryYear&#39;]" ng-django-field-model="newPayment [&#39;cardExpiryYear&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
<span ng-if="kioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year()" ng-then="hasValuecardYear">
[[ KioskMode && !!paymentCtrl.year() ? '\u2022\u2022\u2022\u2022' : paymentCtrl.year() ]]
</span>
<span ng-else="hasValuecardYear" class="exp-placeholder">
Year
</span>
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_card_expiry_year" name="cardExpiryYear" ng-model="newPayment [&#39;cardExpiryYear&#39;]" required="required">
<option value="2019">2019</option>
<option value="2020">2020</option>
<option value="2021">2021</option>
<option value="2022">2022</option>
<option value="2023">2023</option>
<option value="2024">2024</option>
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
<option value="2028">2028</option>
<option value="2029">2029</option>
<option value="2030">2030</option>
<option value="2031">2031</option>
<option value="2032">2032</option>
<option value="2033">2033</option>
<option value="2034">2034</option>
<option value="2035">2035</option>
<option value="2036">2036</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;cardExpiryYear&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;cardExpiryYear&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="card-country-code">
<div class="paymentform-countrycode field-select-full "
ng-django-field="paymentForm [&#39;countryCode&#39;]" ng-django-field-model="newPayment [&#39;countryCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || newPayment [&#39;postalCode&#39;]"
>
<label >
<span class="label-text">
Country/Region
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_country_code" name="countryCode" ng-model="newPayment [&#39;countryCode&#39;]" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can(&#39;createWithoutCountryCode&#39;, Payment, paymentCtrl.company) || newPayment [&#39;postalCode&#39;]">
<option value="" selected="selected"></option>
<option value="US">USA</option>
<option value="AF">Afghanistan</option>
<option value="AL">Albania</option>
<option value="DZ">Algeria</option>
<option value="AS">American Samoa</option>
<option value="AD">Andorra</option>
<option value="AO">Angola</option>
<option value="AI">Anguilla</option>
<option value="AQ">Antarctica</option>
<option value="AG">Antigua & Barbuda</option>
<option value="AR">Argentina</option>
<option value="AM">Armenia</option>
<option value="AW">Aruba</option>
<option value="AU">Australia</option>
<option value="AT">Austria</option>
<option value="AZ">Azerbaijan</option>
<option value="BS">Bahama</option>
<option value="BH">Bahrain</option>
<option value="BD">Bangladesh</option>
<option value="BB">Barbados</option>
<option value="BY">Belarus</option>
<option value="BE">Belgium</option>
<option value="BZ">Belize</option>
<option value="BJ">Benin</option>
<option value="BM">Bermuda</option>
<option value="BT">Bhutan</option>
<option value="BO">Bolivia</option>
<option value="BA">Bosnia and Herzegovina</option>
<option value="BW">Botswana</option>
<option value="BV">Bouvet Island</option>
<option value="BR">Brazil</option>
<option value="IO">British Indian Ocean Territory</option>
<option value="VG">British Virgin Islands</option>
<option value="BN">Brunei Darussalam</option>
<option value="BG">Bulgaria</option>
<option value="BF">Burkina Faso</option>
<option value="BI">Burundi</option>
<option value="KH">Cambodia</option>
<option value="CM">Cameroon</option>
<option value="CA">Canada</option>
<option value="CV">Cape Verde</option>
<option value="KY">Cayman Islands</option>
<option value="CF">Central African Republic</option>
<option value="TD">Chad</option>
<option value="CL">Chile</option>
<option value="CN">China</option>
<option value="CX">Christmas Island</option>
<option value="CC">Cocos (Keeling) Islands</option>
<option value="CO">Colombia</option>
<option value="KM">Comoros</option>
<option value="CG">Congo</option>
<option value="CK">Cook Iislands</option>
<option value="CR">Costa Rica</option>
<option value="HR">Croatia</option>
<option value="CU">Cuba</option>
<option value="CY">Cyprus</option>
<option value="CZ">Czech Republic</option>
<option value="DK">Denmark</option>
<option value="DJ">Djibouti</option>
<option value="DM">Dominica</option>
<option value="DO">Dominican Republic</option>
<option value="TP">East Timor</option>
<option value="EC">Ecuador</option>
<option value="EG">Egypt</option>
<option value="SV">El Salvador</option>
<option value="GQ">Equatorial Guinea</option>
<option value="ER">Eritrea</option>
<option value="EE">Estonia</option>
<option value="ET">Ethiopia</option>
<option value="FK">Falkland Islands (Malvinas)</option>
<option value="FO">Faroe Islands</option>
<option value="FJ">Fiji</option>
<option value="FI">Finland</option>
<option value="FR">France</option>
<option value="FX">France, Metropolitan</option>
<option value="GF">French Guiana</option>
<option value="PF">French Polynesia</option>
<option value="TF">French Southern Territories</option>
<option value="GA">Gabon</option>
<option value="GM">Gambia</option>
<option value="GE">Georgia</option>
<option value="DE">Germany</option>
<option value="GH">Ghana</option>
<option value="GI">Gibraltar</option>
<option value="GR">Greece</option>
<option value="GL">Greenland</option>
<option value="GD">Grenada</option>
<option value="GP">Guadeloupe</option>
<option value="GU">Guam</option>
<option value="GT">Guatemala</option>
<option value="GN">Guinea</option>
<option value="GW">Guinea-Bissau</option>
<option value="GY">Guyana</option>
<option value="HT">Haiti</option>
<option value="HM">Heard & McDonald Islands</option>
<option value="HN">Honduras</option>
<option value="HK">Hong Kong</option>
<option value="HU">Hungary</option>
<option value="IS">Iceland</option>
<option value="IN">India</option>
<option value="ID">Indonesia</option>
<option value="IQ">Iraq</option>
<option value="IE">Ireland</option>
<option value="IR">Islamic Republic of Iran</option>
<option value="IL">Israel</option>
<option value="IT">Italy</option>
<option value="CI">Ivory Coast</option>
<option value="JM">Jamaica</option>
<option value="JP">Japan</option>
<option value="JO">Jordan</option>
<option value="KZ">Kazakhstan</option>
<option value="KE">Kenya</option>
<option value="KI">Kiribati</option>
<option value="KP">Korea, Democratic People's Republic of</option>
<option value="KR">Korea, Republic of</option>
<option value="KW">Kuwait</option>
<option value="KG">Kyrgyzstan</option>
<option value="LA">Lao People's Democratic Republic</option>
<option value="LV">Latvia</option>
<option value="LB">Lebanon</option>
<option value="LS">Lesotho</option>
<option value="LR">Liberia</option>
<option value="LY">Libyan Arab Jamahiriya</option>
<option value="LI">Liechtenstein</option>
<option value="LT">Lithuania</option>
<option value="LU">Luxembourg</option>
<option value="MO">Macau</option>
<option value="MG">Madagascar</option>
<option value="MW">Malawi</option>
<option value="MY">Malaysia</option>
<option value="MV">Maldives</option>
<option value="ML">Mali</option>
<option value="MT">Malta</option>
<option value="MH">Marshall Islands</option>
<option value="MQ">Martinique</option>
<option value="MR">Mauritania</option>
<option value="MU">Mauritius</option>
<option value="YT">Mayotte</option>
<option value="MX">Mexico</option>
<option value="FM">Micronesia</option>
<option value="MD">Moldova, Republic of</option>
<option value="MC">Monaco</option>
<option value="MN">Mongolia</option>
<option value="MS">Monserrat</option>
<option value="MA">Morocco</option>
<option value="MZ">Mozambique</option>
<option value="MM">Myanmar</option>
<option value="NA">Namibia</option>
<option value="NR">Nauru</option>
<option value="NP">Nepal</option>
<option value="NL">Netherlands</option>
<option value="AN">Netherlands Antilles</option>
<option value="NC">New Caledonia</option>
<option value="NZ">New Zealand</option>
<option value="NI">Nicaragua</option>
<option value="NE">Niger</option>
<option value="NG">Nigeria</option>
<option value="NU">Niue</option>
<option value="NF">Norfolk Island</option>
<option value="MP">Northern Mariana Islands</option>
<option value="NO">Norway</option>
<option value="OM">Oman</option>
<option value="PK">Pakistan</option>
<option value="PW">Palau</option>
<option value="PA">Panama</option>
<option value="PG">Papua New Guinea</option>
<option value="PY">Paraguay</option>
<option value="PE">Peru</option>
<option value="PH">Philippines</option>
<option value="PN">Pitcairn</option>
<option value="PL">Poland</option>
<option value="PT">Portugal</option>
<option value="PR">Puerto Rico</option>
<option value="QA">Qatar</option>
<option value="RE">Reunion</option>
<option value="RO">Romania</option>
<option value="RU">Russian Federation</option>
<option value="RW">Rwanda</option>
<option value="LC">Saint Lucia</option>
<option value="WS">Samoa</option>
<option value="SM">San Marino</option>
<option value="ST">Sao Tome & Principe</option>
<option value="SA">Saudi Arabia</option>
<option value="SN">Senegal</option>
<option value="RS">Serbia</option>
<option value="SC">Seychelles</option>
<option value="SL">Sierra Leone</option>
<option value="SG">Singapore</option>
<option value="SK">Slovakia</option>
<option value="SI">Slovenia</option>
<option value="SB">Solomon Islands</option>
<option value="SO">Somalia</option>
<option value="ZA">South Africa</option>
<option value="GS">South Georgia and the South Sandwich Islands</option>
<option value="ES">Spain</option>
<option value="LK">Sri Lanka</option>
<option value="SH">St. Helena</option>
<option value="KN">St. Kitts and Nevis</option>
<option value="PM">St. Pierre & Miquelon</option>
<option value="VC">St. Vincent & the Grenadines</option>
<option value="SD">Sudan</option>
<option value="SR">Suriname</option>
<option value="SJ">Svalbard & Jan Mayen Islands</option>
<option value="SZ">Swaziland</option>
<option value="SE">Sweden</option>
<option value="CH">Switzerland</option>
<option value="SY">Syrian Arab Republic</option>
<option value="TW">Taiwan</option>
<option value="TJ">Tajikistan</option>
<option value="TZ">Tanzania, United Republic of</option>
<option value="TH">Thailand</option>
<option value="TG">Togo</option>
<option value="TK">Tokelau</option>
<option value="TO">Tonga</option>
<option value="TT">Trinidad & Tobago</option>
<option value="TN">Tunisia</option>
<option value="TR">Turkey</option>
<option value="TM">Turkmenistan</option>
<option value="TC">Turks & Caicos Islands</option>
<option value="TV">Tuvalu</option>
<option value="UG">Uganda</option>
<option value="UA">Ukraine</option>
<option value="AE">United Arab Emirates</option>
<option value="GB">United Kingdom (Great Britain)</option>
<option value="UM">United States Minor Outlying Islands</option>
<option value="VI">United States Virgin Islands</option>
<option value="US">USA</option>
<option value="ZZ">Unknown or unspecified country</option>
<option value="UY">Uruguay</option>
<option value="UZ">Uzbekistan</option>
<option value="VU">Vanuatu</option>
<option value="VA">Vatican City State (Holy See)</option>
<option value="VE">Venezuela</option>
<option value="VN">Viet Nam</option>
<option value="WF">Wallis & Futuna Islands</option>
<option value="EH">Western Sahara</option>
<option value="YE">Yemen</option>
<option value="YU">Yugoslavia</option>
<option value="ZR">Zaire</option>
<option value="ZM">Zambia</option>
<option value="ZW">Zimbabwe</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;countryCode&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;countryCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="card-cvc-postal">
<div class="card-cvc"
ng-shortcut="'shift+alt+c'"
ng-shortcut-action="auth.permissions.can('createWithoutCVC', Payment, paymentCtrl.company) && paymentCtrl.overrideCvc()"
>
<span ng-if-once="kioskMode">
<div class="paymentform-cardcvc hide-label-text "
ng-django-field="paymentForm [&#39;cardCvc&#39;]" ng-django-field-model="newPayment [&#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="newPayment [&#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="paymentform-cardcvc hide-label-text "
ng-django-field="paymentForm [&#39;cardCvc&#39;]" ng-django-field-model="newPayment [&#39;cardCvc&#39;]"
ng-django-field-required="!paymentCtrl.isCvcOverridden"
>
<label >
<span class="label-text">
CVC
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_cvc" maxlength="4" name="cardCvc" ng-autofocus="paymentCtrl.swiped" ng-model="newPayment [&#39;cardCvc&#39;]" ng-pattern="/^\d{3,4}$/" ng-placeholder="CVC" ng-required="!paymentCtrl.isCvcOverridden" required="required" type="tel" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardCvc&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="<span class='cvc-icon'></span> [! T('Your card\'s three or four digit verification number, usually on the back') !]"
ng-tip-classes="tip-text-left"
ng-tip-touch="true"
></div>
</div>
<div class="card-postal"
ng-if="newPayment [&#39;countryCode&#39;] && Payment.needsPostalCode(newPayment [&#39;countryCode&#39;])"
>
<span ng-if-once="kioskMode">
<div class="paymentform-postalcode field-location-icon hide-label-text "
ng-django-field="paymentForm [&#39;postalCode&#39;]" ng-django-field-model="newPayment [&#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="newPayment [&#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="password" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<span ng-else-once="kioskMode">
<div class="paymentform-postalcode field-location-icon hide-label-text "
ng-django-field="paymentForm [&#39;postalCode&#39;]" ng-django-field-model="newPayment [&#39;postalCode&#39;]"
ng-django-field-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)"
>
<label >
<span class="label-text">
Zip code
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_postal_code" maxlength="32" name="postalCode" ng-model="newPayment [&#39;postalCode&#39;]" ng-pattern="/^\S(\s?\S)*$/" ng-placeholder="Zip code" ng-required="paymentCtrl.isPostalCodeRequired || !auth.permissions.can('createWithoutPostalCode', Payment, paymentCtrl.company)" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;postalCode&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</span>
<div class="help-icon card-help"
ng-tip="[! T('Please enter your billing postal code (zip code) for verification') !]"
ng-tip-touch="true"
></div>
</div>
</div>
</div>
<a class="card-swipe"
ng-click="paymentCtrl.startSwiping()"
ng-if="paymentCtrl.showingSwipe && !paymentCtrl.cardTypeAbbreviation()"
ng-tip="[! T('Swipe card') !]"
ng-tip-classes="tip-indent"
>
Swipe card
</a>
<div class="swiping" ng-if="paymentCtrl.swiping">
<input class="swipe-input" type="text" ng-swipe="paymentCtrl.swipeComplete" />
<div class="swiping-inner">
<div><img ng-src="//dp58aslhmbcib.cloudfront.net/static/images/card-swipe.gif?99774cb15b0528a7a2caeeb2a01921cc3e14532e" /></div>
Ready to swipe card...
</div>
</div>
</div>
<div class="amex-note"
ng-if="auth.currentUser.isAuthenticated && !newPayment [&#39;countryCode&#39;]"
>
<b>Note:</b> It is strongly recommended that you enter the country for American Express cards, or the charge will fail.
</div>
<div ng-if="!company.isDemoModeEnabled"
ng-link="payment-setup-nag"
ng-init="isShort = true"
></div>
</div>
</div>
<div class="hide">
<div class="paymentform-stripetoken "
ng-django-field="paymentForm [&#39;stripeToken&#39;]" ng-django-field-model="newPayment [&#39;stripeToken&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_stripe_token" name="stripeToken" ng-model="newPayment [&#39;stripeToken&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;stripeToken&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="paymentform-cardlast4 "
ng-django-field="paymentForm [&#39;cardLast4&#39;]" ng-django-field-model="newPayment [&#39;cardLast4&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_last_4" name="cardLast4" ng-model="newPayment [&#39;cardLast4&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in paymentForm [&#39;cardLast4&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="paymentform-cardtype "
ng-django-field="paymentForm [&#39;cardType&#39;]" ng-django-field-model="newPayment [&#39;cardType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_card_type" name="cardType" ng-model="newPayment [&#39;cardType&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;cardType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;cardType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="paymentform-option "
ng-django-field="paymentForm [&#39;option&#39;]" ng-django-field-model="newPayment [&#39;option&#39;]"
>
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<ul id="id_option">
<li><label for="id_option_0"><input checked="checked" data-lpignore="true" id="id_option_0" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="" /> </label></li>
<li><label for="id_option_1"><input data-lpignore="true" id="id_option_1" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="in-store" /> in-store</label></li>
<li><label for="id_option_2"><input data-lpignore="true" id="id_option_2" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="stored-value-card" /> stored-value-card</label></li>
<li><label for="id_option_3"><input data-lpignore="true" id="id_option_3" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="charge" /> charge</label></li>
<li><label for="id_option_4"><input data-lpignore="true" id="id_option_4" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="emv" /> emv</label></li>
<li><label for="id_option_5"><input data-lpignore="true" id="id_option_5" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="ideal" /> ideal</label></li>
<li><label for="id_option_6"><input data-lpignore="true" id="id_option_6" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="file" /> file</label></li>
<li><label for="id_option_7"><input data-lpignore="true" id="id_option_7" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="card-on-file" /> card-on-file</label></li>
<li><label for="id_option_8"><input data-lpignore="true" id="id_option_8" name="option" ng-model="newPayment [&#39;option&#39;]" type="radio" value="affiliate" /> affiliate</label></li>
</ul>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="paymentForm [&#39;option&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in paymentForm [&#39;option&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="paymentForm.all.$error.invalid_emv_provider">Payment device provider not recognized. Please contact FareHarbor Support.</li>
<li ng-if="paymentForm.all.$error.tokenization_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.booking_affiliation_required">An affiliate must be selected.</li>
<li ng-if="paymentForm.all.$error.is_demo_does_not_match">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.stored_value_card_not_found">Gift card not found. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.ideal_not_enabled">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cant_create_affiliate_payments">Cannot create affiliate payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cant_create_stored_value_card_payments">Sorry, your account is not authorized to redeem gift cards.</li>
<li ng-if="paymentForm.all.$error.cannot_add_payment_to_demo_booking">Demo mode must be enabled to add payments to demo bookings.</li>
<li ng-if="paymentForm.all.$error.missing_in_store_payment_note">&#39;%(payment_note)s&#39; cannot be empty. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.card_not_found">Card not found.</li>
<li ng-if="paymentForm.all.$error.stripe_ideal_bank_type_not_specified">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.charge_amount_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-HIGH)</li>
<li ng-if="paymentForm.all.$error.booking_fee_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-LOW)</li>
<li ng-if="paymentForm.all.$error.gross_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-LOW)</li>
<li ng-if="paymentForm.all.$error.cannot_create_demo_card_on_file_payment">Cannot create a payment for a saved card when demo mode is enabled.</li>
<li ng-if="paymentForm.all.$error.invalid_processor_type">Outdated payment processor. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.non_affiliate_collected_by_affiliate">Only payments collected by affiliates may be marked as such. Please contact FareHarbor Support. (A-2)</li>
<li ng-if="paymentForm.all.$error.booking_fee_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-HIGH)</li>
<li ng-if="paymentForm.all.$error.invalid_option">Invalid payment option. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.ideal_option_requires_pending_bookings">Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cardholders_name_not_specified">Payment could not be processed. Cardholder's name is required.</li>
<li ng-if="paymentForm.all.$error.cant_create_credit_card_payment">Cannot create credit card payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.affiliate_not_collected_by_affiliate">Payments collected by affiliates must be marked as such. Please contact FareHarbor Support. (A-1)</li>
<li ng-if="paymentForm.all.$error.cant_skip_payment">Cannot skip payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.unauthorized_card_access">Unable to use card for payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.in_store_payment_type_not_valid">Cannot create in-store payment, selection not valid. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.country_code_not_specified">Payment could not be processed. Billing country is required. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cant_create_in_store_payments">Cannot create in-store payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.charge_amount_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-UNSPECIFIED)</li>
<li ng-if="paymentForm.all.$error.cannot_add_payment_to_non_demo_booking">Demo mode must be disabled to add payments to non-demo bookings.</li>
<li ng-if="paymentForm.all.$error.no_relevant_bookings">Cannot create payment. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.cannot_create_demo_ideal_payment">Cannot pay with iDEAL when demo mode is enabled.</li>
<li ng-if="paymentForm.all.$error.gross_too_high">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-HIGH)</li>
<li ng-if="paymentForm.all.$error.booking_fee_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (F-UNSPECIFIED)</li>
<li ng-if="paymentForm.all.$error.cant_defer_payment">Cannot save card. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.invalid_processor">No processor found. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.in_store_payment_type_not_found">Cannot create in-store payment, type not found. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.gross_not_specified">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (G-UNSPECIFIED)</li>
<li ng-if="paymentForm.all.$error.charge_amount_too_low">Payment could not be processed. Please refresh the page and try again, or contact FareHarbor Support. (C-LOW)</li>
<li ng-if="paymentForm.all.$error.booking_rebooked">This booking has been rebooked. Please refresh the page.</li>
<li ng-if="paymentForm.all.$error.cant_charge_card">Cannot charge that card. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.postal_code_not_specified">Payment could not be processed. Billing postal (zip) code is required. Please refresh the page and try again.</li>
<li ng-if="paymentForm.all.$error.in_store_payment_type_not_authorized">Sorry, you are not authorized to create in-store payments. Please refresh the page and try again.</li>
<li ng-repeat="error in paymentForm.all.$error.$server">[[ error ]]</li>
</ul>
<ul class="errors test-tokenization-error-indicator" ng-if="paymentForm.all.$error.$tokenization">
<li ng-repeat="error in paymentForm.all.$error.$tokenization">
[[ error ]]
</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green test-submit-payment-form-action"
ng-disabled="paymentForm.$invalid || paymentForm.$submitting"
>
[[ paymentForm.$submitting ? T('Verifying...') : T('Save and verify card') ]]
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.CHECK_IN)">
<div class="action-sheet-header respond-print-hide">
<div class="action-sheet-header-content">
<h2>Check in all customers</h2>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
>Close</button>
</span>
<div ng-controller="dashboard.bookings.BookingCheckinStatusEditableCtrl">
<p class="action-sheet-help">
Set check-in status of all customers:
</p>
<ul class="table-nav table-nav--no-top-bottom-borders">
<li>
<a ng-click="bookingCheckinStatusCtrl.changeCheckinStatus(CheckinStatus.EMPTY_CHECKIN_STATUS)"
class="table-nav-item is-tall with-chevron"
ng-shortcut="'shift+1'"
ng-shortcut-click
title="[! T('Shortcut: shift+1') !]"
>
[! CheckinStatus.EMPTY_CHECKIN_STATUS.name !]
</a>
</li>
<li ng-repeat="checkinStatus in checkinStatuses">
<a ng-click="bookingCheckinStatusCtrl.changeCheckinStatus(checkinStatus)"
class="table-nav-item is-tall with-chevron [! CheckinStatus.checkinStatusClass(checkinStatus) !]"
ng-shortcut="$index < 8 ? ('shift+' + ($index + 2)) : ''"
ng-shortcut-click
title="[! $index < 8 ? T('Shortcut: shift+') + ($index + 2) : '' !]"
>
[! checkinStatus.name|capitalize !]
</a>
</li>
</ul>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.REFUND)">
<div ng-controller=
"dashboard.bookings.RefundsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Refunding...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-if="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Refund payments</h2>
</div>
</div>
<p class="action-sheet-help">
<span class="select-all">
Select:
<a ng-click="actionsCtrl.selectFullRefunds(editablePayments, payments)"
ng-can-create="Refund on booking"
>all</a>,
<a ng-click="actionsCtrl.unselectPayments(editablePayments, payments)"
ng-can-create="Refund on booking"
>none</a>
</span>
</p>
<form name="refundPaymentsForm" ng-confirm-navigate-away ng-autofocus>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="refundPaymentsForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<ul ng-can-create="Refund on booking" class="test-refunds-list-indicator">
<li ng-repeat="payment in payments" class="refund-form-block"
ng-class="{ 'is-selected': actionsCtrl.isPaymentSelected(editablePayments, payment) }"
>
<div class="fields "
>
<div ng-if="Payment.isLegacyProcessorBasedType(payment)" ng-link="dashboard.bookings.paymentLegacyFlag"></div>
<div class="overview-payment"
ng-link="payment-and-refunds"
ng-with="showTotals = true"
></div>
<div ng-if="Payment.isDisputedAndNonRefundable(payment)" ng-then="notSelectable"
class="refund-type-select-wrap"
>
<div class="refund-not-selectable">
Cannot be refunded right now.
<a ng-href="https://fareharbor.com/help/payments/disputes/refunding-a-disputed-charge/" ng-outbound-link="_blank">Learn more</a>
</div>
</div>
<div ng-else="notSelectable"
class="refund-type-select-wrap"
>
<div class="table full-width refund-type-select table-dont-respond valign-middle">
<div class="tr"
ng-with="isPartialRefundSelected = actionsCtrl.isPartialRefundSelected(editablePayments, payment);
isFullRefundSelected = actionsCtrl.isFullRefundSelected(editablePayments, payment)"
>
<div class="td option-dont-refund"
ng-class="{ toggled: !isPartialRefundSelected && !isFullRefundSelected }"
ng-click="actionsCtrl.unselectPayment(editablePayments, payment)"
>
Don&#039;t refund
</div>
<div class="td"
ng-if="Payment.isPartialRefundAllowed(payment)"
ng-class="{ toggled: isPartialRefundSelected }"
ng-click="actionsCtrl.selectPartialRefund(editablePayments, payment)"
>
Partial refund
</div>
<div class="td test-full-refund-indicator"
ng-class="{ toggled: isFullRefundSelected }"
ng-click="actionsCtrl.selectFullRefund(editablePayments, payment)"
>
Full refund
</div>
</div>
</div>
</div>
<fieldset class="refund-choose-amount"
ng-if="actionsCtrl.isPartialRefundSelected(editablePayments, payment)"
>
<div ng-if="payment.receipt.gross">
<table class="refund-amount-table"
ng-autofocus
>
<tr>
<td>
Refund amount:
</td>
<td>
<div class="refundpaymentform-payment-paymentpk-refundgross
field-amount
"
ng-django-field="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-django-field-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_refund_gross" max="999999.99" min="0" name="refundGross" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-amount-input-max="payment.receipt.gross" ng-amount-input-min="1" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-prefix="'payment-' + payment.pk " required="required" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;refundGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</td>
</tr>
</table>
<div class="tb tb-calculate-refund-flyout"
ng-with="toggleValue = 'refundCalculator-' + payment.pk"
>
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="toggleValue"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Calculate refund amount') !]"
>
<i class="tb-icon calculator"></i>
<abbr>Calculate refund amount</abbr>
</div>
<div class="tb-flyout tb-flyout--left"
ng-toggled ng-toggled-value="toggleValue"
>
<div class="flyout-section flyout-section--no-border">
<h2>
Calculate refund amount
</h2>
<div ng-portion-calculator="payment.receipt.total"
ng-portion-calculator-currency="payment"
ng-portion-calculator-max="payment.receipt.gross"
ng-portion-calculator-model="editablePayments['payment-' + payment.pk + '-' + 'refundGross']"
ng-portion-calculator-labels-for="refund"
ng-portion-calculator-toggle-value="toggleValue"
></div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = toggleValue"></div>
</div>
</div>
</div>
</div>
</fieldset>
<div ng-repeat="error in refundErrors[payment.pk]" class="form-error">
[[ error ]]
</div>
</div>
<div class="hide">
<div class="refundpaymentform-payment-paymentpk-note "
ng-django-field="refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" name="note" ng-model="editablePayments [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;]" ng-prefix="'payment-' + payment.pk " type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentForm [&#39;payment-&#39; + payment.pk + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</li>
</ul>
<div class="hint hint-alert"
ng-can-list="Account on booking.company"
ng-can-only-when="booking.company.isDefaultProcessorDefaultBankAccountReadyForUpload && isUploadPossible()"
>
<p>
<b ng-if="refundingCount === 1" ng-then="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover this refund.
</b>
<b ng-else="singleRefund">
You don't have enough in your <a ng-href="[! company.$url(urls.dashboard.settings.payments.refundReserve) !]">refund reserve</a> to cover these refunds.
</b>
Your bank account will be automatically debited.
</p>
<p>
<a ng-href="/help/payments/refunds/">Learn about refunds in FareHarbor &raquo;</a>
</p>
</div>
<div ng-can-create="Notification on company"
class="refund-email-form"
>
<div class="refundpaymentsform-sendnotification field-cb-email "
ng-django-field="refundPaymentsForm [&#39;sendNotification&#39;]" ng-django-field-model="editablePayments [&#39;sendNotification&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_send_notification" name="sendNotification" ng-checkbox-madness="true" ng-model="editablePayments [&#39;sendNotification&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Send refunded email
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;sendNotification&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="editablePayments.sendNotification">
<div class="fields "
>
<div class="email-form" >
<div class="refundpaymentsform-notification-emails "
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-prefix="'notification'" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="refundpaymentsform-notification-subject "
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;]" ng-placeholder="Email subject" ng-prefix="'notification'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="refundpaymentsform-notification-note field-textarea
"
ng-django-field="refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-django-field-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".refundpaymentsform-notification-note" ng-model="editablePayments [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;]" ng-placeholder="Message (optional)" ng-prefix="'notification'" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in refundPaymentsForm [&#39;notification&#39; + &#39;-&#39; + &#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
</div>
</div>
<div ng-if="refundErrors.all">
<ul>
<li ng-repeat="error in refundErrors.all"
class="form-error"
>
[[ error ]]
</li>
</ul>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in refundPaymentsForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-with="refundTotal = actionsCtrl.refundTotal(editablePayments, payments)"
ng-disabled="refundPaymentsForm.$invalid || refundPaymentsForm.$submitting || !refundTotal"
ng-click="submit(refundPaymentsForm)"
ng-confirm-click="[! T('Refund these payments? There is no undo.') !]"
>
<span ng-if="refundTotal" ng-then="noRefundTotal">
Refund <span ng-amount="refundTotal" ng-amount-currency="booking"></span>
</span>
<span ng-else="noRefundTotal">Refund payments</span>
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.CUSTOM_REFUND)">
<div ng-controller=
"dashboard.bookings.CustomRefundCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Custom refund</h2>
</div>
</div>
<div class="prose prose-section">
<p>
Create a refund for money marked as collected outside of FareHarbor, or collected in a different payment type.
<a ng-href="https://fareharbor.com/help/payments/refunds/custom-refunds/" ng-outbound-link="_blank"
>Learn more about custom refunds.</a>
</p>
<p>
Custom refunds are usually created in special circumstances.
<a ng-click="actionsCtrl.select(actionsCtrl.REFUND)"
ng-if="actionsCtrl.isSelectable(actionsCtrl.REFUND)"
>Issue a normal refund instead.</a>
</p>
<p><b>Refund amount:</b></p>
</div>
<form name="customRefundForm" ng-confirm-navigate-away ng-autofocus>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="customRefundForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="customrefundform-gross
field-amount
"
ng-django-field="customRefundForm [&#39;gross&#39;]" ng-django-field-model="newRefund [&#39;gross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_gross" max="10000.00" min="0.01" name="gross" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="newRefund [&#39;gross&#39;]" ng-pattern="/^(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="customRefundForm [&#39;gross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="customRefundForm [&#39;gross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in customRefundForm [&#39;gross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="affiliate-form-header">Refund Type</div>
<div class="customrefundform-instorepaymenttype "
ng-django-field="customRefundForm [&#39;inStorePaymentType&#39;]" ng-django-field-model="newRefund [&#39;inStorePaymentType&#39;]"
ng-django-field-required=""
>
<ul ng-radio-flyer class="field-radio-group">
<li class="field-radio-inline-header fh-red">
Refund [[ (newRefund.gross || 0)|amount:InStorePaymentType.isVisibleWhenCollectedByCharter(inStorePaymentTypes)[0] ]] to:
</li>
<li ng-repeat="inStorePaymentType in InStorePaymentType.isVisibleWhenCollectedByCharter(inStorePaymentTypes)">
<label >
<input type="radio" name="in_store_payment_type"
ng-value="inStorePaymentType.pk"
ng-model="newRefund [&#39;inStorePaymentType&#39;]" ng-prefix="" ng-required="required"
>
[[ inStorePaymentType.name ]]
</label>
</li>
</ul>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="customRefundForm.all.$error.refund_gross_too_high">Refund amount is too high</li>
<li ng-if="customRefundForm.all.$error.refund_gross_not_specified">Please provide an amount to refund.</li>
<li ng-if="customRefundForm.all.$error.unauthorized">Only authorized users can issue custom refunds</li>
<li ng-if="customRefundForm.all.$error.refund_gross_too_low">Refund amount is too low</li>
<li ng-repeat="error in customRefundForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-disabled="customRefundForm.$invalid || customRefundForm.$submitting"
ng-click="createCtrl.submit(customRefundForm)"
>
[[ customRefundForm.$submitting ? T('Creating...') : T('Create refund') ]]
</button>
</div>
</form>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.REPRICE)">
<div ng-controller=
"dashboard.bookings.RepriceBookingCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-show="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Repricing booking...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-show="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Reprice booking</h2>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
>Close</button>
</span>
<div class="prose prose-section"
ng-if="!booking.isUnpriced"
>
<p>This booking was priced with:</p>
<ul>
<li>
<b>Total sheet:</b>
[[ booking.totalSheet.name ]]
</li>
<li ng-if="!!booking.affiliation">
<b>Invoice sheet:</b>
[[ booking.invoiceSheet.displayName ? booking.invoiceSheet.displayName : T('Not set') ]]
</li>
</ul>
<p><b>Recalculate booking prices:</b></p>
</div>
<form class="labels-above"
name="repriceBookingForm"
ng-submit="editCtrl.submit(repriceBookingForm)"
>
<div class="fields "
>
<div class="repricebookingform-totalsheet "
ng-django-field="repriceBookingForm [&#39;totalSheet&#39;]" ng-django-field-model="editableBooking [&#39;totalSheet&#39;]"
ng-django-field-required=""
>
<div ng-current-option="editableBooking [&#39;totalSheet&#39;]"
ng-current-option-collection="totalSheets"
ng-current-option-key="'pk'"
ng-current-option-target="currentTotalSheet"
>
<label>
<span class="label-text">
Total sheet
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field">
<select name="total_sheet"
ng-model="editableBooking [&#39;totalSheet&#39;]"
ng-disabled=""
required="required"
ng-options="option.pk as option.displayName for option in totalSheets"
ng-dropdown
>
</select>
<i ng-link="f-req"></i>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="repriceBookingForm [&#39;totalSheet&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in repriceBookingForm [&#39;totalSheet&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div ng-if="booking.affiliation">
<div class="repricebookingform-invoicesheet "
ng-django-field="repriceBookingForm [&#39;invoiceSheet&#39;]" ng-django-field-model="editableBooking [&#39;invoiceSheet&#39;]"
>
<div ng-current-option="editableBooking [&#39;invoiceSheet&#39;]"
ng-current-option-collection="invoiceSheets"
ng-current-option-key="'pk'"
ng-current-option-target="currentInvoiceSheet"
>
<label>
<span class="label-text">
Invoice sheet
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field">
<select name="invoice_sheet"
ng-model="editableBooking [&#39;invoiceSheet&#39;]"
ng-disabled=""
ng-options="option.pk as option.displayName for option in invoiceSheets"
ng-dropdown
ng-placeholder="No invoice sheet"
>
</select>
<i ng-link="f-req"></i>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="repriceBookingForm [&#39;invoiceSheet&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in repriceBookingForm [&#39;invoiceSheet&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="repriceBookingForm.all.$error.unauthorized">only authorized users can change price sheets</li>
<li ng-repeat="error in repriceBookingForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-green btn-wide"
ng-disabled="repriceBookingForm.$invalid || repriceBookingForm.$submitting"
>
[[ repriceBookingForm.$submitting ? T('Repricing...') : T('Reprice booking') ]]
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.PROCESS)">
<div ng-controller=
"dashboard.bookings.ProcessBookingCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="status === 'loading'">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Updating booking...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-if="status === 'error'">
<div class="prose prose-section">
<h1>Update failed</h1>
<p>
Please please contact <a ng-href="mailto:support@fareharbor.com">support@fareharbor.com</a> for assistance.
</p>
</div>
</div>
<div ng-if="status === 'success'">
<div class="prose prose-section">
<h1>Updated booking</h1>
<p>
This booking has been updated successfully.
</p>
</div>
<a class="btn-big btn-black btn-wide btn-icon check-in"
ng-click="actionsCtrl.select(actionsCtrl.NONE)"
>
Continue
</a>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.REAPPLY_RESOURCE_USES)">
<div ng-controller=
"dashboard.bookings.ReapplyBookingResourceUsesCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Reapply Resources</h2>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="reapplyBookingResourceUsesForm.$dirty"
>Close</button>
</span>
<p class="action-sheet-help">
Change which resources this booking uses or reset them to the defaults for the <b>[! booking.availability.requirementGroup.shortName !]</b> resource requirements.
</p>
<div ng-resource-use-table
resource-uses="resourceUses"
to-resource-uses="toResourceUses"
unsatisfiable-resources="unsatisfiableResources"
></div>
<form name="reapplyBookingResourceUsesForm"
ng-confirm-navigate-away
ng-submit="editCtrl.submit(reapplyBookingResourceUsesForm)"
>
<div class="fields "
>
<div ng-selected-resources
availability="availability"
customer-type-rates="customerTypeRateCounts"
requirements="requirements"
reset="reset()"
selections="resourceUseData"
>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in reapplyBookingResourceUsesForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<div ng-if="!isResourceUsesChanged() && !(requirements|isEmptyFilter)" class="hint hint-alert">
Reapplying may not result in any changes to the resources on this booking.
</div>
<button class="btn-big btn-wide btn-green"
ng-disabled="reapplyBookingResourceUsesForm.$invalid || reapplyBookingResourceUsesForm.$submitting"
type="submit"
>
[[ reapplyBookingResourceUsesForm.$submitting ? T('Reapplying...') : T('Reapply Resources') ]]
</button>
</div>
</form>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.NOTIFY)">
<div ng-controller=
"dashboard.bookings.NotificationCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
instant
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Sending email...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-show="!submitting">
<div ng-link="booking-actions-notify-toggle"></div>
<form class="form-big-inputs"
name="notificationForm"
ng-confirm-navigate-away
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="notificationForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="email-form" >
<div class="notificationform-type field-select-full "
ng-django-field="notificationForm [&#39;type&#39;]" ng-django-field-model="data [&#39;type&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select
ng-model="data [&#39;type&#39;]"
ng-prefix=""
ng-options="option.value as option.name for option in notificationTypeOptions"
>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="notificationForm [&#39;type&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in notificationForm [&#39;type&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-emails "
ng-django-field="notificationForm [&#39;emails&#39;]" ng-django-field-model="data [&#39;emails&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_emails" name="emails" ng-model="data [&#39;emails&#39;]" ng-pattern="/^([^@,\s]+@[^@,\.\s]+\.[^@,\s]+)(\s*,\s*[^@,\s]+@[^@,\.\s]+\.[^@,\s]+)*$/" ng-placeholder="Send to address" ng-required="true" required="required" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;emails&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-subject "
ng-django-field="notificationForm [&#39;subject&#39;]" ng-django-field-model="data [&#39;subject&#39;]"
ng-django-field-disabled="!isSubjectEditable"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_subject" maxlength="512" name="subject" ng-disabled="!isSubjectEditable" ng-model="data [&#39;subject&#39;]" ng-placeholder="Email subject" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;subject&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="notificationform-note field-textarea
"
ng-django-field="notificationForm [&#39;note&#39;]" ng-django-field-model="data [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-image-description="" ng-markdown-parent=".notificationform-note" ng-model="data [&#39;note&#39;]" ng-placeholder="Message (optional)" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in notificationForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb email-form-tb js-markdown-tb">
<div class="tb-left">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
<div class="tb-right" ng-if="emailPreviewCtrl && emailPreviewCtrl.isPreviewable()">
<a class="tb-btn tb-btn--popup"
ng-open-window="[[ emailPreviewCtrl.previewUrl() ]]"
ng-open-window-width="770"
ng-open-window-height="650"
>
<i class="tb-icon preview-email">Preview email</i> Preview email
</a>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="notificationForm.all.$error.subject_required">Subject is required</li>
<li ng-if="notificationForm.all.$error.no_eligible_disputes">No eligible disputes.</li>
<li ng-if="notificationForm.all.$error.unauthorized">Only authorized users can send emails</li>
<li ng-repeat="error in notificationForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-disabled="notificationForm.$invalid || notificationForm.$submitting"
ng-click="submit(notificationForm)"
>
Send email
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.NOTIFY_SMS)">
<div ng-controller=
"dashboard.bookings.SmsNotificationCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-if="submitting">
<div class="spinner
instant
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Sending text...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-show="!submitting">
<div ng-link="booking-actions-notify-toggle"></div>
<div class="hint hint-alert" ng-if-once="booking.isOnline && !booking.isSmsEnabled">
<b>Hold up!</b> This customer booked online but didn&#039;t opt in to text messages. Be careful about texting them, you could cost them fees with their carrier.
</div>
<form class="form-big-inputs"
name="smsNotificationForm"
ng-confirm-navigate-away
>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="smsNotificationForm.$dirty"
>Close</button>
</span>
<div class="fields "
>
<div class="smsnotificationform-number field-phone-icon
international-phone-field
"
ng-django-field="smsNotificationForm [&#39;number&#39;]" ng-django-field-model="smsNotification [&#39;number&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_number" maxlength="[[ numberMaxLength ]]" name="number" ng-international-phone-field="true" ng-international-phone-field-countries="countries" ng-international-phone-field-phone-country-model="smsNotification [&#39;phoneCountry&#39;]" ng-model="smsNotification [&#39;number&#39;]" ng-pattern="numberRegex" ng-phone-number-input="True" ng-placeholder="[[ isInternationalSmsEnabled ? T('Mobile number') : T('US mobile number (10 digits)') ]]" ng-required="true" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in smsNotificationForm [&#39;number&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="smsnotificationform-message
field-limited-character
"
ng-django-field="smsNotificationForm [&#39;message&#39;]" ng-django-field-model="smsNotification [&#39;message&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_message" maxlength="130" name="message" ng-autofocus="true" ng-model="smsNotification [&#39;message&#39;]" ng-pattern="/^[\w\s@?!1$&quot;#?%&amp;\\()*:+;,&lt;Ll\-=.&gt;/\&#39;]+$/" ng-placeholder="Enter your message here. (Link to customer&#39;s receipt page will be automatically included at the end.)" required="required" rows="10">
</textarea>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="smsNotificationForm [&#39;message&#39;].$error['pattern']">Non GSM characters are not allowed</li>
<li ng-repeat="error in smsNotificationForm [&#39;message&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb tb--shaded field-tb">
<div class="tb-left">
<div class="tb-group">
<div class="tb-flyout-wrap" ng-if-once="cannedMessagesCtrl">
<div class="tb-btn tb-btn--flyout"
ng-toggle
ng-toggle-value="cannedMessagesCtrl.toggleKey"
ng-tip="[! T('Canned messages') !]"
>
<i class="tb-icon snippet"></i>
<abbr>Canned messages</abbr>
</div>
<div class="tb-flyout"
ng-toggled-show
ng-toggled-show-value="cannedMessagesCtrl.toggleKey"
>
<div ng-data="cannedMessagesCtrl.promises" ng-data-manual>
<div ng-if="dataCtrl.status === 'loading'" class="m-l-10 m-t-10 m-b-10">
<i class="spinner-ticker-css"><span></span></i>
</div>
<div ng-repeat="type in cannedMessagesCtrl.TYPES" ng-if="!cannedMessagesCtrl.hasEmptyMessages(type)">
<a class="flyout-toggle-header"
ng-toggle
ng-toggle-value="type"
ng-toggle-default="false"
ng-toggle-group="cannedTypes"
>
[! cannedMessagesCtrl.cannedMessagesByType[type][0].displayType !]
</a>
<ul class="flyout-menu-items" ng-toggled ng-toggled-value="type">
<li ng-repeat="cannedMessage in cannedMessagesCtrl.cannedMessagesByType[type]" ng-if="!cannedMessagesCtrl.isEmptyMessage(cannedMessage)">
<a ng-click="cannedMessagesCtrl.select(cannedMessage)">
[! cannedMessage.name !]
<span ng-if="cannedMessagesCtrl.loadingCannedMessagePk === cannedMessage.pk" class="spinner-ticker-css"></span>
</a>
</li>
</ul>
</div>
</div>
<div class="flyout-menu-items-desc">
Canned messages let you save messages so you can quickly use them. You can add new ones or edit them in <a ng-href="[! company.$url(urls.dashboard.settings.cannedMessages.index) !]">settings</a>.
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'cannedMessages'"></div>
</div>
</div>
</div>
</div>
<div class="tb-right">
<div class="tb-group">
<div class="tb-label bold" ng-class="{ 'fh-red': smsNotification [&#39;message&#39;].length > 111 }">
[[ 130 - smsNotification [&#39;message&#39;].length ]] characters left
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="smsnotificationform-phonecountry "
ng-django-field="smsNotificationForm [&#39;phoneCountry&#39;]" ng-django-field-model="smsNotification [&#39;phoneCountry&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Phone country
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_phone_country" name="phoneCountry" ng-model="smsNotification [&#39;phoneCountry&#39;]" required="required" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="smsNotificationForm [&#39;phoneCountry&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in smsNotificationForm [&#39;phoneCountry&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="smsNotificationForm.all.$error.blacklisted_number">This phone number is blacklisted due to a STOP request</li>
<li ng-if="smsNotificationForm.all.$error.unauthorized">Only authorized users can send text messages</li>
<li ng-if="smsNotificationForm.all.$error.invalid_number">Please enter a valid US phone number</li>
<li ng-if="smsNotificationForm.all.$error.default">Please try again later</li>
<li ng-if="smsNotificationForm.all.$error.unsupported_carrier">This mobile carrier is not supported</li>
<li ng-if="smsNotificationForm.all.$error.invalid_mobile_number">Please enter a valid mobile phone number</li>
<li ng-if="smsNotificationForm.all.$error.unsupported_country">Please enter a valid US phone number</li>
<li ng-if="smsNotificationForm.all.$error.number_not_whitelisted">This phone number is not whitelisted</li>
<li ng-repeat="error in smsNotificationForm.all.$error.$server">[[ error ]]</li>
</ul>
<div class="form-error" ng-if="!smsNotification.phoneCountry && smsNotification.number">
Select a valid country for the phone number.
</div>
<div class="form-error"
ng-if="
smsNotification.phoneCountry &&
smsNotification.number &&
!isEligiblePhoneNumber
"
>
<span ng-if="isInternationalSmsEnabled">
[[ smsNotification.number ]] is not valid for the selected country.
</span>
<span ng-else="isInternationalSmsEnabled">
[[ smsNotification.number ]] is not a valid US phone number.
</span>
</div>
</div>
<div class="btns">
<button class="btn-big btn-wide btn-green"
ng-disabled="
smsNotificationForm.$invalid ||
smsNotificationForm.$submitting ||
!isEligiblePhoneNumber
"
ng-click="submit(smsNotificationForm)"
>
Send text
</button>
</div>
</form>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.PRINT_RECEIPT)">
<div ng-controller="dashboard.bookings.ReceiptsCtrl as receiptsCtrl"
ng-init="receiptsCtrl.paymentsSet = null;"
>
<div class="action-sheet-header respond-print-hide">
<div class="action-sheet-header-content">
<h2>
<a ng-if="!toggles.state('receiptsMenu')"
class="btn-back"
ng-toggle="receiptsMenu"
ng-toggle-group="receipts"
>Back</a>
Print
</h2>
<a ng-href="https://fareharbor.com/help/dashboard/receipts-and-tickets/printing/"
ng-outbound-link="_blank"
class="hint-help-link"
ng-if="toggles.state('receiptsMenu')"
>Get help with printing &rsaquo;</a>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
>Close</button>
</span>
<div class="respond-print-hide"
ng-show="toggles.state('receiptsMenu')"
>
<div ng-toggle="receiptsMenu"
ng-toggle-group="receipts"
ng-toggle-default="!receiptsCtrl.isPreselecting"
></div>
<div ng-toggled="receiptsMenu" ng-body-class="'body-print-booking'"></div>
<ul class="list-filters list-filters--with-spacing"
ng-show="company.isBocaEnabled || company.isReceiptsEnabled"
>
<li ng-toggle="bocaFormat"
ng-toggle-default="receiptsCtrl.preferredPrintFormat === TicketLayout.BOCA_PRINT_FORMAT"
ng-toggle-group="ticketFormats"
ng-click="receiptsCtrl.savePreferredPrintFormat(TicketLayout.BOCA_PRINT_FORMAT)"
ng-if-once="company.isBocaEnabled"
>
Boca Format
</li>
<li ng-toggle="receiptFormat"
ng-toggle-default="receiptsCtrl.preferredPrintFormat === TicketLayout.RECEIPT_PRINT_FORMAT"
ng-toggle-group="ticketFormats"
ng-click="receiptsCtrl.savePreferredPrintFormat(TicketLayout.RECEIPT_PRINT_FORMAT)"
ng-if-once="company.isReceiptsEnabled"
>
Receipt Format
</li>
<li ng-toggle="otherOptions"
ng-toggle-default="!company.isBocaEnabled && !company.isReceiptsEnabled"
ng-toggle-group="ticketFormats"
>
Other Options
</li>
</ul>
<div ng-if-once="company.isBocaEnabled">
<div ng-toggled="bocaFormat">
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showWholeParty: true })"
class="table-nav-item is-tall with-chevron"
>
Whole party ticket
</div>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true })"
class="table-nav-item is-tall with-chevron"
>
Individual tickets
</div>
<div ng-can-view-amounts="booking.company"
ng-can-only-when="Payment.printablePayments(booking.payments).length"
>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showWholeParty: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
Whole party ticket + payment receipts
</div>
<div ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
Individual tickets + payment receipts
</div>
<div ng-repeat="payment in Payment.printablePayments(booking.payments)"
ng-toggle="bocaDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ activePayment: payment })"
ng-init="receiptsCtrl.isPreselecting && $first && receiptsCtrl.preparePrinting({ activePayment: payment, toggle: 'bocaDisplay' })"
>
<div ng-if="!payment.isDeferred && payment.type !== Payment.AFFILIATE_TYPE"
class="table-nav-item is-tall with-chevron"
>
<ul>
<li ng-amount="payment.initialReceipt.gross + payment.initialReceipt.bookingFee"
ng-amount-company="payment.company"
class="bold"
></li>
<li ng-if-once="payment.isCardOnFile" ng-then="isCardOnFile">
<span class="fh-grey">From company card:</span> <b>[! payment.cardName !]</b>
</li>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<span class="fh-grey">From:</span> [! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]
</span>
<li ng-if-once="!ccPayment && !isCardOnFile">
<span class="fh-grey">Type:</span> [! payment.displayType !]
</li>
<li>
<span ng-if-once="payment.isRefunded" class="badge nowrap">
Refunded
</span>
<span class="fh-grey">
[! payment.createdAt|datetime !]
</span>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="company.isReceiptsEnabled">
<div ng-toggled="receiptFormat">
<div ng-toggle="bookingReceipt"
ng-toggle-group="receipts"
class="table-nav-item is-tall with-chevron"
>
Booking receipt
</div>
<div ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true })"
class="table-nav-item is-tall with-chevron"
>
Individual tickets
</div>
<div ng-can-view-amounts="booking.company">
<div ng-if-once="Payment.printablePayments(booking.payments).length">
<div ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-if-once="Payment.printablePayments(booking.payments)"
ng-click="receiptsCtrl.preparePrinting({ showTickets: true, activePayment: Receipt.ALL_PAYMENT_RECEIPTS })"
class="table-nav-item is-tall with-chevron"
>
Individual tickets + payment receipts
</div>
<div ng-repeat="payment in Payment.printablePayments(booking.payments)"
ng-toggle="receiptDisplay"
ng-toggle-group="receipts"
ng-click="receiptsCtrl.preparePrinting({ activePayment: payment })"
ng-init="receiptsCtrl.isPreselecting && $first && receiptsCtrl.preparePrinting({ activePayment: payment, toggle: 'receiptDisplay' })"
>
<div ng-if="!payment.isDeferred && payment.type !== Payment.AFFILIATE_TYPE"
class="table-nav-item is-tall with-chevron"
>
<ul>
<li ng-amount="payment.initialReceipt.gross + payment.initialReceipt.bookingFee"
ng-amount-company="payment.company"
class="bold"
></li>
<li ng-if-once="payment.isCardOnFile" ng-then="isCardOnFile">
<span class="fh-grey">From company card:</span> <b>[! payment.cardName !]</b>
</li>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<span class="fh-grey">From:</span> [! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]
</span>
<li ng-if-once="!ccPayment && !isCardOnFile">
<span class="fh-grey">Type:</span> [! payment.displayType !]
</li>
<li>
<span ng-if-once="payment.isRefunded" class="badge nowrap">
Refunded
</span>
<span class="fh-grey">
[! payment.createdAt|datetime !]
</span>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-toggled="otherOptions">
<a class="table-nav-item is-tall with-chevron"
ng-print
>Print this page</a>
<a ng-href="[! booking.$url(urls.company.item.booking) !]"
class="table-nav-item is-tall with-chevron"
>Customer confirmation page</a>
</div>
</div>
<div ng-toggled="bocaDisplay">
<div ng-controller=
"dashboard.settings.ticketLayouts.TicketLayoutViewCtrl as ticketLayoutViewCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<ul class="buttons-list respond-print-hide">
<li>
<div class="btns btns--combo">
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide [[ addClassIf(ticketLayoutViewCtrl.needsPrintSettings(), 'btn-segment-left') ]]"
>
Print
</button>
<div class="btn-segment-right-wrap" ng-if="ticketLayoutViewCtrl.needsPrintSettings()">
<div class="btn-big btn-black btn-flyout btn-segment-right active-when-toggled"
ng-toggle="ticketOptionsForm" ng-toggle-auto-close
ng-tip="[! T('Print settings') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon cog-white"></i>
</div>
<div ng-toggled="ticketOptionsForm"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-inner">
<div ng-if-once="ticketLayoutViewCtrl.ticketLayouts.length > 0">
<div class="field "
>
<label>
<span class="label-text">
Ticket layout
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="ticketLayout.pk as ticketLayout.name for ticketLayout in ticketLayoutViewCtrl.ticketLayouts"
ng-model="ticketLayoutViewCtrl.selectedTicketLayoutPk"
ng-change="ticketLayoutViewCtrl.changeTicketLayout()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
<div ng-if="!!activePayment && (activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment.isProcessorBasedType)">
<div class="field "
>
<label>
<span class="label-text">
Credit card receipt copies
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="receiptCopyType.id as receiptCopyType.display for receiptCopyType in ticketLayoutViewCtrl.receiptCopyTypes"
ng-model="ticketLayoutViewCtrl.selectedReceiptCopyType"
ng-change="ticketLayoutViewCtrl.changeReceiptCopyType()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
</li>
</ul>
<div ng-init="ticketLayoutViewCtrl.printType = TicketLayout.BOCA_PRINT_FORMAT"></div>
<div ng-boca-styles-for-layout="ticketLayoutViewCtrl.selectedTicketLayout"></div>
<div class="native-receipt">
<div ng-if="showWholeParty">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
[! booking.customerBreakdown !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
<div class="boca-main">
<div class="table boca-main-content-wrapper full-width">
<div class="tr">
<div class="td boca-main-content">
<div class="table full-width">
<div class="tr">
<div class="td boca-qr"
ng-qr-code="[[ booking.customers[0]|checkinUrl ]]"
ng-if-once="booking.item.isScanningEnabled"
></div>
<div class="td boca-main-text">
<div ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.isCompanyInformationIncluded">
<h2 class="boca-header-large">[! booking.company.name !]</h2>
<div class="boca-section">
<span ng-if="booking.company.phone">[! booking.company.phone !]</span>
<span ng-if="booking.company.phone && booking.company.url">&bull;</span>
<span ng-if="booking.company.url">[! booking.company.url|hostname !]</span>
</div>
</div>
<h3 class="boca-header-med">
[! booking.item.name !]
<span ng-bind="!!booking.availability.headline ? ' &mdash; ' + booking.availability.headline : ''"></span>
</h3>
<h3 class="boca-header-med">
<b>
[! booking.customerBreakdown !]
</b>
&mdash; [! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</h3>
<div>
Booking #[! booking.pk !] &bull; <b>Name:</b> [! booking.contact.name !]
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tr"
ng-if-once="booking.item.receiptFooterSafeHtml"
>
<div class="td boca-fine-print md-inline"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
[! booking.customerBreakdown !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
</div>
</div>
</div>
</div>
<div ng-if="showTickets">
<div ng-repeat="customer in booking.customers">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
1 [! customer.name !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
<div class="boca-main">
<div class="table boca-main-content-wrapper full-width">
<div class="tr">
<div class="td boca-main-content">
<div class="table full-width">
<div class="tr">
<div class="td boca-qr"
ng-qr-code="[[ customer|checkinUrl ]]"
ng-if-once="booking.item.isScanningEnabled"
></div>
<div class="td boca-main-text">
<div ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.isCompanyInformationIncluded">
<h2 class="boca-header-large">[! booking.company.name !]</h2>
<div class="boca-section">
<span ng-if="booking.company.phone">[! booking.company.phone !]</span>
<span ng-if="booking.company.phone && booking.company.url">&bull;</span>
<span ng-if="booking.company.url">[! booking.company.url|hostname !]</span>
</div>
</div>
<h3 class="boca-header-med">
[! booking.item.name !]
<span ng-bind="!!booking.availability.headline ? ' &mdash; ' + booking.availability.headline : ''"></span>
</h3>
<h3 class="boca-header-med">
<b>
1 [! customer.name !]
</b>
&mdash; [! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</h3>
<div>
Booking #[! booking.pk !] &bull; <b>Name:</b> [! booking.contact.name !]
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tr"
ng-if-once="booking.item.receiptFooterSafeHtml"
>
<div class="td boca-fine-print md-inline"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="table valign-middle">
<div class="tr">
<div class="td">
<ul class="boca-section">
<li class="stub-ava">[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</li>
<li>
<b>
1 [! customer.name !]
</b>
&mdash; #[! booking.pk !]</li>
</ul>
<ul>
<li><b>[! booking.company.name !]</b></li>
<li>[! booking.item.name !]</li>
</ul>
</div>
</div>
</div>
</div>
</span>
</div>
</div>
</div>
</div>
</div>
<div ng-repeat="payment in Payment.printablePayments(booking.payments)"
ng-if="activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment === payment"
>
<div ng-if="payment.isProcessorBasedType && (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.MERCHANT_COPY
)">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
boca-ticket--receipt
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
<div class="boca-main">
<div class="boca-receipt-company-info"
ng-if="!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
<div class="boca-receipt-summary-container"
ng-class="{ 'boca-receipt-summary-container--with-company-info':
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub }
">
<div class="boca-receipt-summary">
<div class="boca-section">
<ul ng-if-once="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="hasMultipleContributingBooking"
>
<li><b>[! payment.company.name !]</b></li>
<li ng-if-once="Payment.order(payment)">
Order #[! Payment.order(payment).identifier !]
</li>
</ul>
<ul ng-else-once="hasMultipleContributingBooking"
ng-init="booking = payment.booking || payment.bookings[0]"
>
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if-once="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</li>
<li>
Booking #[! booking.pk !]
</li>
</ul>
</div>
<div class="boca-section">
<table class="boca-receipt-charges">
<tbody>
<tr>
<td>
<span ng-if-once="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if-once="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<span class="boca-ticket-small-text">
([! payment.createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="payment.initialReceipt.total"></td>
</tr>
</tbody>
<tbody ng-if-once="payment.refundCount > 0">
<tr>
<td>
[! nT('Refund', 'Refunds', payment.refundCount) !]
<span class="boca-ticket-small-text" ng-if-once="payment.refundCount === 1">
([! payment.refunds[0].createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="-(payment.refunds|summary:'receipt.total')"></td>
</tr>
<tr>
<td class="bold">Paid</td>
<td class="text-right" ng-amount="payment.receipt.total"></td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-signature">
<p class="print-receipt-text">
Cardholder will pay above amount to card issuer pursuant to cardholder agreement. Cardholder signature:
</p>
<div class="print-receipt-signature-line">x</div>
</div>
</div>
<div class="boca-receipt-emv-details"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Merchant Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
</div>
</div>
</div>
</div>
<div ng-if="!payment.isProcessorBasedType || (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.CUSTOMER_COPY
)">
<div class="boca-ticket-wrap ">
<div class="boca-ticket
boca-ticket--receipt
[[ addClassIf(ticketLayoutViewCtrl.selectedTicketLayout.settings.isRotated, 'boca-ticket--is-rotated') ]]">
<div class="boca-ticket-inner">
<span class="boca-stub boca-stub-trailing"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
<div class="boca-main">
<div class="boca-receipt-company-info"
ng-if="!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
<div class="boca-receipt-summary-container"
ng-class="{ 'boca-receipt-summary-container--with-company-info':
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasTrailingStub &&
!ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub }
">
<div class="boca-receipt-summary">
<div class="boca-section">
<ul ng-if-once="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="hasMultipleContributingBooking"
>
<li><b>[! payment.company.name !]</b></li>
<li ng-if-once="Payment.order(payment)">
Order #[! Payment.order(payment).identifier !]
</li>
</ul>
<ul ng-else-once="hasMultipleContributingBooking"
ng-init="booking = payment.booking || payment.bookings[0]"
>
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if-once="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</li>
<li>
Booking #[! booking.pk !]
</li>
</ul>
</div>
<div class="boca-section">
<table class="boca-receipt-charges">
<tbody>
<tr>
<td>
<span ng-if-once="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if-once="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if-once="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<span class="boca-ticket-small-text">
([! payment.createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="payment.initialReceipt.total"></td>
</tr>
</tbody>
<tbody ng-if-once="payment.refundCount > 0">
<tr>
<td>
[! nT('Refund', 'Refunds', payment.refundCount) !]
<span class="boca-ticket-small-text" ng-if-once="payment.refundCount === 1">
([! payment.refunds[0].createdAt|datetime !])
</span>
</td>
<td class="text-right" ng-amount="-(payment.refunds|summary:'receipt.total')"></td>
</tr>
<tr>
<td class="bold">Paid</td>
<td class="text-right" ng-amount="payment.receipt.total"></td>
</tr>
</tbody>
</table>
</div>
<div class="md-inline"
ng-if-once="booking.item.receiptFooterSafeHtml"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
<div class="boca-receipt-emv-details"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Customer Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<span class="boca-stub boca-stub-leading"
ng-if="ticketLayoutViewCtrl.selectedTicketLayout.settings.hasLeadingStub"
>
<div class="boca-stub-inner">
<div class="bold">[! company.name !]</div>
<div>[! company.url|hostname !]</div>
<div>[! company.phone !]</div>
<div ng-link="physical-address" ng-with="addressObject = (company.primaryLocation || company)"></div>
</div>
</span>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-toggled="receiptDisplay">
<div ng-controller=
"dashboard.settings.ticketLayouts.TicketLayoutViewCtrl as ticketLayoutViewCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<ul class="buttons-list respond-print-hide">
<li>
<div class="btns btns--combo">
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide [[ addClassIf(ticketLayoutViewCtrl.needsPrintSettings(), 'btn-segment-left') ]]"
>
Print
</button>
<div class="btn-segment-right-wrap" ng-if="ticketLayoutViewCtrl.needsPrintSettings()">
<div class="btn-big btn-black btn-flyout btn-segment-right active-when-toggled"
ng-toggle="ticketOptionsForm" ng-toggle-auto-close
ng-tip="[! T('Print settings') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon cog-white"></i>
</div>
<div ng-toggled="ticketOptionsForm"
class="tb-flyout tb-flyout--left"
>
<div class="flyout-inner">
<div ng-if="!!activePayment && (activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment.isProcessorBasedType)">
<div class="field "
>
<label>
<span class="label-text">
Credit card receipt copies
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="receiptCopyType.id as receiptCopyType.display for receiptCopyType in ticketLayoutViewCtrl.receiptCopyTypes"
ng-model="ticketLayoutViewCtrl.selectedReceiptCopyType"
ng-change="ticketLayoutViewCtrl.changeReceiptCopyType()"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
</li>
</ul>
<div class="native-receipt">
<div ng-if="showWholeParty">
</div>
<div ng-if="showTickets">
<div ng-repeat="customer in booking.customers">
<div class="print-receipt">
<div class="print-receipt-section" ng-init="company = booking.company">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>
Booking #[! booking.pk !]</b></li>
<li>[! booking.contact.name !]</li>
<li>Total passengers: <b>[! booking.customerCount !]</b>
</ul>
<ul class="print-receipt-list">
<li>
<b>[[ booking.item.name ]]</b>
<span ng-if="availability.headline">&mdash; [[ availability.headline ]]</span>
</li>
<li>
[[ booking.availability.startAt|datetime:(booking.availability.endAt) ]]
</li>
<li>[! customer.name !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-link="receipt-customer-with-custom-field-values"
></table>
</div>
<div class="print-receipt-section text-center md-inline"
ng-if-once="booking.item.receiptFooterSafeHtml"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<div ng-repeat="payment in Payment.printablePayments(booking.payments)"
ng-if="activePayment === Receipt.ALL_PAYMENT_RECEIPTS || activePayment === payment"
>
<div ng-if="payment.isProcessorBasedType && (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.MERCHANT_COPY
)">
<div class="print-receipt">
<div class="print-receipt-section">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="Payment.isEmv(payment)"
ng-with="addressObject = company.primaryLocation || company"
ng-link="physical-address"
></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>[! contact.name !]</b></li>
<li ng-if="contact.phone">[! contact|contactPhone !]</li>
<li ng-if="contact.email">[! contact.email !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-init="
payments = [ payment ];
taxByType = Payment.taxByType(payment);
"
>
<tbody ng-repeat="payment in payments|orderBy:'createdAt'">
<tr>
<td>
<ul class="print-receipt-list">
<li>
<span ng-if="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
</li>
<li>
[! payment.createdAt|datetime !]
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="payment.initialReceipt.total"
ng-amount-company="payment.company"
></td>
</tr>
<tr ng-repeat="refund in payment.refunds|orderBy:'createdAt'">
<td class="left-indent">
<ul class="print-receipt-list">
<li>Refund</li>
<li>[! refund.createdAt|datetime !]</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="-refund.receipt.total"
ng-amount-company="refund.payment.company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium">
<tr>
<td class="bold text-right">Paid</td>
<td class="print-receipt-amount text-right"
ng-amount="payments|summary:'receipt.total'"
ng-amount-company="company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium"
ng-if="taxByType"
>
<tr ng-repeat="taxType in taxTypes"
ng-if="taxByType[taxType.pk]"
>
<td class="text-right"><b>[! taxType.name !]</b></td>
<td class="print-receipt-amount text-right"
ng-amount="taxByType[taxType.pk]"
ng-amount-currency="payment"
></td>
</tr>
</tbody>
<tbody class="spreadsheet-text-medium">
<tr>
<td colspan="2">
<div ng-if="Payment.isGratuityEnabled(payment)" ng-then="isGratuityEnabled">
<div>
<p class="print-receipt-text">
Thank you! Tip is not included. If you would like to add gratuity please note it here:
</p>
<div class="receipt-tip">
<table>
<tr>
<td>Tip:</td>
<td></td>
</tr>
<tr class="receipt-tip-total">
<td>Total:</td>
<td></td>
</tr>
</table>
</div>
</div>
</div>
<div ng-if="payment.isProcessorBasedType" ng-then="isProcessorBasedType">
<p ng-if="!Payment.isGratuityEnabled(payment)" class="print-receipt-text">
Thank you!
</p>
<div class="print-receipt-signature">
<p class="print-receipt-text">
Cardholder will pay above amount to card issuer pursuant to cardholder agreement. Cardholder signature:
</p>
<div class="print-receipt-signature-line">x</div>
</div>
</div>
<span ng-else="isProcessorBasedType || isGratuityEnabled">
&nbsp;
</span>
</td>
</tr>
</tbody>
<tbody>
<tr class="spreadsheet-text-small">
<td colspan="2">
<aside ng-if="Payment.hasMultipleVisibleContributingBookings(payment)">
Order #[! Payment.order(payment).identifier !]
</aside>
<h3 ng-if="payment.isRefunded" ng-then="paymentIsRefunded">
Original payment for:
</h3>
<h3 ng-else="paymentIsRefunded">
Payment for:
</h3>
</td>
</tr>
</tbody>
<tbody ng-if="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="paymentHasMultipleVisibleContributingBookings"
>
<tr ng-repeat="subPayment in payment.payments">
<td ng-init="booking = subPayment.booking"
colspan="[! payment.isRefunded ? 2 : 1 !]"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="subPayment.receipt.total"
ng-amount-company="subPayment.company"
></td>
</tr>
<tr ng-if="payment.invisibleBookingCount">
<td colspan="[! payment.isRefunded ? 2 : 1 !]">
[! interpolate(nT('%(count)s other booking', '%(count)s other bookings', payment.invisibleBookingCount), { count: payment.invisibleBookingCount }) !]
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="payment.invisibleReceipt.total"
ng-amount-company="order.company"
></td>
</tr>
</tbody>
<tbody ng-else="paymentHasMultipleVisibleContributingBookings">
<tr>
<td ng-if="payment.bookings" ng-then="paymentIsAggregated"
ng-init="booking = payment.bookings[0]"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-else="paymentIsAggregated"
ng-init="booking = payment.booking"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-if="Payment.receiptFooters(payment).length > 0" ng-then="receiptFooters"
class="print-receipt-section item-receipt-footer"
>
<div ng-repeat="item in Payment.items(payment)">
<div ng-if="item.receiptFooter">
<div class="print-receipt-text text-center md-inline"
ng-if-once="item.receiptFooterSafeHtml"
ng-bind-html-once="item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<div ng-else="receiptFooters">
<div ng-if="!Payment.isGratuityEnabled(payment) && !payment.isProcessorBasedType"
class="print-receipt-section item-receipt-footer"
>
<p class="print-receipt-text text-center">
Thanks for your payment!
</p>
</div>
</div>
<div class="print-receipt-section"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Merchant Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-footer">
[[ Receipt.printedAt()|datetime ]]
</div>
</div>
</div>
<div ng-if="!payment.isProcessorBasedType || (
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.BOTH_COPIES ||
ticketLayoutViewCtrl.selectedReceiptCopyType === ticketLayoutViewCtrl.CUSTOMER_COPY
)">
<div class="print-receipt">
<div class="print-receipt-section">
<ul>
<li><b>[! company.name !]</b></li>
<li ng-if-once="Payment.isEmv(payment)"
ng-with="addressObject = company.primaryLocation || company"
ng-link="physical-address"
></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>[! contact.name !]</b></li>
<li ng-if="contact.phone">[! contact|contactPhone !]</li>
<li ng-if="contact.email">[! contact.email !]</li>
</ul>
</div>
<div class="print-receipt-section">
<table class="spreadsheet"
ng-init="
payments = [ payment ];
taxByType = Payment.taxByType(payment);
"
>
<tbody ng-repeat="payment in payments|orderBy:'createdAt'">
<tr>
<td>
<ul class="print-receipt-list">
<li>
<span ng-if="payment.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(payment)" ng-then="ccPayment">
<b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b>[! payment.displayType !]</b>
</span>
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
</li>
<li>
[! payment.createdAt|datetime !]
</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="payment.initialReceipt.total"
ng-amount-company="payment.company"
></td>
</tr>
<tr ng-repeat="refund in payment.refunds|orderBy:'createdAt'">
<td class="left-indent">
<ul class="print-receipt-list">
<li>Refund</li>
<li>[! refund.createdAt|datetime !]</li>
</ul>
</td>
<td class="print-receipt-amount text-right"
ng-amount="-refund.receipt.total"
ng-amount-company="refund.payment.company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium">
<tr>
<td class="bold text-right">Paid</td>
<td class="print-receipt-amount text-right"
ng-amount="payments|summary:'receipt.total'"
ng-amount-company="company"
></td>
</tr>
</tbody>
<tbody class="amount-summary spreadsheet-text-medium"
ng-if="taxByType"
>
<tr ng-repeat="taxType in taxTypes"
ng-if="taxByType[taxType.pk]"
>
<td class="text-right"><b>[! taxType.name !]</b></td>
<td class="print-receipt-amount text-right"
ng-amount="taxByType[taxType.pk]"
ng-amount-currency="payment"
></td>
</tr>
</tbody>
<tbody class="spreadsheet-text-medium">
<tr>
<td colspan="2">
<div ng-if="Payment.isGratuityEnabled(payment)" ng-then="isGratuityEnabled">
<div>
<p class="print-receipt-text">
Thank you! Tip is not included. If you would like to add gratuity please note it here:
</p>
<div class="receipt-tip">
<table>
<tr>
<td>Tip:</td>
<td></td>
</tr>
<tr class="receipt-tip-total">
<td>Total:</td>
<td></td>
</tr>
</table>
</div>
</div>
</div>
<div ng-if="payment.isProcessorBasedType" ng-then="isProcessorBasedType">
<p ng-if="!Payment.isGratuityEnabled(payment)" class="print-receipt-text">
Thank you!
</p>
</div>
<span ng-else="isProcessorBasedType || isGratuityEnabled">
&nbsp;
</span>
</td>
</tr>
</tbody>
<tbody>
<tr class="spreadsheet-text-small">
<td colspan="2">
<aside ng-if="Payment.hasMultipleVisibleContributingBookings(payment)">
Order #[! Payment.order(payment).identifier !]
</aside>
<h3 ng-if="payment.isRefunded" ng-then="paymentIsRefunded">
Original payment for:
</h3>
<h3 ng-else="paymentIsRefunded">
Payment for:
</h3>
</td>
</tr>
</tbody>
<tbody ng-if="Payment.hasMultipleVisibleContributingBookings(payment)"
ng-then="paymentHasMultipleVisibleContributingBookings"
>
<tr ng-repeat="subPayment in payment.payments">
<td ng-init="booking = subPayment.booking"
colspan="[! payment.isRefunded ? 2 : 1 !]"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="subPayment.receipt.total"
ng-amount-company="subPayment.company"
></td>
</tr>
<tr ng-if="payment.invisibleBookingCount">
<td colspan="[! payment.isRefunded ? 2 : 1 !]">
[! interpolate(nT('%(count)s other booking', '%(count)s other bookings', payment.invisibleBookingCount), { count: payment.invisibleBookingCount }) !]
</td>
<td ng-if="!payment.isRefunded" class="print-receipt-amount text-right"
ng-amount="payment.invisibleReceipt.total"
ng-amount-company="order.company"
></td>
</tr>
</tbody>
<tbody ng-else="paymentHasMultipleVisibleContributingBookings">
<tr>
<td ng-if="payment.bookings" ng-then="paymentIsAggregated"
ng-init="booking = payment.bookings[0]"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
<td ng-else="paymentIsAggregated"
ng-init="booking = payment.booking"
colspan="2"
>
<ul class="print-receipt-list">
<li>
<b>[! booking.availability.item.name !]</b>
<span ng-if="booking.availability.headline">
&mdash; [! booking.availability.headline !]
</span>
</li>
<li>
<span ng-if="booking.isCancelled"
class="badge"
>Cancelled</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt) !]
</li>
<li>
[! booking.customerBreakdown !]
</li>
<li>
<i>
Booking #[! booking.pk !]</i>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-if="Payment.receiptFooters(payment).length > 0" ng-then="receiptFooters"
class="print-receipt-section item-receipt-footer"
>
<div ng-repeat="item in Payment.items(payment)">
<div ng-if="item.receiptFooter">
<div class="print-receipt-text text-center md-inline"
ng-if-once="item.receiptFooterSafeHtml"
ng-bind-html-once="item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
<div ng-else="receiptFooters">
<div ng-if="!Payment.isGratuityEnabled(payment) && !payment.isProcessorBasedType"
class="print-receipt-section item-receipt-footer"
>
<p class="print-receipt-text text-center">
Thanks for your payment!
</p>
</div>
</div>
<div class="print-receipt-section"
ng-if-once="Payment.isEmv(payment)"
>
<table ng-init="details = Payment.emvDetails(payment)"
class="emv-details"
>
<thead>
<tr>
<td colspan="2">
Customer Receipt
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="detail in details">
<td class="valign-top">
[! detail.key !]
</td>
<td class="valign-top text-right break-words">
[! detail.value !]
</td>
</tr>
</tbody>
</table>
</div>
<div class="print-receipt-footer">
[[ Receipt.printedAt()|datetime ]]
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-toggled="bookingReceipt">
<button type="button"
ng-print ng-print-auto
ng-print-native=".native-receipt"
ng-body-class="'body-print-receipt'"
class="btn-big btn-black btn-wide btn-icon print respond-print-hide "
>
Print
</button>
<div class="print-receipt native-receipt">
<div class="print-receipt-section" ng-init="company = booking.company">
<ul>
<li ng-if-once="company.imageEmailCdnUrl || company.imageCdnUrl">
<img ng-image="company.imageEmailCdnUrl || company.imageCdnUrl"
ng-image-max-height="250"
alt="[! company.name !]"
class="receipt-logo"
/>
</li>
<li><b>[! company.name !]</b></li>
<li ng-if-once="company.phone">[! company.phone !]</li>
<li ng-if-once="company.url">[! company.url|hostname !]</li>
</ul>
</div>
<div class="print-receipt-section">
<ul class="print-receipt-list">
<li><b>
Booking #[! booking.pk !]</b></li>
<li>[! booking.contact.name !]</li>
<li ng-if="booking.contact.phone">[! booking.contact|contactPhone !]</li>
<li ng-if="booking.contact.email">[! booking.contact.email !]</li>
</ul>
<ul class="print-receipt-list">
<li>
<b>[[ booking.item.name ]]</b>
<span ng-if="availability.headline">&mdash; [[ availability.headline ]]</span>
</li>
<li>
[[ booking.availability.startAt|datetime:(booking.availability.endAt) ]]
</li>
<li>[! booking.customerBreakdown !]</li>
</ul>
</div>
<div class="print-receipt-section">
<div ng-with="includeAmounts = canViewAmounts">
<div ng-if="booking.customers.length >= booking.company.companyFeatures.summarizeBookingCustomersMinimum"
ng-then="summarizeCustomers"
ng-group="booking.customers"
>
<div ng-group-by="$row.customerTypeRate.customerPrototype.customerType.singular + '__' +
((canViewAmounts && booking.needsPricedConfirmations) ? ($row.costs.totalCost.price || null) : '')"
ng-group-as="$row.customerTypeRate.customerPrototype.customerType.singular"
ng-group-default
></div>
<table class="spreadsheet">
<tr ng-repeat="group in $groups">
<td ng-with="showingPrice = group.rows[0].costs.totalCost.price && canViewAmounts && booking.needsPricedConfirmations;">
<b>[[ group.as ]]<span ng-if="showingPrice">:</span></b>
<span ng-if="showingPrice">
<span ng-amount="group.rows[0].costs.totalCost.price"
ng-amount-company="company"
></span>
</span>
<span>x [[ group.rows.length ]]</span>
</td>
<td ng-if="canViewAmounts">
<span ng-show="group.rows[0].costs.totalCost.price && booking.needsPricedConfirmations"
ng-amount="group.rows|summary:'costs.totalCost.price'"
ng-amount-company="booking.company"
></span>
</td>
</tr>
</table>
</div>
<table class="spreadsheet"
ng-else="summarizeCustomers"
ng-repeat="customer in booking.customers"
ng-inline="receipt-customer-with-custom-field-values"
></table>
<table class="spreadsheet">
<tbody ng-repeat="customFieldValue in booking.customFieldValues"
ng-inline="receipt-custom-field-values"
></tbody>
</table>
<table class="spreadsheet" ng-if="visibleLineItems.length > 0">
<tbody ng-repeat="lineItem in visibleLineItems"
ng-inline="receipt-line-items"
></tbody>
</table>
</div>
<table ng-if-once="canViewAmounts && booking.needsPricedConfirmations" class="spreadsheet">
<tbody
ng-init="
hasExplicitGross = booking.explicitGross !== null;
costs = booking.costs;
fee = booking.receipt.bookingFee;
company = booking.company;
showTaxByType = Booking.showTaxByType(booking);
showZeroTax = !booking.item.isNoTax;
"
ng-inline="receipt-subtotal-total"
></tbody>
<tbody>
<tr>
<td colspan="100">&nbsp;</td>
</tr>
</tbody>
<tbody ng-repeat="paymentOrRefund in paymentsAndRefunds">
<tr ng-if="paymentOrRefund.cls === Payment.cls && !paymentOrRefund.isDeferred && (paymentOrRefund.type !== Payment.AFFILIATE_TYPE)">
<td>
<div ng-if="paymentOrRefund.isCardOnFile" ng-then="isCardOnFilePayment">
Charged to company card
</div>
<div ng-if="Payment.isNotCardOnFileProcessorBasedType(paymentOrRefund)" ng-then="ccPayment">
<b>[! paymentOrRefund.displayProcessorBasedType !] [! paymentOrRefund.processorBasedIdentifier !]</b>
</div>
<div ng-if="!ccPayment && !isCardOnFilePayment">
<b>[! paymentOrRefund.displayType !]</b>
</div>
<div ng-if-once="paymentOrRefund.inStorePaymentNote">
[! paymentOrRefund.inStorePaymentType.effectiveNoteLabel !]: <b>[! paymentOrRefund.inStorePaymentNote !]</b>
</div>
[! paymentOrRefund.createdAt|datetime !]
<div class="aggregated-payment-total-text"
ng-if="paymentOrRefund.aggregatedPayment.isAggregated"
>
[! paymentOrRefund.displayType !] charged <span ng-amount="paymentOrRefund.aggregatedPayment.initialReceipt.total" ng-amount-company="booking.company"></span> total for bookings:
<span ng-repeat="booking in paymentOrRefund.aggregatedPayment.bookings">
#[! booking.pk !] ([! booking.availability.item.name !])[! $last ? '.' : ', ' !]
</span>
</div>
</td>
<td ng-amount="paymentOrRefund.initialReceipt.total"
ng-amount-company="booking.company"
></td>
</tr>
<tr ng-if="paymentOrRefund.cls === Refund.cls && (paymentOrRefund.payment.type !== Payment.AFFILIATE_TYPE)">
<td>
<span ng-if="paymentOrRefund.payment.isCardOnFile" ng-then="isCardOnFile">
Refund to company card
</span>
<span ng-if="Payment.isNotCardOnFileProcessorBasedType(paymentOrRefund.payment)" ng-then="ccPayment">
Refund: <b>[! paymentOrRefund.payment.displayProcessorBasedType !] [! paymentOrRefund.payment.processorBasedIdentifier !]</b>
</span>
<span ng-if="!ccPayment && !isCardOnFile">
Refund: <b>[! paymentOrRefund.payment.displayType !]</b>
</span>
<div>[! paymentOrRefund.createdAt|datetime !]</div>
</td>
<td ng-amount="-paymentOrRefund.receipt.total"
ng-amount-company="booking.company"
></td>
</tr>
</tbody>
<tbody ng-hide="!booking.costs.totalCost.total"
ng-inline="receipt-amount-paid"
></tbody>
<tbody ng-if="
booking.company.features.isAmountDueOnReceiptsEnabled && booking.amountDue &&
(booking.receiptCollectedByCharter.gross + booking.receipt.bookingFee)
"
>
<tr>
<td colspan="100">&nbsp;</td>
</tr>
</tbody>
<tbody ng-if-once="booking.company.features.isAmountDueOnReceiptsEnabled && booking.amountDue"
ng-inline="receipt-amount-due"
></tbody>
</table>
</div>
<div class="print-receipt-section text-center md-inline"
ng-if="booking.item.receiptFooterSafeHtml"
ng-bind-html-once="booking.item.receiptFooterSafeHtml"
></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
</div>
<div class="booking-full-invoice is-mobile-toggled"
ng-class="{ 'toggled': toggles.state('mobileView') }"
ng-watch="bookingTracker.modifiedAt"
>
<div class="invoice-booking-info">
<h2 class="booking-info-pk">
Booking #[! booking.pk !]
<span class="badge badge-warning"
ng-tip="[! T('This booking will be deleted when demo mode is disabled') !]"
ng-tip-classes="tip-indent"
ng-if-once="booking.isDemo"
>Demo</span>
</h2>
<span class="booked-at fh-grey [! addClassIf(!booking.isCancelled && !booking.user, 'booked-at-online') !]">
<span ng-if="booking.isCancelled" ng-then="cancelled"
>
<span class="badge badge-error"
ng-if-once="!booking.rebookedTo"
>Cancelled</span>
<span class="badge"
ng-if-once="!!booking.rebookedTo"
>Rebooked</span>
[! booking.modifiedAt|datetime:'relative' !]
</span>
<span ng-else="cancelled"
>
<i ng-if-once="booking.rebookedFrom" class="rebooked-icon" ng-tip="[! T('Rebooked') !]"></i>
<span ng-if-once="!booking.user"
class="test-view-online-booking-action"
>
<i class="booked-online-icon"></i> Booked online
</span>
[! booking.createdAt|datetime:'relative' !]
[! booking.user.name ? interpolate(T('by %(personName)s'), { personName: booking.user.name }) : '' !]
<span ng-if-once="!!booking.user && !navigation.isCurrentCompany(booking.user.company)">
([! booking.user.company.name !])
</span>
</span>
</span>
</div>
<div class="invoice-availability is-big"
ng-link="invoice-availability"
ng-with="availability = booking.availability"
></div>
<div class="invoice-stats" ng-can-view-amounts="booking.company">
<div class="invoice-stats-inner is-toggle"
ng-toggle="bookingPayments"
>
<table class="booking-full-stats">
<tr class="stats-labels">
<td>[[ booking.explicitGross !== null ? T('Set booking total') : T('Booking total') ]]</td>
<td>Payments</td>
<td ng-if="!booking.isUnprocessed && !booking.isCancelled && (booking.amountDue || booking.amountOverpaid)"
ng-then="showAmountDue"
>
<span ng-if="booking.amountDue" class="badge badge-unpaid">Due</span>
<span ng-if="booking.amountOverpaid" class="badge badge-overpaid">Overpaid by</span>
</td>
<td ng-if="!booking.isUnprocessed && !booking.isCancelled && !showAmountDue" rowspan="2">
<span class="badge badge-paid">Paid in Full</span>
</td>
</tr>
<tr class="stats-numbers">
<td>
<span ng-if="booking.isUnprocessed" ng-then="isUnprocessed">Pending</span>
<span ng-else="isUnprocessed"
ng-amount="booking.costs.totalCost.total"
ng-amount-company="booking.company"
class="test-booking-total"
></span>
</td>
<td class="test-booking-paid"
ng-amount="booking.receipt.gross"
ng-amount-company="booking.company"
></td>
<td ng-if="showAmountDue"
ng-amount="booking.amountDue || booking.amountOverpaid"
ng-amount-company="booking.company"
></td>
</tr>
</table>
</div>
<div ng-toggled="bookingPayments" class="invoice-stats-payments">
<div ng-if="!paymentsCollectedByCharter.length && !paymentsCollectedByAffiliate.length"
class="no-overview-payments"
>
No payments have been made for this booking
</div>
<div ng-if="paymentsCollectedByCharter.length">
<table class="overview-payment-row is-header"
ng-if="!!booking.affiliation"
>
<tr>
<td>
[[ booking.company|personalizeCollectedByText ]]
</td>
<td class="op-amount-td bold"
ng-amount="booking.receiptCollectedByCharter.gross"
ng-amount-currency="booking"
></td>
</tr>
</table>
<div ng-repeat="payment in paymentsCollectedByCharter"
class="overview-payment is-boxed"
ng-link="payment-and-refunds"
></div>
</div>
<div ng-if="!!booking.affiliation && paymentsCollectedByAffiliate.length">
<table class="overview-payment-row is-header">
<tr>
<td>
[[ booking.affiliation.affiliateCompany|personalizeCollectedByText ]]
</td>
<td class="op-amount-td bold"
ng-amount="booking.receiptCollectedByAffiliate.gross"
ng-amount-currency="booking"
></td>
</tr>
</table>
<div ng-repeat="payment in paymentsCollectedByAffiliate"
class="overview-payment is-boxed"
ng-link="payment-and-refunds"
></div>
</div>
</div>
</div>
<table class="invoice-table"
ng-if="booking.company.features.isDashboardOrdersEnabled || booking.isOrder"
>
<tr class="invoice-table--row">
<td class="itable-content" colspan="2">
<span class="fh-grey">Order:</span>
<a ng-href="[! booking.order|orderUrl !]"
class="order-link"
ng-if="booking.isOrder"
ng-then="hasOrder"
>
<i class="tb-icon stack-blue"></i>#[[
interpolate(nT('%(bookingId)s (%(count)s booking)', '%(bookingId)s (%(count)s bookings)', booking.order.contributingBookingCount), { bookingId: booking.order.identifier, count: booking.order.contributingBookingCount })
]]
</a>
<span ng-else="hasOrder">
None
</span>
</td>
<td class="respond-print-hide invoice-table-add-button"
ng-can-create="Booking on booking.company"
ng-can-only-when="booking.company.features.isDashboardOrdersEnabled"
ng-then="canOrderize"
>
<span class="inline-add-link test-plusbook-booking-action" ng-click="plusbook.orderize(booking)"
>[[ hasOrder ? T('Add new booking') : cT('"order" as in sales order', 'Start new order') ]]</span>
</td>
<td class="respond-print-hide invoice-table-help-button"
ng-if="canOrderize"
>
<div class="tiny-help-flyout-wrap respond-handhelds-hide">
<div class="tiny-help"
ng-toggle="orderHelp"
ng-toggle-auto-close
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-tip="[! T('Orders help') !]"
>
<i class="help-icon-small-grey"></i>
</div>
<div ng-toggled="orderHelp"
class="tb-flyout tb-flyout--left tiny-help-flyout"
>
<div class="flyout-section flyout-section--no-border">
Group bookings together and collect payment for them at the same time.
<a ng-href="https://fareharbor.com/help/dashboard/orders/overview/"
ng-outbound-link="_blank"
class="hint-help-link nowrap"
>Getting started with orders &rsaquo;</a>
</div>
</div>
</div>
<div class="tiny-help-flyout-wrap respond-desktop-hide">
<a class="tiny-help"
ng-href="https://fareharbor.com/help/dashboard/orders/overview/"
ng-outbound-link="_blank"
>
<i class="help-icon-small-grey"></i>
</a>
</div>
</td>
</tr>
</table>
<div ng-controller=
"dashboard.bookings.NoteEditableCtrl"
class="
[[ addClassIf(!booking.note, 'respond-print-hide') ]]
" >
<div
ng-can="viewBookingNote on booking"
ng-then="allowed">
<form name="updateBookingNoteForm" ng-submit="editCtrl.submit(updateBookingNoteForm)"
ng-confirm-navigate-away
ng-autofocus
class="invoice-table--editing labels-above"
ng-can="updateBookingNote on booking"
ng-can-only-when="editCtrl.editing"
ng-then="editing"
ng-sonar-pause="booking when updated"
>
<div class="fields "
>
<div class="updatebookingnoteform-note
field-markdown
"
ng-django-field="updateBookingNoteForm [&#39;note&#39;]" ng-django-field-model="editableBooking [&#39;note&#39;]"
>
<label >
<span class="label-text">
Booking notes
</span>
<span class="the-field-outer"
>
<span class="the-field">
<textarea cols="40" data-lpignore="true" id="id_note" name="note" ng-markdown-file-upload=".js-markdown-tb .js-upload-button" ng-markdown-parent=".updatebookingnoteform-note" ng-markdown-preview=".js-markdown-tb .js-preview-button" ng-markdown-preview-result=".js-markdown-preview-result" ng-model="editableBooking [&#39;note&#39;]" rows="10">
</textarea>
<span class="field-style-hook"></span>
<div ng-toggled-show class="markdown-preview prose js-markdown-preview-result"
ng-toggled-show-value="'markdownPreview-' + $id"
></div>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateBookingNoteForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
<div class="tb markdown-field-tb tb--shaded js-markdown-tb">
<div class="tb-left"
>
<div class="tb-group">
<span class="tb-btn js-upload-button"
ng-tip="[! T('Upload image or file') !]"
>
<i class="tb-icon upload"></i> <abbr>Upload image or file</abbr>
</span>
</div>
</div>
<div class="tb-right">
<div class="tb-group">
<span class="tb-btn js-preview-button" ng-toggle ng-toggle-value="'markdownPreview-' + $id">
Preview Markdown
<a class="icon-hint"
ng-tip="[! T('Markdown lets you format text using a special syntax. Click here to learn more about it.') !]"
ng-href="https://fareharbor.com/help/more/markdown/" ng-outbound-link="_new"
></a>
</span>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="updateBookingNoteForm.all.$error.user-unauthorized">Only authorized users can edit booking notes</li>
<li ng-repeat="error in updateBookingNoteForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="hint">
<p>Displayed in Notes column of manifest, not visible to customer.</p>
</div>
<div class="btns btns--reversed">
<button class="btn-green btn btn-right" type="submit"
ng-disabled="updateBookingNoteForm.$pristine || updateBookingNoteForm.$invalid || updateBookingNoteForm.$submitting"
>
[[ updateBookingNoteForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn-grey btn btn-right" type="button"
ng-if="!updateBookingNoteForm.$submitting"
ng-click="editCtrl.cancel(updateBookingNoteForm)"
ng-shortcut="'esc'"
ng-shortcut-click
title="[! cT('Escape as in esc key', 'Shortcut: escape') !]"
>
Cancel
</button>
</div>
</form>
<div ng-else="editing">
<div class="print-h3">Booking notes</div>
<table class="invoice-table">
<tr class="invoice-table--row"
ng-class="{
'is-editable': auth.permissions.can('updateBookingNote', booking),
'is-warning': booking.note
}"
ng-click="editCtrl.edit()"
ng-cancel-click="!auth.permissions.can('updateBookingNote', booking)"
ng-shortcut="'shift+b'"
ng-shortcut-click
title="[! T('Shortcut: shift+b') !]"
ng-sonar-unpause="booking when updated"
>
<td class="itable-content" colspan="2">
<div class="md-inline"
ng-if="booking.note" ng-then="bookingNote"
ng-bind-html="booking.noteSafeHtml"
></div>
<div class="fh-grey" ng-else="bookingNote">
Booking notes:
</div>
</td>
<td class="itable-edit with-button"
ng-can="updateBookingNote on booking"
>
<span class="cf-edit-button">Edit</span>
</td>
</tr>
</table>
</div>
</div>
<div ng-else="allowed">
</div>
</div>
<div ng-if="booking.company.affiliatesCount || booking.affiliation"
class="single-booking-affiliation"
ng-class="{ 'respond-print-hide': !booking.affiliation }"
>
<div ng-controller=
"dashboard.shared.BookingAffiliationEditableCtrl"
class="" >
<div
ng-can-view="booking"
ng-init="canOpenBookingAffiliationForm = auth.permissions.can('updateBookingAffiliationInfo', booking) && (auth.permissions.can('updateBookingAffiliations', booking) || !!booking.affiliation)"
ng-then="allowed">
<div ng-if="canOpenBookingAffiliationForm && editCtrl.editing"
ng-then="editing"
ng-autofocus
class="invoice-table--editing"
>
<div ng-if="affiliationCtrl.status === 'loading'">Loading affiliates...</div>
<div ng-else="affiliationCtrl.status === 'loading'">
<form name="affiliationForm" class="test-affiliation-form-indicator"
ng-submit="editCtrl.submit(affiliationForm)"
ng-sonar-pause="booking when updated"
>
<div class="fields "
>
<div
ng-current-block
ng-current-block-affiliation="affiliationOptions.currentAffiliation"
ng-current-block-blocks="booking.availability.blocks"
>
<h2 class="affiliate-form-header update-affiliate-header">
<span ng-can="updateBookingAffiliations on booking">Affiliate &amp;</span> Voucher Number
</h2>
<div ng-can="updateBookingAffiliations on booking">
<div ng-if="booking.availability.company.affiliatesCount > Affiliation.MAX_SELECTABLE_AFFILIATES"
ng-then="remoteDropdown"
>
<div class="affiliationform-affiliation "
ng-django-field="affiliationForm [&#39;affiliation&#39;]" ng-django-field-model="editableAffiliation [&#39;affiliation&#39;]"
>
<div ng-current-option="editableAffiliation [&#39;affiliation&#39;]"
ng-current-option-collection=""
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="affiliation"
ng-model="editableAffiliation [&#39;affiliation&#39;]"
ng-disabled=""
ng-dropdown
ng-placeholder="Not booked by an affiliate"
ng-dropdown-remote-options="option.pk as option.affiliateCompany.name for option in affiliationCtrl.affiliatesNgDropdownEndpoint"
ng-dropdown-current-option="affiliationOptions.currentAffiliation"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="affiliationForm [&#39;affiliation&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in affiliationForm [&#39;affiliation&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div ng-else="remoteDropdown">
<div class="affiliationform-affiliation "
ng-django-field="affiliationForm [&#39;affiliation&#39;]" ng-django-field-model="editableAffiliation [&#39;affiliation&#39;]"
>
<div ng-current-option="editableAffiliation [&#39;affiliation&#39;]"
ng-current-option-collection="affiliationCtrl.affiliations"
ng-current-option-key="'pk'"
ng-current-option-target="affiliationOptions.currentAffiliation"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="affiliation"
ng-model="editableAffiliation [&#39;affiliation&#39;]"
ng-disabled=""
ng-options="option.pk as option.affiliateCompany.name for option in affiliationCtrl.affiliations"
ng-dropdown
ng-placeholder="Not booked by an affiliate"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="affiliationForm [&#39;affiliation&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in affiliationForm [&#39;affiliation&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div ng-if="affiliationOptions.currentAffiliation">
<div class="fields "
>
<div class="affiliationform-voucher-vouchernumber "
ng-django-field="affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;]" ng-django-field-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;]"
ng-django-field-required="affiliationOptions.currentAffiliation.isVoucherNumberRequired"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_voucher_number" maxlength="128" name="voucherNumber" ng-autofocus="true" ng-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;]" ng-pattern="/\S/" ng-placeholder="Voucher" ng-prefix="'voucher'" ng-required="affiliationOptions.currentAffiliation.isVoucherNumberRequired" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;].$error['pattern']">Invalid value</li>
<li ng-repeat="error in affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;voucherNumber&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<h2 class="affiliate-form-header">Agent</h2>
<div ng-if="affiliationCtrl.substatus === 'loading'" ng-then="subloading"
class="fh-grey"
>
Loading agents...
</div>
<div ng-else="subloading">
<div class="affiliationform-voucher-agent "
ng-django-field="affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;agent&#39;]" ng-django-field-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;agent&#39;]"
>
<div ng-current-option="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;agent&#39;]"
ng-current-option-collection="affiliationCtrl.agents"
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="agent"
ng-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;agent&#39;]"
ng-disabled=""
ng-options="option.pk as affiliationCtrl.agentName(option) for option in affiliationCtrl.agents"
ng-dropdown
ng-placeholder="No agent selected"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;agent&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;agent&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="help-input-wrap"
ng-if="editableAffiliation['voucher' + '-agent'] === Agent.OTHER_AGENT.pk"
>
<div class="affiliationform-voucher-agentname "
ng-django-field="affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;agentName&#39;]" ng-django-field-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;agentName&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_agent_name" maxlength="128" name="agentName" ng-autofocus="true" ng-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;agentName&#39;]" ng-placeholder="Agent name (new)" ng-prefix="'voucher'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;agentName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<span class="help-icon"
ng-tip="[! T('Only enter names of real people who should be added to the list of options. (Otherwise, use the booking notes instead.)') !]"
></span>
</div>
<div ng-if="affiliationCtrl.showDesks">
<div class="affiliationform-voucher-desk "
ng-django-field="affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;desk&#39;]" ng-django-field-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;desk&#39;]"
>
<div ng-current-option="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;desk&#39;]"
ng-current-option-collection="affiliationCtrl.desks"
ng-current-option-key="'pk'"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="desk"
ng-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;desk&#39;]"
ng-disabled=""
ng-options="option.pk as option.name for option in affiliationCtrl.desks"
ng-dropdown
ng-placeholder="No desk selected"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;desk&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;desk&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="help-input-wrap"
ng-if="editableAffiliation['voucher' + '-desk'] === Desk.OTHER_DESK.pk"
>
<div class="affiliationform-voucher-deskname "
ng-django-field="affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;deskName&#39;]" ng-django-field-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;deskName&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_desk_name" maxlength="128" name="deskName" ng-autofocus="true" ng-model="editableAffiliation [&#39;voucher&#39; + &#39;-&#39; + &#39;deskName&#39;]" ng-placeholder="Desk name (new)" ng-prefix="'voucher'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in affiliationForm [&#39;voucher&#39; + &#39;-&#39; + &#39;deskName&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<span class="help-icon"
ng-tip="[! T('Only enter names of desks that should be added to the list of options. (Otherwise, use the booking notes instead.)') !]"
></span>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div ng-if="currentBlock">
<h2 class="affiliate-form-header">Block</h2>
<div class="affiliationform-isblockable field-cb "
ng-django-field="affiliationForm [&#39;isBlockable&#39;]" ng-django-field-model="editableAffiliation [&#39;isBlockable&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_blockable" name="isBlockable" ng-checkbox-madness="true" ng-model="editableAffiliation [&#39;isBlockable&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Use seats blocked for [[ currentBlock.affiliation.affiliateCompany.name ]]
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in affiliationForm [&#39;isBlockable&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="update-affiliation-block-info">
<div>
<span class="icon-user-small"></span>
[[ interpolate(nT('%(count)s seat blocked', '%(count)s seats blocked', currentBlock.reservedCapacity), { count: currentBlock.reservedCapacity }) ]],
[[ interpolate(T('%(count)s currently filled'), { count: currentBlock.customerCount }) ]]
</div>
<div ng-show="editableAffiliation.isBlockable && (!booking.affiliation || booking.affiliation !== affiliationOptions.currentAffiliation || !booking.isBlockable)">
<div class="update-block-stat [[ currentBlock|capacityClass:(currentBlock.customerCount + booking.customerCount) ]]">
<span class="icon-user-small"></span>
[[ interpolate(T('%(customerCount)s of %(reservedCount)s will be filled after adding this booking'), { customerCount: currentBlock.customerCount + booking.customerCount, reservedCount: currentBlock.reservedCapacity }) ]]
</div>
<div ng-show="(currentBlock.customerCount + booking.customerCount) > currentBlock.reservedCapacity"
class="update-block-stat"
>
<span class="badge badge-warning">Booking fills beyond block</span>
<div class="block-overbook-message">
Adding this booking to the [[ currentBlock.affiliation.affiliateCompany.name ]] block will also fill [[ (currentBlock.customerCount + booking.customerCount ) - currentBlock.reservedCapacity ]] unblocked seats on this availability.
</div>
</div>
</div>
<div ng-show="!editableAffiliation.isBlockable && booking.affiliation === affiliationOptions.currentAffiliation && booking.isBlockable"
class="[[ currentBlock|capacityClass:(currentBlock.customerCount - booking.customerCount) ]]"
>
<span class="icon-user-small"></span>
[[ currentBlock.customerCount - booking.customerCount ]] of [[ currentBlock.reservedCapacity ]] will be filled after removing this booking from the block
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
<div class="affiliationform-affiliatecompanyshortname "
ng-django-field="affiliationForm [&#39;affiliateCompanyShortname&#39;]" ng-django-field-model="editableAffiliation [&#39;affiliateCompanyShortname&#39;]"
>
<label >
<span class="label-text">
Affiliate company shortname
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_affiliate_company_shortname" name="affiliateCompanyShortname" ng-model="editableAffiliation [&#39;affiliateCompanyShortname&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in affiliationForm [&#39;affiliateCompanyShortname&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="affiliationForm.all.$error.already_invoiced">This booking has already been invoiced. Please delete the relevant invoice before changing or removing the affiliate.</li>
<li ng-if="affiliationForm.all.$error.unauthorized">Only authorized users can update this booking affiliation.</li>
<li ng-if="affiliationForm.all.$error.cannot_remove">Some or all of this booking's total was paid to an affiliate. Please refund these payments before removing the affiliate.</li>
<li ng-if="affiliationForm.all.$error.invalid_company">invalid affiliate company</li>
<li ng-if="affiliationForm.all.$error.cannot_change">Some or all of this booking's total was paid to an affiliate. Please refund these payments before changing the affiliate.</li>
<li ng-repeat="error in affiliationForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<div class="form-error" ng-if="booking.affiliation !== affiliationOptions.currentAffiliation && bookingHasCardOnFilePayment">
A payment was made on this booking with a company card.
</div>
<button class="btn-green btn btn-right test-update-booking-affiliation-info-save-action" type="submit"
ng-disabled="booking.isUnprocessed || affiliationForm.$pristine || affiliationForm.$invalid || affiliationForm.$submitting"
>
[[ affiliationForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn-grey btn btn-right test-update-booking-affiliation-info-cancel-action" type="button"
ng-if="!affiliationForm.$submitting"
ng-click="editCtrl.cancel(affiliationForm)"
ng-sonar-unpause="booking when updated"
>
Cancel
</button>
</div>
</form>
</div>
</div>
<div ng-else="editing">
<div class="print-h3">Affiliate</div>
<table class="invoice-table invoice-table-flyout-wrap">
<tr class="invoice-table--row no-border test-update-booking-affiliation-info-action"
ng-class="{ 'is-editable': canOpenBookingAffiliationForm }"
ng-click="editCtrl.edit()"
ng-cancel-click="!canOpenBookingAffiliationForm"
>
<td class="itable-content">
<div ng-if="!!booking.affiliation" ng-then="bookingAffiliation"
ng-current-block
ng-current-block-affiliate="booking.affiliation.affiliateCompany"
ng-current-block-blocks="booking.availability.blocks"
class="itable-content-flyout-inner"
>
<b>
[[ navigation.isCurrentCompany(booking.affiliation.affiliateCompany) ? booking.company.name : booking.affiliation.affiliateCompany.name ]]
</b>
<div ng-if-once="booking.voucherNumber">
<span class="fh-grey">Voucher:</span> [! booking.voucherNumber !]
</div>
<div ng-if-once="!!booking.agent">
<span class="fh-grey">Agent:</span> [! booking.agent.name !]
</div>
<div ng-if-once="!!booking.desk">
<span class="fh-grey">Desk:</span> [! booking.desk.name !]
</div>
<div ng-if-once="booking.isBlockable && currentBlock" class="fh-grey">
<span class="icon-user-small"></span> Using blocked seats
</div>
</div>
<div ng-else="bookingAffiliation">
<span class="fh-grey">Affiliate:</span>
</div>
</td>
<td class="itable-edit with-button"
ng-if-once="canOpenBookingAffiliationForm"
>
<span class="cf-edit-button">Edit</span>
</td>
</tr>
<tr class="invoice-table--flyout respond-print-hide"
ng-if="!!booking.affiliation"
>
<td colspan="100">
<div class="tb tb--inset-mobile">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="networkContact"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable="true"
ng-toggle-auto-close
ng-tip="[! T('Contact info') !]"
>
<i class="tb-icon phone"></i>
<abbr>[! navigation.isCurrentCompany(booking.affiliation.affiliateCompany) ? T('Company contact info') : T('Affiliate contact info') !]</abbr>
</div>
<div ng-toggled="networkContact"
class="tb-flyout"
>
<div class="flyout-section flyout-section--no-border" ng-link="booking-network-contact"></div>
</div>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
<div class="invoice-affiliation-totals"
ng-can-view-invoice-amounts="booking.company"
ng-can-only-when="!!booking.affiliation && !!booking.invoiceSheet"
>
<table class="invoice-table">
<tr>
<td colspan="100">
<div ng-controller=
"dashboard.bookings.ExplicitInvoicePriceEditableCtrl"
class="" >
<div
ng-can-view="booking"
ng-then="allowed">
<table class="invoice-table">
<tr ng-can="updateExplicitInvoicePrice on booking"
ng-can-only-when="editCtrl.editing"
ng-then="editing"
>
<td colspan="100"
class="invoice-table--editing text-right"
>
<form name="updateBookingExplicitInvoicePriceForm" ng-submit="editCtrl.submit(updateBookingExplicitInvoicePriceForm)"
ng-sonar-pause="booking when updated"
>
<div class="fields "
>
<div class="updatebookingexplicitinvoicepriceform-isexplicitinvoiceprice field-cb field-cb--right "
ng-django-field="updateBookingExplicitInvoicePriceForm [&#39;isExplicitInvoicePrice&#39;]" ng-django-field-model="editableBooking [&#39;isExplicitInvoicePrice&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_explicit_invoice_price" name="isExplicitInvoicePrice" ng-checkbox-madness="true" ng-model="editableBooking [&#39;isExplicitInvoicePrice&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Set this booking's invoice price to a fixed amount
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateBookingExplicitInvoicePriceForm [&#39;isExplicitInvoicePrice&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="editableBooking.isExplicitInvoicePrice">
<div class="updatebookingexplicitinvoicepriceform-explicitinvoiceprice
field-amount
"
ng-django-field="updateBookingExplicitInvoicePriceForm [&#39;explicitInvoicePrice&#39;]" ng-django-field-model="editableBooking [&#39;explicitInvoicePrice&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_explicit_invoice_price" max="999999.99" min="0" name="explicitInvoicePrice" ng-amount-input="true" ng-amount-input-default="''" ng-amount-input-positive="true" ng-autofocus="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editableBooking [&#39;explicitInvoicePrice&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (booking || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateBookingExplicitInvoicePriceForm [&#39;explicitInvoicePrice&#39;].$error['pattern']">Invalid value</li>
<li ng-if="updateBookingExplicitInvoicePriceForm [&#39;explicitInvoicePrice&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in updateBookingExplicitInvoicePriceForm [&#39;explicitInvoicePrice&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in updateBookingExplicitInvoicePriceForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn btn-green btn-right" type="submit"
ng-disabled="updateBookingExplicitInvoicePriceForm.$invalid || updateBookingExplicitInvoicePriceForm.$pristine || updateBookingExplicitInvoicePriceForm.$submitting"
>
Save
</button>
<button class="btn btn-grey btn-right" type="button"
ng-click="editCtrl.cancel(updateBookingExplicitInvoicePriceForm)"
ng-sonar-unpause="booking when updated"
>
Cancel
</button>
</div>
</form>
</td>
</tr>
<tr ng-else="editing"
class="invoice-table--row"
ng-class="{ 'is-editable': auth.permissions.can('updateExplicitInvoicePrice', booking) }"
ng-click="editCtrl.edit()"
>
<td class="invoice-total-label">
<b ng-tip="[! T('This booking\'s invoice price is set to a fixed amount') !]" ng-tip-location=".icon-hint">
<b ng-if="booking.invoiceSheet.relationship === InvoiceSheet.AFFILIATE_RELATIONSHIP">
<span ng-if="auth.isCompanyUser(booking.affiliation.affiliateCompany)">
You should make
</span>
<span ng-else="auth.isCompanyUser(booking.affiliation.affiliateCompany)">
[[ booking.affiliation.affiliateCompany|name ]] should make
</span>
</b>
<b ng-if="booking.invoiceSheet.relationship === InvoiceSheet.CHARTER_RELATIONSHIP">
<span ng-if="auth.isCompanyUser(booking.company)">
You should make
</span>
<span ng-else="auth.isCompanyUser(booking.company)">
[[ booking.company|name ]] should make
</span>
</b>
<span ng-if="booking.explicitInvoicePrice !== null" class="icon-hint"></span>
</b>
</td>
<td class="itable-amount">
[[ booking.costs.invoiceCost.total|amount:booking ]]
</td>
<td class="itable-edit with-button"
ng-can="updateExplicitInvoicePrice on booking"
>
<span>Edit</span>
</td>
</tr>
</table>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
</td>
</tr>
<tr class="invoice-table--row" ng-if="booking.invoiceSheet.relationship === InvoiceSheet.AFFILIATE_RELATIONSHIP">
<td class="itable-content"><b>[[ booking.affiliation.affiliateCompany|personalizeCollectedByText ]]</b></td>
<td class="itable-amount">
[[ booking.receiptCollectedByAffiliate.gross|amount:booking ]]
</td>
</tr>
<tr class="invoice-table--row" ng-if="booking.invoiceSheet.relationship === InvoiceSheet.CHARTER_RELATIONSHIP">
<td class="itable-content"><b>[! booking.company|personalizeCollectedByText !]</b></td>
<td class="itable-amount">
[[ booking.receiptCollectedByCharter.gross|amount:booking ]]
</td>
</tr>
<tbody ng-if="!booking.invoiceEntries.length" ng-then="hasEntries">
<tr class="invoice-table--row">
<td class="fh-grey" colspan="100">
<b>Not yet invoiced</b>
</td>
</tr>
</tbody>
<tbody ng-else="hasEntries">
<tr class="invoice-table--row" ng-if="booking.isInvoicedToCharter">
<td class="itable-content">
<b ng-if-once="auth.isCompanyUser(booking.company)">
Invoiced by you
</b>
<b ng-else-once="auth.isCompanyUser(booking.company)">
Invoiced by [! booking.company|name !]
</b>
<div ng-link="booking-invoices-list"></div>
</td>
<td class="itable-amount">
[[ booking.invoicedToCharter|amount:booking ]]
</td>
</tr>
<tr class="invoice-table--row" ng-if="booking.isInvoicedToAffiliate">
<td class="itable-content">
<b ng-if="auth.isCompanyUser(booking.affiliation.affiliateCompany)">
Invoiced to you
</b>
<b ng-else="auth.isCompanyUser(booking.affiliation.affiliateCompany)">
Invoiced to [[ booking.affiliation.affiliateCompany|name ]]
</b>
<div ng-link="booking-invoices-list"></div>
</td>
<td class="itable-amount">
[[ booking.invoicedToAffiliate|amount:booking ]]
</td>
</tr>
</tbody>
<tbody ng-if="booking.isInvoiceable">
<tr class="invoice-table--row no-border" ng-if="booking.isInvoiceableToAffiliate">
<td class="itable-content">
<b ng-if="auth.isCompanyUser(booking.affiliation.affiliateCompany)">
Due to you
</b>
<b ng-else="auth.isCompanyUser(booking.affiliation.affiliateCompany)">
Due to [[ booking.affiliation.affiliateCompany|name ]]
</b>
</td>
<td class="itable-amount">
[[ booking.invoiceableToAffiliate|amount:booking ]]
</td>
</tr>
<tr class="invoice-table--row no-border" ng-if="booking.isInvoiceableToCharter">
<td>
<b ng-if-once="auth.isCompanyUser(booking.company)">
Due to you
</b>
<b ng-else-once="auth.isCompanyUser(booking.company)">
Due to [! booking.company|name !]
</b>
</td>
<td class="itable-amount">
[[ booking.invoiceableToCharter|amount:booking ]]
</td>
</tr>
</tbody>
<tr class="invoice-table--row no-border"
ng-if="booking.isInvoiced && !booking.isInvoiceable"
>
<td><b>Due</b></td>
<td class="itable-amount">
[[ 0|amount:booking ]]
</td>
</tr>
</table>
</div>
</div>
<div class="table valign-middle booking-full-invoice-customers">
<div class="tr">
<div class="td booking-full-customer-breakdown is-toggle pointer"
ng-toggle="showCustomers" ng-toggle-default="booking.customerCount < 7"
>
<span ng-can="viewCheckinStatus on Customer with booking"
ng-can-only-when="booking.company.features.isCheckinEnabled"
ng-then="showCheckinBreakdown"
>
[[ CheckinStatus.bookingCheckinBreakdown(booking) ]]
</span>
<span ng-else="showCheckinBreakdown">
[! booking.customerBreakdown !]
</span>
([! booking.customerCount !] total)
</div>
<div ng-can="viewInvoiceAmounts on booking.company"
ng-can-only-when="!!booking.affiliation && !booking.isUnprocessed"
class="td invoice-prices-toggle respond-print-hide"
>
<div class="field field-cb-light"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="displayOptions.showInvoicePrices"
>
</span>
<span class="label-text">
Show invoice prices
</span>
</span>
</label>
</div>
</div>
</div>
</div>
<table class="invoice-table"
ng-if="displayOptions.showInvoicePrices"
>
<tr class="invoice-table--row is-super-header">
<td></td>
<td class="itable-amount" ng-can-view-invoice-amounts="booking.company">
Invoice
</td>
<td class="itable-amount" ng-can-view-amounts="booking.company">
Total
</td>
<td class="itable-edit respond-print-hide"
ng-if="canEditCustomFieldValues"
></td>
</tr>
</table>
<table class="invoice-table [[ CheckinStatus.checkinStatusClass(customer.checkinStatus) ]]"
ng-repeat="customer in booking.customers"
ng-toggled="showCustomers"
>
<tr class="invoice-table--row is-shaded is-tall">
<td class="itable-content" colspan="[[ 1 +
( needsPrice(customer.costs) ? 0 : 1 )
+
( displayOptions.showInvoicePrices && canEditCustomFieldValues ? 0 : 1 )
]]"
>
<b title="[! customer.customerTypeRate.customerPrototype.customerType.singular !]">
[! customer.customerTypeRate.customerPrototype.customerType.shortName || customer.customerTypeRate.customerPrototype.customerType.singular !]
</b>
</td>
<td class="itable-amount itable-invoice-price"
ng-if="canViewInvoiceAmounts && displayOptions.showInvoicePrices"
ng-invoice-amount="customer.costs.invoiceCost.price"
ng-invoice-amount-company="booking.company"
></td>
<td class="itable-amount"
ng-if="needsPrice(customer.costs)"
ng-costs="customer.costs"
ng-costs-company="booking.company"
></td>
<td ng-if="displayOptions.showInvoicePrices && canEditCustomFieldValues" class="itable-edit"></td>
</tr>
<tr class="invoice-table--row"
ng-can="viewCheckinStatus on Customer with booking"
ng-can-only-when="booking.company.features.isCheckinEnabled"
ng-can-also-when="needsPrice(customer.baseCosts)"
>
<td class="itable-content" colspan="[[ 1 +
(needsPrice(customer.baseCosts) ? 0 : 1 )
+
( displayOptions.showInvoicePrices && canEditCustomFieldValues ? 0 : 1 )
]]"
>
<div ng-can="viewCheckinStatus on Customer with booking"
ng-can-only-when="booking.company.features.isCheckinEnabled"
ng-then="checkinEnabled"
>
<div ng-controller=
"dashboard.shared.CustomerCheckinStatusEditable"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
[! customer.checkinStatus ? (customer.checkinStatus.name|capitalize) : T('Not checked in') !]
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-can="updateCheckinStatus on Customer with booking" ng-then="editing">
<form name="updateCustomerCheckinStatusForm" class="test-update-customer-checkin-status-form-indicator">
<div class="fields "
>
<div class="updatecustomercheckinstatusform-checkinstatus field-select-max-width-100 "
ng-django-field="updateCustomerCheckinStatusForm [&#39;checkinStatus&#39;]" ng-django-field-model="editableCustomer [&#39;checkinStatus&#39;]"
>
<div ng-current-option="editableCustomer [&#39;checkinStatus&#39;]"
ng-current-option-collection="checkinStatusesForCustomer"
ng-current-option-key="'pk'"
ng-current-option-target="editableCustomer.currentCheckinStatus"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="checkin_status"
ng-model="editableCustomer [&#39;checkinStatus&#39;]"
ng-disabled=""
ng-options="option.pk as option.name|capitalize for option in checkinStatusesForCustomer"
>
<option value="" label="Not checked in">Not checked in</option>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="updateCustomerCheckinStatusForm [&#39;checkinStatus&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in updateCustomerCheckinStatusForm [&#39;checkinStatus&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in updateCustomerCheckinStatusForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
</form>
</div>
<div ng-else="editing" class="test-customer-checkin-status-indicator">
[! customer.checkinStatus ? (customer.checkinStatus.name|capitalize) : T('Not checked in') !]
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<b ng-else="checkinEnabled">Base cost:</b>
</td>
<td class="itable-amount itable-invoice-price"
ng-if="canViewInvoiceAmounts && displayOptions.showInvoicePrices"
ng-invoice-amount="customer.baseCosts.invoiceCost.price"
ng-invoice-amount-company="booking.company"
></td>
<td class="itable-amount"
ng-if="needsPrice(customer.baseCosts)"
>
<span ng-costs="customer.baseCosts" ng-costs-company="booking.company"></span>
</td>
<td ng-if="displayOptions.showInvoicePrices && canEditCustomFieldValues" class="itable-edit"></td>
</tr>
<tr>
<td colspan="100">
<table class="invoice-table invoice-table-flyout-wrap"
ng-class="{ 'respond-print-hide': !customFieldValue.isSelected }"
ng-repeat="customFieldValue in customer.customFieldValues"
ng-controller="dashboard.shared.CustomerCustomFieldValueEditableCtrl"
>
<tr ng-can-update="customFieldValue" ng-can-only-when="editCtrl.editing"
ng-then="editing"
ng-prices="customFieldValue.customFieldInstance"
ng-prices-static="booking.company"
ng-prices-static-total-sheet="booking.totalSheet"
ng-prices-static-invoice-sheet="booking.invoiceSheet"
>
<td colspan="100" class="invoice-table--editing">
<form name="customFieldValueForm"
ng-submit="editCtrl.submit(customFieldValueForm)"
ng-autofocus
ng-confirm-navigate-away
ng-with="customFieldPricing = pricesCtrl.totalPricing(customFieldValue.customFieldInstance); customFieldInstance = customFieldValue.customFieldInstance"
ng-sonar-pause="booking when updated"
ng-sonar-pause-action="editCtrl.cancel(customFieldValueForm)"
>
<div class="fields "
>
<div class="customfieldvalueform-value "
ng-django-field="customFieldValueForm [&#39;value&#39;]" ng-django-field-model="editableCustomFieldValue [&#39;value&#39;]"
ng-django-field-required="!!customFieldPricing.visibility.isRequired"
ng-class="{ 'is-display-only': customField.isDisplayOnly }"
>
<div class="cf-wrap cf-wrap--[! customField.type|css !]
[! CustomField.usesCheckbox(customField) ? 'cf-wrap--checkbox' : '' !]"
ng-class="{
'private-field': customFieldPricing.visibility.isHiddenWhenBooking || customField.isPrivate
}"
>
<span class="private-field-icon test-private-custom-field-indicator"
ng-tip="[[ customField.isPrivate ? T('Only shown to logged in users with permission to see private fields. (That\'s you!)') : T('Will not be shown when booking') ]]"
ng-tip-location=".private-field-lock"
>
<span class="private-field-lock"></span>
</span>
<div ng-if-once="customField.isDisplayOnly">
<div ng-if="customField.type === CustomField.HEADER_TYPE">
<h2>[! customField.title !]</h2>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if="customField.type === CustomField.NOTE_TYPE" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.SHORT_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field test-custom-field-[! customField.name|css !]">
<span class="label-text">[! customField.hint !]</span>
<input id="id_short" maxlength="2048" name="value" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" type="text" />
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.LONG_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="the-field test-custom-field-[! customField.name|css !]">
<textarea cols="40" id="id_long" name="value" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-placeholder="[! customField.hint !]" ng-required="!!customFieldPricing.visibility.isRequired" rows="10">
</textarea>
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.YES_NO_TYPE">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
<label ng-if="customField.type === CustomField.COUNT_TYPE && editableCustomFieldValue.type !== CustomFieldInstanceCondition.RANGE_TYPE"
class="custom-field-[! customField.type|css !] cf-label table valign-middle table-dont-respond"
ng-init="editableCustomFieldValue [&#39;value&#39;] = ((editableCustomFieldValue [&#39;value&#39;]|isDefined) ? editableCustomFieldValue [&#39;value&#39;] : customField.countMin)"
>
<div class="tr">
<div class="td count-field-select"
ng-hide="customField.countMin === customField.countMax && editableCustomFieldValue [&#39;value&#39;] === customField.countMin"
>
<select
ng-model="editableCustomFieldValue [&#39;value&#39;]"
ng-options="option for option in customField.countMin|range:(customField.countMax + 1)"
ng-prefix=""
name="value"
></select>
</div>
<div class="td">
<div class="cf-title">
[! customField.title !]<span
ng-if="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)"
><span ng-if="customField.isPricingHidden && bookCtrl.newBookingOptions.totalCosts[&#39;value&#39;] && PriceLine.showRate(customFieldPricing)"
>: <span ng-amount="bookCtrl.newBookingOptions.totalCosts[&#39;value&#39;].price"></span>
</span>
<span ng-if="!customField.isPricingHidden">
<span class="fh-grey">&mdash;</span>
<span ng-price="customFieldPricing"
ng-price-company="customField.company"
ng-price-count="editableCustomFieldValue [&#39;value&#39;]"
></span>
</span>
</span>
</div>
<div ng-inline="cf-description"></div>
</div>
</div>
</label>
<div ng-if-once="customField.type === CustomField.EXTENDED_OPTION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-prices-extended-options="editableCustomFieldValue [&#39;value&#39;]"
ng-prices-extended-options-field="customField"
ng-prices-extended-options-instance="customFieldInstance"
ng-prices-extended-options-currency="customField"
ng-current-option="editableCustomFieldValue [&#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="pricesExtendedOptionsCtrl.options"
ng-current-option-target="currentOption"
>
<div ng-if="pricesExtendedOptionsCtrl.isImpossibleOption" ng-then="impossibleOption">
<div class="cf-title">
<i class="warning-icon"></i> [! customField.title !]
</div>
</div>
<div ng-if="pricesExtendedOptionsCtrl.isForcedOption" ng-then="forcedOption"
ng-init="customFieldValueForm.$setDirty()"
class="cf-title"
>
<span ng-if="!customField.isPricingHidden"
ng-with="currentOptionPricing = pricesCtrl.totalPricing(currentOption.extendedOption)"
>
<span ng-price="currentOptionPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && currentOption.extendedOption.isAlwaysPerCustomer">
per person
</span>
<span ng-if="PriceLine.showOffset(currentOptionPricing)"></span>
<span ng-if="currentOption.extendedOption.name && (
PriceLine.showOffset(currentOptionPricing) ||
PriceLine.showRate(currentOptionPricing)
)" class="fh-grey"
>&mdash;</span>
</span>
<span ng-bind="currentOption.extendedOption.name"></span>
</div>
<div ng-else="impossibleOption || forcedOption">
<label class="cf-label">
<div class="cf-title" ng-show="customField.title">
<span ng-bind="customField.title"></span>
</div>
<div class="the-field cf-extended-option-dropdown">
<select ng-model="editableCustomFieldValue [&#39;value&#39;]"
ng-options="option.pk as option.label for option in pricesExtendedOptionsCtrl.options"
ng-prefix=""
ng-required="!!customFieldPricing.visibility.isRequired"
name="value"
ng-dropdown
ng-placeholder="[! T('Choose an option') !]"
></select>
<i ng-link="f-req" ng-with="label = T('Choice is required')"></i>
</div>
</label>
</div>
<div ng-show="currentOption">
<div class="option-details md-inline" ng-if="currentOption.extendedOption.description"
ng-bind-html="currentOption.extendedOption.descriptionSafeHtml"
></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-current-option="editableCustomFieldValue [&#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="customField.transportationOptions"
ng-current-option-target="currentTransportationOption"
>
<div class="cf-title">
<span ng-bind-once="customField.title"></span>
<span ng-if="!customField.isPricingHidden">
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</div>
<div ng-if="customField.transportationOptions.length === 1" ng-then="fullTransportation"
ng-init="editableCustomFieldValue [&#39;value&#39;] = customField.transportationOptions[0].pk"
></div>
<div ng-else="fullTransportation"
class="cf-transportation-dropdown"
>
<select
ng-init="editableCustomFieldValue [&#39;value&#39;] = editableCustomFieldValue [&#39;value&#39;] || (customField.transportationOptions.length && customField.transportationOptions[0].pk)"
ng-model="editableCustomFieldValue [&#39;value&#39;]"
ng-options="transportationOption.pk as transportationOption.location for transportationOption in customField.transportationOptions"
ng-prefix=""
name="value"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-placeholder="[! T('Choose transportation') !]"
>
</select>
</div>
<div class="transportation-details">
<h3 class="pickup-time">
<span ng-if="currentTransportationOption.isSelfTransportation" ng-then="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
Please arrive by [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
Please arrive [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
<span ng-else="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
We'll pick you up at [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
We'll pick you up [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
</h3>
<div class="transportation-note md-inline" ng-if="currentTransportationOption.description"
ng-bind-html="currentTransportationOption.descriptionSafeHtml"></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"></div>
</div>
<div ng-if-once="customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-new-transportation="editableCustomFieldValue [&#39;value&#39;]"
ng-mx-form-valid-async
>
<div ng-if="newTransportationCtrl.status === 'loading' || newTransportationCtrl.status === 'error'">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
<div ng-if="newTransportationCtrl.status === 'success'"
ng-mx-form-valid-async-success
>
<div class="table cf-lodging-table">
<div class="tr">
<div class="td">
<label class="cf-label">
<div class="cf-title"
ng-class="{ 'no-title': !customField.title }"
>
[! customField.title || 'none' !]
</div>
<div ng-current-option="newTransportationCtrl.data.lodging"
ng-current-option-collection="newTransportationCtrl.lodgings"
ng-current-option-target="newTransportationCtrl.currentLodging"
></div>
<div ng-if="newTransportationCtrl.lodgings.length"
class="the-field cf-lodging-dropdown"
ng-class="{
'ng-invalid': customFieldValueForm[ + '-lodging'].$invalid,
'ng-required': true
}"
>
<select ng-model="newTransportationCtrl.data.lodging"
ng-options="lodging.pk as lodging.effectiveName for lodging in newTransportationCtrl.lodgings"
ng-placeholder="[[ customField.hint || T('Please select where you are staying') ]]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="lodging"
></select>
<i ng-link="f-req"></i>
</div>
</label>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html="customField.descriptionSafeHtml"
></div>
</div>
<div class="td room-number-field"
ng-if="newTransportationCtrl.currentLodging && !newTransportationCtrl.currentLodging.isSelfLodging && !customField.isLodgingRoomNumberHidden"
>
<label class="cf-label">
<div class="cf-title">Room number</div>
<input id="id_lodging_room_number" maxlength="128" name="lodgingRoomNumber" ng-model="newTransportationCtrl.data.lodgingRoomNumber" ng-placeholder="If known" type="text" />
</label>
</div>
</div>
<div class="tr self-lodging-contact-field" ng-if="newTransportationCtrl.currentLodging && newTransportationCtrl.currentLodging.isSelfLodging">
<label class="cf-label">
<textarea cols="40" id="id_self_lodging_address" name="selfLodgingAddress" ng-model="newTransportationCtrl.data.selfLodgingAddress" ng-placeholder="Please let us know how we can contact you" rows="10">
</textarea>
</label>
</div>
</div>
<div class="new-transportation-details"
ng-if="newTransportationCtrl.isTransportationAvailable() || newTransportationCtrl.showSelfTransportation()"
>
<div ng-if="newTransportationCtrl.isTransportationAvailable()">
<div ng-if="newTransportationCtrl.showNeedsTransportation()"
ng-then="showNeedsTransportation"
>
<div class="new-transportation-options-header bold">
[[ newTransportationCtrl.canOverrideTransportation ?
T('Transportation option:') :
T('Transportation to our location is available. Please select an option:') ]]
</div>
<div class="field field-boolean-radio
ng-required
"
ng-class="{ 'ng-invalid': newTransportationCtrl.needsTransportation === undefined }"
ng-radio-flyer
>
<div class="the-field">
<i ng-link="f-req"></i>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="true"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('Needs transportation') : T('Please pick me up') ]]
<span ng-if="newTransportationCtrl.showTransportationPrice()">
&mdash;
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</label>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="false"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('No transportation') : T('I will provide my own transportation') ]]
</label>
</div>
</div>
</div>
<div ng-if="!showNeedsTransportation && newTransportationCtrl.showTransportationPrice()"
class="need-trans-price"
>
<b ng-hide="showNeedsTransportation">Transportation:</b>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</div>
<div ng-if="newTransportationCtrl.needsTransportation">
<div class="cf-rebook-new-transportation"
ng-if="
newTransportationCtrl.needsTransportation && newTransportationCtrl.rebookingTransportation &&
newTransportationCtrl.rebookTransportationOptions.length > 1
"
>
<h2>How should transportation be rebooked?</h2>
<ul class="cf-rebook-options" ng-radio-flyer>
<li ng-repeat="option in newTransportationCtrl.rebookTransportationOptions" class="cf-rebook-option">
<label>
<input type="radio" ng-model="newTransportationCtrl.rebookTransportationOption" ng-value="option">
[[ option.text ]]
<i ng-if="option.tip" ng-tip="[[ option.tip ]]" class="icon-hint"></i>
</label>
</li>
</ul>
</div>
<div class="new-trans-selects-wrap" ng-if="newTransportationCtrl.showRoutes() || newTransportationCtrl.showStops()">
<div class="new-trans-selects">
<div ng-if="newTransportationCtrl.showRoutes()">
<div ng-current-option="newTransportationCtrl.data.route"
ng-current-option-collection="newTransportationCtrl.routes"
ng-current-option-target="newTransportationCtrl.currentRoute"
></div>
<div class="the-field cf-route-dropdown"
ng-class="{
'ng-invalid': customFieldValueForm[ + '-route'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.route"
ng-options="routeSelection.route.pk as newTransportationCtrl.routeSelectionText(routeSelection) for routeSelection in newTransportationCtrl.routeSelections"
ng-placeholder="[! T('Choose your route') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="route"
></select>
<i ng-link="f-req"></i>
</div>
</div>
<div ng-current-option="newTransportationCtrl.data.stop"
ng-current-option-collection="newTransportationCtrl.stops"
ng-current-option-target="newTransportationCtrl.currentStop"
></div>
<div ng-if="newTransportationCtrl.showStops()"
class="the-field cf-stop-dropdown"
ng-class="{
'ng-invalid': customFieldValueForm[ + '-stop'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.stop"
ng-options="stop.pk as stop.unicode for stop in newTransportationCtrl.stops"
ng-placeholder="[! T('Choose a pickup location') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="stop"
></select>
<i ng-link="f-req"></i>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.needsTransportation && !newTransportationCtrl.currentStop && newTransportationCtrl.stops.length"
class="select-a-stop-note"
>
<span ng-if="newTransportationCtrl.canOverrideTransportation" ng-then="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
Select a pickup location above.
</span>
<span ng-else="required">
Select a pickup location above, or choose &quot;No transportation&quot; instead.
</span>
</span>
<span ng-else="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
Please select a pickup point from the list above.
</span>
<span ng-else="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
If you need transportation, please select a pickup point from the list above.
If you need help, please select &quot;I will provide my own transportation&quot; and call us after completing your booking.
</span>
</span>
</div>
<div ng-if="newTransportationCtrl.currentStop">
<div class="pickup-info">
<h3 class="new-pickup-time">
We'll pick you up at [[ newTransportationCtrl.currentStop.time|time ]] from [[ newTransportationCtrl.currentStop.pickup.name ]]
</h3>
<div class="pickup-notes-toggle" ng-if="newTransportationCtrl.currentStop.pickup.description">
Pickup details will be included in your confirmation email. (<a ng-toggle="showNotes">View details</a>)
</div>
<div ng-toggled="showNotes">
<div ng-if="newTransportationCtrl.currentStop.pickup.description" class="md-inline"
ng-bind-html="newTransportationCtrl.currentStop.pickup.descriptionSafeHtml"
></div>
</div>
</div>
<div ng-toggled="showNotes">
<a ng-href="[[ newTransportationCtrl.currentStop.pickup.mapUrl ]]"
ng-if="newTransportationCtrl.currentStop.pickup.mapUrl"
ng-outbound-link="_blank"
class="pickup-map-link"
>
<b class="map-link-headline">See pickup location on a map</b>
</a>
</div>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.showSelfTransportation()"
class="pickup-info"
>
<h3 class="new-pickup-time">
Please arrive by [[ availability.startAt|dateSubtract:availability.item.noTransportationMinutes:'minutes'|time ]]
</h3>
<div ng-if="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
>
<div class="pickup-notes-toggle">
Directions will be included in your confirmation email. (<a ng-toggle="showSelfNotes">View directions</a>)
</div>
<div class="md-inline"
ng-toggled="showSelfNotes"
ng-bind-html="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
></div>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-prevalidate-custom-field="editableCustomFieldValueOptions" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div class="cf-admin-note md-inline"
ng-can-list="Code on customField.company"
>
<span class="icon-lock" ng-tip="[! T('Customers booking online don\'t see this note.') !]"></span>
Accepts codes from <a ng-href="[! customField.campaign.$url(urls.dashboard.settings.campaigns.campaign.index) !]"> [! customField.campaign.name !]</a>.
<span ng-show="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)">
Changes price by <span class="option-offset" ng-price="customFieldPricing" ng-price-company="customField.company"></span> when code is valid.
</span>
</div>
<div ng-with="prevalidity = editableCustomFieldValueOptions.prevalidity[&#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_GENERATOR_TYPE">
<div ng-if="!!customFieldPricing.visibility.isRequired" ng-then="requiredField" ng-init="editableCustomFieldValue [&#39;value&#39;] = true;">
<div class="cf-title">
<span ng-if="!customField.isPricingHidden && (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing))">
<span class="option-offset"
ng-price="customFieldPricing"
ng-price-company="customField.company"
></span>
<span ng-if="!!customField.title">&mdash;</span>
</span>
[! customField.title !]
</div>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-else="requiredField">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CARD_GENERATOR_TYPE">
<div ng-can-view-amounts="customField.company" ng-then="canViewAmounts"
ng-card-generator="editableCustomFieldValue [&#39;value&#39;]"
ng-form="cardGeneratorSubform"
>
<div ng-if="cardGeneratorCtrl.isAlreadyGenerated" ng-then="alreadyGenerated">
<b ng-amount="cardGeneratorCtrl.selectedAmount"
ng-amount-company="customField.company"
></b> <span class="fh-grey">&mdash;</span>
This field has already generated a gift card.
</div>
<div ng-if="!alreadyGenerated && customFieldValue" ng-then="hasValue">
This field cannot be edited from here. Please edit the generated gift card instead.
</div>
<div ng-if="!alreadyGenerated && !hasValue">
<div ng-if="!customFieldPricing.visibility.isRequired"
class="table table-dont-respond valign-middle
cf-checkbox cf-checkbox--no-offset
test-custom-field-[! customField.name|css !]-select
"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input type="checkbox"
class="ng-pristine"
ng-model="cardGeneratorCtrl.isSelected"
ng-checkbox-madness="true"
>
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if-once="customField.title">[! customField.title !]</h2>
</div>
</div>
</label>
</div>
<div ng-if="cardGeneratorCtrl.isSelected">
<div class="cf-title" ng-if="customField.title && customFieldPricing.visibility.isRequired">[[ customField.title ]]</div>
<fieldset>
<legend class="card-generator-header">Choose Amount</legend>
<div class="card-generator-amounts-wrap">
<div class="table table-dont-respond full-width">
<ul ng-radio-flyer
class="card-generator-amounts tr"
ng-class="{ '-custom-amount': toggles.state(cardGeneratorCtrl.toggleValue) }"
>
<li class="td">
<label ng-toggle ng-toggle-value="cardGeneratorCtrl.toggleValue"
ng-toggle-interactive="false"
ng-toggle-default="cardGeneratorCtrl.defaultToOther"
ng-click="toggles.toggle(cardGeneratorCtrl.toggleValue, true)"
>
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]">
<div>Custom</div>
</label>
</li>
<li ng-repeat="suggestedAmount in cardGeneratorCtrl.suggestedAmounts"
class="td"
>
<label ng-click="cardGeneratorCtrl.selectAmount(suggestedAmount)">
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]" ng-checked="!toggles.state(cardGeneratorCtrl.toggleValue) && cardGeneratorCtrl.selectedAmount === suggestedAmount">
<div ng-amount="suggestedAmount" ng-amount-currency="customField" ng-amount-hide-cents></div>
</label>
</li>
</ul>
</div>
</div>
</fieldset>
<div ng-toggled ng-toggled-value="cardGeneratorCtrl.toggleValue"
class="card-generator-custom-amount"
>
<div class="cardgeneratorsubform-selectedamount
field-amount
"
ng-django-field="cardGeneratorSubform [&#39;selectedAmount&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Gift amount:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount" max="999999.99" min="0" name="amount" ng-amount-input="true" ng-amount-input-default="cardGeneratorCtrl.minimumAmount" ng-amount-input-min="cardGeneratorCtrl.minimumAmount" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cardGeneratorSubform [&#39;selectedAmount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="cardGeneratorCtrl.selectedAmount">
<div class="p-t-15 prose"
ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
<fieldset>
<legend class="card-generator-header">Recipient Info</legend>
<p class="p-b-10">
You&#039;ll confirm these details, add an optional note, and send your digital gift card after checkout.
</p>
<div class="m-b-5 test-custom-field-[! customField.name|css !]-name">
<div class="cardgeneratorsubform-name field-person-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;name&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;name&#39;]"
ng-django-field-required="!auth.permissions.can('skipRecipientName', customField)"
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="cardGeneratorCtrl [&#39;name&#39;]" ng-placeholder="Full name" ng-required="!auth.permissions.can('skipRecipientName', customField)" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="cardgeneratorsubform-email field-email-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;email&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;email&#39;]"
ng-django-field-required="false"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="cardGeneratorCtrl [&#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-required="false" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</fieldset>
</div>
</div>
</div>
</div>
<div ng-else="canViewAmounts">
Sorry, you are not authorized to create gift cards.
</div>
</div>
<div ng-if-once="customField.type === CustomField.MULTI_CAMPAIGN_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label ng-toggle ng-toggle-value="'addCampaignCode' + customField.pk"
ng-toggle-default="auth.currentUser.isAuthenticated || customFieldPricing.visibility.isRequired || customField.isCodeInputShownByDefault || !!editableCustomFieldValue[&#39;value&#39;]"
class="cf-label hide-when-toggled"
ng-mx-click="click-add-promo-code"
>
<span class="fh-grey underline pointer">[! customField.codeToggleText || T('Add promo or discount code') !]</span>
</label>
<label class="cf-label"
ng-toggled ng-toggled-value="'addCampaignCode' + customField.pk"
>
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-prevalidate-custom-field="editableCustomFieldValueOptions" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div
ng-with="prevalidity = editableCustomFieldValueOptions.prevalidity[&#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.WAIVER_TYPE">
<div class="custom-field-[! customField.type|css !]"
ng-can-create="Waiver on customField.company"
ng-can-only-when="customField.connectedWaivers.length"
>
<div class="cf-admin-note md-inline">
<span class="icon-lock" ng-tip="[! T('Only people in your company see this note') !]"></span>
<b ng-show="!!customField.name">[! customField.name !]:</b>
Customers will be asked to sign:
<span ng-repeat="connectedWaiver in customField.connectedWaivers" >
<a ng-href="[! connectedWaiver.waiver.$url(urls.dashboard.settings.waivers.waiver.index) !]">[! connectedWaiver.waiver.name !]</a><span ng-if="!$last">,</span>
</span>
</div>
</div>
</div>
<ul class="errors">
<li ng-repeat="error in customFieldValueForm [&#39;value&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in customFieldValueForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<button class="btn btn-green btn-right" type="submit"
ng-disabled="booking.isUnprocessed || customFieldValueForm.$pristine || customFieldValueForm.$invalid || customFieldValueForm.$submitting"
>
[[ customFieldValueForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn btn-grey" type="button"
ng-click="editCtrl.cancel(customFieldValueForm)"
ng-disabled="customFieldValueForm.$submitting"
ng-sonar-unpause="booking when updated"
>
Cancel
</button>
</div>
</form>
</td>
</tr>
<tr class="invoice-table--row [! canEditCustomFieldValues ? 'is-editable' : '' !]"
ng-if="!editing"
ng-click="editCtrl.edit()"
>
<td class="itable-content" colspan="[[ 1 +
( canViewAmounts && (displayOptions.showInvoicePrices || customFieldValue.costs.totalCost.price) ? 0 : 1 )
+
( !auth.permissions.canUpdate(customFieldValue) ? 1 : 0 )
]]"
>
<div ng-if-once="customFieldValue.customFieldInstance.customField.type === CustomField.TRANSPORTATION_TYPE"
ng-then="isOldTrans"
>
<div ng-show="customFieldValue.transportationOption.shortName">
<b>Pickup:</b> [! customFieldValue.transportationOption.shortName !]
</div>
<div ng-show="!customFieldValue.transportationOption.isSelfTransportation">
<b>Pickup time:</b> [! customFieldValue.booking.availability.startAt|dateSubtract:customFieldValue.transportationOption.minutesBeforeStart:'minutes'|time !]
</div>
</div>
<div class="transportation-details"
ng-if="!auth.permissions.canUpdate(customFieldValue) && customFieldValue.customFieldInstance.customField.type === CustomField.TRANSPORTATION_TYPE"
>
<h3 class="pickup-time">
[! customFieldValue.transportationOption.isSelfTransportation ? T('Please arrive by:') : T('Pickup time:') !]
[! customFieldValue.booking.availability.startAt|dateSubtract:customFieldValue.transportationOption.minutesBeforeStart:'minutes'|time !]
</h3>
<div class="transportation-note md-inline" ng-if-once="customFieldValue.transportationOption.description"
ng-bind-html-once="customFieldValue.transportationOption.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customFieldValue.customFieldInstance.customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
ng-then="isNewTrans"
>
<ul ng-if="booking.lodging" ng-then="hasLodging"
class="itable-content-flyout-inner"
>
<li>
<b>[! booking.lodging.shortName || booking.lodging.effectiveName !]</b>
</li>
<li ng-if-once="booking.lodging.isSelfLodging">
[! booking.selfLodgingAddress !]
</li>
<li ng-if-once="booking.lodgingRoomNumber">
<span class="fh-grey">Room number:</span> [! booking.lodgingRoomNumber !]
</li>
<li ng-if-once="booking.stop">
<div ng-if-once="booking.stop.pickup.name">
<span class="fh-grey">Pickup location:</span> [! booking.stop.pickup|name !]
</div>
<div ng-if-once="booking.stop.time">
<span class="fh-grey">Pickup time:</span> [! booking.stop.time|time !]
</div>
</li>
<li ng-if-once="!booking.stop && booking.run">
<div ng-if-once="booking.run.route.name">
<span class="fh-grey">Route:</span> [! booking.run.route.name !]
</div>
<div ng-if-once="booking.run.startAt">
<span class="fh-grey">Route time:></span> [! booking.run.startAt|time !]
</div>
</li>
</ul>
<div ng-else-once="hasLodging">
<span class="fh-grey">
[! (customFieldValue.customFieldInstance.customField.shortName || customFieldValue.customFieldInstance.customField.name)|colonless !]:
</span>
None
</div>
</div>
<div ng-else-once="isOldTrans || isNewTrans">
<span class="fh-grey">
[! (customFieldValue.customFieldInstance.customField.shortName || customFieldValue.customFieldInstance.customField.name)|colonless !]:
</span>
<span class="[! !!customFieldValue.displayValue && (CustomField.isCodeType(customFieldValue.customFieldInstance.customField).type === CustomField.CODE_TYPE || customFieldValue.customFieldInstance.customField.type === CustomField.MULTI_CAMPAIGN_TYPE) ? 'badge badge-fh-blue font-monospace' : '' !]">
[! customFieldValue.displayValue !]
</span>
</div>
</td>
<td class="itable-amount itable-invoice-price"
ng-if="canViewInvoiceAmounts && displayOptions.showInvoicePrices"
ng-invoice-amount="customFieldValue.costs.invoiceCost.price"
ng-invoice-amount-company="booking.company"
></td>
<td class="itable-amount"
ng-if="canViewAmounts && (displayOptions.showInvoicePrices || customFieldValue.costs.totalCost.price)"
ng-costs="customFieldValue.costs"
ng-costs-company="booking.company"
></td>
<td class="itable-edit with-button respond-print-hide"
ng-can="editCustomFieldValues on booking"
>
<span class="cf-edit-button test-update-custom-field-value-action">Edit</span>
</td>
</tr>
<tr ng-if="!editing && booking.lodging && customFieldValue.customFieldInstance.customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="invoice-table--flyout respond-print-hide"
>
<td colspan="100">
<div class="tb tb--inset-mobile">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="'bookingLodging' + booking.pk"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable="true"
ng-toggle-auto-close
ng-tip="[! T('Lodging contact info') !]"
>
<i class="tb-icon phone"></i>
<abbr>Lodging contact info</abbr>
</div>
<div ng-toggled ng-toggled-value="'bookingLodging' + booking.pk"
class="tb-flyout"
>
<div class="flyout-section flyout-section--no-border" ng-inline="transportation-lodging-contact"></div>
</div>
</div>
</div>
</td>
</tr>
</table>
</td>
</tr>
<tr>
<td colspan="100">
<div ng-with="resourceUses = customer.resourceUses" ng-link="dashboard.bookings.resourceUses"></div>
</td>
</tr>
</table>
<table class="invoice-table has-top-margin"
ng-can-list="WaiverInstance on booking" ng-can-only-when="!!booking.groupedWaiverInstances.length"
ng-repeat="groupedWaiverInstance in booking.groupedWaiverInstances"
>
<tr class="invoice-table--row is-shaded is-tall">
<td colspan="2" class="itable-content"><b>[[ groupedWaiverInstance.waiver.name ]]</b></td>
<td class="itable-tb nowrap">
<div class="tb">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="'signWaiver-' + $id"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<b>
[[ groupedWaiverInstance.waiverParticipantCount ]] signed
</b>
</div>
<div class="tb-flyout tb-flyout--left tb-flyout--auto-width-narrow"
ng-toggled ng-toggled-value="'signWaiver-' + $id"
>
<ul class="flyout-menu-items">
<li>
<a ng-waiver="groupedWaiverInstance.waiver"
ng-waiver-booking="booking"
>Sign now</a>
</li>
</ul>
</div>
</div>
</div>
</td>
</tr>
<tr class="invoice-table--row" ng-repeat="waiverInstance in groupedWaiverInstance.waiverInstances">
<td colspan="100">
<div class="single-booking-waiver-tb">
<div class="tb tb--inset-mobile no-margin respond-print-hide">
<div class="tb-right">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="'waiver' + waiverInstance.pk"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-tip="[! T('Waiver options') !]"
>
<i class="tb-icon download"></i>
<abbr>Waiver options</abbr>
</div>
<div class="tb-flyout tb-flyout--left tb-flyout--auto-width-narrow"
ng-toggled ng-toggled-value="'waiver' + waiverInstance.pk"
>
<ul class="flyout-menu-items">
<li>
<a ng-href="[! waiverInstance.redirectUrl !]" ng-outbound-link="_blank">View PDF</a>
</li>
<li ng-can-remove="waiverInstance">
<div ng-controller=
"dashboard.bookings.WaiverEditableCtrl"
class="" >
<div
ng-can-remove="waiverInstance"
ng-then="allowed">
<div ng-delete-form="disableForm">
<ul class="errors"
ng-if="disableForm.all.$error.$server"
>
<li ng-repeat="error in disableForm.all.$error.$server">
[[ error ]]
</li>
</ul>
<button type="button"
ng-click="removeCtrl.remove(disableForm)"
ng-confirm-click="[! T('Remove this waiver? There is no undo.') !]"
ng-disabled="disableForm.$submitting"
>
Remove waiver
</button>
</div>
</div>
<div ng-else="allowed">
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div ng-repeat="participant in waiverInstance.participants">
<div>
[! participant.name !]
<span ng-if-once="!!participant.email">(<a ng-href="mailto:[! participant.email !]">[! participant.email !]</a>)</span>
</div>
<div ng-if-once="participant.dobAt">
<div ng-if-once="participant.isAgeVerified">
Age verified
</div>
<div ng-if-once="!participant.isAgeVerified">
[!
interpolate(nT('%(count)s year old', '%(count)s years old', participant.ageInYears), { count: participant.ageInYears })
!]
<span class="fh-grey">([! participant.dobAt|date !])</span>
</div>
</div>
</div>
</td>
</tr>
</table>
<table class="invoice-table has-top-margin"
ng-if="booking.generatedStoredValueCards.length"
>
<tr class="invoice-table--row is-shaded is-tall">
<td colspan="3" class="itable-content"><b>Generated Gift Cards</b></td>
</tr>
<tr class="invoice-table--row is-editable"
ng-repeat="generatedStoredValueCard in booking.generatedStoredValueCards"
ng-navigate="[! generatedStoredValueCard.$url(urls.dashboard.settings.storedValue.storedValueCard.index) !]"
>
<td>
<a ng-href="[! generatedStoredValueCard.$url(urls.dashboard.settings.storedValue.storedValueCard.index) !]"
class="font-monospace"
>
[! generatedStoredValueCard.number || generatedStoredValueCard.obscuredNumber !]
</a>
</td>
<td class="itable-amount">
<span ng-amount="generatedStoredValueCard.balance"
ng-amount-company="generatedStoredValueCard.company"
ng-if="canViewAmounts"
></span>
</td>
<td class="itable-navigate with-button"></td>
</tr>
</table>
<table ng-if="booking.customFieldValues.length || booking.generatedCodes.length || booking.bookingLevelResourceUses.length"
ng-with="availability = booking.availability"
class="invoice-table [[ addClassIf(toggles.state('showCustomers'), 'has-top-margin') ]]"
>
<tr class="invoice-table--row is-shaded is-tall">
<td colspan="100">
<b>Booking extras</b>
</td>
</tr>
<tr>
<td colspan="100">
<table class="invoice-table invoice-table-flyout-wrap"
ng-class="{ 'respond-print-hide': !customFieldValue.isSelected }"
ng-repeat="customFieldValue in booking.customFieldValues"
ng-controller="dashboard.shared.BookingCustomFieldValueEditableCtrl"
>
<tr ng-can-update="customFieldValue" ng-can-only-when="editCtrl.editing"
ng-then="editing"
ng-prices="customFieldValue.customFieldInstance"
ng-prices-static="booking.company"
ng-prices-static-total-sheet="booking.totalSheet"
ng-prices-static-invoice-sheet="booking.invoiceSheet"
>
<td colspan="100" class="invoice-table--editing">
<form name="customFieldValueForm"
ng-submit="editCtrl.submit(customFieldValueForm)"
ng-autofocus
ng-confirm-navigate-away
ng-with="customFieldPricing = pricesCtrl.totalPricing(customFieldValue.customFieldInstance); customFieldInstance = customFieldValue.customFieldInstance"
ng-sonar-pause="booking when updated"
ng-sonar-pause-action="editCtrl.cancel(customFieldValueForm)"
>
<div class="fields "
>
<div class="customfieldvalueform-value "
ng-django-field="customFieldValueForm [&#39;value&#39;]" ng-django-field-model="editableCustomFieldValue [&#39;value&#39;]"
ng-django-field-required="!!customFieldPricing.visibility.isRequired"
ng-class="{ 'is-display-only': customField.isDisplayOnly }"
>
<div class="cf-wrap cf-wrap--[! customField.type|css !]
[! CustomField.usesCheckbox(customField) ? 'cf-wrap--checkbox' : '' !]"
ng-class="{
'private-field': customFieldPricing.visibility.isHiddenWhenBooking || customField.isPrivate
}"
>
<span class="private-field-icon test-private-custom-field-indicator"
ng-tip="[[ customField.isPrivate ? T('Only shown to logged in users with permission to see private fields. (That\'s you!)') : T('Will not be shown when booking') ]]"
ng-tip-location=".private-field-lock"
>
<span class="private-field-lock"></span>
</span>
<div ng-if-once="customField.isDisplayOnly">
<div ng-if="customField.type === CustomField.HEADER_TYPE">
<h2>[! customField.title !]</h2>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if="customField.type === CustomField.NOTE_TYPE" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.SHORT_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field test-custom-field-[! customField.name|css !]">
<span class="label-text">[! customField.hint !]</span>
<input id="id_short" maxlength="2048" name="value" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" type="text" />
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.LONG_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="the-field test-custom-field-[! customField.name|css !]">
<textarea cols="40" id="id_long" name="value" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-placeholder="[! customField.hint !]" ng-required="!!customFieldPricing.visibility.isRequired" rows="10">
</textarea>
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.YES_NO_TYPE">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
<label ng-if="customField.type === CustomField.COUNT_TYPE && editableCustomFieldValue.type !== CustomFieldInstanceCondition.RANGE_TYPE"
class="custom-field-[! customField.type|css !] cf-label table valign-middle table-dont-respond"
ng-init="editableCustomFieldValue [&#39;value&#39;] = ((editableCustomFieldValue [&#39;value&#39;]|isDefined) ? editableCustomFieldValue [&#39;value&#39;] : customField.countMin)"
>
<div class="tr">
<div class="td count-field-select"
ng-hide="customField.countMin === customField.countMax && editableCustomFieldValue [&#39;value&#39;] === customField.countMin"
>
<select
ng-model="editableCustomFieldValue [&#39;value&#39;]"
ng-options="option for option in customField.countMin|range:(customField.countMax + 1)"
ng-prefix=""
name="value"
></select>
</div>
<div class="td">
<div class="cf-title">
[! customField.title !]<span
ng-if="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)"
><span ng-if="customField.isPricingHidden && bookCtrl.newBookingOptions.totalCosts[&#39;value&#39;] && PriceLine.showRate(customFieldPricing)"
>: <span ng-amount="bookCtrl.newBookingOptions.totalCosts[&#39;value&#39;].price"></span>
</span>
<span ng-if="!customField.isPricingHidden">
<span class="fh-grey">&mdash;</span>
<span ng-price="customFieldPricing"
ng-price-company="customField.company"
ng-price-count="editableCustomFieldValue [&#39;value&#39;]"
></span>
</span>
</span>
</div>
<div ng-inline="cf-description"></div>
</div>
</div>
</label>
<div ng-if-once="customField.type === CustomField.EXTENDED_OPTION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-prices-extended-options="editableCustomFieldValue [&#39;value&#39;]"
ng-prices-extended-options-field="customField"
ng-prices-extended-options-instance="customFieldInstance"
ng-prices-extended-options-currency="customField"
ng-current-option="editableCustomFieldValue [&#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="pricesExtendedOptionsCtrl.options"
ng-current-option-target="currentOption"
>
<div ng-if="pricesExtendedOptionsCtrl.isImpossibleOption" ng-then="impossibleOption">
<div class="cf-title">
<i class="warning-icon"></i> [! customField.title !]
</div>
</div>
<div ng-if="pricesExtendedOptionsCtrl.isForcedOption" ng-then="forcedOption"
ng-init="customFieldValueForm.$setDirty()"
class="cf-title"
>
<span ng-if="!customField.isPricingHidden"
ng-with="currentOptionPricing = pricesCtrl.totalPricing(currentOption.extendedOption)"
>
<span ng-price="currentOptionPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && currentOption.extendedOption.isAlwaysPerCustomer">
per person
</span>
<span ng-if="PriceLine.showOffset(currentOptionPricing)"></span>
<span ng-if="currentOption.extendedOption.name && (
PriceLine.showOffset(currentOptionPricing) ||
PriceLine.showRate(currentOptionPricing)
)" class="fh-grey"
>&mdash;</span>
</span>
<span ng-bind="currentOption.extendedOption.name"></span>
</div>
<div ng-else="impossibleOption || forcedOption">
<label class="cf-label">
<div class="cf-title" ng-show="customField.title">
<span ng-bind="customField.title"></span>
</div>
<div class="the-field cf-extended-option-dropdown">
<select ng-model="editableCustomFieldValue [&#39;value&#39;]"
ng-options="option.pk as option.label for option in pricesExtendedOptionsCtrl.options"
ng-prefix=""
ng-required="!!customFieldPricing.visibility.isRequired"
name="value"
ng-dropdown
ng-placeholder="[! T('Choose an option') !]"
></select>
<i ng-link="f-req" ng-with="label = T('Choice is required')"></i>
</div>
</label>
</div>
<div ng-show="currentOption">
<div class="option-details md-inline" ng-if="currentOption.extendedOption.description"
ng-bind-html="currentOption.extendedOption.descriptionSafeHtml"
></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-current-option="editableCustomFieldValue [&#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="customField.transportationOptions"
ng-current-option-target="currentTransportationOption"
>
<div class="cf-title">
<span ng-bind-once="customField.title"></span>
<span ng-if="!customField.isPricingHidden">
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</div>
<div ng-if="customField.transportationOptions.length === 1" ng-then="fullTransportation"
ng-init="editableCustomFieldValue [&#39;value&#39;] = customField.transportationOptions[0].pk"
></div>
<div ng-else="fullTransportation"
class="cf-transportation-dropdown"
>
<select
ng-init="editableCustomFieldValue [&#39;value&#39;] = editableCustomFieldValue [&#39;value&#39;] || (customField.transportationOptions.length && customField.transportationOptions[0].pk)"
ng-model="editableCustomFieldValue [&#39;value&#39;]"
ng-options="transportationOption.pk as transportationOption.location for transportationOption in customField.transportationOptions"
ng-prefix=""
name="value"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-placeholder="[! T('Choose transportation') !]"
>
</select>
</div>
<div class="transportation-details">
<h3 class="pickup-time">
<span ng-if="currentTransportationOption.isSelfTransportation" ng-then="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
Please arrive by [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
Please arrive [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
<span ng-else="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
We'll pick you up at [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
We'll pick you up [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
</h3>
<div class="transportation-note md-inline" ng-if="currentTransportationOption.description"
ng-bind-html="currentTransportationOption.descriptionSafeHtml"></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"></div>
</div>
<div ng-if-once="customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-new-transportation="editableCustomFieldValue [&#39;value&#39;]"
ng-mx-form-valid-async
>
<div ng-if="newTransportationCtrl.status === 'loading' || newTransportationCtrl.status === 'error'">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
<div ng-if="newTransportationCtrl.status === 'success'"
ng-mx-form-valid-async-success
>
<div class="table cf-lodging-table">
<div class="tr">
<div class="td">
<label class="cf-label">
<div class="cf-title"
ng-class="{ 'no-title': !customField.title }"
>
[! customField.title || 'none' !]
</div>
<div ng-current-option="newTransportationCtrl.data.lodging"
ng-current-option-collection="newTransportationCtrl.lodgings"
ng-current-option-target="newTransportationCtrl.currentLodging"
></div>
<div ng-if="newTransportationCtrl.lodgings.length"
class="the-field cf-lodging-dropdown"
ng-class="{
'ng-invalid': customFieldValueForm[ + '-lodging'].$invalid,
'ng-required': true
}"
>
<select ng-model="newTransportationCtrl.data.lodging"
ng-options="lodging.pk as lodging.effectiveName for lodging in newTransportationCtrl.lodgings"
ng-placeholder="[[ customField.hint || T('Please select where you are staying') ]]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="lodging"
></select>
<i ng-link="f-req"></i>
</div>
</label>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html="customField.descriptionSafeHtml"
></div>
</div>
<div class="td room-number-field"
ng-if="newTransportationCtrl.currentLodging && !newTransportationCtrl.currentLodging.isSelfLodging && !customField.isLodgingRoomNumberHidden"
>
<label class="cf-label">
<div class="cf-title">Room number</div>
<input id="id_lodging_room_number" maxlength="128" name="lodgingRoomNumber" ng-model="newTransportationCtrl.data.lodgingRoomNumber" ng-placeholder="If known" type="text" />
</label>
</div>
</div>
<div class="tr self-lodging-contact-field" ng-if="newTransportationCtrl.currentLodging && newTransportationCtrl.currentLodging.isSelfLodging">
<label class="cf-label">
<textarea cols="40" id="id_self_lodging_address" name="selfLodgingAddress" ng-model="newTransportationCtrl.data.selfLodgingAddress" ng-placeholder="Please let us know how we can contact you" rows="10">
</textarea>
</label>
</div>
</div>
<div class="new-transportation-details"
ng-if="newTransportationCtrl.isTransportationAvailable() || newTransportationCtrl.showSelfTransportation()"
>
<div ng-if="newTransportationCtrl.isTransportationAvailable()">
<div ng-if="newTransportationCtrl.showNeedsTransportation()"
ng-then="showNeedsTransportation"
>
<div class="new-transportation-options-header bold">
[[ newTransportationCtrl.canOverrideTransportation ?
T('Transportation option:') :
T('Transportation to our location is available. Please select an option:') ]]
</div>
<div class="field field-boolean-radio
ng-required
"
ng-class="{ 'ng-invalid': newTransportationCtrl.needsTransportation === undefined }"
ng-radio-flyer
>
<div class="the-field">
<i ng-link="f-req"></i>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="true"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('Needs transportation') : T('Please pick me up') ]]
<span ng-if="newTransportationCtrl.showTransportationPrice()">
&mdash;
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</label>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="false"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('No transportation') : T('I will provide my own transportation') ]]
</label>
</div>
</div>
</div>
<div ng-if="!showNeedsTransportation && newTransportationCtrl.showTransportationPrice()"
class="need-trans-price"
>
<b ng-hide="showNeedsTransportation">Transportation:</b>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</div>
<div ng-if="newTransportationCtrl.needsTransportation">
<div class="cf-rebook-new-transportation"
ng-if="
newTransportationCtrl.needsTransportation && newTransportationCtrl.rebookingTransportation &&
newTransportationCtrl.rebookTransportationOptions.length > 1
"
>
<h2>How should transportation be rebooked?</h2>
<ul class="cf-rebook-options" ng-radio-flyer>
<li ng-repeat="option in newTransportationCtrl.rebookTransportationOptions" class="cf-rebook-option">
<label>
<input type="radio" ng-model="newTransportationCtrl.rebookTransportationOption" ng-value="option">
[[ option.text ]]
<i ng-if="option.tip" ng-tip="[[ option.tip ]]" class="icon-hint"></i>
</label>
</li>
</ul>
</div>
<div class="new-trans-selects-wrap" ng-if="newTransportationCtrl.showRoutes() || newTransportationCtrl.showStops()">
<div class="new-trans-selects">
<div ng-if="newTransportationCtrl.showRoutes()">
<div ng-current-option="newTransportationCtrl.data.route"
ng-current-option-collection="newTransportationCtrl.routes"
ng-current-option-target="newTransportationCtrl.currentRoute"
></div>
<div class="the-field cf-route-dropdown"
ng-class="{
'ng-invalid': customFieldValueForm[ + '-route'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.route"
ng-options="routeSelection.route.pk as newTransportationCtrl.routeSelectionText(routeSelection) for routeSelection in newTransportationCtrl.routeSelections"
ng-placeholder="[! T('Choose your route') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="route"
></select>
<i ng-link="f-req"></i>
</div>
</div>
<div ng-current-option="newTransportationCtrl.data.stop"
ng-current-option-collection="newTransportationCtrl.stops"
ng-current-option-target="newTransportationCtrl.currentStop"
></div>
<div ng-if="newTransportationCtrl.showStops()"
class="the-field cf-stop-dropdown"
ng-class="{
'ng-invalid': customFieldValueForm[ + '-stop'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.stop"
ng-options="stop.pk as stop.unicode for stop in newTransportationCtrl.stops"
ng-placeholder="[! T('Choose a pickup location') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="stop"
></select>
<i ng-link="f-req"></i>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.needsTransportation && !newTransportationCtrl.currentStop && newTransportationCtrl.stops.length"
class="select-a-stop-note"
>
<span ng-if="newTransportationCtrl.canOverrideTransportation" ng-then="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
Select a pickup location above.
</span>
<span ng-else="required">
Select a pickup location above, or choose &quot;No transportation&quot; instead.
</span>
</span>
<span ng-else="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
Please select a pickup point from the list above.
</span>
<span ng-else="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
If you need transportation, please select a pickup point from the list above.
If you need help, please select &quot;I will provide my own transportation&quot; and call us after completing your booking.
</span>
</span>
</div>
<div ng-if="newTransportationCtrl.currentStop">
<div class="pickup-info">
<h3 class="new-pickup-time">
We'll pick you up at [[ newTransportationCtrl.currentStop.time|time ]] from [[ newTransportationCtrl.currentStop.pickup.name ]]
</h3>
<div class="pickup-notes-toggle" ng-if="newTransportationCtrl.currentStop.pickup.description">
Pickup details will be included in your confirmation email. (<a ng-toggle="showNotes">View details</a>)
</div>
<div ng-toggled="showNotes">
<div ng-if="newTransportationCtrl.currentStop.pickup.description" class="md-inline"
ng-bind-html="newTransportationCtrl.currentStop.pickup.descriptionSafeHtml"
></div>
</div>
</div>
<div ng-toggled="showNotes">
<a ng-href="[[ newTransportationCtrl.currentStop.pickup.mapUrl ]]"
ng-if="newTransportationCtrl.currentStop.pickup.mapUrl"
ng-outbound-link="_blank"
class="pickup-map-link"
>
<b class="map-link-headline">See pickup location on a map</b>
</a>
</div>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.showSelfTransportation()"
class="pickup-info"
>
<h3 class="new-pickup-time">
Please arrive by [[ availability.startAt|dateSubtract:availability.item.noTransportationMinutes:'minutes'|time ]]
</h3>
<div ng-if="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
>
<div class="pickup-notes-toggle">
Directions will be included in your confirmation email. (<a ng-toggle="showSelfNotes">View directions</a>)
</div>
<div class="md-inline"
ng-toggled="showSelfNotes"
ng-bind-html="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
></div>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-prevalidate-custom-field="editableCustomFieldValueOptions" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div class="cf-admin-note md-inline"
ng-can-list="Code on customField.company"
>
<span class="icon-lock" ng-tip="[! T('Customers booking online don\'t see this note.') !]"></span>
Accepts codes from <a ng-href="[! customField.campaign.$url(urls.dashboard.settings.campaigns.campaign.index) !]"> [! customField.campaign.name !]</a>.
<span ng-show="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)">
Changes price by <span class="option-offset" ng-price="customFieldPricing" ng-price-company="customField.company"></span> when code is valid.
</span>
</div>
<div ng-with="prevalidity = editableCustomFieldValueOptions.prevalidity[&#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_GENERATOR_TYPE">
<div ng-if="!!customFieldPricing.visibility.isRequired" ng-then="requiredField" ng-init="editableCustomFieldValue [&#39;value&#39;] = true;">
<div class="cf-title">
<span ng-if="!customField.isPricingHidden && (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing))">
<span class="option-offset"
ng-price="customFieldPricing"
ng-price-company="customField.company"
></span>
<span ng-if="!!customField.title">&mdash;</span>
</span>
[! customField.title !]
</div>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-else="requiredField">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-required="!!customFieldPricing.visibility.isRequired" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CARD_GENERATOR_TYPE">
<div ng-can-view-amounts="customField.company" ng-then="canViewAmounts"
ng-card-generator="editableCustomFieldValue [&#39;value&#39;]"
ng-form="cardGeneratorSubform"
>
<div ng-if="cardGeneratorCtrl.isAlreadyGenerated" ng-then="alreadyGenerated">
<b ng-amount="cardGeneratorCtrl.selectedAmount"
ng-amount-company="customField.company"
></b> <span class="fh-grey">&mdash;</span>
This field has already generated a gift card.
</div>
<div ng-if="!alreadyGenerated && customFieldValue" ng-then="hasValue">
This field cannot be edited from here. Please edit the generated gift card instead.
</div>
<div ng-if="!alreadyGenerated && !hasValue">
<div ng-if="!customFieldPricing.visibility.isRequired"
class="table table-dont-respond valign-middle
cf-checkbox cf-checkbox--no-offset
test-custom-field-[! customField.name|css !]-select
"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input type="checkbox"
class="ng-pristine"
ng-model="cardGeneratorCtrl.isSelected"
ng-checkbox-madness="true"
>
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if-once="customField.title">[! customField.title !]</h2>
</div>
</div>
</label>
</div>
<div ng-if="cardGeneratorCtrl.isSelected">
<div class="cf-title" ng-if="customField.title && customFieldPricing.visibility.isRequired">[[ customField.title ]]</div>
<fieldset>
<legend class="card-generator-header">Choose Amount</legend>
<div class="card-generator-amounts-wrap">
<div class="table table-dont-respond full-width">
<ul ng-radio-flyer
class="card-generator-amounts tr"
ng-class="{ '-custom-amount': toggles.state(cardGeneratorCtrl.toggleValue) }"
>
<li class="td">
<label ng-toggle ng-toggle-value="cardGeneratorCtrl.toggleValue"
ng-toggle-interactive="false"
ng-toggle-default="cardGeneratorCtrl.defaultToOther"
ng-click="toggles.toggle(cardGeneratorCtrl.toggleValue, true)"
>
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]">
<div>Custom</div>
</label>
</li>
<li ng-repeat="suggestedAmount in cardGeneratorCtrl.suggestedAmounts"
class="td"
>
<label ng-click="cardGeneratorCtrl.selectAmount(suggestedAmount)">
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]" ng-checked="!toggles.state(cardGeneratorCtrl.toggleValue) && cardGeneratorCtrl.selectedAmount === suggestedAmount">
<div ng-amount="suggestedAmount" ng-amount-currency="customField" ng-amount-hide-cents></div>
</label>
</li>
</ul>
</div>
</div>
</fieldset>
<div ng-toggled ng-toggled-value="cardGeneratorCtrl.toggleValue"
class="card-generator-custom-amount"
>
<div class="cardgeneratorsubform-selectedamount
field-amount
"
ng-django-field="cardGeneratorSubform [&#39;selectedAmount&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Gift amount:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount" max="999999.99" min="0" name="amount" ng-amount-input="true" ng-amount-input-default="cardGeneratorCtrl.minimumAmount" ng-amount-input-min="cardGeneratorCtrl.minimumAmount" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cardGeneratorSubform [&#39;selectedAmount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="cardGeneratorCtrl.selectedAmount">
<div class="p-t-15 prose"
ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
<fieldset>
<legend class="card-generator-header">Recipient Info</legend>
<p class="p-b-10">
You&#039;ll confirm these details, add an optional note, and send your digital gift card after checkout.
</p>
<div class="m-b-5 test-custom-field-[! customField.name|css !]-name">
<div class="cardgeneratorsubform-name field-person-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;name&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;name&#39;]"
ng-django-field-required="!auth.permissions.can('skipRecipientName', customField)"
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="cardGeneratorCtrl [&#39;name&#39;]" ng-placeholder="Full name" ng-required="!auth.permissions.can('skipRecipientName', customField)" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="cardgeneratorsubform-email field-email-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;email&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;email&#39;]"
ng-django-field-required="false"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="cardGeneratorCtrl [&#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-required="false" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</fieldset>
</div>
</div>
</div>
</div>
<div ng-else="canViewAmounts">
Sorry, you are not authorized to create gift cards.
</div>
</div>
<div ng-if-once="customField.type === CustomField.MULTI_CAMPAIGN_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label ng-toggle ng-toggle-value="'addCampaignCode' + customField.pk"
ng-toggle-default="auth.currentUser.isAuthenticated || customFieldPricing.visibility.isRequired || customField.isCodeInputShownByDefault || !!editableCustomFieldValue[&#39;value&#39;]"
class="cf-label hide-when-toggled"
ng-mx-click="click-add-promo-code"
>
<span class="fh-grey underline pointer">[! customField.codeToggleText || T('Add promo or discount code') !]</span>
</label>
<label class="cf-label"
ng-toggled ng-toggled-value="'addCampaignCode' + customField.pk"
>
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="editableCustomFieldValue [&#39;value&#39;]" ng-prevalidate-custom-field="editableCustomFieldValueOptions" ng-pseudo-placeholder="True" ng-required="!!customFieldPricing.visibility.isRequired" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div
ng-with="prevalidity = editableCustomFieldValueOptions.prevalidity[&#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.WAIVER_TYPE">
<div class="custom-field-[! customField.type|css !]"
ng-can-create="Waiver on customField.company"
ng-can-only-when="customField.connectedWaivers.length"
>
<div class="cf-admin-note md-inline">
<span class="icon-lock" ng-tip="[! T('Only people in your company see this note') !]"></span>
<b ng-show="!!customField.name">[! customField.name !]:</b>
Customers will be asked to sign:
<span ng-repeat="connectedWaiver in customField.connectedWaivers" >
<a ng-href="[! connectedWaiver.waiver.$url(urls.dashboard.settings.waivers.waiver.index) !]">[! connectedWaiver.waiver.name !]</a><span ng-if="!$last">,</span>
</span>
</div>
</div>
</div>
<ul class="errors">
<li ng-repeat="error in customFieldValueForm [&#39;value&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in customFieldValueForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<button class="btn btn-green btn-right" type="submit"
ng-disabled="booking.isUnprocessed || customFieldValueForm.$pristine || customFieldValueForm.$invalid || customFieldValueForm.$submitting"
>
[[ customFieldValueForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn btn-grey" type="button"
ng-click="editCtrl.cancel(customFieldValueForm)"
ng-disabled="customFieldValueForm.$submitting"
ng-sonar-unpause="booking when updated"
>
Cancel
</button>
</div>
</form>
</td>
</tr>
<tr class="invoice-table--row [! canEditCustomFieldValues ? 'is-editable' : '' !]"
ng-if="!editing"
ng-click="editCtrl.edit()"
>
<td class="itable-content" colspan="[[ 1 +
( canViewAmounts && (displayOptions.showInvoicePrices || customFieldValue.costs.totalCost.price) ? 0 : 1 )
+
( !auth.permissions.canUpdate(customFieldValue) ? 1 : 0 )
]]"
>
<div ng-if-once="customFieldValue.customFieldInstance.customField.type === CustomField.TRANSPORTATION_TYPE"
ng-then="isOldTrans"
>
<div ng-show="customFieldValue.transportationOption.shortName">
<b>Pickup:</b> [! customFieldValue.transportationOption.shortName !]
</div>
<div ng-show="!customFieldValue.transportationOption.isSelfTransportation">
<b>Pickup time:</b> [! customFieldValue.booking.availability.startAt|dateSubtract:customFieldValue.transportationOption.minutesBeforeStart:'minutes'|time !]
</div>
</div>
<div class="transportation-details"
ng-if="!auth.permissions.canUpdate(customFieldValue) && customFieldValue.customFieldInstance.customField.type === CustomField.TRANSPORTATION_TYPE"
>
<h3 class="pickup-time">
[! customFieldValue.transportationOption.isSelfTransportation ? T('Please arrive by:') : T('Pickup time:') !]
[! customFieldValue.booking.availability.startAt|dateSubtract:customFieldValue.transportationOption.minutesBeforeStart:'minutes'|time !]
</h3>
<div class="transportation-note md-inline" ng-if-once="customFieldValue.transportationOption.description"
ng-bind-html-once="customFieldValue.transportationOption.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customFieldValue.customFieldInstance.customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
ng-then="isNewTrans"
>
<ul ng-if="booking.lodging" ng-then="hasLodging"
class="itable-content-flyout-inner"
>
<li>
<b>[! booking.lodging.shortName || booking.lodging.effectiveName !]</b>
</li>
<li ng-if-once="booking.lodging.isSelfLodging">
[! booking.selfLodgingAddress !]
</li>
<li ng-if-once="booking.lodgingRoomNumber">
<span class="fh-grey">Room number:</span> [! booking.lodgingRoomNumber !]
</li>
<li ng-if-once="booking.stop">
<div ng-if-once="booking.stop.pickup.name">
<span class="fh-grey">Pickup location:</span> [! booking.stop.pickup|name !]
</div>
<div ng-if-once="booking.stop.time">
<span class="fh-grey">Pickup time:</span> [! booking.stop.time|time !]
</div>
</li>
<li ng-if-once="!booking.stop && booking.run">
<div ng-if-once="booking.run.route.name">
<span class="fh-grey">Route:</span> [! booking.run.route.name !]
</div>
<div ng-if-once="booking.run.startAt">
<span class="fh-grey">Route time:></span> [! booking.run.startAt|time !]
</div>
</li>
</ul>
<div ng-else-once="hasLodging">
<span class="fh-grey">
[! (customFieldValue.customFieldInstance.customField.shortName || customFieldValue.customFieldInstance.customField.name)|colonless !]:
</span>
None
</div>
</div>
<div ng-else-once="isOldTrans || isNewTrans">
<span class="fh-grey">
[! (customFieldValue.customFieldInstance.customField.shortName || customFieldValue.customFieldInstance.customField.name)|colonless !]:
</span>
<span class="[! !!customFieldValue.displayValue && (CustomField.isCodeType(customFieldValue.customFieldInstance.customField).type === CustomField.CODE_TYPE || customFieldValue.customFieldInstance.customField.type === CustomField.MULTI_CAMPAIGN_TYPE) ? 'badge badge-fh-blue font-monospace' : '' !]">
[! customFieldValue.displayValue !]
</span>
</div>
</td>
<td class="itable-amount itable-invoice-price"
ng-if="canViewInvoiceAmounts && displayOptions.showInvoicePrices"
ng-invoice-amount="customFieldValue.costs.invoiceCost.price"
ng-invoice-amount-company="booking.company"
></td>
<td class="itable-amount"
ng-if="canViewAmounts && (displayOptions.showInvoicePrices || customFieldValue.costs.totalCost.price)"
ng-costs="customFieldValue.costs"
ng-costs-company="booking.company"
></td>
<td class="itable-edit with-button respond-print-hide"
ng-can="editCustomFieldValues on booking"
>
<span class="cf-edit-button test-update-custom-field-value-action">Edit</span>
</td>
</tr>
<tr ng-if="!editing && booking.lodging && customFieldValue.customFieldInstance.customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="invoice-table--flyout respond-print-hide"
>
<td colspan="100">
<div class="tb tb--inset-mobile">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="'bookingLodging' + booking.pk"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable="true"
ng-toggle-auto-close
ng-tip="[! T('Lodging contact info') !]"
>
<i class="tb-icon phone"></i>
<abbr>Lodging contact info</abbr>
</div>
<div ng-toggled ng-toggled-value="'bookingLodging' + booking.pk"
class="tb-flyout"
>
<div class="flyout-section flyout-section--no-border" ng-inline="transportation-lodging-contact"></div>
</div>
</div>
</div>
</td>
</tr>
</table>
</td>
</tr>
<tr class="invoice-table--row" ng-if="booking.generatedCodes.length">
<td colspan="100">
<span class="fh-grey">Generated codes:</span>
<span ng-repeat="generatedCode in booking.generatedCodes">
<a ng-href="[! generatedCode.$url(urls.dashboard.settings.campaigns.campaign.code) !]"
class="badge nowrap pointer badge-fh-blue"
>
<span class="font-monospace">[! generatedCode.code !]</span>
([! generatedCode.useCount > 0 ?
interpolate(nT('Used %(count)s time', 'Used %(count)s times', generatedCode.useCount), { count: generatedCode.useCount }) : T('Not used')
!])
</a>
<a ng-href="[! generatedCode.$url(urls.dashboard.settings.campaigns.campaign.index) !]">([! generatedCode.campaign.name !])</a><span ng-if="!$last">,</span>
</span>
</td>
</tr>
</table>
<div ng-with="resourceUses = booking.bookingLevelResourceUses" ng-link="dashboard.bookings.resourceUses"></div>
<table class="invoice-table has-top-margin"
ng-controller="dashboard.bookings.LineItemsCtrl"
>
<tbody ng-repeat="lineItem in lineItems" ng-controller="dashboard.shared.LineItemCtrl">
<tr class="invoice-table-row"
ng-can-update="lineItem"
ng-can-only-when="editCtrl.editing"
ng-then="editing"
>
<td colspan="100" class="invoice-table--editing">
<form name="updateLineItemForm"
ng-submit="editCtrl.submit(updateLineItemForm)"
ng-sonar-pause="booking when updated"
>
<div class="fields "
>
<div class="table table-dont-respond valign-top full-width line-item-form smush-fields">
<div class="tr">
<div class="td line-item-description">
<div class="updatelineitemform-description "
ng-django-field="updateLineItemForm [&#39;description&#39;]" ng-django-field-model="editableLineItem [&#39;description&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Description
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_description" maxlength="1024" name="description" ng-autofocus="true" ng-model="editableLineItem [&#39;description&#39;]" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateLineItemForm [&#39;description&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="td">
<div class="updatelineitemform-offset
field-amount
"
ng-django-field="updateLineItemForm [&#39;offset&#39;]" ng-django-field-model="editableLineItem [&#39;offset&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Amount
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_offset" max="999999.99" min="-999999.99" name="offset" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editableLineItem [&#39;offset&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (booking || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateLineItemForm [&#39;offset&#39;].$error['pattern']">Invalid value</li>
<li ng-if="updateLineItemForm [&#39;offset&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in updateLineItemForm [&#39;offset&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="tr">
<div class="td">
<div class="updatelineitemform-isprivate field-cb "
ng-django-field="updateLineItemForm [&#39;isPrivate&#39;]" ng-django-field-model="editableLineItem [&#39;isPrivate&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input checked="checked" data-lpignore="true" id="id_is_private" name="isPrivate" ng-checkbox-madness="true" ng-model="editableLineItem [&#39;isPrivate&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Private: Do not show to customer
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateLineItemForm [&#39;isPrivate&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="td">
<div class="updatelineitemform-istaxable field-cb-light "
ng-django-field="updateLineItemForm [&#39;isTaxable&#39;]" ng-django-field-model="editableLineItem [&#39;isTaxable&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input checked="checked" data-lpignore="true" id="id_is_taxable" name="isTaxable" ng-checkbox-madness="true" ng-model="editableLineItem [&#39;isTaxable&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Taxed
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateLineItemForm [&#39;isTaxable&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in updateLineItemForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<button class="btn btn-right btn-green" type="submit"
ng-disabled="updateLineItemForm.$pristine || updateLineItemForm.$invalid || updateLineItemForm.$submitting"
>
[[ updateLineItemForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn btn-right btn-grey" type="button"
ng-click="editCtrl.cancel(updateLineItemForm)"
ng-sonar-unpause="booking when updated"
>
Cancel
</button>
<button class="btn btn-left btn-red btn--push-right test-delete-line-item-indicator" type="button"
ng-can-remove="lineItem"
ng-confirm-click="[! T('Remove this line item?') !]"
ng-click="editCtrl.remove()"
>
Remove
</button>
</div>
</form>
</td>
</tr>
<tr class="invoice-table--row [! auth.permissions.canUpdate(lineItem) ? 'is-editable' : '' !] test-line-item-indicator"
ng-else="editing"
ng-click="editCtrl.edit()"
>
<td class="itable-content">
<span class="icon-lock" ng-if-once="lineItem.isPrivate"></span>
[! lineItem.description !]
<span class="fh-grey"
ng-if-once="!lineItem.isTaxable"
>
(Not taxed)
</span>
</td>
<td class="itable-amount itable-invoice-price"
ng-if="canViewInvoiceAmounts && displayOptions.showInvoicePrices"
ng-invoice-amount="lineItem.costs.invoiceCost.price"
ng-invoice-amount-company="booking.company"
></td>
<td class="itable-amount"
ng-can-view-amounts="booking.company"
ng-costs="lineItem.costs"
ng-costs-company="booking.company"
></td>
<td class="itable-edit with-button respond-print-hide test-update-line-item-action"
ng-can-update="lineItem"
>
<span>Edit</span>
</td>
</tr>
</tbody>
<tbody ng-can-create="LineItem on booking"
ng-can-only-when="!booking.isUnprocessed"
>
<tr ng-if="listCtrl.adding"
ng-then="addingLineItem"
>
<td colspan="100"
class="invoice-table--editing"
>
<form name="addLineItem"
ng-submit="listCtrl.submit(addLineItem)"
ng-sonar-pause="booking when updated"
>
<div class="hint">
Add an expense or discount to this booking.
<a ng-href="https://fareharbor.com/help/dashboard/bookings/expenses-and-discounts/"
ng-outbound-link="_blank"
class="hint-help-link nowrap"
>Learn more</a>
</div>
<div class="fields "
>
<div class="table table-dont-respond valign-top full-width line-item-form smush-fields">
<div class="tr">
<div class="td line-item-description">
<div class="addlineitem-description "
ng-django-field="addLineItem [&#39;description&#39;]" ng-django-field-model="newLineItem [&#39;description&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Description
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_description" maxlength="1024" name="description" ng-autofocus="true" ng-model="newLineItem [&#39;description&#39;]" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in addLineItem [&#39;description&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="td">
<div class="addlineitem-offset
field-amount
"
ng-django-field="addLineItem [&#39;offset&#39;]" ng-django-field-model="newLineItem [&#39;offset&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Amount
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_offset" max="999999.99" min="-999999.99" name="offset" ng-amount-input="true" ng-amount-input-allow-empty="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="newLineItem [&#39;offset&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (booking || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="addLineItem [&#39;offset&#39;].$error['pattern']">Invalid value</li>
<li ng-if="addLineItem [&#39;offset&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in addLineItem [&#39;offset&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="tr">
<div class="td">
<div class="addlineitem-isprivate field-cb "
ng-django-field="addLineItem [&#39;isPrivate&#39;]" ng-django-field-model="newLineItem [&#39;isPrivate&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input checked="checked" data-lpignore="true" id="id_is_private" name="isPrivate" ng-checkbox-madness="true" ng-model="newLineItem [&#39;isPrivate&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Private: Do not show to customer
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in addLineItem [&#39;isPrivate&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="td">
<div class="addlineitem-istaxable field-cb-light "
ng-django-field="addLineItem [&#39;isTaxable&#39;]" ng-django-field-model="newLineItem [&#39;isTaxable&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input checked="checked" data-lpignore="true" id="id_is_taxable" name="isTaxable" ng-checkbox-madness="true" ng-model="newLineItem [&#39;isTaxable&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Taxed
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in addLineItem [&#39;isTaxable&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in addLineItem.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<button class="btn btn-green btn-right test-create-line-item-action" type="submit"
ng-disabled="booking.isUnprocessed || addLineItem.$invalid || addLineItem.$submitting"
>
[[ addLineItem.$submitting ? T('Adding...' ): T('Add') ]]
</button>
<button class="btn btn-grey" type="button"
ng-click="listCtrl.cancel(addLineItem)"
ng-disabled="addLineItem.$submitting"
ng-sonar-unpause="booking when updated"
>
Cancel
</button>
</div>
</form>
</td>
</tr>
<tr class="invoice-table--row is-editable is-tall respond-print-hide"
ng-else="addingLineItem"
ng-click="listCtrl.add()"
>
<td colspan="100">
<a class="form-link test-add-line-item-action">Add expense or discount</a>
</td>
</tr>
</tbody>
</table>
<table class="invoice-table has-top-margin print-break-avoid"
ng-can-view-amounts="booking.company"
ng-can-only-when="!booking.isUnprocessed"
>
<tbody ng-if="!booking.company.features.isTaxInclusionEnabled">
<tr class="invoice-table--row is-tall">
<td class="text-right">
<b>
<span ng-if="booking.explicitGross !== null" ng-then="notExplicitGross">Computed Subtotal</span>
<span ng-else="notExplicitGross">Subtotal</span>
</b>
</td>
<td class="itable-amount" ng-costs="booking.computedCosts" ng-costs-company="booking.company"></td>
</tr>
</tbody>
<tbody ng-if="Booking.showTaxByType(booking)"
ng-then="showTaxByType"
>
<tr class="invoice-table--row is-tall"
ng-repeat="taxType in taxTypes"
ng-if="(booking.costs.totalCost.taxByType[taxType.pk]|isDefined) && (booking.costs.totalCost.taxByType[taxType.pk] || !item.isNoTax)"
>
<td class="text-right"><b>[! taxType|name !]</b></td>
<td class="itable-amount">[[ booking.costs.totalCost.taxByType[taxType.pk]|amount:booking ]]</td>
</tr>
</tbody>
<tbody ng-if="!showTaxByType && (booking.computedCosts.totalCost.tax || !booking.item.isNoTax)">
<tr class="invoice-table--row is-tall">
<td class="text-right">
<b>
<span ng-if="booking.explicitGross !== null" ng-then="isComputed">
Computed [! Company.taxDisplayName(booking.company) !]
</span>
<span ng-else="isComputed">[! Company.taxDisplayName(booking.company) !]</span>
</b>
</td>
<td class="itable-amount">[[ booking.computedCosts.totalCost.tax|amount:booking ]]</td>
</tr>
</tbody>
<tbody ng-if="booking.explicitGross !== null">
<tr class="invoice-table--row is-tall">
<td class="text-right"><b>Computed Total</b></td>
<td class="itable-amount">[[ booking.computedCosts.totalCost.total|amount:booking ]]</td>
</tr>
</tbody>
<tbody>
<tr>
<td colspan="100">
<div ng-controller=
"dashboard.bookings.ExplicitGrossEditableCtrl"
class="" >
<div
ng-can-view="booking"
ng-then="allowed">
<table class="invoice-table">
<tr ng-can="updateExplicitTotal on booking"
ng-can-only-when="editCtrl.editing"
ng-then="editing"
ng-autofocus
>
<td colspan="100"
class="invoice-table--editing text-right"
>
<form name="updateBookingExplicitGrossForm" ng-submit="editCtrl.submit(updateBookingExplicitGrossForm)"
ng-sonar-pause="booking when updated"
>
<div class="fields "
>
<div class="updatebookingexplicitgrossform-isexplicitgross field-cb field-cb--right "
ng-django-field="updateBookingExplicitGrossForm [&#39;isExplicitGross&#39;]" ng-django-field-model="editableBooking [&#39;isExplicitGross&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_explicit_gross" name="isExplicitGross" ng-checkbox-madness="true" ng-model="editableBooking [&#39;isExplicitGross&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Set this booking's total to a fixed amount
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in updateBookingExplicitGrossForm [&#39;isExplicitGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="editableBooking.isExplicitGross">
<div class="updatebookingexplicitgrossform-explicitgross clear
field-amount
"
ng-django-field="updateBookingExplicitGrossForm [&#39;explicitGross&#39;]" ng-django-field-model="editableBooking [&#39;explicitGross&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_explicit_gross" max="999999.99" min="0" name="explicitGross" ng-amount-input="true" ng-amount-input-default="''" ng-amount-input-positive="true" ng-autofocus="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="editableBooking [&#39;explicitGross&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="any" type="text" />
<span class="field-style-hook">
[! (booking || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="updateBookingExplicitGrossForm [&#39;explicitGross&#39;].$error['pattern']">Invalid value</li>
<li ng-if="updateBookingExplicitGrossForm [&#39;explicitGross&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in updateBookingExplicitGrossForm [&#39;explicitGross&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in updateBookingExplicitGrossForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<button class="btn btn-green btn-right" type="submit"
ng-disabled="updateBookingExplicitGrossForm.$invalid || updateBookingExplicitGrossForm.$pristine || updateBookingExplicitGrossForm.$submitting"
>
Save
</button>
<button class="btn btn-grey" type="button"
ng-click="editCtrl.cancel(updateBookingExplicitGrossForm)"
ng-sonar-unpause="booking when updated"
>
Cancel
</button>
</div>
</form>
</td>
</tr>
<tr ng-else="editing"
class="invoice-table--row is-shaded is-tall no-border"
ng-class="{ 'is-editable': auth.permissions.can('updateExplicitTotal', booking) }"
ng-click="editCtrl.edit()"
ng-tip="[! T('Change booking total') !]"
ng-tip-location=".cf-edit-button"
ng-tip-classes="tip-indent"
>
<td class="text-right">
<b ng-tip="[! T('This booking\'s total is set to a fixed amount') !]" ng-tip-location=".icon-hint">
<span ng-if="booking.explicitGross !== null" ng-then="isExplicit">
Set Total
<span class="icon-hint"></span>
</span>
<span ng-else="isExplicit">Total</span>
</b>
</td>
<td class="itable-amount">
[[ booking.costs.totalCost.total|amount:booking ]]
</td>
<td class="itable-edit with-button"
ng-can="updateExplicitTotal on booking"
>
<span class="cf-edit-button">
<span>Edit</span>
</span>
</td>
</tr>
</table>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="booking-full-activities is-mobile-toggled"
ng-class="{ 'toggled': toggles.state('mobileActivity') }"
ng-activities="booking"
ng-activities-note
ng-activities-header="[! T('Activity:') !]"
></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
<div ng-else="orderPath || bookingPath">
<div class="booking-full-content clearfix">
<div class="booking-full-actions">
<div class="booking-actions">
<div ng-controller=
"dashboard.bookings.ContactActionsCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div class="respond-print-hide"
ng-if="actionsCtrl.isSelected(actionsCtrl.NONE)"
ng-body-class="'body-print-booking'"
>
<div class="action-sheet-header respond-print-hide">
<h2>
Contact actions
</h2>
</div>
<ul class="buttons-list test-action-buttons-indicator">
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.CREATE_BOOKING)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon plus"
ng-click="plusbook.plusbook(contact)"
ng-shortcut="'=|shift+n'"
ng-shortcut-click
title="[! T('Shortcut: shift+n') !]"
>
New booking for contact
</button>
</li>
<li ng-if="actionsCtrl.isSelectable(actionsCtrl.MODIFY)">
<button type="button"
class="btn-big btn-black btn-wide btn-icon merge-booking"
ng-click="actionsCtrl.select(actionsCtrl.MODIFY)"
ng-shortcut="'m|shift+m'"
ng-shortcut-click
title="[! T('Shortcut: shift+m') !]"
ng-start-booking
>
Manage orders
</button>
</li>
<li ng-if="!actionsCtrl.isAnySelectable()" class="fh-grey">
No actions available.
</li>
</ul>
</div>
<div class="action-window">
<div ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)"
ng-sonar-pause="contact when updated"
>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.MODIFY)">
<div ng-controller="dashboard.bookings.ModifyContactBookingsCtrl">
<div ng-show="submitting">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">Modifying...</div>
<div class="booking-action-loading">Please do not leave or refresh this page</div>
</div>
<div ng-show="!submitting">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Manage orders</h2>
<a ng-href="https://fareharbor.com/help/dashboard/orders/managing/"
ng-outbound-link="_blank"
class="hint-help-link"
>Watch the video &rsaquo;</a>
</div>
</div>
<p class="action-sheet-help">
Move bookings to and from orders.
</p>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
ng-confirm-click="[! T('Are you sure you want to close? Your changes will be lost.') !]"
ng-confirm-click-when="modifyContactBookingsForm.$dirty"
>Close</button>
</span>
<form class="labels-above"
name="modifyContactBookingsForm"
ng-submit="modifyContactBookingsCtrl.submit(modifyContactBookingsForm)"
>
<div class="fields "
>
<div class="modifycontactbookingsform-modifytype "
ng-django-field="modifyContactBookingsForm [&#39;modifyType&#39;]" ng-django-field-model="editableBookings [&#39;modifyType&#39;]"
ng-django-field-required=""
>
<ul ng-radio-flyer
class="field-radio-group"
>
<li ng-if="modifyContactBookingsCtrl.isModifyTypeValid(modifyContactBookingsCtrl.CREATE_ORDER_TYPE)">
<label >
<input type="radio" name="modify_type"
ng-value="modifyContactBookingsCtrl.CREATE_ORDER_TYPE"
ng-model="editableBookings [&#39;modifyType&#39;]" ng-prefix="" ng-required="required"
>
Create new order
</label>
</li>
<li ng-if="modifyContactBookingsCtrl.isModifyTypeValid(modifyContactBookingsCtrl.TO_ORDER_TYPE)"
ng-repeat="order in contact.relatedOrders"
>
<label >
<input type="radio" name="modify_type"
ng-value="order.pk"
ng-model="editableBookings [&#39;modifyType&#39;]" ng-prefix="" ng-required="required"
>
Add to order #[! order.identifier !]
</label>
</li>
<li ng-if="modifyContactBookingsCtrl.isModifyTypeValid(modifyContactBookingsCtrl.FROM_ORDER_TYPE)">
<label >
<input type="radio" name="modify_type"
ng-value="modifyContactBookingsCtrl.FROM_ORDER_TYPE"
ng-model="editableBookings [&#39;modifyType&#39;]" ng-prefix="" ng-required="required"
>
Remove from order
</label>
</li>
<li ng-if-once="!modifyContactBookingsCtrl.isAnyModifyTypeValid"
class="form-error"
>
<b>No available options.</b>
</li>
</ul>
</div>
<p class="action-sheet-help" ng-select-all="modifyContactBookingsCtrl.selectableBookings"
ng-select-all-model="editableBookings['booking-' + $element.pk]"
></p>
<div ng-repeat="order in modifyContactBookingsCtrl.selectableOrders">
<p class="action-sheet-help" ng-select-all="order.selectableBookings"
ng-select-all-model="editableBookings['booking-' + $element.pk]"
ng-select-all-text='[! interpolate(cT("\"order\" as in sales order", "Order #%(orderId)s"), { orderId: order.identifier }) !]'
></p>
<ul>
<li ng-repeat="booking in order.selectableBookings">
<div class="field field-cb"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="editableBookings['booking-' + booking.pk]"
>
</span>
<span class="label-text">
Booking #[! booking.pk !]<div class="fh-grey text-small">[! booking.availability.item|name !] &bull; [! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !] &bull; [! booking.customerBreakdownShort !]</div>
</span>
</span>
</label>
</div>
</li>
</ul>
</div>
<div ng-if="modifyContactBookingsCtrl.selectableStandAloneBookings.length">
<p class="action-sheet-help" ng-select-all="modifyContactBookingsCtrl.selectableStandAloneBookings"
ng-select-all-model="editableBookings['booking-' + $element.pk]"
ng-select-all-text='[! cT("\"order\" as in sales order", "Not in an order") !]'
></p>
<ul>
<li ng-repeat="booking in modifyContactBookingsCtrl.selectableStandAloneBookings">
<div class="field field-cb"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="editableBookings['booking-' + booking.pk]"
>
</span>
<span class="label-text">
Booking #[! booking.pk !]<div class="fh-grey text-small">[! booking.availability.item|name !] &bull; [! booking.availability.startAt|datetime:'short':(booking.availability.endAt) !] &bull; [! booking.customerBreakdownShort !]</div>
</span>
</span>
</label>
</div>
</li>
</ul>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-if="modifyContactBookingsForm.all.$error.no_order">An error occurred. Please refresh the page and try again.</li>
<li ng-if="modifyContactBookingsForm.all.$error.booking_is_demo_mismatch">Demo mode for all bookings must match.</li>
<li ng-if="modifyContactBookingsForm.all.$error.order_is_demo_mismatch">Demo mode for order must match bookings.</li>
<li ng-if="modifyContactBookingsForm.all.$error.company_is_demo_mismatch">Demo mode for company must match bookings and orders.</li>
<li ng-repeat="error in modifyContactBookingsForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns">
<button class="btn-big btn-green btn-wide"
ng-disabled="modifyContactBookingsForm.$invalid || modifyContactBookingsForm.$submitting || !modifyContactBookingsCtrl.isValid()"
>
[[ modifyContactBookingsForm.$submitting ? T('Moving...') : T('Move bookings') ]]
</button>
</div>
</form>
</div>
</div>
</div>
<div ng-if="actionsCtrl.isSelected(actionsCtrl.MERGE)">
<div ng-controller="dashboard.bookings.MergeContactsCtrl">
<div class="action-sheet-header">
<div class="action-sheet-header-content">
<h2>Merge contacts</h2>
</div>
</div>
<span ng-if="!actionsCtrl.isSelected(actionsCtrl.NONE)">
<button class="button-close respond-print-hide"
type="button"
ng-click="actionsCtrl.reset()"
ng-shortcut="'esc'"
ng-shortcut-click
ng-sonar-unpause="booking when updated"
>Close</button>
</span>
<h3>Coming soon!</h3>
</div>
</div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
</div>
<div class="booking-full-invoice">
<div ng-controller=
"dashboard.bookings.ViewContactCtrl"
class="[[ dataCtrl.status|css ]] "
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="spinner
normal
">
<div class="spinner-inner"></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div ng-repeat="order in contact.relatedOrders">
<div class="table valign-middle booking-full-invoice-customers">
<div class="tr">
<div class="td booking-full-customer-breakdown">
<a ng-href="[! order|orderUrl !]">
Order #[! order.identifier !]</a>
</div>
</div>
</div>
<div class="order-invoice-bookings">
<div ng-repeat="booking in order.allBookings"
ng-link="order-invoice-bookings"
></div>
</div>
</div>
<div ng-if="contact.standAloneBookings.length">
<div class="table valign-middle booking-full-invoice-customers">
<div class="tr">
<div class="td booking-full-customer-breakdown">
[[ contact.relatedOrders.length ? T('Other Bookings') : T('Bookings') ]]
</div>
</div>
</div>
<div class="order-invoice-bookings">
<div ng-repeat="booking in contact.standAloneBookings"
ng-link="order-invoice-bookings"
></div>
</div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</div>
</div>
<div class="booking-full-activities"
ng-activities="contact"
ng-activities-note
ng-activities-header="[! T('Contact activity:') !]"
></div>
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
<div ng-link="data-disconnect"></div>
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
<div ng-link="forbidden"></div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-embed-generator-setup">
<div class="field field-cb [! inFlyout ? 'flyout-section flyout-section--no-border flyout-section--no-bottom-padding' : '' !]"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="ctrl.embedOptions.isFullItems"
>
</span>
<span class="label-text">
Include item description and images
</span>
</span>
</label>
</div>
<div ng-if-once="company.isCharter && (company.companyFeatures.isContentTranslationEnabled || company.features.isAllOnlineUiLanguagesEnabled)"
class="[! inFlyout ? 'flyout-section flyout-section--no-border' : 'labels-left embed-generator-message' !]"
>
<div ng-language-dropdown ng-language-dropdown-hide-unsupported-languages>
<div class="field "
>
<label>
<span class="label-text">
Language
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="lang.code as lang.display group by lang.group for lang in languageDropdownCtrl.languageChoices"
ng-model="ctrl.embedOptions.language"
ng-disabled="languageDropdownCtrl.isLoading"
ng-placeholder="Auto-detect language"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
<p class="hint hint--after-field">
If no language is set, language will be determined by the user&#039;s browser preferences.
<a ng-href="https://fareharbor.com/help/dashboard/communication/language-translation/#how-it-works"
ng-outbound-link="_blank"
>Learn more</a>
</p>
</div>
</div>
</div>
<h3 class="[! inFlyout ? 'flyout-toggle-header' : 'embed-generator-toggle-heading' !]"
ng-toggle="embedGeneratorOptions"
>
Advanced settings
</h3>
<div class="[! inFlyout ? 'flyout-section' : '' !]"
ng-toggled="embedGeneratorOptions"
>
<div class="[! inFlyout ? '' : 'labels-left' !]">
<div class="field ">
<label>
<span class="label-text">
Online ref
</span>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="ctrl.embedOptions.onlineBookingReference"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
<p class="hint hint--after-field">Custom tag or label given to bookings made through this integration</p>
</div>
<div ng-else="ctrl.isSheetsAndSchedulesLoaded"
class="ng-data-spinner"
><i class="spinner-ticker-css"><span></span></i></div>
<div ng-if="ctrl.isSheetsAndSchedulesLoaded && ctrl.onlineSheetsAndSchedules.length > 1">
<div class="field "
ng-current-option="ctrl.sheetOrSchedule"
ng-current-option-collection="ctrl.onlineSheetsAndSchedules"
>
<label>
<span class="label-text">
Pricing
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field"
>
<select ng-dropdown
ng-options="sheetOrSchedule as PriceSheet.dropdownLabel(sheetOrSchedule) for sheetOrSchedule in ctrl.onlineSheetsAndSchedules"
ng-model="ctrl.sheetOrSchedule"
ng-placeholder="Use default online pricing"
></select>
<span class="field-style-hook"></span>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</label>
<p class="hint hint--after-field">Choose a specific online sheet or schedule that should be used for bookings</p>
</div>
</div>
<div ng-if-once="company.affiliatesCount">
<div class="field "
>
<label>
<span class="label-text">
ASN company
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field"
ng-data="ctrl.affiliations.$promise" ng-data-small
>
<select ng-dropdown
ng-options="a.affiliateCompany.shortname as a.affiliateCompany.name for a in ctrl.affiliations"
ng-model="ctrl.embedOptions.asnShortname"
ng-placeholder="No affiliation"
></select>
<span class="field-style-hook"></span>
</span>
</span>
</label>
<p class="hint hint--after-field">
The affiliate to associate with bookings, if you are using the ASN network
</p>
</div>
<div ng-if="ctrl.embedOptions.asnShortname">
<div class="field ">
<label>
<span class="label-text">
ASN ref
</span>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="ctrl.embedOptions.asnReference"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
<p class="hint hint--after-field">
The voucher number that should be set for ASN bookings
</p>
</div>
</div>
</div>
<div ng-can-admin-update="company">
<div class="field ">
<label>
<span class="label-text">
Return-to URL
</span>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="ctrl.embedOptions.backUrl"
ng-pattern="/^(?:https?:\/\/)?(?:[a-z0-9\-_]+\.[a-z0-9\-_]+)+.*/i"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<p class="hint">
<span class="admin-badge">FH</span> Where to bring the user when they click 'Leave Checkout' in an offsite ('simple fallback') page
</p>
</div>
</div>
<div class="[! inFlyout ? '' : 'labels-left-content' !]"
ng-can-admin-update="company"
>
<div class="field field-cb field-admin-badge"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="ctrl.isSimpleFallback"
>
</span>
<span class="label-text">
Use simplified page design when unable to Lightframe
</span>
</span>
</label>
</div>
<div class="field field-cb field-admin-badge"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="ctrl.embedOptions.isKioskModeEnabled"
>
</span>
<span class="label-text">
Kiosk mode
</span>
</span>
</label>
</div>
<div class="field field-cb field-admin-badge"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="ctrl.embedOptions.isLightframeDisabled"
>
</span>
<span class="label-text">
Disable Lightframe
</span>
</span>
</label>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-embed-generator-type">
<ul class="field-radio-list" ng-radio-flyer>
<li>
<label >
<input type="radio" name=""
ng-value="embedGenerator.CALENDAR_EMBED"
ng-model="ctrl.embedOptions.embedType" ng-prefix="" ng-required="required"
>
Embedded calendar
</label>
</li>
<li>
<label >
<input type="radio" name=""
ng-value="embedGenerator.ITEM_GRID_EMBED"
ng-model="ctrl.embedOptions.embedType" ng-prefix="" ng-required="required"
>
Embedded grid of items
</label>
</li>
<li>
<label >
<input type="radio" name=""
ng-value="embedGenerator.BOOK_BUTTON_EMBED"
ng-model="ctrl.embedOptions.embedType" ng-prefix="" ng-required="required"
>
Book button or link
</label>
</li>
</ul>
</script>
<script type="text/ng-template" id="ng-embed-generator-open">
<div class="embed-generator-open"
ng-if="openCtrl.embedOptions.embedType === embedGenerator.CALENDAR_EMBED"
>
<ul class="list-filters list-filters-embed-generator-opens"
ng-if-once="!embedGeneratorCtrl.item"
>
<li class="list-filters-label">
Include
</li><li ng-click="openCtrl.embedOptions.open = embedGenerator.FLOW_PAGE_OPEN"
ng-class="{ toggled: openCtrl.embedOptions.open === embedGenerator.FLOW_PAGE_OPEN }"
>
Flow page items
</li><li ng-click="openCtrl.embedOptions.open = embedGenerator.ITEM_OPEN"
ng-class="{ toggled: openCtrl.embedOptions.open === embedGenerator.ITEM_OPEN }"
>
Specific item
</li>
</ul>
<div class="labels-left"
ng-if="openCtrl.embedOptions.open === embedGenerator.FLOW_PAGE_OPEN"
>
<div ng-embed-generator-flow-page-select
ng-embed-generator-flow-page-select-placeholder="T('All items')"
ng-embed-generator-flow-page-select-item="null"
></div>
<p class="hint"
ng-if="!openCtrl.chosenFlowNodeIncludesItems"
>
<span class="badge badge-warning">Warning</span>
This flow page does not contain any items. The calendar will be empty.
</p>
<p class="hint">
The calendar will include items on the selected flow page. If the flow page is empty, all items will be included.
<span ng-can-create="FlowNode on company">
Create a new flow page <a ng-href="[! company.$url(urls.dashboard.settings.flows.index) !]">here</a>.
</span>
</p>
</div>
<div class="labels-left"
ng-if="openCtrl.embedOptions.open === embedGenerator.ITEM_OPEN"
>
<div ng-embed-generator-item-select
ng-embed-generator-item-select-required="true"
></div>
<div ng-watch="openCtrl.chosenItem">
<div ng-embed-generator-flow-page-select
ng-embed-generator-flow-page-select-item="openCtrl.chosenItem"
ng-embed-generator-flow-page-select-allow-no-flow="true"
ng-embed-generator-flow-page-select-required="true"
ng-embed-generator-flow-page-select-hint="T('This flow can be accessed during the booking process.')"
></div>
</div>
</div>
</div>
<div class="embed-generator-message embed-generator-open labels-left"
ng-if="openCtrl.embedOptions.embedType === embedGenerator.ITEM_GRID_EMBED"
ng-embed-generator-flow-page-select
ng-embed-generator-flow-page-select-required="true"
ng-embed-generator-flow-page-select-allow-no-flow="false"
ng-embed-generator-flow-page-select-item="embedGeneratorCtrl.item"
></div>
<div class="embed-generator-open"
ng-if="openCtrl.embedOptions.embedType === embedGenerator.BOOK_BUTTON_EMBED"
>
<ul class="list-filters list-filters-embed-generator-opens">
<li class="list-filters-label">
Open to
<li ng-if-once="!embedGeneratorCtrl.item"
ng-click="openCtrl.embedOptions.open = (openCtrl.embedOptions.open === embedGenerator.FLOW_PAGE_CALENDAR_OPEN ?
openCtrl.embedOptions.open : embedGenerator.FLOW_PAGE_OPEN)"
ng-class="{ toggled: openCtrl.embedOptions.open === embedGenerator.FLOW_PAGE_OPEN || openCtrl.embedOptions.open === embedGenerator.FLOW_PAGE_CALENDAR_OPEN }"
>
Specific flow
</li><li ng-click="openCtrl.embedOptions.open = embedGenerator.ITEM_OPEN"
ng-class="{ toggled: openCtrl.embedOptions.open === embedGenerator.ITEM_OPEN }"
>
Specific item
</li><li ng-click="openCtrl.embedOptions.open = embedGenerator.AVAILABILITY_OPEN"
ng-class="{ toggled: openCtrl.embedOptions.open === embedGenerator.AVAILABILITY_OPEN }"
>
Specific availability
</li>
</ul>
<div ng-if="
openCtrl.embedOptions.open === embedGenerator.FLOW_PAGE_OPEN ||
openCtrl.embedOptions.open === embedGenerator.FLOW_PAGE_CALENDAR_OPEN
">
<div class="labels-left"
ng-embed-generator-flow-page-select
ng-embed-generator-flow-page-select-allow-no-flow="false"
ng-embed-generator-flow-page-select-item="null"
></div>
<div class="field field-cb labels-left-content"
ng-class="{ 'ng-disabled': !openCtrl.chosenFlowNodeSupportsCalendar }"
>
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="checkbox"
value=""
class="ng-pristine"
ng-model="openCtrl.embedOptions.open"
ng-disabled="!openCtrl.chosenFlowNodeSupportsCalendar"
ng-true-value="'[! embedGenerator.FLOW_PAGE_CALENDAR_OPEN !]'"
ng-false-value="'[! embedGenerator.FLOW_PAGE_OPEN !]'"
>
</span>
<span class="label-text">
Start on calendar
<span class="icon-hint" ng-tip="Must first be enabled in the flow page settings"></span>
</span>
</span>
</label>
</div>
</div>
<div class="labels-left"
ng-if="openCtrl.embedOptions.open === embedGenerator.ITEM_OPEN || openCtrl.embedOptions.open === embedGenerator.AVAILABILITY_OPEN"
>
<div ng-embed-generator-item-select
ng-embed-generator-item-select-required="true"
></div>
<div ng-if="openCtrl.embedOptions.open === embedGenerator.AVAILABILITY_OPEN">
<div class="field ">
<label>
<span class="label-text">
Availability
</span>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="openCtrl.embedOptions.availabilityPk"
ng-required="true"
ng-pattern="/[0-9]+/"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<p class="hint">Enter the availability ID.</p>
</div>
<div ng-watch="openCtrl.chosenItem">
<div ng-if="openCtrl.chosenItem"
ng-embed-generator-flow-page-select
ng-embed-generator-flow-page-select-allow-no-flow="true"
ng-embed-generator-flow-page-select-required="true"
ng-embed-generator-flow-page-select-item="openCtrl.chosenItem"
></div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-embed-generator-message">
<div class="embed-generator-message"
ng-if="ctrl.embedOptions.embedType === embedGenerator.BOOK_BUTTON_EMBED"
>
<div class="field ">
<label>
<span class="label-text">
Label
</span>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="ctrl.embedOptions.message"
ng-placeholder="[! embedGenerator.DEFAULT_MESSAGE !]"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<div ng-can-admin-update="company">
<div class="field ">
<label>
<span class="label-text">
Tags
</span>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="ctrl.embedOptions.buttonTags"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
<p class="hint">
<span class="admin-badge">FH</span> Categorize this button for conversion tracking
</p>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-embed-generator-code">
<div class="embed-generator-code">
<ul class="list-filters list-filters-embed-generator-code-types">
<li ng-if="ctrl.embedOptions.embedType === embedGenerator.BOOK_BUTTON_EMBED"
ng-click="ctrl.codeType = embedGenerator.ANCHOR_CODE_TYPE"
ng-class="{ toggled: ctrl.codeType === embedGenerator.ANCHOR_CODE_TYPE }"
>Simple HTML</li>
<li ng-if="ctrl.embedOptions.embedType === embedGenerator.BOOK_BUTTON_EMBED"
ng-click="ctrl.codeType = embedGenerator.URL_CODE_TYPE"
ng-class="{ toggled: ctrl.codeType === embedGenerator.URL_CODE_TYPE }"
>Link</li>
<li ng-click="ctrl.codeType = embedGenerator.JAVASCRIPT_CODE_TYPE"
ng-class="{ toggled: ctrl.codeType === embedGenerator.JAVASCRIPT_CODE_TYPE }"
>JavaScript</li>
<li ng-click="ctrl.codeType = embedGenerator.WORDPRESS_CODE_TYPE"
ng-class="{ toggled: ctrl.codeType === embedGenerator.WORDPRESS_CODE_TYPE }"
>WordPress shortcode</li>
</ul>
<p class="hint"
ng-if="ctrl.codeType === embedGenerator.WORDPRESS_CODE_TYPE && ctrl.embedOptions.isKioskModeEnabled"
>
<i class="warning-icon"></i>
The WordPress shortcode does not support kiosk mode.
</p>
<textarea class="monospace url-copy-field"
ng-model="ctrl.code"
ng-autoselect
></textarea>
</div>
</script>
<script type="text/ng-template" id="ng-embed-generator-flow-page-select">
<div class="field "
ng-current-option="flowPageSelectCtrl.chosenRootFlowNodePk"
ng-current-option-collection="flowPageSelectCtrl.rootFlowNodes"
ng-current-option-target="flowPageSelectCtrl.chosenRootFlowNode"
>
<label>
<span class="label-text">
[! flowPageSelectCtrl.label || T('Flow') !]
<span class="icon-hint"
ng-if-once="flowPageSelectCtrl.hint"
ng-tip="[! flowPageSelectCtrl.hint !]"
></span>
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field"
ng-data="flowPageSelectCtrl.promise" ng-data-small
>
<select ng-dropdown
ng-options="flowNode.pk as flowNode.name for flowNode in flowPageSelectCtrl.rootFlowNodes"
ng-model="flowPageSelectCtrl.chosenRootFlowNodePk"
ng-placeholder="[! flowPageSelectCtrl.placeholder || T('Your default flow') !]"
ng-dropdown-allow-clear="!flowPageSelectCtrl.isRequired"
></select>
<span class="field-style-hook"></span>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</label>
</div>
<div ng-if="flowPageSelectCtrl.chosenRootFlowNode && flowPageSelectCtrl.chosenRootFlowNode.pk">
<div class="field "
ng-current-option="embedGeneratorCtrl.embedOptions.flowNodePk"
ng-current-option-collection="flowPageSelectCtrl.flowPages"
ng-current-option-target="flowPageSelectCtrl.chosenFlowNode"
>
<label>
<span class="label-text">
Flow page
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field"
ng-data="flowPageSelectCtrl.flowPages.$promise" ng-data-small
>
<select ng-dropdown
ng-options="flowNode.pk as flowPageSelectCtrl.flowPageName(flowNode) for flowNode in flowPageSelectCtrl.flowPages"
ng-model="embedGeneratorCtrl.embedOptions.flowNodePk"
ng-placeholder="[! interpolate(T('Top level (%(flowName)s)'), { flowName: flowPageSelectCtrl.chosenRootFlowNode.name }) !]"
ng-dropdown-allow-clear="false"
></select>
<span class="field-style-hook"></span>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</label>
</div>
</div>
<span ng-if="flowPageSelectCtrl.chosenRootFlowNode === FlowNode.NO_FLOW" class="hint">
<b>No flow selected:</b> Navigation toolbar will be hidden.
</span>
</script>
<script type="text/ng-template" id="ng-embed-generator-item-select">
<div class="field "
ng-current-option="embedGeneratorCtrl.embedOptions.itemPk"
ng-current-option-collection="itemSelectCtrl.items"
ng-current-option-target="openCtrl.chosenItem"
>
<label>
<span class="label-text">
Item
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field"
ng-data="itemSelectCtrl.items.$promise" ng-data-small
>
<select ng-dropdown
ng-options="item.pk as item.name for item in itemSelectCtrl.items"
ng-model="embedGeneratorCtrl.embedOptions.itemPk"
ng-disabled="embedGeneratorCtrl.item"
ng-placeholder="Choose an item"
ng-dropdown-allow-clear="!itemSelectCtrl.isRequired"
></select>
<span class="field-style-hook"></span>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</label>
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.currentSheets">
<div class="print-header-date" ng-repeat="sheet in pricingCurrentSheetsCtrl.sheets">
<div><b>[[ sheet.name ]]</b></div>
[[ sheet.company.name ]]
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.editors">
<div ng-can="viewPricing on Company.forObject(pricingEditorsCtrl.object)">
<div ng-if="pricingCtrl.status === 'loading'"
class="price-form-loading"
>
Loading...
</div>
<div ng-if="pricingCtrl.status === 'success'">
<div class="price-form-repeated"
ng-repeat="sheet in pricingCtrl.sheets"
>
<div ng-pricing-editor="pricingEditorsCtrl.object" ng-pricing-editor-sheet="sheet"></div>
</div>
</div>
<div ng-if="pricingCtrl.status === 'error'"
class="price-form-loading"
>
Error
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.editor">
<div ng-if="pricingEditorCtrl.requirements.isEditable"
class="price-form has-column-borders
[[ pricingCtrl.needsVisAndSheetRateColumns ? 'vis-price-tax-discount-final' :
pricingEditorCtrl.sheet.cls === InvoiceSheet.cls ? 'price-tax-discount-final' : 'vis-price-tax-final'
]]
"
ng-with="requirements = pricingEditorCtrl.requirements"
>
<div class="price-form-sheet-heading" ng-if="pricingCtrl.sheets.length > 1">
[[ pricingEditorCtrl.sheet.displayName ]]
</div>
<div ng-if="pricingEditorCtrl.inspecting" ng-then="inspecting">
<div ng-pricing-inspector="pricingEditorCtrl.object" ng-pricing-inspector-sheet="pricingEditorCtrl.sheet"></div>
</div>
<div ng-can="updatePricing on Company.forObject(pricingEditorCtrl.object)"
ng-can-only-when="pricingEditorCtrl.editing"
ng-then="editing"
>
<form name="priceLineForm" ng-submit="pricingEditorCtrl.submit(priceLineForm)"
ng-confirm-navigate-away
>
<div class="fields "
>
<div class="table price-form-columns valign-top">
<div class="tr">
<div class="td vis"
ng-if="pricingCtrl.needsVisibilityColumn"
>
<div class="price-col-inner" ng-if="pricingEditorCtrl.requirements.needsVisibility && pricingEditorCtrl.requirements.needsEditableVisibility">
<div class="pricelineform-visibility field-price-line-type "
ng-django-field="priceLineForm [&#39;visibility&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;visibility&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_visibility" name="visibility" ng-model="pricingEditorCtrl.editableLine [&#39;visibility&#39;]" required="required">
<option value="inherit" selected="selected">Inherit</option>
<option value="visible">Visible</option>
<option value="hidden">Hidden</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;visibility&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in priceLineForm [&#39;visibility&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="pricingEditorCtrl.editableLine.visibility === TotalLine.VISIBLE_VISIBILITY">
<div ng-if="pricingEditorCtrl.requirements.needsRequired">
<div class="pricelineform-isrequired field-cb-light "
ng-django-field="priceLineForm [&#39;isRequired&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;isRequired&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_required" name="isRequired" ng-checkbox-madness="true" ng-model="pricingEditorCtrl.editableLine [&#39;isRequired&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Require an answer
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in priceLineForm [&#39;isRequired&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="pricingEditorCtrl.requirements.needsHidden">
<div class="pricelineform-ishiddenonreceipts field-cb-light "
ng-django-field="priceLineForm [&#39;isHiddenOnReceipts&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;isHiddenOnReceipts&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_hidden_on_receipts" name="isHiddenOnReceipts" ng-checkbox-madness="true" ng-model="pricingEditorCtrl.editableLine [&#39;isHiddenOnReceipts&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Hide on receipts
<i class="icon-hint" ng-tip="Will not be included in emails or printed receipts" ></i>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in priceLineForm [&#39;isHiddenOnReceipts&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="pricelineform-ishiddenwhenbooking field-cb-light "
ng-django-field="priceLineForm [&#39;isHiddenWhenBooking&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;isHiddenWhenBooking&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_hidden_when_booking" name="isHiddenWhenBooking" ng-checkbox-madness="true" ng-model="pricingEditorCtrl.editableLine [&#39;isHiddenWhenBooking&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Hide when booking
<i class="icon-hint" ng-tip="Will be added to bookings but not shown when creating them" ></i>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in priceLineForm [&#39;isHiddenWhenBooking&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-if="pricingEditorCtrl.editableLine.visibility === TotalLine.HIDDEN_VISIBILITY"
class="fh-grey"
>
<i class="icon-lock"></i> Will not be shown or added to booking.
</div>
</div>
</div>
<div class="td price">
<div class="price-col-inner" ng-if="pricingEditorCtrl.requirements.needsPrice">
<div class="pricelineform-pricetype field-price-line-type "
ng-django-field="priceLineForm [&#39;priceType&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;priceType&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_price_type" name="priceType" ng-model="pricingEditorCtrl.editableLine [&#39;priceType&#39;]" required="required">
<option value="inherit" selected="selected">Inherit</option>
<option value="change">Change</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;priceType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in priceLineForm [&#39;priceType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="pricingEditorCtrl.editableLine.priceType === TotalLine.CHANGE_PRICE_TYPE">
<div class="custom-field-pricing-inputs">
<div ng-if="pricingEditorCtrl.requirements.needsExtendedPrice" ng-then="extendedPrice">
<div class="pricelineform-modifiertype field-price-modifier-type "
ng-django-field="priceLineForm [&#39;modifierType&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;modifierType&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_modifier_type" name="modifierType" ng-model="pricingEditorCtrl.editableLine [&#39;modifierType&#39;]" required="required">
<option value="adjust">Adjust total by</option>
<option value="set">Set total to</option>
<option value="none" selected="selected">No price</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;modifierType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in priceLineForm [&#39;modifierType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="pricingEditorCtrl.editableLine.modifierType !== PriceLine.NONE_MODIFIER_TYPE">
<div ng-if="pricingEditorCtrl.editableLine.modifierType !== PriceLine.NONE_MODIFIER_TYPE">
<div class="pricelineform-modifierkind field-select-with-label-light "
ng-django-field="priceLineForm [&#39;modifierKind&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;modifierKind&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Set in:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select name="modifier_kind"
ng-model="pricingEditorCtrl.editableLine [&#39;modifierKind&#39;]"
ng-disabled=""
ng-prefix=""
ng-required=""
ng-options="choice[0] as choice[1] for choice in modifierKindChoices"
required="required"
></select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;modifierKind&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in priceLineForm [&#39;modifierKind&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="pricingEditorCtrl.editableLine.modifierKind === PriceLine.OFFSET_MODIFIER_KIND">
<div class="pricelineform-offset
field-amount
"
ng-django-field="priceLineForm [&#39;offset&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;offset&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_offset" max="999999.99" min="-999999.99" name="offset" ng-amount-input="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="pricingEditorCtrl.editableLine [&#39;offset&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-placeholder="0.00" step="any" type="text" value="0" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;offset&#39;].$error['pattern']">Invalid value</li>
<li ng-if="priceLineForm [&#39;offset&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in priceLineForm [&#39;offset&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="pricingEditorCtrl.editableLine.modifierKind === PriceLine.PERCENTAGE_MODIFIER_KIND">
<div class="pricelineform-rate
field-percent
"
ng-django-field="priceLineForm [&#39;rate&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;rate&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_rate" max="1000" min="-100" name="rate" ng-float-input="" ng-float-input-decimal-places="7" ng-float-input-max-digits="8" ng-model="pricingEditorCtrl.editableLine [&#39;rate&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-placeholder="0" step="1e-7" type="text" value="0" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;rate&#39;].$error['min_value']">Must be between -100% and 1000%</li>
<li ng-if="priceLineForm [&#39;rate&#39;].$error['pattern']">Invalid value</li>
<li ng-if="priceLineForm [&#39;rate&#39;].$error['max_value']">Must be between -100% and 1000%</li>
<li ng-if="priceLineForm [&#39;rate&#39;].$error['max_decimal_places']">Ensure that there are no more than 5 decimal places.</li>
<li ng-if="priceLineForm [&#39;rate&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in priceLineForm [&#39;rate&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div ng-if="!extendedPrice && !pricingEditorCtrl.requirements.needsTaxableOnly">
<div class="pricelineform-offset
field-amount
"
ng-django-field="priceLineForm [&#39;offset&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;offset&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_offset" max="999999.99" min="-999999.99" name="offset" ng-amount-input="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="pricingEditorCtrl.editableLine [&#39;offset&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-placeholder="0.00" step="any" type="text" value="0" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;offset&#39;].$error['pattern']">Invalid value</li>
<li ng-if="priceLineForm [&#39;offset&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in priceLineForm [&#39;offset&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-can-admin-update="company"
ng-can-only-when="PriceLine.isCustomTaxAllowed(pricingEditorCtrl.editableLine, company)"
>
<div class="pricelineform-customtax field-price-line-type field-admin-badge "
ng-django-field="priceLineForm [&#39;customTax&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;customTax&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Taxes:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_custom_tax" name="customTax" ng-model="pricingEditorCtrl.editableLine [&#39;customTax&#39;]" required="required">
<option value="no" selected="selected">Standard tax</option>
<option value="only-taxed">Custom tax</option>
<option value="all">Custom tax (include untaxed)</option>
<option value="always">Custom tax (include untaxed, even on untaxed sheets)</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;customTax&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in priceLineForm [&#39;customTax&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-can-admin-update="company"
ng-can-only-when="PriceLine.isTaxInclusionAllowed(pricingEditorCtrl.editableLine, company)"
>
<div class="pricelineform-taxinclusion field-price-line-type "
ng-django-field="priceLineForm [&#39;taxInclusion&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;taxInclusion&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
Taxes included:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_tax_inclusion" name="taxInclusion" ng-model="pricingEditorCtrl.editableLine [&#39;taxInclusion&#39;]" required="required">
<option value="inherit" selected="selected">Inherit</option>
<option value="not-included">Not included</option>
<option value="included">Included</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;taxInclusion&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in priceLineForm [&#39;taxInclusion&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="td taxes">
<div class="price-col-inner" ng-if="pricingEditorCtrl.requirements.needsTaxes">
<div class="field field-price-line-type"
ng-if-once="pricingEditorCtrl.object.cls !== Item.cls"
>
<select ng-model="pricingEditorCtrl.editableLine.isTaxable"
ng-options="option.value as option.label for option in pricingEditorCtrl.isTaxableChoices"
></select>
</div>
<div ng-if="
PriceLine.isTaxTypesAllowed(pricingEditorCtrl.editableLine, pricingEditorCtrl.object, pricingEditorCtrl.sheet) &&
pricingEditorCtrl.editableLine.taxTypes
">
<div class="field"
ng-repeat="taxType in pricingCtrl.taxTypes"
>
<label>
<span class="display-block label-text">
[! interpolate(T('%(name)s (%(rate)s)'), {name: (taxType|name), rate: TaxType.displayRate(taxType)}) !]
</span>
<select ng-model="pricingEditorCtrl.editableLine.taxTypes[taxType.pk]"
ng-options="option.value as option.label for option in pricingEditorCtrl.isTaxableChoices"
></select>
</label>
</div>
</div>
<div class="fh-grey"
ng-can-admin-update="company"
ng-can-only-when="pricingEditorCtrl.editableLine.isTaxable == PriceLine.ON_IS_TAXABLE && company.features.isAggregateTaxEnabled && !PriceLine.isAggregateTaxableObject(pricingEditorCtrl.object)"
>
<span class="admin-badge">FH</span> Aggregate tax enabled
</div>
</div>
</div>
<div class="td discount" ng-if="pricingCtrl.needsSheetRateColumn">
<div class="price-col-inner" ng-if="pricingEditorCtrl.requirements.needsSheetRate">
<div class="pricelineform-sheetratetype field-price-line-type "
ng-django-field="priceLineForm [&#39;sheetRateType&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;sheetRateType&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_sheet_rate_type" name="sheetRateType" ng-model="pricingEditorCtrl.editableLine [&#39;sheetRateType&#39;]" required="required">
<option value="inherit" selected="selected">Inherit</option>
<option value="change">Change</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;sheetRateType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in priceLineForm [&#39;sheetRateType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="pricingEditorCtrl.editableLine.sheetRateType === TotalLine.CHANGE_SHEET_RATE_TYPE">
<div class="pricelineform-sheetrate
field-percent
"
ng-django-field="priceLineForm [&#39;sheetRate&#39;]" ng-django-field-model="pricingEditorCtrl.editableLine [&#39;sheetRate&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_sheet_rate" max="1000" min="-100" name="sheetRate" ng-float-input="" ng-float-input-decimal-places="7" ng-float-input-max-digits="8" ng-model="pricingEditorCtrl.editableLine [&#39;sheetRate&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" step="1e-7" type="text" value="0" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="priceLineForm [&#39;sheetRate&#39;].$error['min_value']">Must be between -100% and 1000%</li>
<li ng-if="priceLineForm [&#39;sheetRate&#39;].$error['pattern']">Invalid value</li>
<li ng-if="priceLineForm [&#39;sheetRate&#39;].$error['max_value']">Must be between -100% and 1000%</li>
<li ng-if="priceLineForm [&#39;sheetRate&#39;].$error['max_decimal_places']">Ensure that there are no more than 5 decimal places.</li>
<li ng-if="priceLineForm [&#39;sheetRate&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in priceLineForm [&#39;sheetRate&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</div>
<div class="td final">
<div ng-if="pricingEditorCtrl.requirements.needsPrice">
<div class="price-cell">
<div class="price-cell-inner"
ng-with="
calculatedPricing = pricingEditorCtrl.calculatedPricing();
costPreview = pricingEditorCtrl.costPreview(calculatedPricing);
"
>
<div class="the-price [[ pricingEditorCtrl.calculatedVisibility()|addClassIf:'visible':'hidden' ]]"
ng-cost-preview="costPreview"
ng-cost-preview-pricing="calculatedPricing"
ng-cost-preview-verbose="true"
></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in priceLineForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="price-form-buttons">
<div class="btns">
<button class="btn-tiny btn-green btn-left" type="submit"
ng-disabled="priceLineForm.$invalid || priceLineForm.$pristine || priceLineForm.$submitting"
>
[[ priceLineForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn-tiny btn-grey btn-left" type="button"
ng-click="pricingEditorCtrl.cancel(priceLineForm)"
>
Cancel
</button>
<button class="btn-tiny btn-grey btn--push-left" type="button"
ng-click="pricingEditorCtrl.inspect()"
>
Inspect
</button>
</div>
</div>
</form>
</div>
<div class="table valign-middle price-form-columns previewing"
ng-else="editing"
>
<div class="tr">
<div class="td vis
[! addClassIf(pricingEditorCtrl.effectivePricing.line && pricingEditorCtrl.effectivePricing.line.visibility !== TotalLine.INHERIT_VISIBILITY, 'changed') !]
[! addClassIf(!requirements.needsVisibility, 'cloak') !]
"
ng-class="{
'warn': pricingEditorCtrl.effectivePricing.visibility.isVisible && (customField.isPrivate || extendedOption.isPrivate)
}"
ng-if="pricingCtrl.needsVisibilityColumn"
ng-tip="[! T('Field is set to private, so will only be shown to logged in users who have been given permission to see') !]"
ng-tip-location=".icon-hint"
ng-tip-when="pricingEditorCtrl.effectivePricing.visibility.isVisible && (customField.isPrivate || extendedOption.isPrivate)"
ng-click="pricingEditorCtrl.edit()"
title="[! T('Visibility') !]"
>
<span class="price-cell" ng-if-once="requirements.needsVisibility && requirements.needsEditableVisibility">
<span class="price-cell-inner">
<span class="the-price closed" ng-effective-visibility="pricingEditorCtrl.effectivePricing.visibility"></span>
</span>
</span>
</div>
<div class="td price
[! addClassIf(pricingEditorCtrl.effectivePricing.line && pricingEditorCtrl.effectivePricing.line.priceType !== PriceLine.INHERIT_PRICE_TYPE, 'changed') !]
[! addClassIf(!requirements.needsPrice, 'cloak') !]
"
ng-click="pricingEditorCtrl.edit()"
title="[! T('Price') !]"
>
<span class="price-cell" ng-if-once="requirements.needsPrice" ng-then="needsPrice">
<span class="price-cell-inner" ng-if-once="!requirements.needsTaxableOnly">
<span class="the-price closed" ng-effective-price="pricingEditorCtrl.effectivePricing.price"></span>
</span>
</span>
</div>
<div class="td taxes
[! addClassIf(pricingEditorCtrl.effectivePricing.line && !PriceLine.isInheritTaxability(pricingEditorCtrl.effectivePricing.line), 'changed') !]
[! addClassIf(!requirements.needsTaxes, 'cloak') !]
"
ng-click="pricingEditorCtrl.edit()"
title="[! T('Taxes') !]"
>
<div class="price-cell" ng-if-once="requirements.needsTaxes">
<div class="price-cell-inner">
<div class="the-price closed"
ng-effective-taxes="pricingEditorCtrl.effectivePricing"
></div>
</div>
</div>
</div>
<div class="td discount
[! addClassIf(pricingEditorCtrl.effectivePricing.line && pricingEditorCtrl.effectivePricing.line.sheetRateType !== PriceLine.INHERIT_SHEET_RATE_TYPE, 'changed') !]
[! addClassIf(!requirements.needsSheetRate, 'cloak') !]
"
ng-if="pricingCtrl.needsSheetRateColumn"
ng-click="pricingEditorCtrl.edit()"
title="[[ pricingEditorCtrl.sheet.cls === InvoiceSheet.cls ? T('Commission') : T('Discount') ]]"
>
<span class="price-cell"
ng-if-once="requirements.needsSheetRate"
ng-then="needsSheetRate"
>
<span class="price-cell-inner">
<span class="the-price closed"
ng-effective-sheet-rate="pricingEditorCtrl.effectivePricing.sheetRate"
></span>
</span>
</span>
</div>
<div class="td final"
ng-click="pricingEditorCtrl.edit()"
title="[! pricingEditorCtrl.sheet.cls === TotalSheet.cls ? T('Final Price') : (pricingEditorCtrl.sheet.cls === InvoiceSheet.cls && pricingEditorCtrl.sheet.relationship === InvoiceSheet.CHARTER_RELATIONSHIP) ? T('Final Net') : T('Final Commission') !]"
>
<span class="price-cell" ng-if-once="requirements.needsPrice" ng-then="needsFinal">
<span class="price-cell-inner">
<span class="the-price"
ng-cost-preview="pricingEditorCtrl.costPreview(pricingEditorCtrl.effectivePricing)"
ng-cost-preview-pricing="pricingEditorCtrl.effectivePricing"
></span>
</span>
</span>
<span ng-else-once="needsFinal" ng-inline="pricing.unpriced"></span>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.effectiveVisibility">
[[ visibility.isVisible ? T('Visible') : T('Hidden') ]]
<span class="icon-hint"></span>
</script>
<script type="text/ng-template" id="dashboard.pricing.effectiveSheetRate">
<span ng-if="pricingEditorCtrl.sheet.cls === TotalSheet.cls">
[[ TotalSheet.displaySheetRate(sheetRate.sheetRate)|percentage ]]
</span>
<span ng-if="pricingEditorCtrl.sheet.cls === InvoiceSheet.cls">
[[ InvoiceSheet.displaySheetRate(sheetRate.sheetRate, pricingEditorCtrl.sheet.relationship)|percentage:'hidePlus' ]]
</span>
</script>
<script type="text/ng-template" id="dashboard.pricing.effectivePrice">
<span ng-if-once="price.modifierType === PriceLine.NONE_MODIFIER_TYPE" ng-then="none" class="fh-grey">None</span>
<span ng-else-once="none">
<span ng-if-once="price.modifierType === PriceLine.SET_MODIFIER_TYPE">Set to</span>
<span ng-if-once="price.modifierType === PriceLine.ADJUST_MODIFIER_TYPE"></span>
<b ng-if-once="price.modifierKind === PriceLine.OFFSET_MODIFIER_KIND">
[[ price.offset|amount:company ]]
</b>
<b ng-if-once="price.modifierKind === PriceLine.PERCENTAGE_MODIFIER_KIND">
[[ price.rate|percentage ]]
</b>
</span>
</script>
<script type="text/ng-template" id="dashboard.pricing.effectiveTaxes">
<div ng-if-once="effectivePricing.sheet.taxability === PriceSheet.NONE_TAXABILITY"
class="fh-grey"
ng-then="sheetNotTaxed"
>
Sheet not taxed
</div>
<div ng-else="sheetNotTaxed">
<span ng-if-once="effectivePricing.taxes.taxability === PriceSheet.NONE_TAXABILITY || !PriceLine.effectiveTaxTypes(effectivePricing).length"
ng-then="untaxed"
>
Not taxed
</span>
<div ng-else-once="untaxed">
<div ng-repeat="taxType in pricingCtrl.taxTypes"
ng-if-once="(effectivePricing.taxes.ratesByType[taxType.pk]|isDefined) || (effectivePricing.taxes.offsetsByType[taxType.pk]|isDefined)"
>
&bull; [! interpolate(T('%(name)s (%(rate)s)'), {name: (taxType|name), rate: TaxType.displayRate(taxType)}) !]
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.costPreview">
<span class="fh-grey" ng-if="costPreviewCtrl.cost.price === null">
None
</span>
<span ng-if="costPreviewCtrl.cost.price !== null">
<span ng-if="costPreviewCtrl.pricing.price.modifierType === PriceLine.SET_MODIFIER_TYPE">Set to</span>
<span ng-if="costPreviewCtrl.pricing.price.modifierKind === PriceLine.OFFSET_MODIFIER_KIND">
<ul ng-if="costPreviewCtrl.isVerbose">
<li>
Price: <b>[[ costPreviewCtrl.cost.price|amount:company ]]</b>
</li>
<li ng-repeat="taxType in taxTypes = (pricingCtrl.taxTypes|filter:costPreviewCtrl.showTaxType)">
[! taxType|name !]: <b>[[ costPreviewCtrl.cost.taxByType[taxType.pk]|amount:company ]]</b>
</li>
<li ng-else="taxTypes.length">
[! Company.taxDisplayName(company) !]: <b>[[ 0|amount:company ]]</b>
</li>
<li>
Total: <b>[[ (costPreviewCtrl.cost.price + costPreviewCtrl.cost.tax)|amount:company ]]</b>
</li>
</ul>
<b ng-else="costPreviewCtrl.isVerbose">[[ (costPreviewCtrl.cost.price + costPreviewCtrl.cost.tax)|amount:company ]]</b>
</span>
<b ng-if="costPreviewCtrl.pricing.price.modifierKind === PriceLine.PERCENTAGE_MODIFIER_KIND">
[[ costPreviewCtrl.pricing.price.rate|percentage ]] @
<span ng-effective-sheet-rate="costPreviewCtrl.pricing.sheetRate"></span>
</b>
</span>
</script>
<script type="text/ng-template" id="dashboard.pricing.inspector">
<div ng-can="viewPricing on Company.forObject(pricingInspectorCtrl.object)">
<div ng-if="pricingInspectorCtrl.status === 'loading'"
class="price-form-loading"
>
Loading...
</div>
<div ng-if="pricingInspectorCtrl.status === 'success'" class="price-form price-form--inset [[ pricingCtrl.needsVisibilityColumn ? 'vis-price-discount-final' : 'price-discount-final' ]] price-inspector">
<div class="inspector-header">
Price overview
</div>
<div class="table valign-middle price-form-columns previewing">
<div class="tr inspector-tr-sheet">
<div class="td cloak vis" ng-if="pricingCtrl.needsVisibilityColumn">
<span class="inspector-cell" ng-if="pricingInspectorCtrl.sheet.cls === TotalSheet.cls">
<b class="the-price">Visible</b>
</span>
</div>
<div class="td cloak price">
<span class="inspector-cell">
<b class="the-price">None</b>
</span>
</div>
<div class="td cloak taxes">
<span class="inspector-cell">
<b class="the-price"
ng-if="pricingInspectorCtrl.sheet.taxability === PriceSheet.NONE_TAXABILITY"
ng-then="untaxed"
>Not taxed</b>
<b class="the-price"
ng-else="untaxed"
>Taxed</b>
</span>
</div>
<div class="td cloak discount" ng-if="pricingCtrl.needsSheetRateColumn">
<span class="inspector-cell">
<b class="the-price" ng-effective-sheet-rate="pricingInspectorCtrl.sheet"></b>
</span>
</div>
<a class="td cloak final" ng-href="[[ pricingInspectorCtrl.url(pricingInspectorCtrl.sheet) ]]">
<span class="inspector-cell">
[[ pricingInspectorCtrl.sheet.displayName ]] sheet
</span>
</a>
</div>
<div class="tr inspector-tr-[[ line.object.cls|css ]]"
ng-repeat="line in pricingInspectorCtrl.lines"
>
<div class="td cloak vis" ng-if="pricingCtrl.needsVisibilityColumn">
<span class="inspector-cell" ng-if="pricingInspectorCtrl.sheet.cls === TotalSheet.cls">
<span ng-if="line.visibility === TotalLine.INHERIT_VISIBILITY" ng-then="inheritVisibility"
class="the-price fh-grey"
>
Inherit
</span>
<span ng-else="inheritVisibility">
<b class="the-price" ng-effective-visibility="line"></b>
</span>
</span>
</div>
<div class="td cloak price">
<span class="inspector-cell">
<span ng-if="line.priceType === PriceLine.INHERIT_PRICE_TYPE" ng-then="inheritPrice"
class="the-price fh-grey"
>
Inherit
</span>
<span ng-else="inheritPrice">
<b class="the-price" ng-effective-price="line"></b>
</span>
</span>
</div>
<div class="td cloak taxes">
<span class="inspector-cell">
<span ng-if="line.isTaxable !== PriceLine.ON_IS_TAXABLE && line.isTaxable !== PriceLine.OFF_IS_TAXABLE"
ng-then="inherit"
class="the-price fh-grey"
>
Inherit
</span>
<span ng-if="line.isTaxable === PriceLine.OFF_IS_TAXABLE" ng-then="untaxed">
<b class="the-price">Not taxed</b>
</span>
<span ng-else="inherit || untaxed">
<b class="the-price">Taxed</b>
</span>
</span>
</div>
<div class="td cloak discount" ng-if="pricingCtrl.needsSheetRateColumn">
<span class="inspector-cell">
<span ng-if="line.sheetRateType === PriceLine.INHERIT_SHEET_RATE_TYPE" ng-then="inheritSheetRate"
class="the-price fh-grey"
>
Inherit
</span>
<span ng-else="inheritSheetRate">
<b class="the-price" ng-effective-sheet-rate="line"></b>
</span>
</span>
</div>
<a class="td cloak final" ng-href="[[ pricingInspectorCtrl.url(line.object, line.sheet) ]]">
<span class="inspector-cell">
<span ng-if="line.object.cls === ExtendedOption.cls" ng-then="extendedOption">
[[ line.sheet.displayName ]] sheet on option
</span>
<span ng-if="line.object.cls === CustomFieldInstance.cls" ng-then="customFieldInstance">
[[ line.sheet.displayName ]] sheet on [[ line.object.customField.cls|uncamel|lowercase ]] for item
</span>
<span ng-if="line.object.cls === CustomerTypeRate.cls" ng-then="customerTypeRate">
[[ line.sheet.displayName ]] sheet on [[ line.object.customerPrototype.customerType.plural ]] (availability)
</span>
<span ng-if="line.object.cls === CustomerPrototype.cls" ng-then="customerPrototype">
[[ line.sheet.displayName ]] sheet on [[ line.object.name || line.object.customerType.plural ]] (item)
</span>
<span ng-if="line.object.cls === CustomerType.cls" ng-then="customerType">
[[ line.sheet.displayName ]] sheet on [[ line.object.plural ]]
</span>
<span ng-else="extendedOption || customFieldInstance || customerType || customerPrototype || customerTypeRate">
[[ line.sheet.displayName ]] sheet on [[ line.object.cls|uncamel|lowercase ]]
</span>
</span>
</a>
</div>
</div>
</div>
<div ng-if="pricingInspectorCtrl.status === 'error'"
class="price-form-loading"
>
Error
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.navigation">
<div ng-if="pricingNavigationCtrl.status === 'loading'" class="tb-left">
<div class="tb-text">Loading...</div>
</div>
<div ng-if="pricingNavigationCtrl.status === 'success'">
<div class="tb-left">
<div class="tb-flyout-wrap"
ng-link="sheet-nav-flyout"
></div>
</div>
<div class="tb-right">
<span class="tb-btn"
ng-tip="Previous sheet (Shortcut: &larr; key)"
ng-click="pricingNavigationCtrl.previousSheet()"
ng-shortcut="'left'"
ng-shortcut-click
>
<span class="tb-icon arrow-left"></span>
</span>
<span class="tb-btn"
ng-tip="Next sheet (Shortcut: &rarr; key)"
ng-click="pricingNavigationCtrl.nextSheet()"
ng-shortcut="'right'"
ng-shortcut-click
>
<span class="tb-icon arrow-right"></span>
</span>
</div>
</div>
</script>
<script type="text/ng-template" id="schedule-entries">
<div class="reorder-note"
ng-can-create="TotalScheduleEntry on company"
ng-can-only-when="entries.length > 1"
ng-then="sortable"
>
Drag to reorder sheets. The first sheet with matching rules will be used.
</div>
<table class="spreadsheet highlight-rows"
ng-if="entries.length || schedule.fallback"
ng-then="hasSheets"
ng-sortable="listCtrl.reorder"
ng-sortable-selector="tbody.sortable"
ng-sortable-table="true"
>
<thead class="ss-header ss-header-shade">
<tr>
<td ng-if="sortable"></td>
<td>Sheet</td>
<td ng-if-once="showOnlineColumn">Online?</td>
<td>Note</td>
<td>Rules</td>
<td>
<span ng-can-create="TotalScheduleEntry on company" ng-then="editTotalScheduleEntry">Edit</span>
<span ng-else="editTotalScheduleEntry">View</span>
</td>
</tr>
</thead>
<tbody ng-repeat="entry in entries" ng-sortable-item="entry"
ng-init="groupedRules = ScheduleEntryRule.groupRules(entry.rules)"
>
<tr>
<td ng-if="sortable" class="td-sortable-handle">
<span class="sortable-handle small"></span>
</td>
<td class="show-links">
<a ng-href="[! entry.sheet.$url() !]">[! entry.sheet.displayName !]</a>
</td>
<td ng-if-once="showOnlineColumn">
<span class="fh-green" ng-if-once="entry.sheet.isOnline">&check;</span>
</td>
<td>[! entry.notes !]</td>
<td>
<div ng-repeat="type in ScheduleEntryRule.RULE_TYPES"
ng-if-once="groupedRules[type].length"
ng-init="rules = groupedRules[type]"
>
[! ScheduleEntryRule.displayType(rules[0]) !]:
<span ng-if-once="ScheduleEntryRule.isDayOfWeekType(rules[0])"
ng-then="dayOfWeek"
>
[! ScheduleEntryRule.combinedDayPattern(rules)|commaSeparated !]
</span>
<span ng-else-once="dayOfWeek">
<span ng-repeat="rule in rules">
[! rule.startAt|datetimeRange:rule.endAt !]<span
ng-else-once="$last">,</span>
</span>
</span>
</div>
<div ng-if="!entry.rules.length">
<span class="warning-icon"></span>
<span class="warning-color">Will not be used (no rules added)</span>
</div>
</td>
<td class="show-links">
<a ng-href="[! entry.$url() !]">
[! auth.permissions.canUpdate(entry) ? T("Edit") : T("View") !]&nbsp;&raquo;
</a>
</td>
</tr>
</tbody>
<tbody ng-if="schedule.fallback">
<tr>
<td ng-if="sortable" class="td-sortable-handle"></td>
<td class="show-links">
<a ng-href="[! schedule.fallback.$url() !]">
[! schedule.fallback.displayName !]
</a>
</td>
<td ng-if-once="showOnlineColumn">
<span class="fh-green" ng-if="schedule.fallback.isOnline">&check;</span>
</td>
<td></td>
<td>Used if no other sheet has matching rules</td>
<td class="show-links">
<a ng-href="[! schedule.$url(settingsUrl) !]"
ng-can-update="schedule"
>Edit&nbsp;&raquo;</a>
</td>
</tr>
</tbody>
</table>
<div class="fh-grey"
ng-else="hasSheets"
>
<span class="warning-icon"></span>
<span class="warning-color">No sheets added yet. Bookings using this schedule will not have invoice pricing.</span>
</div>
</script>
<script type="text/ng-template" id="schedule-entry-rules">
<div ng-if="rules.length"
ng-then="hasRules"
>
<p class="fh-grey">
This sheet can only be used when at least one rule of each type you&#039;ve added matches.
</p>
<table class="spreadsheet highlight-rows">
<thead class="ss-header ss-header-shade">
<tr>
<td>Type</td>
<td>When</td>
<td>
<span ng-can-create="TotalScheduleEntryRule on company">Delete</span>
</td>
</tr>
</thead>
<tbody ng-repeat="type in ScheduleEntryRule.RULE_TYPES">
<tr ng-repeat="rule in groupedRules[type] track by rule.pk">
<td>
<span ng-if="$first">
[! ScheduleEntryRule.displayType(rule) !]
</span>
</td>
<td>
<span ng-if-once="ScheduleEntryRule.isDateType(rule)">
[! rule.startAt|datetimeRange:(rule.endAt):'shortFullYear' !]
</span>
<span ng-if-once="ScheduleEntryRule.isDayOfWeekType(rule)">
[! rule.dayPattern|map:Rule.weekDayShort|commaSeparated !]
</span>
</td>
<td>
<a class="fh-red underline"
ng-can-remove="rule"
ng-click="listCtrl.remove(rule)"
ng-confirm-click="[! T('Are you sure you want to delete this rule?') !]"
>
Delete
</a>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-else="hasRules" class="fh-grey">
<span class="warning-icon"></span>
<span class="warning-color">No rules added yet. Sheet will not be used until rules are added.</span>
</div>
</script>
<script type="text/ng-template" id="schedule-default-tag">
<span ng-if-once="schedule.isCompanyDirectDefault || schedule.isCompanyOnlineDefault">
<span class="fh-light-grey">&check;</span>
<span>Company Default &ndash;</span>
<span ng-if-once="schedule.isCompanyOnlineDefault">Online</span>
<span ng-if-once="schedule.isCompanyDirectDefault && schedule.isCompanyOnlineDefault">&amp;</span>
<span ng-if-once="schedule.isCompanyDirectDefault">Direct</span>
</span>
</script>
<script type="text/ng-template" id="price-form-headings">
<div class="table valign-middle price-form-columns"
ng-can="viewPricing on Company.forObject(pricingCtrl.object)" ng-then="canViewPricing"
>
<div class="tr"
ng-with="multipleSheets = pricingCtrl.sheets.length > 1; onlySheet = pricingCtrl.sheets[0]"
>
<div class="td vis" ng-if="pricingCtrl.needsVisibilityColumn" ng-auto-export-skip>
<h2 class="price-col-header">
Visibility
</h2>
</div>
<div class="td price" ng-auto-export-skip>
<h2 class="price-col-header">
[[
(!multipleSheets && onlySheet.cls === InvoiceSheet.cls) ?
T('Invoice Price') :
T('Price')
]]
</h2>
</div>
<div class="td taxes" ng-auto-export-skip>
<h2 class="price-col-header">
Tax
</h2>
</div>
<div class="td discount"
ng-if="pricingCtrl.needsSheetRateColumn"
ng-auto-export-skip
>
<h2 class="price-col-header">
[[
multipleSheets ?
T('Rate') :
onlySheet.cls === InvoiceSheet.cls ?
T('Commission') :
T('Discount')
]]
</h2>
</div>
<div class="td final" ng-tip="[! T('Includes tax, if added') !]" ng-tip-location=".icon-hint" ng-auto-export-skip>
<h2 class="price-col-header">
[[
(multipleSheets || onlySheet.cls === TotalSheet.cls) ?
T('Final Price') :
(onlySheet.cls === InvoiceSheet.cls && onlySheet.relationship === InvoiceSheet.CHARTER_RELATIONSHIP) ?
T('Final Net') :
T('Final Commission')
]]
<i class="icon-hint respond-print-hide"></i>
</h2>
</div>
</div>
</div>
<div class="table valign-middle price-form-columns" ng-else="canViewPricing">
<div class="tr">
<h2 class="price-col-header"></h2>
</div>
</div>
</script>
<script type="text/ng-template" id="sheet-nav-flyout">
<div class="tb-btn tb-btn--flyout"
ng-toggle="sheetNav"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
Prices and visibility:
<b class="fh-blue" ng-if="pricingNavigation.sheets.length === 1">[[ pricingNavigation.sheets[0].displayName ]]</b>
<b class="fh-blue" ng-if="pricingNavigation.sheets.length > 1">[[ interpolate(T('%(count)s sheets'), { count: pricingNavigation.sheets.length }) ]]</b>
</div>
<div ng-toggled="sheetNav"
class="tb-flyout tb-flyout--sheet-nav"
ng-body-class="setMaxHeight ? 'hide-body-overflow' : ''"
>
<div class="flyout-scrollable"
ng-style="{ 'max-height': setMaxHeight ? (dimensions.height - 100) : '' }"
>
<div class="settings-window-header">
<h1>Price Sheets</h1>
<div class="settings-window-header-description">
Sets of prices and visibility settings that can be used when booking
</div>
</div>
<div class="sheet-nav-wrap">
<p class="sheet-nav-selected-notice hint">
[[ interpolate(nT('%(count)s sheet selected.', '%(count)s sheets selected.', pricingNavigation.sheets.length), { count: pricingNavigation.sheets.length }) ]]
<span class="fh-grey">Alt-click to select multiple or deselect.</span>
</p>
<table class="price-sheet-block is-clickable"
ng-class="{ 'active': pricingNavigation.isSelected(pricingNavigationCtrl.totalSheets.base) }"
ng-click="pricingNavigationCtrl.selectSheet(pricingNavigationCtrl.totalSheets.base)"
ng-alt-click="pricingNavigationCtrl.toggleSheet(pricingNavigationCtrl.totalSheets.base)"
>
<tr>
<td class="icon"></td>
<td class="price-sheet-block-name">
<h2>Base</h2>
</td>
<td class="price-sheet-block-desc">
<div>These prices are used by all other sheets unless overridden</div>
</td>
</tr>
</table>
<div class="sheet-nav-wrap-inset">
<ul class="list-filters"
ng-hide="!company.affiliatesCount"
>
<li ng-toggle="sheetNavTotal"
ng-toggle-group="sheetNavTypes"
ng-toggle-default="pricingNavigation.sheets.length !== 1 || pricingNavigation.sheets[0].cls === TotalSheet.cls"
>
Customer price sheets
</li>
<li ng-toggle="sheetNavInvoice"
ng-toggle-group="sheetNavTypes"
ng-toggle-default="pricingNavigation.sheets.length === 1 && pricingNavigation.sheets[0].cls === InvoiceSheet.cls"
>
Affiliate invoice price sheets
</li>
</ul>
<div ng-toggled="sheetNavTotal">
<div class="sheet-nav-header"
ng-hide="!company.affiliatesCount"
>
<h1>Customer total price sheets</h1>
<div class="settings-window-header-description">
Determine the prices that should be charged to customers
</div>
</div>
<table class="price-sheet-block is-clickable"
ng-class="{ 'active': pricingNavigation.isSelected(pricingNavigationCtrl.totalSheets.totalBase) }"
ng-click="pricingNavigationCtrl.selectSheet(pricingNavigationCtrl.totalSheets.totalBase)"
ng-alt-click="pricingNavigationCtrl.toggleSheet(pricingNavigationCtrl.totalSheets.totalBase)"
>
<tr>
<td class="icon"></td>
<td class="price-sheet-block-name">
<h2>Total Base</h2>
</td>
<td class="price-sheet-block-desc">
<div>These prices are used by customer price sheets unless overridden</div>
</td>
</tr>
</table>
<ul class="sheet-nav-wrap-inset price-sheet-list">
<li ng-repeat="sheet in pricingNavigationCtrl.totalSheets">
<table class="price-sheet-block is-clickable"
ng-class="{ 'active': pricingNavigation.isSelected(sheet) }"
ng-click="pricingNavigationCtrl.selectSheet(sheet)"
ng-alt-click="pricingNavigationCtrl.toggleSheet(sheet)"
>
<tr>
<td class="icon"></td>
<td class="price-sheet-block-name">
<h2 ng-if-once="!!sheet.name">[! sheet.name !]</h2>
<div ng-if="sheet.sheetRate !== 1" class="nowrap">
Price change: [[ TotalSheet.displaySheetRate(sheet.sheetRate)|percentage ]]
</div>
</td>
<td class="price-sheet-block-desc">
<div></div>
<div ng-if-once="sheet.isOnline">
&bull; For when customers are booking online
</div>
<div ng-if-once="!sheet.isCascading">
&bull; Skips Total Base and Base sheets
</div>
</td>
</tr>
</table>
</li>
</ul>
</div>
<div ng-toggled="sheetNavInvoice">
<div class="sheet-nav-header">
<h1>Affiliate invoice price sheets</h1>
<div class="settings-window-header-description">
Determine the prices that should be invoiced for affiliates
</div>
</div>
<table class="price-sheet-block is-clickable"
ng-class="{ 'active': pricingNavigation.isSelected(pricingNavigationCtrl.invoiceSheets.invoiceBase) }"
ng-click="pricingNavigationCtrl.selectSheet(pricingNavigationCtrl.invoiceSheets.invoiceBase)"
ng-alt-click="pricingNavigationCtrl.toggleSheet(pricingNavigationCtrl.invoiceSheets.invoiceBase)"
>
<tr>
<td class="icon"></td>
<td class="price-sheet-block-name">
<h2>Invoice Base</h2>
</td>
<td class="price-sheet-block-desc">
<div>These prices and rates are used by affiliate invoice sheets unless overridden</div>
</td>
</tr>
</table>
<ul class="sheet-nav-wrap-inset price-sheet-list">
<li ng-repeat="sheet in pricingNavigationCtrl.invoiceSheets">
<table class="price-sheet-block is-clickable"
ng-class="{ 'active': pricingNavigation.isSelected(sheet) }"
ng-click="pricingNavigationCtrl.selectSheet(sheet)"
ng-alt-click="pricingNavigationCtrl.toggleSheet(sheet)"
>
<tr>
<td class="icon"></td>
<td class="price-sheet-block-name">
<h2 ng-if-once="!!sheet.name">[! sheet.name !]</h2>
<div class="nowrap">
[[
interpolate(T('Commission: %(percentAmount)s'), { percentAmount: (InvoiceSheet.displaySheetRate(sheet.sheetRate, sheet.relationship)|percentage:'hideplus') })
]]
</div>
<div ng-if="sheet.relationship === InvoiceSheet.AFFILIATE_RELATIONSHIP"
class="nowrap"
>Owed to affiliate</div>
</td>
<td class="price-sheet-block-desc">
<div></div>
<span ng-if="!sheet.isCascading">
&bull; Skips Invoice Base and Base sheets
</span>
</td>
</tr>
</table>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.tools">
<div class="tb-group">
<div class="tb-flyout-wrap tb-collapse-on-mobile">
<div class="tb-btn tb-btn--flyout"
ng-toggle="priceTools"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
ng-class="{
highlighted: filterPricing.isFiltering()
}"
>
<i class="tb-icon filter"></i>
Filter pricing
</div>
<div class="tb-flyout tb-flyout--auto-width-narrow"
ng-toggled-show="priceTools"
>
<ul class="flyout-checklist nowrap">
<li>
<div ng-pricing-hide-hidden></div>
</li>
<li ng-if="pricingToolsCtrl.isFilteringFields">
<div ng-pricing-hide-fields="pricingToolsCtrl.isHidingFields"></div>
</li>
<li ng-if="pricingToolsCtrl.isFilteringItems">
<div ng-pricing-hide-resources="pricingToolsCtrl.isHidingResources"></div>
</li>
<li ng-if="pricingToolsCtrl.isFilteringFields">
<div ng-pricing-simplify="pricingToolsCtrl.isSimplified"></div>
</li>
</ul>
<div ng-pricing-filter
ng-pricing-filter-items="pricingToolsCtrl.isFilteringItems"
ng-pricing-filter-fields="pricingToolsCtrl.isFilteringFields"
class="flyout-section labels-above flyout-section--no-bottom-padding"
></div>
<div class="flyout-section" ng-if="pricingToolsCtrl.isFilteringItems">
<div ng-pagination-settings></div>
</div>
<div class="flyout-section">
<a ng-click="pricingToolsCtrl.reset()" class="fh-grey">Reset</a>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.filter">
<div class="field" ng-if="pricingFilterCtrl.isFilteringItems">
<label>
<span class="label-text nowrap">Filter items</span>
<div class="field-search-wrap">
<input class="field-search js-disable-shortcuts" type="text"
ng-model="pricingFilterCtrl.spec.items"
/>
<div ng-clear-input="pricingFilterCtrl.spec.items"></div>
</div>
</label>
</div>
<div class="field">
<label>
<span class="label-text nowrap">Filter customers and groups</span>
<div class="field-search-wrap">
<input class="field-search js-disable-shortcuts" type="text"
ng-model="pricingFilterCtrl.spec.containers"
/>
<div ng-clear-input="pricingFilterCtrl.spec.containers"></div>
</div>
</label>
</div>
<div class="field" ng-if="!filterPricing.isHidingFields && pricingFilterCtrl.isFilteringFields">
<label class="field-search-wrap">
<span class="label-text nowrap">Filter fields</span>
<div class="field-search-wrap">
<input class="field-search js-disable-shortcuts" type="text"
ng-model="pricingFilterCtrl.spec.fields"
/>
<div ng-clear-input="pricingFilterCtrl.spec.fields"></div>
</div>
</label>
</div>
</script>
<script type="text/ng-template" id="dashboard.pricing.hideHidden">
<label>
<input type="checkbox"
ng-checked="filterPricing.isHidingHiddenObjects"
ng-click="filterPricing.hideHiddenObjects()"
>
Hide if not visible
</label>
</script>
<script type="text/ng-template" id="dashboard.pricing.hideResources">
<label>
<input type="checkbox"
ng-checked="filterPricing.isHidingResources"
ng-click="filterPricing.hideResources()"
>
Hide resources
</label>
</script>
<script type="text/ng-template" id="dashboard.pricing.hideFields">
<label>
<input type="checkbox"
ng-checked="filterPricing.isHidingFields"
ng-click="filterPricing.hideFields()"
>
Hide custom fields
</label>
</script>
<script type="text/ng-template" id="dashboard.pricing.simplify">
<label>
<input type="checkbox"
ng-checked="filterPricing.isSimplified"
ng-click="filterPricing.simplify()"
>
Simple custom fields
</label>
</script>
<script type="text/ng-template" id="pricing.unpriced">
<span class="price-cell">
<span class="price-cell-inner">
<span class="the-price fh-grey">
[[ requirements.isPricedByOptions ? T('Priced by options') : requirements.isCannotBePriced ? T('Cannot be priced') : '' ]]
</span>
</span>
</span>
</script>
<script type="text/ng-template" id="reports.accounts">
<div ng-if="auth.permissions.can('viewAccountsType', Report, company)">
<div ng-repeat="account in accounts">
<table class="invoice-table" ng-if="account.isDefault && includeAdminAccounts">
<thead>
<tr class="invoice-table--row is-tall is-super-header">
<td colspan="2">
[! !account.isDefault ?
interpolate(cT('Legacy as in older version', 'FareHarbor Legacy System Accounts in %(currency)s'), { currency: (account.processorCurrency|currency) }) :
interpolate(T('FareHarbor System Accounts in %(currency)s'), { currency: (account.processorCurrency|currency) })
!]
</td>
</tr>
</thead>
<tbody>
<tr class="invoice-table--row is-tall">
<td><b>Future payouts</b></td>
<td class="itable-amount">[[ account.escrow.balance|amount:account ]]</td>
</tr>
<tr class="invoice-table--row is-tall">
<td><b>Processing Fees Owed</b></td>
<td class="itable-amount">[[ account.processingFeeOwed.balance|amount:account ]]</td>
</tr>
<tr class="invoice-table--row is-tall">
<td><b>Booking Fee Processing Fees Owed</b></td>
<td class="itable-amount">[[ account.bookingFeeProcessingFeeOwed.balance|amount:account ]]</td>
</tr>
</tbody>
</table>
<div ng-if="account.isDefault && !includeAdminAccounts">
<div class="flex-row flex--justify-between">
<div class="flex-item text-medium">
<b>Future payouts</b>
</div>
<div class="flex-item flex-item--push-left text-medium text-right nowrap" ng-if="isProjectedRefundReserveRecurringTransferAmountLoaded">
[[ (account.escrow.balance - company.projectedUpcomingRefundReserveRecurrentTransferAmount)|amount:account ]]
</div>
</div>
<div ng-if="company.companyFeatures.isRefundReserveRecurringTransferEnabled"
class="flex-row flex--justify-between"
>
<div class="flex-item text-medium">
<b>Next projected recurring transfer</b>
</div>
<div class="flex-item flex-item--push-left text-medium text-right nowrap" ng-if="isProjectedRefundReserveRecurringTransferAmountLoaded">
[[ company.projectedUpcomingRefundReserveRecurrentTransferAmount|amount:account ]]
</div>
</div>
<div class="flex-row flex--justify-between">
<div class="flex-item text-medium itable-amount">
<b>Refund reserve</b>
</div>
<div class="flex-item flex-item--push-left text-medium text-right nowrap"
ng-if="isProjectedRefundReserveRecurringTransferAmountLoaded"
ng-tip-when="company.companyFeatures.isRefundReserveRecurringTransferEnabled"
ng-tip="[[ T('Autofill limit') ]]: [[ company.companyFeatures.refundReserveAutofillLimit|amount:account ]]"
ng-tip-position="left"
>
[[ account.deposit.balance|amount:account ]]
</div>
</div>
<div class="flex-row flex--justify-between flex--items-center refund-reserve-total">
<div class="flex-item text-medium">
<b ng-if="company.isDefaultProcessorUploadsEnabled">Total available for refunds without triggering a bank debit</b>
<b ng-else="company.isDefaultProcessorUploadsEnabled">Total available for refunds</b>
</div>
<div class="flex-item flex-item--push-left text-medium text-right text-huge nowrap">
<span ng-if="isProjectedRefundReserveRecurringTransferAmountLoaded" ng-then="projectedRefundReserveRecurringTransferAmountSuccess">
[[ (account.deposit.balance + account.escrow.balance)|amount:account ]]
</span>
<div class="spinner-ticker-wrap" ng-else="projectedRefundReserveRecurringTransferAmountSuccess">
<i class="spinner-ticker-css"><span></span></i>
</div>
</div>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="payout-details">
<div ng-with="transfers = payout.transfers; refundReserveTransfer = payout.refundReserveTransfer">
<table class="spreadsheet highlight-rows width-auto"
ng-can-list="Transfer on company"
ng-can-only-when="transfers.length || refundReserveTransfer.offset"
ng-auto-export="report"
ng-table="transfers"
>
<thead ng-navigation-path="urls.dashboard.reports.payouts.index">
<tr class="payout-header">
<td colspan="9" class="spanned-header big transfers-header">Transfers</td>
</tr>
</thead>
<thead class="ss-header ss-header-shade">
<tr>
<td ng-table-header="$row.pk"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Transfer ID") !]'
>
ID
</td>
<td ng-table-header="$row.offset">
Amount
</td>
<td ng-table-header="$row.createdAt"
ng-table-header-default
>
Created At
</td>
<td ng-table-header="$row.user.name">
Created By
</td>
<td ng-table-header="$row.refund.payment.booking.pk">
Booking
</td>
<td ng-table-header="$row.noteSafeHtml">
Note
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="transfer in $table.collection">
<td class="show-links">
<a ng-href="[! transfer.$url(urls.dashboard.reports.accounts.transfer) !]">#[! transfer.pk !]</a>
</td>
<td>[! transfer.offset|amount:transfer !]</td>
<td>
[! transfer.createdAt|datetimeWithTimezone:company.timezone !]
</td>
<td>
<a ng-href="[! transfer.user.$url(urls.dashboard.settings.permissions.user.index) !]">[! transfer.user.name !]</a>
</td>
<td>
<a ng-if="!!transfer.refund" ng-href="[! transfer.refund.payment.booking.$url(urls.dashboard.overlay.contact.booking) !]">
#[! transfer.refund.payment.booking.pk !]
</a>
</td>
<td ng-bind-html="transfer.noteSafeHtml"></td>
</tr>
<tr ng-if="refundReserveTransfer.offset">
<td></td>
<td>[! refundReserveTransfer.offset|amount:transfer !]</td>
<td><span class="badge">Pending</span></td>
<td>
<a ng-href="[[ company.$url(urls.dashboard.settings.payments.refundReserve) ]]?recurring-transfer-form=open">
Automatically generated
</a>
</td>
<td></td>
<td>
Recurring transfer
</td>
</tr>
</tbody>
<tfoot ng-if="transfers.length > 1">
<tr ng-auto-export-skip>
<td></td>
<td ng-table-summary="$row.offset">
[[ $summary+refundReserveTransfer.offset|amount:company ]]
</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>
</table>
</div>
<div ng-if="payout.uploads.length" ng-with="uploads = payout.uploads">
<table class="spreadsheet highlight-rows "
ng-can-list="Upload on company"
ng-can-only-when="uploads.length"
ng-auto-export="report"
ng-table="uploads"
>
<thead>
<tr class="payout-header">
<td colspan="11" class="spanned-header big transfers-header">
Bank debits & transfers
</td>
</tr>
</thead>
<thead class="ss-header ss-header-shade">
<tr>
<td ng-table-header="$row.pk"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Upload ID") !]'
>
Debit ID
</td>
<td ng-table-header="$row.total">
Gross
</td>
<td ng-table-header="$row.invoiceFee">
Fee
</td>
<td ng-table-header="$row.total - $row.invoiceFee">
Net
</td>
<td ng-table-header="-$row.createdAt"
ng-table-header-default
>
Created At
</td>
<td ng-table-header="$row.user.name">
Created By
</td>
<td ng-table-header="$row.refunds.length ? $row.refunds[0].payment.booking.pk : ''; $row.invoice.identifier">
For
</td>
<td ng-table-header="$row.noteSafeHtml">
Note
</td>
<td ng-can-admin-update="company" ng-table-header="!$row.isExternal">
External
</td>
<td ng-can-admin-update="company" ng-table-header="$row.processorIdentifier">
Processor ID
</td>
<td ng-table-header="$row.status">
Debit Status
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="upload in $table.collection">
<td class="show-links">
<a ng-href="[! upload|uploadUrl !]">#[! upload.pk !]</a>
</td>
<td>[! upload.total|amount:upload !]</td>
<td>[! upload.invoiceFee|amount:upload !]</td>
<td>[! (upload.total - upload.invoiceFee)|amount:upload !]</td>
<td>
[! upload.createdAt|datetimeWithTimezone:company.timezone !]
</td>
<td>
<a ng-href="[! upload.user.$url(urls.dashboard.settings.users.user.index) !]">[! upload.user.name !]</a>
</td>
<td class="show-links">
<div ng-if-once="!!upload.invoice">
<a ng-href="[! upload.invoice|invoiceUrl !]">
Invoice [! upload.invoice.identifier !]</a>
</div>
<div ng-repeat="refund in upload.allRefunds">
<a ng-href="[! refund.payment.booking.$url(urls.dashboard.overlay.contact.booking) !]">
Booking #[! refund.payment.booking.pk !]</a>
</div>
<div ng-if-once="!upload.invoice && !upload.allRefunds.length && !upload.isExternal">Refund reserve</div>
<div ng-if-once="!upload.invoice && !upload.allRefunds.length && upload.isExternal">External transfer</div>
</td>
<td ng-bind-html="upload.noteSafeHtml"></td>
<td ng-can-admin-view="upload.company">
<span ng-if-once="upload.isExternal" class="fh-green">&#10003;</span>
</td>
<td ng-can-admin-view="upload.company">
[! upload.processorIdentifier !] ([! upload.processorType|capitalize !])
</td>
<td>
<span class="badge" ng-class="{
'badge-green': upload.status === 'succeeded',
'badge-red': upload.status === 'failed'
}">
[! upload.status !]
</span>
</td>
</tr>
</tbody>
<tfoot ng-if="uploads.length > 1">
<tr ng-auto-export-skip>
<td></td>
<td ng-table-summary="$row.total">
[[ $summary|amount:company ]]
</td>
<td colspan="100"></td>
</tr>
</tfoot>
</table>
</div>
<div ng-if="payout.adjustments.length" ng-with="adjustments = payout.adjustments">
<table class="spreadsheet highlight-rows" ng-if="adjustments.length"
ng-auto-export="report"
ng-table="adjustments"
>
<thead>
<tr class="payout-header">
<td colspan="11" class="spanned-header big adjustments-header">Adjustments</td>
</tr>
</thead>
<thead class="ss-header ss-header-shade">
<tr>
<td ng-table-header="$row.pk"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Adjustment ID") !]'
>
ID
</td>
<td ng-table-header="$row.offset">
Amount
</td>
<td ng-table-header="$row.createdAt" ng-table-header-default>
Created At
</td>
<td ng-table-header="$row.user.name">
Created By
</td>
<td ng-table-header="$row.noteSafeHtml">
Note
</td>
<td ng-table-header="-$row.isProcessable">
Processable
</td>
<td ng-table-header="-$row.isExternal">
External
</td>
<td ng-table-header="-$row.isPayable">
Payable
</td>
<td ng-table-header="$row.processorIdentifier">
Identifier
</td>
<td ng-table-header="$row.status">
Status
</td>
</tr>
</thead>
<tbody ng-repeat="adjustment in $table.collection">
<tr>
<td>
#[! adjustment.pk !]
</td>
<td>
<span ng-amount="adjustment.offset"></span>
</td>
<td>
[! adjustment.createdAt|datetimeWithTimezone:company.timezone !]
</td>
<td>
[! adjustment.user.name !]
</td>
<td ng-bind-html="adjustment.noteSafeHtml" class="md-inline"></td>
<td ng-auto-export-value="[! adjustment.isProcessable ? T('Yes') : T('No') !]">
<span ng-if="adjustment.isProcessable" ng-then="isProcessable" class="fh-green">&#10003;</span>
<span ng-else="isProcessable" class="fh-red">&#10008;</span>
</td>
<td ng-auto-export-value="[! adjustment.isExternal ? T('Yes') : T('No') !]">
<span ng-if="adjustment.isExternal" ng-then="isExternal" class="fh-green">&#10003;</span>
<span ng-else="isExternal" class="fh-red">&#10008;</span>
</td>
<td ng-auto-export-value="[! adjustment.isPayable ? T('Yes') : T('No') !]">
<span ng-if="adjustment.isPayable" ng-then="isPayable" class="fh-green">&#10003;</span>
<span ng-else="isPayable" class="fh-red">&#10008;</span>
</td>
<td>
[! adjustment.processorIdentifier !] ([! adjustment.processorType !])
</td>
<td>
[! adjustment.status|capitalize !]
</td>
</tr>
</tbody>
<tfoot ng-if="adjustments.length > 1">
<tr ng-auto-export-skip>
<td></td>
<td ng-table-summary="$row.offset">
[[ $summary|amount:company ]]
</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tfoot>
</table>
</div>
<div ng-if="payout.payments.length">
<table class="spreadsheet nowrap highlight-rows" ng-table="payout.payments" ng-auto-export="report">
<thead>
<tr ng-if="payout.payments.length">
<td colspan="6" class="spanned-header big payments-header">Payments</td>
<td colspan="20" class="bookings-header show-links"
ng-auto-export-value="[! T('For Booking') !]"
>
For Booking<br>
<a ng-toggle="showFullBooking">
<span class="hide-when-toggled">+Show more</span>
<span class="show-when-toggled">-Show less</span>
</a>
</td>
</tr>
</thead>
<thead class="ss-header ss-header-shade">
<tr>
<td
ng-table-header="$row.pk"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Payment ID") !]'
>
ID
</td>
<td
ng-table-header="-$row.initialReceipt.gross"
>
Gross
</td>
<td
ng-table-header="-$row.initialReceipt.processingFee"
>
Fee
</td>
<td
ng-table-header="$row.initialReceipt.net"
>
Net
</td>
<td
ng-table-header="$row.costs.totalCost.tax"
>
Tax
</td>
<td
ng-table-header="$row.createdAt"
ng-table-header-default
>
Created At
</td>
<td
ng-table-header="$row.user.name"
>
Created By
</td>
<td
ng-table-header="-$row.booking.pk"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Booking ID") !]'
>
ID
</td>
<td ng-auto-export-only
ng-table-header="-$row.booking.isCancelled"
>
Cancelled?
</td>
<td
ng-table-header="$row.booking.originalCreatedAt"
ng-auto-export-value="[! T('Booking Created At') !]"
>
Created At
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.booking.originalUser.name"
ng-auto-export-value="[! T('Originally Booked By') !]"
>
Booked By <span class="icon-hint" ng-tip="[! T('User who originally created the booking') !]"></span>
</td>
<td
ng-table-header="$row.booking.availability.item.name"
>
Item
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.booking.availability.startAt"
>
Availability
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.booking.contact.name"
>
Contact
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.booking.customerBreakdownShort || $row.booking.customerBreakdown"
>
Pax
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
ng-table-header="$row.booking.costs.totalCost.total"
ng-auto-export-value="[! T('Booking total') !]"
>
Total
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
ng-table-header="isCharterPerspective ? $row.booking.receiptCollectedByCharter.gross : $row.booking.receiptCollectedByAffiliate.gross"
>
Revenue<br>Collected
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.booking.affiliation ? $row.booking.affiliation.affiliateCompany.name : ''"
>
Affiliate
</td>
<td
ng-if="true
&& toggles.state('showFullBooking')
"
ng-table-header="$row.booking.voucherNumber"
>
Voucher
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="payment in $table.collection">
<td
title='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Payment ID") !]'
>
#[! payment.pk !]
</td>
<td
title="[! T('Payment Gross') !]"
>
[! payment.initialReceipt.gross|amount:payment.booking !]
</td>
<td
title="[! T('Payment Processing Fee') !]"
>
[! (-1 * payment.initialReceipt.processingFee)|amount:payment.booking !]
</td>
<td
title="[! T('Payment Net') !]"
>
[! (payment.initialReceipt.gross - payment.initialReceipt.processingFee)|amount:payment.booking !]
</td>
<td
title="[! T('Payment Tax') !]"
>
[! payment.costs.totalCost.tax|amount:payment.booking !]
</td>
<td
title="[! T('Payment Created At') !]"
>
[! payment.createdAt|datetimeWithTimezone:payment.booking.company.timezone !]
</td>
<td
title="[! T('Payment Created By') !]"
>
[! payment.user ? payment.user.name : 'Online' !]
</td>
<td
class="show-links"
title='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Booking ID") !]'
ng-auto-export-value="#[! payment.booking.pk !]"
>
<span class="[! payment.booking.isCancelled ? 'strike' : '' !]"><a ng-href="[! payment.booking|bookingUrl !]">#[! payment.booking.pk !]</a></span>
<span ng-show="payment.booking.isCancelled" class="fh-red"
ng-tip="[! T('Booking is cancelled') !]"
ng-tip-classes="tip-indent"
>&#10008;</span>
</td>
<td ng-auto-export-only
>
[! payment.booking.isCancelled ? T('Cancelled') : T('No') !]
</td>
<td
title="[! T('Booking Created At') !]"
>
[! payment.booking.originalCreatedAt|datetimeWithTimezone:payment.booking.company.timezone !]
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Booked By') !]"
>
[! payment.booking.originalUser ? payment.booking.originalUser.name : T('Online') !]
</td>
<td
title="[! T('Booking Item') !]"
>
[! payment.booking.availability.item|name !]
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Booking Availability') !]"
>
<a ng-href="[! payment.booking.availability|availabilityUrl !]">
[! payment.booking.availability.startAt|datetimeRange:(payment.booking.availability.endAt) !]
</a>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Booking Contact') !]"
>
[! payment.booking.contact.name !]
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Customer Breakdown') !]"
>
[! payment.booking.customerBreakdownShort || payment.booking.customerBreakdown !]
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
title="[! T('Booking Total') !]"
>
[! payment.booking.costs.totalCost.total|amount:payment.booking !]
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
title="[! T('Collected by You') !]"
>
[! (isCharterPerspective ? payment.booking.receiptCollectedByCharter.gross : payment.booking.receiptCollectedByAffiliate.gross )|amount:payment.booking !]
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Booking Affiliate') !]"
>
[! payment.booking.affiliation ? payment.booking.affiliation.affiliateCompany.name : '' !]
</td>
<td
ng-if="true
&& toggles.state('showFullBooking')
"
title="[! T('Booking Voucher') !]"
>
[! payment.booking.voucherNumber !]
</td>
</tr>
</tbody>
<tfoot ng-if="payout.payments.length > 1">
<tr ng-auto-export-skip>
<td
ng-table-summary="1" ng-table-summary-once
>
[! $summary !] rows
</td>
<td
ng-table-summary="$row.initialReceipt.gross" ng-table-summary-once
title="[! T('Total Payments Gross') !]"
>
[[ $summary|amount:company ]]
</td>
<td
ng-table-summary="$row.initialReceipt.processingFee" ng-table-summary-once
title="[! T('Total Payment Processing Fees') !]"
>
[[ (-1 * $summary)|amount:company ]]
</td>
<td
ng-table-summary="$row.initialReceipt.net" ng-table-summary-once
title="[! T('Total Payments Net') !]"
>
[[ $summary|amount:company ]]
</td>
<td
ng-table-summary="$row.costs.totalCost.tax" ng-table-summary-once
title="[! T('Total Tax') !]"
>
[[ $summary|amount:company ]]
</td>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td ng-auto-export-only
>
</td>
<td
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
>
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td
ng-if="true
&& toggles.state('showFullBooking')
"
>
</td>
</tr>
</tfoot>
</table>
</div>
<div ng-if="payout.refunds.length">
<table class="spreadsheet no-wrap highlight-rows" ng-table="payout.refunds" ng-auto-export="report">
<thead>
<tr class="payout-header">
<td colspan="6" class="spanned-header big refunds-header">Refunds</td>
<td colspan="20" class="bookings-header show-links"
ng-auto-export-value="[! T('For Booking') !]"
>
For Booking<br>
<a ng-toggle="showFullBooking">
<span class="hide-when-toggled">+Show more</span>
<span class="show-when-toggled">-Show less</span>
</a>
</td>
</tr>
</thead>
<thead class="ss-header ss-header-shade">
<tr>
<td
ng-table-header="-$row.pk"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Refund ID") !]'
>
ID
</td>
<td
ng-table-header="-$row.receipt.gross"
>
Gross
</td>
<td
ng-table-header="-$row.receipt.processingFee"
>
Fee
</td>
<td
ng-table-header="-1 * ($row.receipt.net)"
>
Net
</td>
<td
ng-table-header="-1 * ($row.costs.totalCost.tax)"
>
Tax
</td>
<td
ng-table-header="$row.createdAt"
ng-table-header-default
>
Created At
</td>
<td
ng-table-header="$row.user.name"
>
Created By
</td>
<td
ng-table-header="-$row.payment.booking.pk"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Booking ID") !]'
>
ID
</td>
<td ng-auto-export-only
ng-table-header="-$row.payment.booking.isCancelled"
>
Cancelled?
</td>
<td
ng-table-header="$row.payment.booking.originalCreatedAt"
ng-auto-export-value="[! T('Booking Created At') !]"
>
Created At
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.payment.booking.originalUser.name"
ng-auto-export-value="[! T('Originally Booked By') !]"
>
Booked By <span class="icon-hint" ng-tip="[! T('User who originally created the booking') !]"></span>
</td>
<td
ng-table-header="$row.payment.booking.availability.item.name"
>
Item
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.payment.booking.availability.startAt"
>
Availability
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.payment.booking.contact.name"
>
Contact
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.payment.booking.customerBreakdownShort || $row.payment.booking.customerBreakdown"
>
Pax
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
ng-table-header="$row.payment.booking.costs.totalCost.total"
ng-auto-export-value="[! T('Booking total') !]"
>
Total
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
ng-table-header="isCharterPerspective ? $row.payment.booking.receiptCollectedByCharter.gross : $row.payment.booking.receiptCollectedByAffiliate.gross"
>
Revenue<br>Collected
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
ng-table-header="$row.payment.booking.affiliation ? $row.payment.booking.affiliation.affiliateCompany.name : ''"
>
Affiliate
</td>
<td
ng-if="true
&& toggles.state('showFullBooking')
"
ng-table-header="$row.payment.booking.voucherNumber"
>
Voucher
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="refund in $table.collection">
<td
title='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Refund ID") !]'
>
#[! refund.pk !]
</td>
<td
title="[! T('Refund Gross') !]"
>
[! (-1 * refund.receipt.gross)|amount:refund.payment.booking !]
</td>
<td
title="[! T('Refund Returned Fee') !]"
>
[! refund.receipt.processingFee|amount:refund.payment.booking !]
</td>
<td
title="[! T('Refund Net') !]"
>
[! (-1 * refund.receipt.net)|amount:refund.payment.booking !]
</td>
<td
title="[! T('Refund Tax') !]"
>
[! (-1 * refund.costs.totalCost.tax)|amount:refund.payment.booking !]
</td>
<td
title="[! T('Refund Created At') !]"
>
[! refund.createdAt|datetimeWithTimezone:refund.payment.booking.company.timezone !]
</td>
<td
title="[! T('Refund Created By') !]"
>
[! refund.user.name !]
</td>
<td
class="show-links"
title='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Booking ID") !]'
ng-auto-export-value="#[! refund.payment.booking.pk !]"
>
<span class="[! refund.payment.booking.isCancelled ? 'strike' : '' !]"><a ng-href="[! refund.payment.booking|bookingUrl !]">#[! refund.payment.booking.pk !]</a></span>
<span ng-show="refund.payment.booking.isCancelled" class="fh-red"
ng-tip="[! T('Booking is cancelled') !]"
ng-tip-classes="tip-indent"
>&#10008;</span>
</td>
<td ng-auto-export-only
>
[! refund.payment.booking.isCancelled ? T('Cancelled') : T('No') !]
</td>
<td
title="[! T('Booking Created At') !]"
>
[! refund.payment.booking.originalCreatedAt|datetimeWithTimezone:refund.payment.booking.company.timezone !]
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Booked By') !]"
>
[! refund.payment.booking.originalUser ? refund.payment.booking.originalUser.name : T('Online') !]
</td>
<td
title="[! T('Booking Item') !]"
>
[! refund.payment.booking.availability.item|name !]
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Booking Availability') !]"
>
<a ng-href="[! refund.payment.booking.availability|availabilityUrl !]">
[! refund.payment.booking.availability.startAt|datetimeRange:(refund.payment.booking.availability.endAt) !]
</a>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Booking Contact') !]"
>
[! refund.payment.booking.contact.name !]
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Customer Breakdown') !]"
>
[! refund.payment.booking.customerBreakdownShort || refund.payment.booking.customerBreakdown !]
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
title="[! T('Booking Total') !]"
>
[! refund.payment.booking.costs.totalCost.total|amount:refund.payment.booking !]
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
title="[! T('Collected by You') !]"
>
[! (isCharterPerspective ? refund.payment.booking.receiptCollectedByCharter.gross : refund.payment.booking.receiptCollectedByAffiliate.gross )|amount:refund.payment.booking !]
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
title="[! T('Booking Affiliate') !]"
>
[! refund.payment.booking.affiliation ? refund.payment.booking.affiliation.affiliateCompany.name : '' !]
</td>
<td
ng-if="true
&& toggles.state('showFullBooking')
"
title="[! T('Booking Voucher') !]"
>
[! refund.payment.booking.voucherNumber !]
</td>
</tr>
</tbody>
<tfoot ng-if="payout.refunds.length > 1">
<tr ng-auto-export-skip>
<td
ng-table-summary="1"
>
[[ $summary ]] rows
</td>
<td
ng-table-summary="$row.receipt.gross"
>
[[ (-1 * $summary)|amount:company ]]
</td>
<td
ng-table-summary="$row.receipt.processingFee"
>
[[ $summary|amount:company ]]
</td>
<td
ng-table-summary="$row.receipt.net"
>
[[ (-1 * $summary)|amount:company ]]
</td>
<td
ng-table-summary="$row.costs.totalCost.tax"
>
[[ (-1 * $summary)|amount:company ]]
</td>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td ng-auto-export-only
>
</td>
<td
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
>
</td>
<td ng-if="canViewAmounts
&& toggles.state('showFullBooking')
"
>
</td>
<td
ng-if="
toggles.state('showFullBooking')
"
>
</td>
<td
ng-if="true
&& toggles.state('showFullBooking')
"
>
</td>
</tr>
</tfoot>
</table>
</div>
</script>
<script type="text/ng-template" id="report-long-load">
<div class="report-long-load"
ng-with="reportPermalink = makePermalink(report)"
>
<p>
<b>Your report is taking a minute to generate.</b> This can happen when you are loading a lot of data or for bookings that you created a while ago.
</p>
<p ng-if="reportPermalink">
You can minimize this window and it will load when it is ready. Or, you can use the link below to come back a little later and view it when it has finished:
</p>
<p ng-else="reportPermalink">
You can minimize this window and it will load when it is ready.
</p>
<input class="field-copy-code" ng-autoselect
ng-if="reportPermalink"
value='https://fareharbor.com[[ reportPermalink ]]' />
</div>
</script>
<script type="text/ng-template" id="dashboard.reports.header">
<div class="report-header">
<div class="report-header-inner"
ng-class="{ 'with-border': !reportDefinition.needsAccountTabs }"
>
<div class="print-header respond-print-show" ng-if="status === 'success'">
<div class="print-header-date">
<b>[[ reportDefinition.displayType ]]</b> &mdash; [! company.name !]
</div>
<p ng-if="!report.isInProgress"
class="print-header-generated"
>
Generated [[ report.modifiedAt|datetime ]]
</p>
</div>
<h1 class="respond-print-hide">
[[ reportDefinition.displayType ]]
<span ng-if="report.options.isDetailed">(detailed)</span>
</h1>
<ul class="report-header-details"
ng-if="!!report.options"
>
<li ng-if="report.options.customField"
class="report-header-details-dark"
>
<b>Custom field:</b> [[ report.options.customField.name ]]
</li>
<li ng-if="report.options.startAt && report.options.endAt">
<span ng-show="report.type === 'payments'">Payments made</span>
<span ng-show="report.type === 'invoice'">Bookings for availabilities on</span>
<span ng-show="report.options.dateType === Report.AVAILABILITY_DATE_TYPE">Bookings for</span>
<span ng-show="report.options.dateType === Report.BOOKING_DATE_TYPE">Bookings created on</span>
<span ng-show="report.options.dateType === Report.DISPUTE_DATE_TYPE">Dispute opened on</span>
<span ng-show="report.options.dateType === Report.PAYMENT_DATE_TYPE">Payments created on</span>
[[ report.options.startAt|dateRange:(report.options.endAt):'long' ]]
</li>
<li ng-if="report.options.disputeStatusFilter">
<b>Dispute status:</b>
<span ng-show="report.options.disputeStatusFilter === Report.ALL_DISPUTE_STATUS_FILTER_OPTION">All</span>
<span ng-show="report.options.disputeStatusFilter === Report.ALL_CLOSED_DISPUTE_STATUS_FILTER_OPTION">All closed</span>
<span ng-show="report.options.disputeStatusFilter === Report.ALL_OPEN_DISPUTE_STATUS_FILTER_OPTION">All open</span>
<span ng-show="Dispute.STATUSES|contains:report.options.disputeStatusFilter">[[ report.options.disputeStatusFilter|capitalize ]]</span>
</li>
<li ng-if="report.options.userTypeFilter">
<b>Report for user that:</b>
<span ng-show="report.options.userTypeFilter === Report.CURRENT_USER_TYPE_FILTER_OPTION">Was last to rebook</span>
<span ng-show="report.options.userTypeFilter === Report.ORIGINAL_USER_TYPE_FILTER_OPTION">Originally booked</span>
</li>
<li ng-if="report.options.cancelledBookingsFilter">
<b>Cancelled bookings:</b>
<span ng-show="report.options.cancelledBookingsFilter === Report.ALL_CANCELLED_BOOKINGS_FILTER_OPTION">Include all cancelled bookings</span>
<span ng-show="report.options.cancelledBookingsFilter === Report.NO_CANCELLED_BOOKINGS_FILTER_OPTION">Don&#039;t include cancelled bookings</span>
<span ng-show="report.options.cancelledBookingsFilter === Report.NON_REFUNDED_CANCELLED_BOOKINGS_FILTER_OPTION">Include non-refunded cancelled bookings</span>
<span ng-show="report.options.cancelledBookingsFilter === Report.ONLY_CANCELLED_BOOKINGS_FILTER_OPTION">Include only cancelled bookings</span>
</li>
<li ng-if="report.options.affiliate">
<b>Affiliate:</b> [[ report.options.affiliate.name ]]
</li>
<li ng-if="report.options.affiliateFilter && report.options.affiliateFilter !== Report.DIRECT_AFFILIATE_FILTER_OPTION">
<b>Affiliate:</b> [[ report.options.affiliateFilter.name || T('All affiliates') ]]
</li>
<li ng-if="report.options.partnerFilter && report.options.partnerFilter !== Report.DIRECT_PARTNER_FILTER_OPTION">
<b>Partner:</b> [[ report.options.partnerFilter.name || T('All partners') ]]
</li>
<li ng-if="report.options.partner">
<b>Partner:</b> [[ report.options.partner.name ]]
</li>
<li ng-if="report.options.itemFilter && report.options.itemFilter !== Report.ALL_ITEM_FILTER_OPTION">
<b>Item:</b> [[ report.options.itemFilter.name ]]
</li>
<li ng-if="report.options.salespersonFilter && report.options.salespersonFilter !== Report.ALL_SALESPERSON_FILTER_OPTION">
<b>Salesperson:</b> [[ report.options.salespersonFilter.name ]]
</li>
<li ng-if="report.options.userFilter && report.options.userFilter !== Report.ALL_USER_FILTER_OPTION">
<b>[[ report.type === 'revenue-summary' ? T('Revenue collected by:') : T('Bookings created by:') ]]</b>
[[ report.options.userFilter.name ? report.options.userFilter.name : T('Online') ]]
</li>
<li ng-if="report.options.referenceAt">
<b>Reference date:</b> [[ report.options.referenceAt|date:'long' ]]
</li>
</ul>
</div>
<ul class="tabs"
ng-if="reportDefinition.needsAccountTabs"
>
<li ng-can-list="Payout on company" ng-can-only-when="company.isAffiliate || company.isCharter">
<a ng-href="[! company.$url(urls.dashboard.reports.payouts.index) !]" ng-navigation-active>Payouts</a>
</li>
<li ng-can-list="Booking on company" ng-can-only-when="company.isAffiliate || company.isCharter">
<a ng-href="[! company.$url(urls.dashboard.reports.escrow.index) !]" ng-navigation-active>Future Payouts</a>
</li>
<li ng-can-list="Transfer on company" ng-can-only-when="company.isCharter">
<a ng-href="[! company.$url(urls.dashboard.reports.accounts.index) !]" ng-navigation-active>
<span ng-if-once="company.isDefaultProcessorUploadsEnabled" ng-then="defaultProcessorUploadsEnabled">
Bank Debits & Transfers
</span>
<span ng-else-once="defaultProcessorUploadsEnabled">
Transfers
</span>
</a>
</li>
</ul>
</div>
<div class="tb-report-generated tb tb--inset-mobile respond-print-hide">
<div class="tb-left">
<div class="tb-group">
<div class="tb-text report-generate"
ng-inline="dashboard.reports.reportProgress"
></div>
</div>
<div class="tb-group"
ng-else="status === 'loading'"
>
<div class="tb-flyout-wrap"
ng-with="reportPermalink = makePermalink(report); includeGoButton = true"
ng-if="reportPermalink"
ng-link="dashboard.reports.shareTools"
></div>
<span ng-auto-exporter="report" ng-auto-exporter-filename="[[ exportFilename() ]]"
class="tb-data"
></span>
<a class="tb-btn"
ng-tip="[! T('Print') !]"
ng-print
ng-if="reportDefinition.needsPrint && report.status === Report.SUCCEEDED_STATUS"
>
<i class="tb-icon print"></i> <abbr>Print</abbr>
</a>
</div>
<div class="tb-group"
ng-if="reportDefinition.helpLink"
>
<a class="tb-btn tb-btn--popup"
ng-href="https://fareharbor.com[[ reportDefinition.helpLink ]]"
ng-outbound-link="_blank"
><i class="tb-icon help"></i> [[ reportDefinition.helpText ? reportDefinition.helpText : T('Learn about this report') ]]</a>
</div>
<div class="tb-group"
ng-navigation-prefix="urls.dashboard.reports.invoices.index"
>
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="invoiceHelp"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="tb-icon help"></i> Learn about invoicing
</div>
<div class="tb-flyout tb-flyout--auto-width-narrow"
ng-toggled="invoiceHelp"
>
<ul class="flyout-menu-items"
ng-toggle="invoiceHelp"
>
<li>
<a ng-href="https://fareharbor.com/help/payments/invoicing/invoices/" ng-outbound-link="_blank">Invoicing overview</a>
</li>
<li>
<a ng-href="https://fareharbor.com/help/payments/invoicing/creating-an-invoice/" ng-outbound-link="_blank">Creating an invoice</a>
</li>
<li>
<a ng-href="https://fareharbor.com/help/payments/invoicing/paying-invoices/" ng-outbound-link="_blank">Paying invoices</a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.reports.reportProgress">
<span ng-if="status === 'loading'" ng-then="reportLoading">
<i class="spinner-ticker-css"><span></span></i> Loading report...
</span>
<span ng-else="reportLoading">
<span ng-if="report.isInProgress" ng-then="generating">
<i class="spinner-ticker-css"><span></span></i> Generating report...&nbsp;
<a ng-click="cancel(report)"
class="report-cancel"
>Cancel</a>
</span>
<span ng-else="generating">
<span ng-if="report.status === Report.SUCCEEDED_STATUS">
<span ng-interval="60">
Report accurate as of [[ (report.modifiedAt|datetime:'relative':'relative-time')|lowercase ]]
</span>
<a ng-click="regenerate()"
class="report-regenerate"
>Refresh</a>
</span>
<span ng-if="report.status === Report.CANCELLED_STATUS">
Report was cancelled
<a ng-click="regenerate()"
class="report-regenerate"
>Restart</a>
</span>
<span ng-if="report.status === Report.FAILED_STATUS">
Report failed
<a ng-click="regenerate()"
class="report-regenerate"
>Retry</a>
</span>
<span ng-if="report.status === Report.NEW_STATUS">
Report failed to start
<a ng-click="regenerate()"
class="report-regenerate"
>Retry</a>
</span>
</span>
</span>
</script>
<script type="text/ng-template" id="reports-loading-status">
<div ng-if="status === 'initial'"
class="report-initial"
>
Set options and click the create button.
</div>
<div ng-if="status === 'loading'"
class="report-generating"
>
<h1>Generating report</h1>
<div class="report-generating-subhead">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Gathering data...
</div>
</div>
</div>
<div ng-if="status === 'processing'"
class="report-generating"
>
<h1>Generating report</h1>
<div class="report-generating-subhead">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Processing...
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="summary-report-table">
<div ng-if="!subreports.length">
No bookings match the filter options
</div>
<div ng-if="subreports.length && !detailView">
<span ng-if="subreports.length > 1" ng-then="multipleSubreports">
<table class="spreadsheet width-auto highlight-rows" ng-table="subreports" ng-auto-export="report">
<thead class="ss-header">
<tr class="ss-header-shade bold" ng-auto-export-skip>
<td colspan="[[ (!itemsOnly ? 1 : 0) + 1 + (needsUseCount ? 1 : 0) + (needsAvailabilityCount ? 1 : 0) ]]"></td>
<td colspan="10" class="bookings-header spanned-header">Booking Sums</td>
</tr>
<tr class="ss-header-shade bold" ng-auto-export-skip>
<td colspan="[! (!itemsOnly ? 1 : 0) + 1 + (needsUseCount ? 1 : 0) + (needsAvailabilityCount ? 1 : 0) + 1 + (needsCustomerCount ? 1 : 0) + (canViewAmounts ? 5 : 0) !]"></td>
<td ng-if="canViewAmounts" colspan="2" class="spanned-header">
Affiliate Invoicing
</td>
<td ng-if="canViewAmounts"></td>
</tr>
<tr class="ss-header-shade bold">
<td ng-if="!itemsOnly"
ng-table-header="$row.elementName" ng-table-header-default
>
[! elementHeader !]
</td>
<td>Item</td>
<td ng-if="needsUseCount"
ng-table-header="$row.summaryRow.useCount"
>
[[ useCountHeader ]]
</td>
<td ng-if="needsAvailabilityCount"
ng-table-header="$row.summaryRow.availabilityCount"
>
Availabilities
</td>
<td ng-table-header="-$row.summaryRow.bookingCount"
ng-tip="[! T('Number of bookings') !]"
ng-tip-classes="tip-indent"
>
<span ng-show="needsAvailabilityCount">Bookings</span>
<span ng-show="needsUseCount">Bookings<br>Used On</span>
<span ng-show="!needsAvailabilityCount && !needsUseCount">#</span>
</td>
<td ng-if="needsCustomerCount"
ng-tip="[! T('Number of customers') !]"
ng-tip-classes="tip-indent"
ng-table-header="$row.summaryRow.customerCount"
>
Pax
</td>
<td ng-if="canViewAmounts"
ng-table-header="$row.summaryRow.price"
>
Subtotal
</td>
<td ng-if="canViewAmounts"
ng-table-header="$row.summaryRow.tax"
>
Tax
</td>
<td ng-if="canViewAmounts"
ng-table-header="$row.summaryRow.total"
>
Total
</td>
<td ng-if="canViewAmounts"
ng-table-header="$row.summaryRow.percentTotalSales"
>
% of Report Sum<br>Booking Totals
</td>
<td ng-if="canViewAmounts"
ng-table-header="isCharterPerspective ? $row.summaryRow.grossCollectedByCharter : $row.summaryRow.grossCollectedByAffiliate"
>
Revenue<br>Collected
</td>
<td ng-if="canViewAmounts"
ng-table-header="$row.summaryRow.invoiceableToCharter"
>
<span ng-if-once="isCharterPerspective">
Receivable<br>from Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Receivable<br>from You
</span>
</td>
<td ng-if="canViewAmounts"
ng-table-header="$row.summaryRow.invoiceableToAffiliate"
>
<span ng-if-once="isCharterPerspective">
Payable<br>to Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Payable<br>to You
</span>
</td>
<td ng-if="canViewAmounts && isCharterPerspective"
ng-table-header="$row.summaryRow.netCharterRevenue"
>
Net<br>Revenue
<span class="icon-hint respond-print-hide"
ng-tip="[! T('Collected payments less credit card processing fees, plus or minus affiliate commissions and invoices') !]"
></span>
</td>
</tr>
</thead>
<tbody ng-repeat="subreport in $table.collection">
<tr ng-repeat="row in subreport.allRows"
ng-class="{ 'tr-bold': $last }"
>
<td ng-if="!itemsOnly">
<b ng-if="$first">[! subreport.elementName|capitalize !]</b>
</td>
<td>
<a ng-if="!$last" ng-href="[! row.item.$url(urls.dashboard.items.item.index) !]">
[! row.item|name !]
</a>
</td>
<td ng-if="needsUseCount">[! row.useCount !]</td>
<td ng-if="needsAvailabilityCount">
<span ng-if="$last">[! row.availabilityCount !]</span>
<a class="form-link"
ng-if="!$last"
ng-click="showDetails(subreport, row, AVAILABILITIES_DETAIL_VIEW)"
>
[! row.availabilityCount !]
</a>
</td>
<td title="[! T('Number of bookings') !]">
<span ng-if="$last">[! row.bookingCount !]</span>
<a class="form-link"
ng-if="!$last"
ng-click="showDetails(subreport, row, BOOKINGS_DETAIL_VIEW)"
>
[! row.bookingCount !]
</a>
</td>
<td ng-if="needsCustomerCount" title="[! T('Sum number of customers on bookings') !]">[! row.customerCount !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking subtotals') !]">[! row.price|amount:currency !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking taxes') !]">[! row.tax|amount:currency !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking totals') !]">[! row.total|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.percentTotalSales|percentageFromPercentage:'hidePlus' !]</td>
<td ng-if="canViewAmounts">[! (isCharterPerspective ? row.grossCollectedByCharter : row.grossCollectedByAffiliate)|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.invoiceableToCharter|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.invoiceableToAffiliate|amount:currency !]</td>
<td ng-if="canViewAmounts && isCharterPerspective">[! row.netCharterRevenue|amount:currency !]</td>
</tr>
<tr ng-if="subreports.length > 1">
<td colspan="100">&nbsp;</td>
</tr>
</tbody>
<tbody ng-if="totalsSubreport">
<tr class="ss-header-shade bold" ng-auto-export-skip>
<td colspan="[[ (!itemsOnly ? 1 : 0) + 1 + (needsUseCount ? 1 : 0) + (needsAvailabilityCount ? 1 : 0) ]]"></td>
<td colspan="10" class="bookings-header spanned-header">Booking Sums</td>
</tr>
<tr class="ss-header-shade bold" ng-auto-export-skip>
<td colspan="[! (!itemsOnly ? 1 : 0) + 1 + (needsUseCount ? 1 : 0) + (needsAvailabilityCount ? 1 : 0) + 1 + (needsCustomerCount ? 1 : 0) + (canViewAmounts ? 5 : 0) !]"></td>
<td ng-if="canViewAmounts" colspan="2" class="spanned-header">
Affiliate Invoicing
</td>
<td ng-if="canViewAmounts"></td>
</tr>
<tr class="ss-header-shade bold">
<td ng-if="!itemsOnly"
>
</td>
<td>Item</td>
<td ng-if="needsUseCount"
>
[[ useCountHeader ]]
</td>
<td ng-if="needsAvailabilityCount"
>
Availabilities
</td>
<td
ng-tip="[! T('Number of bookings') !]"
ng-tip-classes="tip-indent"
>
<span ng-show="needsAvailabilityCount">Bookings</span>
<span ng-show="needsUseCount">Bookings<br>Used On</span>
<span ng-show="!needsAvailabilityCount && !needsUseCount">#</span>
</td>
<td ng-if="needsCustomerCount"
ng-tip="[! T('Number of customers') !]"
ng-tip-classes="tip-indent"
>
Pax
</td>
<td ng-if="canViewAmounts"
>
Subtotal
</td>
<td ng-if="canViewAmounts"
>
Tax
</td>
<td ng-if="canViewAmounts"
>
Total
</td>
<td ng-if="canViewAmounts"
>
% of Report Sum<br>Booking Totals
</td>
<td ng-if="canViewAmounts"
>
Revenue<br>Collected
</td>
<td ng-if="canViewAmounts"
>
<span ng-if-once="isCharterPerspective">
Receivable<br>from Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Receivable<br>from You
</span>
</td>
<td ng-if="canViewAmounts"
>
<span ng-if-once="isCharterPerspective">
Payable<br>to Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Payable<br>to You
</span>
</td>
<td ng-if="canViewAmounts && isCharterPerspective"
>
Net<br>Revenue
<span class="icon-hint respond-print-hide"
ng-tip="[! T('Collected payments less credit card processing fees, plus or minus affiliate commissions and invoices') !]"
></span>
</td>
</tr>
<tr ng-repeat="row in totalsSubreport.allRows"
ng-class="{ 'tr-bold': $last }"
>
<td ng-if="!itemsOnly">
<b ng-if="$first">[! totalsSubreport.elementName|capitalize !]</b>
</td>
<td>
<a ng-if="!$last" ng-href="[! row.item.$url(urls.dashboard.items.item.index) !]">
[! row.item|name !]
</a>
</td>
<td ng-if="needsUseCount">[! row.useCount !]</td>
<td ng-if="needsAvailabilityCount">
<span ng-if="$last">[! row.availabilityCount !]</span>
<a class="form-link"
ng-if="!$last"
ng-click="showDetails(totalsSubreport, row, AVAILABILITIES_DETAIL_VIEW)"
>
[! row.availabilityCount !]
</a>
</td>
<td title="[! T('Number of bookings') !]">
<span ng-if="$last">[! row.bookingCount !]</span>
<a class="form-link"
ng-if="!$last"
ng-click="showDetails(totalsSubreport, row, BOOKINGS_DETAIL_VIEW)"
>
[! row.bookingCount !]
</a>
</td>
<td ng-if="needsCustomerCount" title="[! T('Sum number of customers on bookings') !]">[! row.customerCount !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking subtotals') !]">[! row.price|amount:currency !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking taxes') !]">[! row.tax|amount:currency !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking totals') !]">[! row.total|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.percentTotalSales|percentageFromPercentage:'hidePlus' !]</td>
<td ng-if="canViewAmounts">[! (isCharterPerspective ? row.grossCollectedByCharter : row.grossCollectedByAffiliate)|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.invoiceableToCharter|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.invoiceableToAffiliate|amount:currency !]</td>
<td ng-if="canViewAmounts && isCharterPerspective">[! row.netCharterRevenue|amount:currency !]</td>
</tr>
</tbody>
</table>
</span>
<span ng-else="multipleSubreports">
<table class="spreadsheet width-auto highlight-rows" ng-table="subreports" ng-auto-export="report">
<thead class="ss-header">
<tr class="ss-header-shade bold" ng-auto-export-skip>
<td colspan="[[ (!itemsOnly ? 1 : 0) + 1 + (needsUseCount ? 1 : 0) + (needsAvailabilityCount ? 1 : 0) ]]"></td>
<td colspan="10" class="bookings-header spanned-header">Booking Sums</td>
</tr>
<tr class="ss-header-shade bold" ng-auto-export-skip>
<td colspan="[! (!itemsOnly ? 1 : 0) + 1 + (needsUseCount ? 1 : 0) + (needsAvailabilityCount ? 1 : 0) + 1 + (needsCustomerCount ? 1 : 0) + (canViewAmounts ? 5 : 0) !]"></td>
<td ng-if="canViewAmounts" colspan="2" class="spanned-header">
Affiliate Invoicing
</td>
<td ng-if="canViewAmounts"></td>
</tr>
<tr class="ss-header-shade bold">
<td ng-if="!itemsOnly"
>
[! elementHeader !]
</td>
<td>Item</td>
<td ng-if="needsUseCount"
>
[[ useCountHeader ]]
</td>
<td ng-if="needsAvailabilityCount"
>
Availabilities
</td>
<td
ng-tip="[! T('Number of bookings') !]"
ng-tip-classes="tip-indent"
>
<span ng-show="needsAvailabilityCount">Bookings</span>
<span ng-show="needsUseCount">Bookings<br>Used On</span>
<span ng-show="!needsAvailabilityCount && !needsUseCount">#</span>
</td>
<td ng-if="needsCustomerCount"
ng-tip="[! T('Number of customers') !]"
ng-tip-classes="tip-indent"
>
Pax
</td>
<td ng-if="canViewAmounts"
>
Subtotal
</td>
<td ng-if="canViewAmounts"
>
Tax
</td>
<td ng-if="canViewAmounts"
>
Total
</td>
<td ng-if="canViewAmounts"
>
% of Report Sum<br>Booking Totals
</td>
<td ng-if="canViewAmounts"
>
Revenue<br>Collected
</td>
<td ng-if="canViewAmounts"
>
<span ng-if-once="isCharterPerspective">
Receivable<br>from Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Receivable<br>from You
</span>
</td>
<td ng-if="canViewAmounts"
>
<span ng-if-once="isCharterPerspective">
Payable<br>to Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Payable<br>to You
</span>
</td>
<td ng-if="canViewAmounts && isCharterPerspective"
>
Net<br>Revenue
<span class="icon-hint respond-print-hide"
ng-tip="[! T('Collected payments less credit card processing fees, plus or minus affiliate commissions and invoices') !]"
></span>
</td>
</tr>
</thead>
<tbody ng-repeat="subreport in $table.collection">
<tr ng-repeat="row in subreport.allRows"
ng-class="{ 'tr-bold': $last }"
>
<td ng-if="!itemsOnly">
<b ng-if="$first">[! subreport.elementName|capitalize !]</b>
</td>
<td>
<a ng-if="!$last" ng-href="[! row.item.$url(urls.dashboard.items.item.index) !]">
[! row.item|name !]
</a>
</td>
<td ng-if="needsUseCount">[! row.useCount !]</td>
<td ng-if="needsAvailabilityCount">
<span ng-if="$last">[! row.availabilityCount !]</span>
<a class="form-link"
ng-if="!$last"
ng-click="showDetails(subreport, row, AVAILABILITIES_DETAIL_VIEW)"
>
[! row.availabilityCount !]
</a>
</td>
<td title="[! T('Number of bookings') !]">
<span ng-if="$last">[! row.bookingCount !]</span>
<a class="form-link"
ng-if="!$last"
ng-click="showDetails(subreport, row, BOOKINGS_DETAIL_VIEW)"
>
[! row.bookingCount !]
</a>
</td>
<td ng-if="needsCustomerCount" title="[! T('Sum number of customers on bookings') !]">[! row.customerCount !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking subtotals') !]">[! row.price|amount:currency !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking taxes') !]">[! row.tax|amount:currency !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking totals') !]">[! row.total|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.percentTotalSales|percentageFromPercentage:'hidePlus' !]</td>
<td ng-if="canViewAmounts">[! (isCharterPerspective ? row.grossCollectedByCharter : row.grossCollectedByAffiliate)|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.invoiceableToCharter|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.invoiceableToAffiliate|amount:currency !]</td>
<td ng-if="canViewAmounts && isCharterPerspective">[! row.netCharterRevenue|amount:currency !]</td>
</tr>
<tr ng-if="subreports.length > 1">
<td colspan="100">&nbsp;</td>
</tr>
</tbody>
<tbody ng-if="totalsSubreport">
<tr class="ss-header-shade bold" ng-auto-export-skip>
<td colspan="[[ (!itemsOnly ? 1 : 0) + 1 + (needsUseCount ? 1 : 0) + (needsAvailabilityCount ? 1 : 0) ]]"></td>
<td colspan="10" class="bookings-header spanned-header">Booking Sums</td>
</tr>
<tr class="ss-header-shade bold" ng-auto-export-skip>
<td colspan="[! (!itemsOnly ? 1 : 0) + 1 + (needsUseCount ? 1 : 0) + (needsAvailabilityCount ? 1 : 0) + 1 + (needsCustomerCount ? 1 : 0) + (canViewAmounts ? 5 : 0) !]"></td>
<td ng-if="canViewAmounts" colspan="2" class="spanned-header">
Affiliate Invoicing
</td>
<td ng-if="canViewAmounts"></td>
</tr>
<tr class="ss-header-shade bold">
<td ng-if="!itemsOnly"
>
</td>
<td>Item</td>
<td ng-if="needsUseCount"
>
[[ useCountHeader ]]
</td>
<td ng-if="needsAvailabilityCount"
>
Availabilities
</td>
<td
ng-tip="[! T('Number of bookings') !]"
ng-tip-classes="tip-indent"
>
<span ng-show="needsAvailabilityCount">Bookings</span>
<span ng-show="needsUseCount">Bookings<br>Used On</span>
<span ng-show="!needsAvailabilityCount && !needsUseCount">#</span>
</td>
<td ng-if="needsCustomerCount"
ng-tip="[! T('Number of customers') !]"
ng-tip-classes="tip-indent"
>
Pax
</td>
<td ng-if="canViewAmounts"
>
Subtotal
</td>
<td ng-if="canViewAmounts"
>
Tax
</td>
<td ng-if="canViewAmounts"
>
Total
</td>
<td ng-if="canViewAmounts"
>
% of Report Sum<br>Booking Totals
</td>
<td ng-if="canViewAmounts"
>
Revenue<br>Collected
</td>
<td ng-if="canViewAmounts"
>
<span ng-if-once="isCharterPerspective">
Receivable<br>from Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Receivable<br>from You
</span>
</td>
<td ng-if="canViewAmounts"
>
<span ng-if-once="isCharterPerspective">
Payable<br>to Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Payable<br>to You
</span>
</td>
<td ng-if="canViewAmounts && isCharterPerspective"
>
Net<br>Revenue
<span class="icon-hint respond-print-hide"
ng-tip="[! T('Collected payments less credit card processing fees, plus or minus affiliate commissions and invoices') !]"
></span>
</td>
</tr>
<tr ng-repeat="row in totalsSubreport.allRows"
ng-class="{ 'tr-bold': $last }"
>
<td ng-if="!itemsOnly">
<b ng-if="$first">[! totalsSubreport.elementName|capitalize !]</b>
</td>
<td>
<a ng-if="!$last" ng-href="[! row.item.$url(urls.dashboard.items.item.index) !]">
[! row.item|name !]
</a>
</td>
<td ng-if="needsUseCount">[! row.useCount !]</td>
<td ng-if="needsAvailabilityCount">
<span ng-if="$last">[! row.availabilityCount !]</span>
<a class="form-link"
ng-if="!$last"
ng-click="showDetails(totalsSubreport, row, AVAILABILITIES_DETAIL_VIEW)"
>
[! row.availabilityCount !]
</a>
</td>
<td title="[! T('Number of bookings') !]">
<span ng-if="$last">[! row.bookingCount !]</span>
<a class="form-link"
ng-if="!$last"
ng-click="showDetails(totalsSubreport, row, BOOKINGS_DETAIL_VIEW)"
>
[! row.bookingCount !]
</a>
</td>
<td ng-if="needsCustomerCount" title="[! T('Sum number of customers on bookings') !]">[! row.customerCount !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking subtotals') !]">[! row.price|amount:currency !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking taxes') !]">[! row.tax|amount:currency !]</td>
<td ng-if="canViewAmounts" title="[! T('Sum booking totals') !]">[! row.total|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.percentTotalSales|percentageFromPercentage:'hidePlus' !]</td>
<td ng-if="canViewAmounts">[! (isCharterPerspective ? row.grossCollectedByCharter : row.grossCollectedByAffiliate)|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.invoiceableToCharter|amount:currency !]</td>
<td ng-if="canViewAmounts">[! row.invoiceableToAffiliate|amount:currency !]</td>
<td ng-if="canViewAmounts && isCharterPerspective">[! row.netCharterRevenue|amount:currency !]</td>
</tr>
</tbody>
</table>
</span>
</div>
<div ng-if="detailView === AVAILABILITIES_DETAIL_VIEW">
<div class="summary-report-back respond-print-hide">
<a ng-click="showSummary()" class="btn-back">Back</a>
</div>
<div ng-if="!itemsOnly && selectedSubreport !== totalsSubreport">
<b>[! elementHeader !]:</b>
[! selectedSubreport.elementName|capitalize !]
</div>
<div>
<b>Item:</b> [! selectedRow.item|name !]
</div>
<table class="spreadsheet width-auto" ng-table="selectedRow.availabilities" ng-auto-export="report">
<thead class="ss-header sticky--db">
<tr class="ss-header-shade">
<td ng-table-header="$row.startAt">
Availability
</td>
<td ng-table-header="$row.capacity">
Capacity
</td>
<td ng-table-header="$row.headline">
Headline
</td>
<td ng-table-header="$row.headlinePrivate">
Private headline
</td>
<td ng-auto-export-skip></td>
</tr>
</thead>
<tbody>
<tr ng-repeat="availability in $table.collection">
<td>
[! availability.startAt|datetimeRange:(availability.endAt) !]
</td>
<td>[! availability.capacity !]</td>
<td>[! availability.headline !]</td>
<td>[! availability.headlinePrivate !]</td>
<td ng-auto-export-skip>
<a ng-href="[! availability|availabilityUrl !]" class="form-link">View &raquo;</a>
</td>
</tr>
</tbody>
</table>
</div>
<div ng-if="detailView === BOOKINGS_DETAIL_VIEW">
<div class="summary-report-back respond-print-hide">
<a ng-click="showSummary()" class="btn-back">Back</a>
</div>
<div ng-if="!itemsOnly && selectedSubreport !== totalsSubreport">
<b>[! elementHeader !]:</b>
[! selectedSubreport.elementName|capitalize !]
</div>
<div>
<b>Item:</b> [! selectedRow.item|name !]
</div>
<div ng-if="selectedRow.dailyAggregates.length > 1"
class="summary-detail-view-charts"
>
<ul class="list-filters list-filters--with-spacing">
<li ng-toggle="bookingsGraph"
ng-toggle-group="dailyGraphs"
ng-toggle-default="true"
>Bookings</li>
<li ng-toggle="customersGraph"
ng-toggle-group="dailyGraphs"
>Customers</li>
<li ng-toggle="dailyTable"
ng-toggle-group="dailyGraphs"
>Table</li>
</ul>
<div
ng-toggled-show
ng-toggled-show-value="showName"
ng-link="count-line-graph"
ng-init="title = T('Bookings'); showName = 'bookingsGraph';
lineGraph = selectedRow.dailyAggregates; lineGraphOptions = 'bookingCount';"
>
</div>
<div
ng-toggled-show
ng-toggled-show-value="showName"
ng-link="count-line-graph"
ng-init="title = T('Customers'); showName = 'customersGraph';
lineGraph = selectedRow.dailyAggregates; lineGraphOptions = 'customerCount';"
>
</div>
<table ng-toggled-show="dailyTable" class="spreadsheet width-auto highlight-rows" ng-table="selectedRow.dailyAggregates"
ng-auto-export="report"
>
<thead class="ss-header">
<tr class="ss-header-shade">
<td>
Date
</td>
<td>
Bookings
</td>
<td>
Customers
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="day in $table.collection">
<td>[! day.at|date !]</td>
<td>[! day.bookingCount !]</td>
<td>[! day.customerCount !]</td>
</tr>
</tbody>
<tfoot>
<tr ng-auto-export-skip>
<td></td>
<td ng-table-summary="$row.bookingCount">
[[ $summary ]]
</td>
<td ng-table-summary="$row.customerCount">
[[ $summary ]]
</td>
</tr>
</tfoot>
</table>
</div>
<table class="spreadsheet width-auto nowrap highlight-rows" ng-table="selectedRow.bookings"
ng-auto-export="report"
>
<thead>
<tr ng-auto-export-skip>
<td class="bookings-header"
colspan="100"
>
Bookings
</td>
</tr>
</thead>
<thead class="ss-header sticky--reports">
<tr class="ss-header-shade">
<td
ng-table-header="-$row.pk"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Booking ID") !]'
>
ID
</td>
<td ng-auto-export-only
ng-table-header="-$row.isCancelled"
>
Cancelled?
</td>
<td
ng-table-header="$row.originalCreatedAt"
ng-auto-export-value="[! T('Booking Created At') !]"
>
Created At
</td>
<td
ng-table-header="$row.originalUser.name"
ng-auto-export-value="[! T('Originally Booked By') !]"
>
Booked By <span class="icon-hint" ng-tip="[! T('User who originally created the booking') !]"></span>
</td>
<td
ng-table-header="$row.availability.startAt"
>
Availability
</td>
<td
ng-table-header="$row.contact.name"
>
Contact
</td>
<td
ng-auto-export-only
ng-table-header="$row.contact.phone"
>
Phone
</td>
<td
ng-auto-export-only
ng-table-header="$row.contact.email"
>
Email
</td>
<td
ng-table-header="$row.customerCount"
>
Pax
</td>
<td ng-if="canViewAmounts
"
ng-table-header="$row.costs.totalCost.price"
>
Subtotal
</td>
<td ng-if="canViewAmounts
"
ng-table-header="$row.costs.totalCost.tax"
>
Tax
</td>
<td ng-if="canViewAmounts
"
ng-table-header="$row.costs.totalCost.total"
ng-auto-export-value="[! T('Booking total') !]"
>
Total
</td>
<td ng-if="canViewAmounts
"
ng-table-header="isCharterPerspective ? $row.receiptCollectedByCharter.gross : $row.receiptCollectedByAffiliate.gross"
>
Revenue<br>Collected
</td>
<td
ng-table-header="$row.affiliation ? $row.affiliation.affiliateCompany.name : ''"
>
Affiliate
</td>
<td
ng-table-header="$row.voucherNumber"
>
Voucher
</td>
<td ng-if="canViewAmounts
"
ng-table-header="$row.invoiceableToCharter"
>
<span ng-if-once="isCharterPerspective">Receivable<br>from affiliate</span>
<span ng-else-once="isCharterPerspective">Receivable<br>from you</span>
</td>
<td ng-if="canViewAmounts
"
ng-table-header="$row.invoiceableToAffiliate"
>
<span ng-if-once="isCharterPerspective">
Payable<br>to Affiliate
</span>
<span ng-else-once="isCharterPerspective">
Payable<br>to You
</span>
</td>
<td ng-if="canViewAmounts"
ng-table-header="$row.netCharterRevenue"
>
Net<br>revenue
<span class="icon-hint respond-print-hide"
ng-tip="[! T('Collected payments less credit card processing fees, plus or minus affiliate commissions and invoices') !]"
></span>
</td>
</tr>
</thead>
<tbody>
<tr ng-repeat="booking in $table.collection">
<td
class="show-links"
title='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Booking ID") !]'
ng-auto-export-value="#[! booking.pk !]"
>
<span class="[! booking.isCancelled ? 'strike' : '' !]"><a ng-href="[! booking|bookingUrl !]">#[! booking.pk !]</a></span>
<span ng-show="booking.isCancelled" class="fh-red"
ng-tip="[! T('Booking is cancelled') !]"
ng-tip-classes="tip-indent"
>&#10008;</span>
</td>
<td ng-auto-export-only
>
[! booking.isCancelled ? T('Cancelled') : T('No') !]
</td>
<td
title="[! T('Booking Created At') !]"
>
[! booking.originalCreatedAt|datetimeWithTimezone:booking.company.timezone !]
</td>
<td
title="[! T('Booked By') !]"
>
[! booking.originalUser ? booking.originalUser.name : T('Online') !]
</td>
<td
title="[! T('Booking Availability') !]"
>
<a ng-href="[! booking.availability|availabilityUrl !]">
[! booking.availability.startAt|datetimeRange:(booking.availability.endAt) !]
</a>
</td>
<td
title="[! T('Booking Contact') !]"
>
[! booking.contact.name !]
</td>
<td
ng-auto-export-only
title="[! T('Booking Phone') !]"
>
[! booking.contact|contactPhone !]
</td>
<td
ng-auto-export-only
title="[! T('Booking Email') !]"
>
[! booking.contact.email !]
</td>
<td
title="[! T('Booking Customer Count') !]"
>
[! booking.customerCount !]
</td>
<td ng-if="canViewAmounts
"
title="[! T('Subtotal') !]"
>
[! booking.costs.totalCost.price|amount:booking !]
</td>
<td ng-if="canViewAmounts
"
title="[! T('Tax') !]"
>
[! booking.costs.totalCost.tax|amount:booking !]
</td>
<td ng-if="canViewAmounts
"
title="[! T('Booking Total') !]"
>
[! booking.costs.totalCost.total|amount:booking !]
</td>
<td ng-if="canViewAmounts
"
title="[! T('Collected by You') !]"
>
[! (isCharterPerspective ? booking.receiptCollectedByCharter.gross : booking.receiptCollectedByAffiliate.gross )|amount:booking !]
</td>
<td
title="[! T('Booking Affiliate') !]"
>
[! booking.affiliation ? booking.affiliation.affiliateCompany.name : '' !]
</td>
<td
title="[! T('Booking Voucher') !]"
>
[! booking.voucherNumber !]
</td>
<td ng-if="canViewAmounts
"
title="[! isCharterPerspective ? T('Due from affiliate') : T('Due from You') !]"
>
[! booking.invoiceableToCharter|amount:booking !]
</td>
<td ng-if="canViewAmounts
"
title="[! isCharterPerspective ? T('Owed to affiliate') : T('Owed to you') !]"
>
[! booking.invoiceableToAffiliate|amount:booking !]
</td>
<td ng-if="canViewAmounts"
title="[! T('Net Revenue') !]"
>
[! booking.netCharterRevenue|amount:booking !]
</td>
</tr>
</tbody>
<tfoot ng-if="$table.collection.length > 1">
<tr ng-auto-export-skip>
<td
>
</td>
<td ng-auto-export-only
>
</td>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td
ng-auto-export-only
>
</td>
<td
ng-auto-export-only
>
</td>
<td
title="[! T('Total Number of Customers') !]"
ng-table-summary="$row.customerCount"
>
[[ $summary ]]
</td>
<td ng-if="canViewAmounts
"
title="[! T('Total Bookings Subtotal') !]"
ng-table-summary="$row.costs.totalCost.price"
>
[[ $summary|amount:currency ]]
</td>
<td ng-if="canViewAmounts
"
title="[! T('Total Bookings Tax') !]"
ng-table-summary="$row.costs.totalCost.tax"
>
[[ $summary|amount:currency ]]
</td>
<td ng-if="canViewAmounts
"
title="[! T('Bookings Total') !]"
ng-table-summary="$row.costs.totalCost.total"
>
[[ $summary|amount:currency ]]
</td>
<td ng-if="canViewAmounts
"
ng-table-summary="isCharterPerspective ? $row.receiptCollectedByCharter.gross : $row.receiptCollectedByAffiliate.gross"
title="[! T('Total Collected by You') !]"
>
[! $summary|amount:currency !]
</td>
<td
>
</td>
<td
>
</td>
<td ng-if="canViewAmounts
"
ng-table-summary="$row.invoiceableToCharter"
title="[! isCharterPerspective ? T('Total due from affiliate') : T('Total Due from You') !]"
>
[! $summary|amount:currency !]
</td>
<td ng-if="canViewAmounts
"
ng-table-summary="$row.invoiceableToAffiliate"
title="[! isCharterPerspective ? T('Total Owed to Affiliate') : T('Total Owed to You') !]"
>
[! $summary|amount:currency !]
</td>
<td ng-if="canViewAmounts"
ng-table-summary="$row.netCharterRevenue"
title="[! T('Total Net Revenue') !]"
>
[! $summary|amount:currency !]
</td>
</tr>
</tfoot>
</table>
</div>
</script>
<script type="text/ng-template" id="dashboard.reports.shareTools">
<div class="tb-btn tb-btn--flyout"
ng-toggle="reportLinkMenu"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="tb-icon share"></i> Share
</div>
<div class="tb-flyout"
ng-toggled="reportLinkMenu"
>
<div class="flyout-section">
<h2>Use this link to share or come back to this report with all the same options:</h2>
<div class="table full-width valign-middle flyout-copy-link">
<div class="tr">
<div class="td">
<input class="field-copy-code" ng-autoselect
value='https://fareharbor.com[[ reportPermalink ]]'
/>
</div>
<div class="td" ng-if="includeGoButton">
<a class="btn-tiny btn-green" ng-href="[[ reportPermalink ]]"
ng-toggle="reportLinkMenu"
>Go</a>
</div>
</div>
</div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'reportLinkMenu'"></div>
</div>
</script>
<script type="text/ng-template" id="count-line-graph">
<div
ng-toggled-show
ng-toggled-show-value="showName"
ng-line-graph="lineGraph"
ng-line-graph-options="lineGraphOptions"
>
<span name="title">[[ title ]]</span>
<span name="subTitle">
[[ showName === 'onlineBookingsGraph' || showName === 'volumeBookings' ?
interpolate(nT('%(count)s online booking', '%(count)s online bookings', graph.total), { count: (graph.total|number) }) : ''
]]
[[ showName === 'directBookingsGraph' ?
interpolate(nT('%(count)s direct booking', '%(count)s direct bookings', graph.total), { count: (graph.total|number) }) : ''
]]
[[ showName === 'affiliateBookingsGraph' ?
interpolate(nT('%(count)s affiliate booking', '%(count)s affiliate bookings', graph.total), { count: (graph.total|number) }) : ''
]]
[[ showName === 'affiliateOnlineBookingsGraph' ?
interpolate(ncT('ASN is acronym of "Affiliate Sales Network"', '%(count)s ASN booking', '%(count)s ASN bookings', graph.total), { count: (graph.total|number) }) : ''
]]
[[ showName === 'callCenterBookingsGraph' ?
interpolate(nT('%(count)s call center booking', '%(count)s call center bookings', graph.total), { count: (graph.total|number) }) : ''
]]
[[ showName === 'bookingGraph' ?
interpolate(nT('%(count)s booking', '%(count)s bookings', graph.total), { count: (graph.total|number) }) : ''
]]
[[ showName === 'customersGraph' ?
interpolate(nT('%(count)s customer', '%(count)s customers', graph.total), { count: (graph.total|number) }) : ''
]]
[[ showName === 'volumeInvoices' ?
interpolate(nT('%(count)s invoice payment', '%(count)s invoice payments', graph.total), { count: (graph.total|number) }) : ''
]]
</span>
<span name="tip">
[[ (d.startAt|date) ]] [[ d.startAt != d.endAt ? ' &mdash; ' + (d.endAt|date) : '' ]]
&lt;br /&gt;
[[ showName === 'onlineBookingsGraph' || showName === 'volumeBookings' ?
interpolate(nT('%(count)s online booking', '%(count)s online bookings', d.value), { count: (d.value|number) }) : ''
]]
[[ showName === 'directBookingsGraph' ?
interpolate(nT('%(count)s direct booking', '%(count)s direct bookings', d.value), { count: (d.value|number) }) : ''
]]
[[ showName === 'affiliateBookingsGraph' ?
interpolate(nT('%(count)s affiliate booking', '%(count)s affiliate bookings', d.value), { count: (d.value|number) }) : ''
]]
[[ showName === 'affiliateOnlineBookingsGraph' ?
interpolate(ncT('ASN is acronym of "Affiliate Sales Network"', '%(count)s ASN booking', '%(count)s ASN bookings', d.value), { count: (d.value|number) }) : ''
]]
[[ showName === 'callCenterBookingsGraph' ?
interpolate(nT('%(count)s call center booking', '%(count)s call center bookings', d.value), { count: (d.value|number) }) : ''
]]
[[ showName === 'bookingGraph' ?
interpolate(nT('%(count)s booking', '%(count)s bookings', d.value), { count: (d.value|number) }) : ''
]]
[[ showName === 'customersGraph' ?
interpolate(nT('%(count)s customer', '%(count)s customers', d.value), { count: (d.value|number) }) : ''
]]
[[ showName === 'volumeInvoices' ?
interpolate(nT('%(count)s invoice payment', '%(count)s invoice payments', d.value), { count: (d.value|number) }) : ''
]]
</span>
</span>
<span name="format">[[ value|number ]]</span>
</div>
</script>
<script type="text/ng-template" id="dashboard.reports.advanced.navigation">
<div class="tb tb--shaded tb--inset-mobile">
<div class="tb-left">
<div class="tb-group respond-handhelds-hide">
<div class="tb-btn"
ng-toggle="showReportsNav"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="tb-icon hamburger"></i>
Report type
</div>
</div>
<div class="tb-group">
<a class="tb-btn tb-btn--popup"
ng-href="https://fareharbor.com/help/reporting/advanced-reports"
ng-outbound-link="_blank"
><i class="tb-icon help"></i> Advanced reports help</a>
</div>
<div class="tb-group">
<div class="tb-flyout-wrap"
ng-controller="dashboard.reports.SuggestedReportsCtrl"
>
<div class="tb-btn tb-btn--flyout tb-collapse-on-mobile"
ng-toggle="suggestedReportsList"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<span class="respond-handhelds-show">
<i class="tb-icon hamburger "></i>
</span>
Suggested reports
</div>
<div ng-toggled-show="suggestedReportsList"
class="tb-flyout"
ng-toggled-action="currentSuggestedReport.refresh(newReport)"
>
<ul class="flyout-menu-items flyout-scrollable"
ng-style="{ 'max-height': dimensions.height - 100 }"
>
<li ng-repeat="suggestedReport in suggestedReports"
ng-class="{ 'flyout-menu-item--is-tall': suggestedReport.slug === 'default' }"
>
<a ng-href="[! SuggestedReport.url(suggestedReport, company) !]"
ng-toggle="suggestedReportsList"
ng-class="{ 'current': currentSuggestedReport.is(suggestedReport) }"
>
<span ng-if="suggestedReport.slug === 'default'" ng-then="isDefault">
<i class="tb-icon plus"></i>
New [! Report.MODELS[reportModel.cls].name !] report
</span>
<span ng-else="isDefault">
[! suggestedReport.name !]
<span class="flyout-menu-item-note"
ng-if="suggestedReport.note"
>
[! suggestedReport.note !]
</span>
</span>
</a>
</li>
<li class="flyout-menu-items-empty"
ng-hide="suggestedReports.length"
>No suggested reports</li>
</ul>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'suggestedReportsList'"></div>
</div>
</div>
<div ng-controller=
"dashboard.reports.CustomReportsCtrl"
class="[[ dataCtrl.status|css ]]
tb-data
"
>
<div ng-if="dataCtrl.status === 'loading'">
<div class="tb-loading">
<i class="spinner-ticker-css"><span></span></i>
</div>
</div>
<div ng-if="dataCtrl.status === 'success'"
>
<div
ng-can-list="CustomReport on company"
ng-then="allowed">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout tb-collapse-on-mobile"
ng-toggle="customReportsList"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<span class="respond-handhelds-show">
<i class="tb-icon hamburger "></i>
</span>
Saved reports
</div>
<div ng-toggled-show="customReportsList"
class="tb-flyout"
ng-toggled-action="currentCustomReport.refresh(newReport)"
>
<ul class="flyout-presets flyout-presets--sortable flyout-scrollable"
ng-sortable="listCtrl.reorder"
ng-style="{ 'max-height': dimensions.height - 275 }"
>
<li ng-repeat="customReport in customReports"
ng-sortable-item="customReport"
>
<span class="sortable-handle small"
ng-tip="[! T('Drag to reorder') !]"
ng-tip-classes="tip-indent"
ng-can-update="customReport"
ng-can-only-when="customReports.length > 0"
></span>
<div ng-controller=
"dashboard.shared.CustomReportEditableCtrl"
class="" >
<div
ng-can-view="customReport"
ng-then="allowed">
<form class="flyout-preset-edit-form"
name="customReportForm"
ng-submit="editCtrl.submit(customReportForm)"
ng-can-update="customReport"
ng-can-only-when="editCtrl.editing"
ng-then="editing"
>
<div class="fields "
>
<div class="customreportform-name "
ng-django-field="customReportForm [&#39;name&#39;]" ng-django-field-model="editableCustomReport [&#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="editableCustomReport [&#39;name&#39;]" ng-placeholder="Report name" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customReportForm [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="customreportform-note "
ng-django-field="customReportForm [&#39;note&#39;]" ng-django-field-model="editableCustomReport [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" maxlength="1024" name="note" ng-model="editableCustomReport [&#39;note&#39;]" ng-placeholder="Note" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customReportForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="customreportform-overwriteoptions field-cb "
ng-django-field="customReportForm [&#39;overwriteOptions&#39;]" ng-django-field-model="editableCustomReport [&#39;overwriteOptions&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_overwrite_options" name="overwriteOptions" ng-checkbox-madness="true" ng-model="editableCustomReport [&#39;overwriteOptions&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Update to current settings on save
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customReportForm [&#39;overwriteOptions&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
<div class="customreportform-options "
ng-django-field="customReportForm [&#39;options&#39;]" ng-django-field-model="editableCustomReport [&#39;options&#39;]"
>
<label >
<span class="label-text">
Options
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_options" name="options" ng-model="editableCustomReport [&#39;options&#39;]" type="hidden" value="{}" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customReportForm [&#39;options&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in customReportForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns btns--reversed">
<button class="btn-tiny btn-green btn-right" type="submit"
ng-disabled="customReportForm.$invalid || customReportForm.$submitting || customReportForm.$pristine"
>
[[ customReportForm.$submitting ? T('Saving...') : T('Save') ]]
</button>
<button class="btn-tiny btn-grey" type="button"
ng-if="!customReportForm.$submitting"
ng-click="editCtrl.cancel(customReportForm)"
>
Cancel
</button>
<div class="btn-wrap--right" ng-generic-form="removeCustomReportForm">
<ul class="errors"
ng-if="removeCustomReportForm.all.$error.$server"
>
<li ng-repeat="error in removeCustomReportForm.all.$error.$server">
[[ error ]]
</li>
</ul>
<button class="btn-tiny btn-red" type="button"
ng-can-remove="customReport"
ng-click="editCtrl.remove(removeCustomReportForm)"
ng-confirm-click="[! interpolate(T('Are you sure you want to delete %(customReportName)s?'), { customReportName: customReport.name }) !]"
ng-disabled="removeCustomReportForm.$submitting"
>
[[ removeCustomReportForm.$submitting ? T('Deleting...') : T('Delete') ]]
</button>
</div>
</div>
</form>
<div ng-else="editing">
<a class="flyout-preset-apply can-wrap [! auth.permissions.canUpdate(customReport) ? 'is-editable' : '' !]"
ng-class="{ 'is-active': currentCustomReport.is(customReport) }"
ng-href="[! CustomReport.url(customReport) !]"
ng-toggle="customReportsList"
>
[! customReport.name !]
<span class="flyout-preset-note"
ng-if="customReport.note"
>
[! customReport.note !]
</span>
</a>
<a ng-click="editCtrl.edit()"
ng-can-update="customReport"
class="flyout-preset-edit-btn"
><span>Edit</span></a>
</div>
</div>
<div ng-else="allowed">
<div ng-link="forbidden"></div>
</div>
</div>
</li>
<li class="flyout-presets-empty"
ng-hide="customReports.length"
>No saved reports</li>
</ul>
<div ng-can-create="CustomReport on company">
<div class="flyout-create-form-toggle shaded"
ng-if="!listCtrl.adding"
ng-click="listCtrl.add()"
>New saved report</div>
<form class="flyout-create-form shaded"
name="customReportForm"
ng-if="listCtrl.adding"
ng-submit="listCtrl.submit(customReportForm)"
>
<div class="flyout-create-form-header">
Save your current filter and display options as a new saved report:
</div>
<div class="fields "
>
<div class="customreportform-name "
ng-django-field="customReportForm [&#39;name&#39;]" ng-django-field-model="newCustomReport [&#39;name&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="newCustomReport [&#39;name&#39;]" ng-placeholder="Report name" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customReportForm [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="customreportform-note "
ng-django-field="customReportForm [&#39;note&#39;]" ng-django-field-model="newCustomReport [&#39;note&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_note" maxlength="1024" name="note" ng-model="newCustomReport [&#39;note&#39;]" ng-placeholder="Note" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customReportForm [&#39;note&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="hide">
<div class="customreportform-options "
ng-django-field="customReportForm [&#39;options&#39;]" ng-django-field-model="newCustomReport [&#39;options&#39;]"
>
<label >
<span class="label-text">
Options
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_options" name="options" ng-model="newCustomReport [&#39;options&#39;]" type="hidden" value="{}" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customReportForm [&#39;options&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in customReportForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<button class="btn-tiny btn-green"
type="submit"
ng-disabled="customReportForm.$invalid || customReportForm.$submitting || customReportForm.$pristine"
>
[[ customReportForm.$submitting ? T('Creating...') : T('Create') ]]
</button>
</form>
<div class="flyout-section">
<div class="hint">
<a ng-href="https://fareharbor.com/help/reporting/advanced-reports/saving/" ng-outbound-link="_blank"
class="hint-help-link"
>How to save a report</a>
</div>
</div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'customReportsList'"></div>
</div>
</div>
</div>
<div ng-else="allowed">
</div>
</div>
<div ng-if="dataCtrl.status === 'error'">
</div>
<div ng-if="dataCtrl.status === 'not-found'">
<div ng-link="404"></div>
</div>
<div ng-if="dataCtrl.status === 'disconnect'">
</div>
<div ng-if="dataCtrl.status === 'forbidden'">
</div>
</div>
</div>
<div class="tb-group"
ng-controller="dashboard.reports.ReportShareCtrl"
>
<div class="tb-flyout-wrap"
ng-if="makeShareLink()"
ng-with="reportPermalink = makeShareLink()"
ng-link="dashboard.reports.shareTools"
></div>
<span class="respond-handhelds-hide tb-data"
ng-auto-exporter="report"
ng-auto-exporter-filename="[[ exportFilename() ]]"
></span>
<a class="tb-btn respond-handhelds-hide"
ng-tip="[! T('Print') !]"
ng-print
ng-if="report"
>
<i class="tb-icon print"></i> <abbr>Print</abbr>
</a>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.reports.advanced.sidebar">
<div ng-controller="dashboard.reports.SidebarCtrl">
<div class="settings-nav-mobile-close"
ng-toggle ng-toggle-value="'advancedSidebar-' + model.cls"
ng-toggle-group="secondarySettingsNav"
ng-toggle-group-closeable
>
<i class="tb-icon back"></i> Back
</div>
<a ng-href="[! SuggestedReport.url(suggestedReports[0], company) !]"
ng-click="toggles.toggle('showReportsNav', false)"
class="report-without-presets"
>
New [! reportModelName !] report</a>
<div class="switch-report-model"
ng-navigation-prefix="urls.dashboard.reports.advanced.index"
ng-navigation-prefix-when="currentModel !== model"
>
<a ng-href="[! Report.advancedSwitchUrl(company, model.cls) !]"
ng-click="toggles.toggle('showReportsNav', false)"
>
Switch to the [! reportModelName !] report and keep current options</a>
</div>
<div ng-if="suggestedReports.length > 1" class="settings-nav-section">
<div class="settings-nav-header">Suggested Reports</div>
<ul class="settings-nav-list has-dark-hovers">
<li ng-repeat="suggestedReport in suggestedReports"
ng-if-once="$index > 0"
>
<a ng-href="[! SuggestedReport.url(suggestedReport, company) !]"
ng-click="toggles.toggle('showReportsNav', false)"
>
[! suggestedReport.name !]
<span class="settings-nav-list-note"
ng-if="suggestedReport.note"
>
[! suggestedReport.note !]
</span>
</a>
</li>
</ul>
</div>
<div ng-if="customReports.length" class="settings-nav-section">
<div class="settings-nav-header">Saved Reports</div>
<ul class="settings-nav-list has-dark-hovers">
<li ng-repeat="customReport in customReports">
<a ng-href="[! CustomReport.url(customReport) !]"
ng-click="toggles.toggle('showReportsNav', false)"
>
[! customReport.name !]
<span class="settings-nav-list-note"
ng-if="customReport.note"
>
[! customReport.note !]
</span>
</a>
</li>
</ul>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.reports.advanced.breadcrumbs">
<div ng-if="breadcrumbs.length > 1"
class="ar-breadcrumbs [[ addClassIf(isBreadcrumbsDisabled(), 'disabled') ]]"
>
<span ng-repeat="breadcrumb in breadcrumbs"
ng-init="grouping = breadcrumb.grouping; group = breadcrumb.group"
>
<span ng-if="!$first" class="fh-grey">
[! grouping.displayName|capitalize !]:
</span>
<a ng-click="drillBackTo(breadcrumb)" ng-if="!$last">
<span ng-if="$first">Report</span>
<span ng-if="!$first"
ng-advanced-display-object
ng-advanced-display-object-name-only
></span>
</a>
<span ng-if="$last"
ng-advanced-display-object
ng-advanced-display-object-name-only
></span>
<span ng-if="!$last" class="fh-grey">&#8250;</span>
</span>
</div>
</script>
<script type="text/ng-template" id="dashboard.reports.advanced.printDescription">
<div class="print-header respond-print-show">
<div class="print-header-generated"
ng-if="report.status === Report.SUCCEEDED_STATUS"
>
Generated [[ (report.modifiedAt|datetime)|lowercase ]]
</div>
<div class="print-header-date">
<b>[[ Report.MODELS[report.options.modelName].name ]]</b>
<div>
<span ng-if-once="report.options.dateType === Report.AVAILABILITY_DATE_TYPE">
Availabilities on
</span>
<span ng-if-once="report.options.dateType === Report.BOOKING_DATE_TYPE">
Bookings created on
</span>
<span ng-if-once="report.options.dateType === Report.BOOKING_ORIGINAL_DATE_TYPE">
Bookings originally created on
</span>
<span ng-if-once="report.options.dateType === Report.LINE_ITEM_DATE_TYPE">
Created on
</span>
<span ng-if-once="report.options.dateType === Report.PAYMENT_OR_REFUND_DATE_TYPE">
Paid or refunded on
</span>
<span ng-if-once="report.options.dateType === Report.PAYMENT_OR_REFUND_ACCRUAL_DATE_TYPE">
Accrued on
</span>
<span ng-if-once="report.options.presetDateRange"
ng-init="range = (report.options.presetDateRange|parsePresetDateRange:report.company)"
>
[! range[0]|dateRange:range[1] !]
</span>
<span ng-if-once="!report.options.presetDateRange">
[! report.options.startAt|dateRange:report.options.endAt !]
</span>
</div>
<div ng-repeat="company in report.options.companies">
<div ng-if-once="company.selectedAsCharter && !company.selectedAsAffiliate">
[! company.company.name !]
</div>
<div ng-if-once="company.selectedAsAffiliate">
<div ng-if-once="company.selectedAllPartners" ng-then="selectedAllPartners">
[! company.company.name !] + All partners
</div>
<div ng-else-once="selectedAllPartners">
<span ng-if-once="company.selectedAsCharter">
[! company.company.name !] + partners:
[! company.partners|map:'partner.name'|commaSeparated !]
</span>
<span ng-else-once="company.selectedAsCharter">
[! company.company.name !] partners:
[! company.partners|map:'partner.name'|commaSeparated !]
</span>
</div>
</div>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-advanced-display-header">
<span>[! grouping.displayName|capitalize !]</span>
</script>
<script type="text/ng-template" id="ng-advanced-display-object">
<a ng-if-once="!!objectUrl"
ng-href="[! objectUrl !]"
class="[! (object.cls === Booking.cls && object.isCancelled)|addClassIf:'cancelled' !]"
>
[! objectDisplay !]
</a>
<span ng-else-once="!!objectUrl">
[! objectDisplay !]
</span>
</script>
<script type="text/ng-template" id="dashboard.reports.ngAdvancedFilterGroup">
<div ng-if="filterGroupCtrl.requireCustomFields"
class="filter-column-warning"
>
Please add at least one custom field to run the [! Report.MODELS[newReport.options.modelName].name !] report.
</div>
<ul class="flyout-presets" ng-if="filterGroupCtrl.filters.length">
<li ng-repeat="filter in filterGroupCtrl.filters|filter:showFilter"
ng-advanced-filter="filter"
></li>
</ul>
<a class="flyout-create-form-toggle"
ng-if="!filterGroupCtrl.isAdding && filterGroupCtrl.allowAdding()"
ng-click="filterGroupCtrl.add()"
>[! filterGroupCtrl.addBtnText || T('Add Filter') !]</a>
<form class="flyout-create-form"
ng-if="filterGroupCtrl.isAdding"
ng-submit="filterGroupCtrl.submit()"
>
<div class="field">
<label>
<span class="the-field-outer">
<span class="the-field">
<select ng-if="!filterGroupCtrl.forceType"
ng-model="filterGroupCtrl.newFilter.type"
ng-options="type as filterName(type) for type in (filterGroupCtrl.types|filter:filterGroupCtrl.allowType)"
ng-dropdown
ng-placeholder="[! T('Filter by...') !]"
></select>
</span>
</span>
</label>
</div>
<div ng-watch="filterGroupCtrl.newFilter.type">
<div ng-if="filterGroupCtrl.newFilter.type"
ng-advanced-filter-form="filterGroupCtrl.newFilter"
></div>
</div>
<div class="btns">
<button class="btn-tiny btn-green btn-left"
type="submit"
ng-disabled="!filterGroupCtrl.isValid(filterGroupCtrl.newFilter)"
>
Save
</button>
<button class="btn-tiny btn-grey btn-left"
ng-click="filterGroupCtrl.isAdding = false"
>
Cancel
</button>
</div>
</form>
</script>
<script type="text/ng-template" id="dashboard.reports.ngAdvancedFilter">
<div class="flyout-preset-edit-wrap"
ng-else="filterCtrl.isEditing"
ng-click="filterCtrl.edit()"
>
<div class="flyout-preset-text">
[[ filterName(filterCtrl.filter.type, filterCtrl.filter) ]]
<span class="flyout-preset-note">
[! filterCtrl.summary() !]
</span>
</div>
<a class="flyout-preset-edit-btn">
<span>Edit</span>
</a>
</div>
<form class="flyout-preset-edit-form"
ng-if="filterCtrl.isEditing"
ng-submit="filterCtrl.submit()"
>
<div class="flyout-create-form-header">
[[ filterName(filterCtrl.filter.type, filterCtrl.filter) ]]
</div>
<div ng-advanced-filter-form="filterCtrl.editableFilter"></div>
<div class="btns">
<button class="btn-tiny btn-green btn-left"
type="submit"
ng-disabled="!filterGroupCtrl.isValid(filterCtrl.editableFilter)"
>
Save
</button>
<button class="btn-tiny btn-grey btn-left"
ng-click="filterCtrl.isEditing = false"
>
Cancel
</button>
<button class="btn-tiny btn-red btn--push-left"
ng-click="filterGroupCtrl.remove(filterCtrl.filter)"
ng-confirm-click="[! T('Remove this filter?') !]"
>
Remove
</button>
</div>
</form>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.companycurrency">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;Australian Dollars (AUD)&quot;,&quot;value&quot;:&quot;aud&quot;},{&quot;name&quot;:&quot;Canadian Dollars (CAD)&quot;,&quot;value&quot;:&quot;cad&quot;},{&quot;name&quot;:&quot;Swiss Franc (CHF)&quot;,&quot;value&quot;:&quot;chf&quot;},{&quot;name&quot;:&quot;Danish Krone (DKK)&quot;,&quot;value&quot;:&quot;dkk&quot;},{&quot;name&quot;:&quot;Euro (EUR)&quot;,&quot;value&quot;:&quot;eur&quot;},{&quot;name&quot;:&quot;British Pounds Sterling (GBP)&quot;,&quot;value&quot;:&quot;gbp&quot;},{&quot;name&quot;:&quot;Hong Kong Dollars (HKD)&quot;,&quot;value&quot;:&quot;hkd&quot;},{&quot;name&quot;:&quot;Mexican Peso (MXN)&quot;,&quot;value&quot;:&quot;mxn&quot;},{&quot;name&quot;:&quot;Norwegian Kroner (NOK)&quot;,&quot;value&quot;:&quot;nok&quot;},{&quot;name&quot;:&quot;New Zealand Dollars (NZD)&quot;,&quot;value&quot;:&quot;nzd&quot;},{&quot;name&quot;:&quot;Swedish Krona (SEK)&quot;,&quot;value&quot;:&quot;sek&quot;},{&quot;name&quot;:&quot;Singapore dollars (SGD)&quot;,&quot;value&quot;:&quot;sgd&quot;},{&quot;name&quot;:&quot;US Dollars (USD)&quot;,&quot;value&quot;:&quot;usd&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.source">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;Online&quot;,&quot;value&quot;:&quot;online&quot;},{&quot;name&quot;:&quot;Direct&quot;,&quot;value&quot;:&quot;direct&quot;},{&quot;name&quot;:&quot;Network&quot;,&quot;value&quot;:&quot;network&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.cancelledstatus">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;Uncancelled bookings&quot;,&quot;value&quot;:&quot;uncancelled&quot;},{&quot;name&quot;:&quot;Cancelled bookings with \u003e 0 paid&quot;,&quot;value&quot;:&quot;unrefunded&quot;},{&quot;name&quot;:&quot;Cancelled bookings with 0 paid&quot;,&quot;value&quot;:&quot;refunded&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.paidstatus">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;paid&quot;,&quot;value&quot;:&quot;paid&quot;},{&quot;name&quot;:&quot;unpaid&quot;,&quot;value&quot;:&quot;unpaid&quot;},{&quot;name&quot;:&quot;overpaid&quot;,&quot;value&quot;:&quot;overpaid&quot;},{&quot;name&quot;:&quot;underpaid&quot;,&quot;value&quot;:&quot;underpaid&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.creditcardtype">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;Visa&quot;,&quot;value&quot;:&quot;visa&quot;},{&quot;name&quot;:&quot;MasterCard&quot;,&quot;value&quot;:&quot;mastercard&quot;},{&quot;name&quot;:&quot;American Express&quot;,&quot;value&quot;:&quot;american express&quot;},{&quot;name&quot;:&quot;Discover&quot;,&quot;value&quot;:&quot;discover&quot;},{&quot;name&quot;:&quot;Diners Club&quot;,&quot;value&quot;:&quot;diners club&quot;},{&quot;name&quot;:&quot;JCB&quot;,&quot;value&quot;:&quot;jcb&quot;},{&quot;name&quot;:&quot;None&quot;,&quot;value&quot;:&quot;none&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.disputestatus">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;None&quot;,&quot;value&quot;:&quot;none&quot;},{&quot;name&quot;:&quot;Pending&quot;,&quot;value&quot;:&quot;pending&quot;},{&quot;name&quot;:&quot;Disputed&quot;,&quot;value&quot;:&quot;disputed&quot;},{&quot;name&quot;:&quot;Won&quot;,&quot;value&quot;:&quot;won&quot;},{&quot;name&quot;:&quot;Lost&quot;,&quot;value&quot;:&quot;lost&quot;},{&quot;name&quot;:&quot;Refunded&quot;,&quot;value&quot;:&quot;refunded&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.paymentrecognized">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;Previously recognized&quot;,&quot;value&quot;:&quot;previously recognized&quot;},{&quot;name&quot;:&quot;Recognized&quot;,&quot;value&quot;:&quot;recognized&quot;},{&quot;name&quot;:&quot;Deferred&quot;,&quot;value&quot;:&quot;deferred&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.paymentcollected">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;Previously collected&quot;,&quot;value&quot;:&quot;previously collected&quot;},{&quot;name&quot;:&quot;Collected&quot;,&quot;value&quot;:&quot;collected&quot;},{&quot;name&quot;:&quot;Not collected&quot;,&quot;value&quot;:&quot;not collected&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.accrualstatus">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;Recognized Revenue: Previously Collected&quot;,&quot;value&quot;:&quot;Recognized Revenue: Previously Collected&quot;},{&quot;name&quot;:&quot;Recognized Revenue: Collected&quot;,&quot;value&quot;:&quot;Recognized Revenue: Collected&quot;},{&quot;name&quot;:&quot;Deferred Revenue: Collected&quot;,&quot;value&quot;:&quot;Deferred Revenue: Collected&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.invoicesheetrelationship">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;None&quot;,&quot;value&quot;:&quot;none&quot;},{&quot;name&quot;:&quot;Owed to affiliate&quot;,&quot;value&quot;:&quot;affiliate&quot;},{&quot;name&quot;:&quot;Owed to provider&quot;,&quot;value&quot;:&quot;charter&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.nullableString">
<div ng-field-or-boolean="filterFormCtrl.filter.data.value"
ng-field-or-boolean-labels="{ exact: T('contains') }"
>
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="filterFormCtrl.filter.data.value"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.string">
<div class="field ">
<label>
<span class="the-field-outer">
<span class="the-field">
<input type="text" class="ng-pristine"
ng-model="filterFormCtrl.filter.data.value"
data-lpignore="true"
>
<span class="field-style-hook"></span>
</span>
</span>
</label>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.multipleChoice">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value"
ng-multiple-choice-field-show-none-choice="filterFormCtrl.isNullable"
ng-multiple-choice-field-show-any-choice="filterFormCtrl.isNullable"
>
<div ng-multiple-choice-field-choices="filterFormCtrl.choices"
ng-multiple-choice-field-choices-value-field="filterFormCtrl.filterSpec.valueField || 'pk'"
ng-multiple-choice-field-choices-show-select-all="true"
ng-multiple-choice-field-choices-name-field="filterFormCtrl.choiceName"
></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.bookedByUser">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value"
ng-multiple-choice-field-show-none-choice="filterFormCtrl.isNullable"
ng-multiple-choice-field-show-any-choice="filterFormCtrl.isNullable"
>
<div ng-multiple-choice-field-choices="filterFormCtrl.allUsers"
ng-multiple-choice-field-choices-value-field="filterFormCtrl.filterSpec.valueField || 'pk'"
ng-multiple-choice-field-choices-show-select-all="true"
ng-multiple-choice-field-choices-name-field="filterFormCtrl.choiceName"
ng-multiple-choice-field-header="T('Users')"
ng-multiple-choice-field-allow-toggle="true"
></div>
<div ng-multiple-choice-field-choices="filterFormCtrl.relatedUsers"
ng-multiple-choice-field-choices-value-field="filterFormCtrl.filterSpec.valueField || 'pk'"
ng-multiple-choice-field-choices-show-select-all="true"
ng-multiple-choice-field-choices-name-field="filterFormCtrl.choiceName"
ng-multiple-choice-field-header="T('Outside Users')"
ng-multiple-choice-field-allow-toggle="true"
ng-multiple-choice-field-choices-empty-note=""
></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.customfields">
<div class="flyout-checklist-header">
Answers from these custom fields:
</div>
<div ng-data="allCustomFields.$promise" ng-data-stale="allCustomFields" ng-data-small
class="flyout-ng-data"
>
<div class="advanced-custom-field-filter-inner"
ng-advanced-filter-group="filterFormCtrl.filter.data.value"
ng-advanced-filter-group-company="filterGroupCtrl.company"
ng-advanced-filter-group-force-type="Report.CUSTOM_FIELD_FILTER_TYPE"
ng-advanced-filter-group-add-btn-text="T('Add custom field')"
></div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.customfield">
<div class="customfieldfilterform-customfield "
ng-django-field="customFieldFilterForm [&#39;customField&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;customField&#39;]"
>
<div ng-current-option="filterFormCtrl.filter.data [&#39;customField&#39;]"
ng-current-option-collection="customFields"
ng-current-option-key="'pk'"
ng-current-option-target="filterFormCtrl.customField"
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="custom_field"
ng-model="filterFormCtrl.filter.data [&#39;customField&#39;]"
ng-disabled=""
ng-options="customField.pk as CustomField.dropdownName(customField) group by (customField.isHidden ? 'Deleted' : '') for customField in customFields"
ng-dropdown
ng-placeholder="Choose custom field"
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="customFieldFilterForm [&#39;customField&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in customFieldFilterForm [&#39;customField&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
<div ng-if="filterFormCtrl.filter.data.customField"
ng-prices-none
ng-with="
customFieldPricing = PriceLine.NONE_PRICING;
customField = filterFormCtrl.customField;
"
>
<div class="customfieldfilterform-valuetype field-select-max-width-100 "
ng-django-field="customFieldFilterForm [&#39;valueType&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;valueType&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<select data-lpignore="true" id="id_value_type" name="valueType" ng-model="filterFormCtrl.filter.data [&#39;valueType&#39;]">
<option value="" selected="selected">Any value</option>
<option value="selected">When not empty</option>
<option value="not-selected">When empty</option>
<option value="exact">When a specific value is selected</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="customFieldFilterForm [&#39;valueType&#39;].$error['invalid_choice']">Select a valid choice. The value is not one of the available choices.</li>
<li ng-repeat="error in customFieldFilterForm [&#39;valueType&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div ng-if="filterFormCtrl.filter.data.valueType === CustomFieldInstanceCondition.EXACT_TYPE">
<div class="customfieldfilterform-value "
ng-django-field="customFieldFilterForm [&#39;value&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-class="{ 'is-display-only': customField.isDisplayOnly }"
>
<div class="cf-wrap cf-wrap--[! customField.type|css !]
[! CustomField.usesCheckbox(customField) ? 'cf-wrap--checkbox' : '' !]"
ng-class="{
'private-field': customFieldPricing.visibility.isHiddenWhenBooking || customField.isPrivate
}"
>
<span class="private-field-icon test-private-custom-field-indicator"
ng-tip="[[ customField.isPrivate ? T('Only shown to logged in users with permission to see private fields. (That\'s you!)') : T('Will not be shown when booking') ]]"
ng-tip-location=".private-field-lock"
>
<span class="private-field-lock"></span>
</span>
<div ng-if-once="customField.isDisplayOnly">
<div ng-if="customField.type === CustomField.HEADER_TYPE">
<h2>[! customField.title !]</h2>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if="customField.type === CustomField.NOTE_TYPE" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.SHORT_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field test-custom-field-[! customField.name|css !]">
<span class="label-text">[! customField.hint !]</span>
<input id="id_short" maxlength="2048" name="value" ng-model="filterFormCtrl.filter.data [&#39;value&#39;]" ng-pseudo-placeholder="True" type="text" />
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.LONG_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="the-field test-custom-field-[! customField.name|css !]">
<textarea cols="40" id="id_long" name="value" ng-model="filterFormCtrl.filter.data [&#39;value&#39;]" ng-placeholder="[! customField.hint !]" rows="10">
</textarea>
<i ng-link="f-req"></i>
</div>
<div ng-inline="cf-description"></div>
</label>
</div>
<div ng-if-once="customField.type === CustomField.YES_NO_TYPE">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;value&#39;]" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
<label ng-if="customField.type === CustomField.COUNT_TYPE && filterFormCtrl.filter.data.type !== CustomFieldInstanceCondition.RANGE_TYPE"
class="custom-field-[! customField.type|css !] cf-label table valign-middle table-dont-respond"
ng-init="filterFormCtrl.filter.data [&#39;value&#39;] = ((filterFormCtrl.filter.data [&#39;value&#39;]|isDefined) ? filterFormCtrl.filter.data [&#39;value&#39;] : customField.countMin)"
>
<div class="tr">
<div class="td count-field-select"
ng-hide="customField.countMin === customField.countMax && filterFormCtrl.filter.data [&#39;value&#39;] === customField.countMin"
>
<select
ng-model="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-options="option for option in customField.countMin|range:(customField.countMax + 1)"
ng-prefix=""
name="value"
></select>
</div>
<div class="td">
<div class="cf-title">
[! customField.title !]<span
ng-if="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)"
><span ng-if="customField.isPricingHidden && bookCtrl.newBookingOptions.totalCosts[&#39;value&#39;] && PriceLine.showRate(customFieldPricing)"
>: <span ng-amount="bookCtrl.newBookingOptions.totalCosts[&#39;value&#39;].price"></span>
</span>
<span ng-if="!customField.isPricingHidden">
<span class="fh-grey">&mdash;</span>
<span ng-price="customFieldPricing"
ng-price-company="customField.company"
ng-price-count="filterFormCtrl.filter.data [&#39;value&#39;]"
></span>
</span>
</span>
</div>
<div ng-inline="cf-description"></div>
</div>
</div>
</label>
<div ng-if-once="customField.type === CustomField.EXTENDED_OPTION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-prices-extended-options="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-prices-extended-options-field="customField"
ng-prices-extended-options-instance="customFieldInstance"
ng-prices-extended-options-currency="customField"
ng-current-option="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="pricesExtendedOptionsCtrl.options"
ng-current-option-target="currentOption"
>
<div ng-if="pricesExtendedOptionsCtrl.isImpossibleOption" ng-then="impossibleOption">
<div class="cf-title">
<i class="warning-icon"></i> [! customField.title !]
</div>
</div>
<div ng-if="pricesExtendedOptionsCtrl.isForcedOption" ng-then="forcedOption"
ng-init="customFieldFilterForm.$setDirty()"
class="cf-title"
>
<span ng-if="!customField.isPricingHidden"
ng-with="currentOptionPricing = pricesCtrl.totalPricing(currentOption.extendedOption)"
>
<span ng-price="currentOptionPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && currentOption.extendedOption.isAlwaysPerCustomer">
per person
</span>
<span ng-if="PriceLine.showOffset(currentOptionPricing)"></span>
<span ng-if="currentOption.extendedOption.name && (
PriceLine.showOffset(currentOptionPricing) ||
PriceLine.showRate(currentOptionPricing)
)" class="fh-grey"
>&mdash;</span>
</span>
<span ng-bind="currentOption.extendedOption.name"></span>
</div>
<div ng-else="impossibleOption || forcedOption">
<label class="cf-label">
<div class="cf-title" ng-show="customField.title">
<span ng-bind="customField.title"></span>
</div>
<div class="the-field cf-extended-option-dropdown">
<select ng-model="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-options="option.pk as option.label for option in pricesExtendedOptionsCtrl.options"
ng-prefix=""
ng-required=""
name="value"
ng-dropdown
ng-placeholder="[! T('Choose an option') !]"
></select>
<i ng-link="f-req" ng-with="label = T('Choice is required')"></i>
</div>
</label>
</div>
<div ng-show="currentOption">
<div class="option-details md-inline" ng-if="currentOption.extendedOption.description"
ng-bind-html="currentOption.extendedOption.descriptionSafeHtml"
></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-if-once="customField.type === CustomField.TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-current-option="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-current-option-key="'pk'"
ng-current-option-collection="customField.transportationOptions"
ng-current-option-target="currentTransportationOption"
>
<div class="cf-title">
<span ng-bind-once="customField.title"></span>
<span ng-if="!customField.isPricingHidden">
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</div>
<div ng-if="customField.transportationOptions.length === 1" ng-then="fullTransportation"
ng-init="filterFormCtrl.filter.data [&#39;value&#39;] = customField.transportationOptions[0].pk"
></div>
<div ng-else="fullTransportation"
class="cf-transportation-dropdown"
>
<select
ng-init="filterFormCtrl.filter.data [&#39;value&#39;] = filterFormCtrl.filter.data [&#39;value&#39;] || (customField.transportationOptions.length && customField.transportationOptions[0].pk)"
ng-model="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-options="transportationOption.pk as transportationOption.location for transportationOption in customField.transportationOptions"
ng-prefix=""
name="value"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-placeholder="[! T('Choose transportation') !]"
>
</select>
</div>
<div class="transportation-details">
<h3 class="pickup-time">
<span ng-if="currentTransportationOption.isSelfTransportation" ng-then="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
Please arrive by [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
Please arrive [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
<span ng-else="selfTransportation">
<span ng-if="availability" ng-then="knownStart" class="notranslate">
We'll pick you up at [[ availability.startAt|dateSubtract:currentTransportationOption.minutesBeforeStart:'minutes'|time ]]
</span>
<span ng-else="knownStart">
We'll pick you up [[ currentTransportationOption.minutesBeforeStart ]] minutes before start time
</span>
</span>
</h3>
<div class="transportation-note md-inline" ng-if="currentTransportationOption.description"
ng-bind-html="currentTransportationOption.descriptionSafeHtml"></div>
</div>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"></div>
</div>
<div ng-if-once="customField.type === CustomField.NEW_TRANSPORTATION_TYPE"
class="custom-field-[! customField.type|css !]"
ng-new-transportation="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-mx-form-valid-async
>
<div ng-if="newTransportationCtrl.status === 'loading' || newTransportationCtrl.status === 'error'">
<div class="spinner-ticker-wrap">
<i class="spinner-ticker-css"><span></span></i> Loading...
</div>
</div>
<div ng-if="newTransportationCtrl.status === 'success'"
ng-mx-form-valid-async-success
>
<div class="table cf-lodging-table">
<div class="tr">
<div class="td">
<label class="cf-label">
<div class="cf-title"
ng-class="{ 'no-title': !customField.title }"
>
[! customField.title || 'none' !]
</div>
<div ng-current-option="newTransportationCtrl.data.lodging"
ng-current-option-collection="newTransportationCtrl.lodgings"
ng-current-option-target="newTransportationCtrl.currentLodging"
></div>
<div ng-if="newTransportationCtrl.lodgings.length"
class="the-field cf-lodging-dropdown"
ng-class="{
'ng-invalid': customFieldFilterForm[ + '-lodging'].$invalid,
'ng-required': true
}"
>
<select ng-model="newTransportationCtrl.data.lodging"
ng-options="lodging.pk as lodging.effectiveName for lodging in newTransportationCtrl.lodgings"
ng-placeholder="[[ customField.hint || T('Please select where you are staying') ]]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="lodging"
></select>
<i ng-link="f-req"></i>
</div>
</label>
<div class="cf-description md-inline" ng-if="customField.description"
ng-bind-html="customField.descriptionSafeHtml"
></div>
</div>
<div class="td room-number-field"
ng-if="newTransportationCtrl.currentLodging && !newTransportationCtrl.currentLodging.isSelfLodging && !customField.isLodgingRoomNumberHidden"
>
<label class="cf-label">
<div class="cf-title">Room number</div>
<input id="id_lodging_room_number" maxlength="128" name="lodgingRoomNumber" ng-model="newTransportationCtrl.data.lodgingRoomNumber" ng-placeholder="If known" type="text" />
</label>
</div>
</div>
<div class="tr self-lodging-contact-field" ng-if="newTransportationCtrl.currentLodging && newTransportationCtrl.currentLodging.isSelfLodging">
<label class="cf-label">
<textarea cols="40" id="id_self_lodging_address" name="selfLodgingAddress" ng-model="newTransportationCtrl.data.selfLodgingAddress" ng-placeholder="Please let us know how we can contact you" rows="10">
</textarea>
</label>
</div>
</div>
<div class="new-transportation-details"
ng-if="newTransportationCtrl.isTransportationAvailable() || newTransportationCtrl.showSelfTransportation()"
>
<div ng-if="newTransportationCtrl.isTransportationAvailable()">
<div ng-if="newTransportationCtrl.showNeedsTransportation()"
ng-then="showNeedsTransportation"
>
<div class="new-transportation-options-header bold">
[[ newTransportationCtrl.canOverrideTransportation ?
T('Transportation option:') :
T('Transportation to our location is available. Please select an option:') ]]
</div>
<div class="field field-boolean-radio
ng-required
"
ng-class="{ 'ng-invalid': newTransportationCtrl.needsTransportation === undefined }"
ng-radio-flyer
>
<div class="the-field">
<i ng-link="f-req"></i>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="true"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('Needs transportation') : T('Please pick me up') ]]
<span ng-if="newTransportationCtrl.showTransportationPrice()">
&mdash;
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</span>
</label>
<label class="">
<input type="radio"
ng-model="newTransportationCtrl.needsTransportation"
ng-value="false"
ng-required="newTransportationCtrl.needsTransportation === undefined"
/>
[[ newTransportationCtrl.canOverrideTransportation ? T('No transportation') : T('I will provide my own transportation') ]]
</label>
</div>
</div>
</div>
<div ng-if="!showNeedsTransportation && newTransportationCtrl.showTransportationPrice()"
class="need-trans-price"
>
<b ng-hide="showNeedsTransportation">Transportation:</b>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-show="!customFieldInstance.customerPrototype && customField.isAlwaysPerCustomer">per person</span>
</div>
<div ng-if="newTransportationCtrl.needsTransportation">
<div class="cf-rebook-new-transportation"
ng-if="
newTransportationCtrl.needsTransportation && newTransportationCtrl.rebookingTransportation &&
newTransportationCtrl.rebookTransportationOptions.length > 1
"
>
<h2>How should transportation be rebooked?</h2>
<ul class="cf-rebook-options" ng-radio-flyer>
<li ng-repeat="option in newTransportationCtrl.rebookTransportationOptions" class="cf-rebook-option">
<label>
<input type="radio" ng-model="newTransportationCtrl.rebookTransportationOption" ng-value="option">
[[ option.text ]]
<i ng-if="option.tip" ng-tip="[[ option.tip ]]" class="icon-hint"></i>
</label>
</li>
</ul>
</div>
<div class="new-trans-selects-wrap" ng-if="newTransportationCtrl.showRoutes() || newTransportationCtrl.showStops()">
<div class="new-trans-selects">
<div ng-if="newTransportationCtrl.showRoutes()">
<div ng-current-option="newTransportationCtrl.data.route"
ng-current-option-collection="newTransportationCtrl.routes"
ng-current-option-target="newTransportationCtrl.currentRoute"
></div>
<div class="the-field cf-route-dropdown"
ng-class="{
'ng-invalid': customFieldFilterForm[ + '-route'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.route"
ng-options="routeSelection.route.pk as newTransportationCtrl.routeSelectionText(routeSelection) for routeSelection in newTransportationCtrl.routeSelections"
ng-placeholder="[! T('Choose your route') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="route"
></select>
<i ng-link="f-req"></i>
</div>
</div>
<div ng-current-option="newTransportationCtrl.data.stop"
ng-current-option-collection="newTransportationCtrl.stops"
ng-current-option-target="newTransportationCtrl.currentStop"
></div>
<div ng-if="newTransportationCtrl.showStops()"
class="the-field cf-stop-dropdown"
ng-class="{
'ng-invalid': customFieldFilterForm[ + '-stop'].$invalid,
'ng-required': true
}"
>
<select
ng-model="newTransportationCtrl.data.stop"
ng-options="stop.pk as stop.unicode for stop in newTransportationCtrl.stops"
ng-placeholder="[! T('Choose a pickup location') !]"
ng-dropdown
ng-dropdown-allow-clear="false"
ng-required="true"
ng-prefix=""
name="stop"
></select>
<i ng-link="f-req"></i>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.needsTransportation && !newTransportationCtrl.currentStop && newTransportationCtrl.stops.length"
class="select-a-stop-note"
>
<span ng-if="newTransportationCtrl.canOverrideTransportation" ng-then="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
Select a pickup location above.
</span>
<span ng-else="required">
Select a pickup location above, or choose &quot;No transportation&quot; instead.
</span>
</span>
<span ng-else="companyTransportation">
<span ng-if="customFieldPricing.visibility.isRequired" ng-then="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
Please select a pickup point from the list above.
</span>
<span ng-else="required">
<b>We couldn&#039;t automatically assign you to a pickup location.</b>
If you need transportation, please select a pickup point from the list above.
If you need help, please select &quot;I will provide my own transportation&quot; and call us after completing your booking.
</span>
</span>
</div>
<div ng-if="newTransportationCtrl.currentStop">
<div class="pickup-info">
<h3 class="new-pickup-time">
We'll pick you up at [[ newTransportationCtrl.currentStop.time|time ]] from [[ newTransportationCtrl.currentStop.pickup.name ]]
</h3>
<div class="pickup-notes-toggle" ng-if="newTransportationCtrl.currentStop.pickup.description">
Pickup details will be included in your confirmation email. (<a ng-toggle="showNotes">View details</a>)
</div>
<div ng-toggled="showNotes">
<div ng-if="newTransportationCtrl.currentStop.pickup.description" class="md-inline"
ng-bind-html="newTransportationCtrl.currentStop.pickup.descriptionSafeHtml"
></div>
</div>
</div>
<div ng-toggled="showNotes">
<a ng-href="[[ newTransportationCtrl.currentStop.pickup.mapUrl ]]"
ng-if="newTransportationCtrl.currentStop.pickup.mapUrl"
ng-outbound-link="_blank"
class="pickup-map-link"
>
<b class="map-link-headline">See pickup location on a map</b>
</a>
</div>
</div>
</div>
</div>
<div ng-if="newTransportationCtrl.showSelfTransportation()"
class="pickup-info"
>
<h3 class="new-pickup-time">
Please arrive by [[ availability.startAt|dateSubtract:availability.item.noTransportationMinutes:'minutes'|time ]]
</h3>
<div ng-if="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
>
<div class="pickup-notes-toggle">
Directions will be included in your confirmation email. (<a ng-toggle="showSelfNotes">View directions</a>)
</div>
<div class="md-inline"
ng-toggled="showSelfNotes"
ng-bind-html="
newTransportationCtrl.currentLodging.noTransportationNotesSafeHtml ||
availability.item.noTransportationNotesSafeHtml ||
company.noTransportationNotesSafeHtml"
></div>
</div>
</div>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label class="cf-label">
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="filterFormCtrl.filter.data [&#39;value&#39;]" ng-prevalidate-custom-field="nullModel" ng-pseudo-placeholder="True" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div class="cf-admin-note md-inline"
ng-can-list="Code on customField.company"
>
<span class="icon-lock" ng-tip="[! T('Customers booking online don\'t see this note.') !]"></span>
Accepts codes from <a ng-href="[! customField.campaign.$url(urls.dashboard.settings.campaigns.campaign.index) !]"> [! customField.campaign.name !]</a>.
<span ng-show="PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)">
Changes price by <span class="option-offset" ng-price="customFieldPricing" ng-price-company="customField.company"></span> when code is valid.
</span>
</div>
<div ng-with="prevalidity = nullModel.prevalidity[&#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.CODE_GENERATOR_TYPE">
<div ng-if="" ng-then="requiredField" ng-init="filterFormCtrl.filter.data [&#39;value&#39;] = true;">
<div class="cf-title">
<span ng-if="!customField.isPricingHidden && (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing))">
<span class="option-offset"
ng-price="customFieldPricing"
ng-price-company="customField.company"
></span>
<span ng-if="!!customField.title">&mdash;</span>
</span>
[! customField.title !]
</div>
<div ng-if="customField.description" class="prose"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
</div>
<div ng-else="requiredField">
<div class="custom-field-[! customField.type|css !] table table-dont-respond valign-middle cf-checkbox"
ng-with="hasOffset = (PriceLine.showOffset(customFieldPricing) || PriceLine.showRate(customFieldPricing)) && !customField.isPricingHidden"
ng-class="{
'cf-checkbox--no-offset': !hasOffset
}"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input id="id_yes_no" name="value" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;value&#39;]" type="checkbox" />
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if="customField.title || hasOffset">
<span class="cf-checkbox-amount fh-blue"
ng-if="hasOffset"
>
<span ng-price="customFieldPricing" ng-price-company="customField.company"></span>
<span ng-if="customField.title">&ndash;</span>
</span>
<span ng-if="customField.title">
[! customField.title !]
</span>
</h2>
<div class="cf-checkbox-the-description" ng-inline="cf-description"></div>
<i ng-link="f-req" ng-with="label = T('Must be checked')"></i>
</div>
</div>
</label>
</div>
</div>
</div>
<div ng-if-once="customField.type === CustomField.CARD_GENERATOR_TYPE">
<div ng-can-view-amounts="customField.company" ng-then="canViewAmounts"
ng-card-generator="filterFormCtrl.filter.data [&#39;value&#39;]"
ng-form="cardGeneratorSubform"
>
<div ng-if="cardGeneratorCtrl.isAlreadyGenerated" ng-then="alreadyGenerated">
<b ng-amount="cardGeneratorCtrl.selectedAmount"
ng-amount-company="customField.company"
></b> <span class="fh-grey">&mdash;</span>
This field has already generated a gift card.
</div>
<div ng-if="!alreadyGenerated && customFieldValue" ng-then="hasValue">
This field cannot be edited from here. Please edit the generated gift card instead.
</div>
<div ng-if="!alreadyGenerated && !hasValue">
<div ng-if="!customFieldPricing.visibility.isRequired"
class="table table-dont-respond valign-middle
cf-checkbox cf-checkbox--no-offset
test-custom-field-[! customField.name|css !]-select
"
>
<label class="tr cf-label">
<div class="td cf-checkbox-field test-custom-field-[! customField.name|css !]">
<input type="checkbox"
class="ng-pristine"
ng-model="cardGeneratorCtrl.isSelected"
ng-checkbox-madness="true"
>
</div>
<div class="td">
<div class="cf-checkbox-description">
<h2 class="cf-checkbox-title" ng-if-once="customField.title">[! customField.title !]</h2>
</div>
</div>
</label>
</div>
<div ng-if="cardGeneratorCtrl.isSelected">
<div class="cf-title" ng-if="customField.title && customFieldPricing.visibility.isRequired">[[ customField.title ]]</div>
<fieldset>
<legend class="card-generator-header">Choose Amount</legend>
<div class="card-generator-amounts-wrap">
<div class="table table-dont-respond full-width">
<ul ng-radio-flyer
class="card-generator-amounts tr"
ng-class="{ '-custom-amount': toggles.state(cardGeneratorCtrl.toggleValue) }"
>
<li class="td">
<label ng-toggle ng-toggle-value="cardGeneratorCtrl.toggleValue"
ng-toggle-interactive="false"
ng-toggle-default="cardGeneratorCtrl.defaultToOther"
ng-click="toggles.toggle(cardGeneratorCtrl.toggleValue, true)"
>
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]">
<div>Custom</div>
</label>
</li>
<li ng-repeat="suggestedAmount in cardGeneratorCtrl.suggestedAmounts"
class="td"
>
<label ng-click="cardGeneratorCtrl.selectAmount(suggestedAmount)">
<input type="radio" name="[! 'generatorAmount' + customFieldInstance.pk + (card ? card.key : '') !]" ng-checked="!toggles.state(cardGeneratorCtrl.toggleValue) && cardGeneratorCtrl.selectedAmount === suggestedAmount">
<div ng-amount="suggestedAmount" ng-amount-currency="customField" ng-amount-hide-cents></div>
</label>
</li>
</ul>
</div>
</div>
</fieldset>
<div ng-toggled ng-toggled-value="cardGeneratorCtrl.toggleValue"
class="card-generator-custom-amount"
>
<div class="cardgeneratorsubform-selectedamount
field-amount
"
ng-django-field="cardGeneratorSubform [&#39;selectedAmount&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]"
ng-django-field-required="true"
>
<label >
<span class="label-text">
Gift amount:
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocomplete="off" data-lpignore="true" id="id_amount" max="999999.99" min="0" name="amount" ng-amount-input="true" ng-amount-input-default="cardGeneratorCtrl.minimumAmount" ng-amount-input-min="cardGeneratorCtrl.minimumAmount" ng-amount-input-positive="true" ng-float-input="" ng-float-input-decimal-places="None" ng-float-input-max-digits="None" ng-model="cardGeneratorCtrl [&#39;selectedAmount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" ng-required="true" step="any" type="text" />
<span class="field-style-hook">
[! (company || 'usd')|currencySymbol:'short' !]
</span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="cardGeneratorSubform [&#39;selectedAmount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in cardGeneratorSubform [&#39;selectedAmount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div ng-if="cardGeneratorCtrl.selectedAmount">
<div class="p-t-15 prose"
ng-if="customField.description"
ng-bind-html-once="customField.descriptionSafeHtml"
></div>
<fieldset>
<legend class="card-generator-header">Recipient Info</legend>
<p class="p-b-10">
You&#039;ll confirm these details, add an optional note, and send your digital gift card after checkout.
</p>
<div class="m-b-5 test-custom-field-[! customField.name|css !]-name">
<div class="cardgeneratorsubform-name field-person-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;name&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;name&#39;]"
ng-django-field-required="!auth.permissions.can('skipRecipientName', customField)"
>
<label >
<span class="label-text">
Full name
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_name" maxlength="128" name="name" ng-model="cardGeneratorCtrl [&#39;name&#39;]" ng-placeholder="Full name" ng-required="!auth.permissions.can('skipRecipientName', customField)" required="required" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;name&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="cardgeneratorsubform-email field-email-icon hide-label-text "
ng-django-field="cardGeneratorSubform [&#39;email&#39;]" ng-django-field-model="cardGeneratorCtrl [&#39;email&#39;]"
ng-django-field-required="false"
>
<label >
<span class="label-text">
Email address
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input autocapitalize="off" autocorrect="off" data-lpignore="true" id="id_email" name="email" ng-model="cardGeneratorCtrl [&#39;email&#39;]" ng-pattern="/^[^@\s]+@[^@\.\s]+\.[^@\s]+$/" ng-placeholder="Email address" ng-required="false" spellcheck="off" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in cardGeneratorSubform [&#39;email&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</fieldset>
</div>
</div>
</div>
</div>
<div ng-else="canViewAmounts">
Sorry, you are not authorized to create gift cards.
</div>
</div>
<div ng-if-once="customField.type === CustomField.MULTI_CAMPAIGN_TYPE"
class="custom-field-[! customField.type|css !]"
>
<label ng-toggle ng-toggle-value="'addCampaignCode' + customField.pk"
ng-toggle-default="auth.currentUser.isAuthenticated || customFieldPricing.visibility.isRequired || customField.isCodeInputShownByDefault || !!filterFormCtrl.filter.data[&#39;value&#39;]"
class="cf-label hide-when-toggled"
ng-mx-click="click-add-promo-code"
>
<span class="fh-grey underline pointer">[! customField.codeToggleText || T('Add promo or discount code') !]</span>
</label>
<label class="cf-label"
ng-toggled ng-toggled-value="'addCampaignCode' + customField.pk"
>
<div ng-if="customField.title" ng-bind="customField.title" class="cf-title"></div>
<div class="field the-field">
<span class="label-text">[! customField.hint !]</span>
<input id="id_code" maxlength="64" name="value" ng-model="filterFormCtrl.filter.data [&#39;value&#39;]" ng-prevalidate-custom-field="nullModel" ng-pseudo-placeholder="True" required="required" type="text" />
<i ng-link="f-req"></i>
<span class="field-prevalid-flag">
<b ng-if="prevalidity.totalPricing && !customField.isPricingHidden"
ng-price="prevalidity.totalPricing"
ng-price-company="customField.company"
></b>
</span>
<span class="field-preinvalid-flag"
ng-tip="[! T('Not a valid code. Please check your spelling or try a different code.') !]"
ng-tip-classes="tip-indent"
></span>
</div>
<div ng-inline="cf-description"></div>
</label>
<div
ng-with="prevalidity = nullModel.prevalidity[&#39;value&#39;]"
ng-link="book.customFieldValueNotes"
></div>
</div>
<div ng-if-once="customField.type === CustomField.WAIVER_TYPE">
<div class="custom-field-[! customField.type|css !]"
ng-can-create="Waiver on customField.company"
ng-can-only-when="customField.connectedWaivers.length"
>
<div class="cf-admin-note md-inline">
<span class="icon-lock" ng-tip="[! T('Only people in your company see this note') !]"></span>
<b ng-show="!!customField.name">[! customField.name !]:</b>
Customers will be asked to sign:
<span ng-repeat="connectedWaiver in customField.connectedWaivers" >
<a ng-href="[! connectedWaiver.waiver.$url(urls.dashboard.settings.waivers.waiver.index) !]">[! connectedWaiver.waiver.name !]</a><span ng-if="!$last">,</span>
</span>
</div>
</div>
</div>
<ul class="errors">
<li ng-repeat="error in customFieldFilterForm [&#39;value&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
<div ng-if="modelBeingFiltered === Booking">
<div class="customfieldfilterform-iscustomerlevel field-cb "
ng-django-field="customFieldFilterForm [&#39;isCustomerLevel&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;isCustomerLevel&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_customer_level" name="isCustomerLevel" ng-model="filterFormCtrl.filter.data [&#39;isCustomerLevel&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Customer level uses
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customFieldFilterForm [&#39;isCustomerLevel&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="customfieldfilterform-iswholebookinglevel field-cb "
ng-django-field="customFieldFilterForm [&#39;isWholeBookingLevel&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;isWholeBookingLevel&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_is_whole_booking_level" name="isWholeBookingLevel" ng-model="filterFormCtrl.filter.data [&#39;isWholeBookingLevel&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Whole-booking uses
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in customFieldFilterForm [&#39;isWholeBookingLevel&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.weekday">
<div class="form-week-days has-bottom-margin">
<div class="flex-item--full-width" ng-if-once="company.features.isSundayBased" ng-then="isSundayBased">
<div class="weekdaysfilterform-sunday "
ng-django-field="weekdaysFilterForm [&#39;sunday&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;sunday&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_sunday" name="sunday" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;sunday&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Su
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in weekdaysFilterForm [&#39;sunday&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="weekdaysfilterform-monday "
ng-django-field="weekdaysFilterForm [&#39;monday&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;monday&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_monday" name="monday" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;monday&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
M
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in weekdaysFilterForm [&#39;monday&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="weekdaysfilterform-tuesday "
ng-django-field="weekdaysFilterForm [&#39;tuesday&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;tuesday&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_tuesday" name="tuesday" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;tuesday&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
T
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in weekdaysFilterForm [&#39;tuesday&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="weekdaysfilterform-wednesday "
ng-django-field="weekdaysFilterForm [&#39;wednesday&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;wednesday&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_wednesday" name="wednesday" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;wednesday&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
W
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in weekdaysFilterForm [&#39;wednesday&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="weekdaysfilterform-thursday "
ng-django-field="weekdaysFilterForm [&#39;thursday&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;thursday&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_thursday" name="thursday" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;thursday&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Th
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in weekdaysFilterForm [&#39;thursday&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="weekdaysfilterform-friday "
ng-django-field="weekdaysFilterForm [&#39;friday&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;friday&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_friday" name="friday" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;friday&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
F
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in weekdaysFilterForm [&#39;friday&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="weekdaysfilterform-saturday "
ng-django-field="weekdaysFilterForm [&#39;saturday&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;saturday&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_saturday" name="saturday" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;saturday&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
S
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in weekdaysFilterForm [&#39;saturday&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="flex-item--full-width" ng-else="isSundayBased">
<div class="weekdaysfilterform-sunday "
ng-django-field="weekdaysFilterForm [&#39;sunday&#39;]" ng-django-field-model="filterFormCtrl.filter.data [&#39;sunday&#39;]"
>
<label class="label-text-after">
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_sunday" name="sunday" ng-checkbox-madness="true" ng-model="filterFormCtrl.filter.data [&#39;sunday&#39;]" type="checkbox" />
<span class="field-style-hook"></span>
</span>
<span class="label-text">
Su
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in weekdaysFilterForm [&#39;sunday&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
</div>
<div ng-if="ruleFormCtrl && !ruleFormCtrl.isDayFieldsValid()" class="form-error">
Please select at least one day
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.company">
<div class="advanced-custom-field-filter-inner">
<ul class="flyout-presets"
ng-if="filterFormCtrl.filter.data.value.length"
>
<li ng-repeat="shortname in filterFormCtrl.filter.data.value">
<div class="flyout-preset-text">[! shortname !]</div>
<a class="flyout-preset-edit-btn"
ng-click="filterFormCtrl.remove(shortname)"
ng-tip="[! T('Remove') !]"
ng-tip-classes="tip-indent"
>
<span>Remove</span>
</a>
</li>
</ul>
<div class="flyout-create-form"
ng-if="filterFormCtrl.adding"
>
<select ng-model="filterFormCtrl.newCompany"
ng-dropdown
ng-dropdown-remote-options="(company.name + ' - ' + company.shortname) for company in filterFormCtrl.companiesEndpoint"
ng-placeholder="[! T('Filter to...') !]"
></select>
</div>
<a class="flyout-create-form-toggle"
ng-else="filterFormCtrl.adding"
ng-click="filterFormCtrl.add()"
>Add company</a>
</div>
</script>
<script type="text/ng-template" id="ngAdvancedFilterForm.contactlanguage">
<div ng-multiple-choice-field="filterFormCtrl.filter.data.value">
<div ng-multiple-choice-field-choices="[{&quot;name&quot;:&quot;Afrikaans&quot;,&quot;value&quot;:&quot;af&quot;},{&quot;name&quot;:&quot;Albanian&quot;,&quot;value&quot;:&quot;sq&quot;},{&quot;name&quot;:&quot;Arabic&quot;,&quot;value&quot;:&quot;ar&quot;},{&quot;name&quot;:&quot;Azerbaijani&quot;,&quot;value&quot;:&quot;az&quot;},{&quot;name&quot;:&quot;Basque&quot;,&quot;value&quot;:&quot;eu&quot;},{&quot;name&quot;:&quot;Belarusian&quot;,&quot;value&quot;:&quot;be&quot;},{&quot;name&quot;:&quot;Bengali&quot;,&quot;value&quot;:&quot;bn&quot;},{&quot;name&quot;:&quot;Bokmal (Norway)&quot;,&quot;value&quot;:&quot;nb&quot;},{&quot;name&quot;:&quot;Bosnian&quot;,&quot;value&quot;:&quot;bs&quot;},{&quot;name&quot;:&quot;Breton&quot;,&quot;value&quot;:&quot;br&quot;},{&quot;name&quot;:&quot;Bulgarian&quot;,&quot;value&quot;:&quot;bg&quot;},{&quot;name&quot;:&quot;Burmese&quot;,&quot;value&quot;:&quot;my&quot;},{&quot;name&quot;:&quot;Catalan&quot;,&quot;value&quot;:&quot;ca&quot;},{&quot;name&quot;:&quot;Chinese (Simplified)&quot;,&quot;value&quot;:&quot;zh-cn&quot;},{&quot;name&quot;:&quot;Chinese (Traditional)&quot;,&quot;value&quot;:&quot;zh-tw&quot;},{&quot;name&quot;:&quot;Croatian&quot;,&quot;value&quot;:&quot;hr&quot;},{&quot;name&quot;:&quot;Czech&quot;,&quot;value&quot;:&quot;cs&quot;},{&quot;name&quot;:&quot;Danish&quot;,&quot;value&quot;:&quot;da&quot;},{&quot;name&quot;:&quot;Dutch&quot;,&quot;value&quot;:&quot;nl&quot;},{&quot;name&quot;:&quot;English&quot;,&quot;value&quot;:&quot;en&quot;},{&quot;name&quot;:&quot;English (Australia)&quot;,&quot;value&quot;:&quot;en-au&quot;},{&quot;name&quot;:&quot;English (Canada)&quot;,&quot;value&quot;:&quot;en-ca&quot;},{&quot;name&quot;:&quot;English (UK)&quot;,&quot;value&quot;:&quot;en-gb&quot;},{&quot;name&quot;:&quot;English (US)&quot;,&quot;value&quot;:&quot;en-us&quot;},{&quot;name&quot;:&quot;Esperanto&quot;,&quot;value&quot;:&quot;eo&quot;},{&quot;name&quot;:&quot;Estonian&quot;,&quot;value&quot;:&quot;et&quot;},{&quot;name&quot;:&quot;Finnish&quot;,&quot;value&quot;:&quot;fi&quot;},{&quot;name&quot;:&quot;French&quot;,&quot;value&quot;:&quot;fr&quot;},{&quot;name&quot;:&quot;French (Canada)&quot;,&quot;value&quot;:&quot;fr-ca&quot;},{&quot;name&quot;:&quot;Frisian&quot;,&quot;value&quot;:&quot;fy-nl&quot;},{&quot;name&quot;:&quot;Galician&quot;,&quot;value&quot;:&quot;gl&quot;},{&quot;name&quot;:&quot;Georgian&quot;,&quot;value&quot;:&quot;ka&quot;},{&quot;name&quot;:&quot;German&quot;,&quot;value&quot;:&quot;de&quot;},{&quot;name&quot;:&quot;Greek&quot;,&quot;value&quot;:&quot;el&quot;},{&quot;name&quot;:&quot;Hebrew&quot;,&quot;value&quot;:&quot;he&quot;},{&quot;name&quot;:&quot;Hindi&quot;,&quot;value&quot;:&quot;hi&quot;},{&quot;name&quot;:&quot;Hungarian&quot;,&quot;value&quot;:&quot;hu&quot;},{&quot;name&quot;:&quot;Icelandic&quot;,&quot;value&quot;:&quot;is&quot;},{&quot;name&quot;:&quot;Indonesian&quot;,&quot;value&quot;:&quot;id&quot;},{&quot;name&quot;:&quot;Interlingua&quot;,&quot;value&quot;:&quot;ia&quot;},{&quot;name&quot;:&quot;Irish&quot;,&quot;value&quot;:&quot;ga&quot;},{&quot;name&quot;:&quot;Italian&quot;,&quot;value&quot;:&quot;it&quot;},{&quot;name&quot;:&quot;Japanese&quot;,&quot;value&quot;:&quot;ja&quot;},{&quot;name&quot;:&quot;Kannada&quot;,&quot;value&quot;:&quot;kn&quot;},{&quot;name&quot;:&quot;Kazakh&quot;,&quot;value&quot;:&quot;kk&quot;},{&quot;name&quot;:&quot;Khmer&quot;,&quot;value&quot;:&quot;km&quot;},{&quot;name&quot;:&quot;Korean&quot;,&quot;value&quot;:&quot;ko&quot;},{&quot;name&quot;:&quot;Latin (Serbia)&quot;,&quot;value&quot;:&quot;sr-latn&quot;},{&quot;name&quot;:&quot;Latvian&quot;,&quot;value&quot;:&quot;lv&quot;},{&quot;name&quot;:&quot;Lithuanian&quot;,&quot;value&quot;:&quot;lt&quot;},{&quot;name&quot;:&quot;Luxembourgish&quot;,&quot;value&quot;:&quot;lb&quot;},{&quot;name&quot;:&quot;Macedonian&quot;,&quot;value&quot;:&quot;mk&quot;},{&quot;name&quot;:&quot;Malayalam&quot;,&quot;value&quot;:&quot;ml&quot;},{&quot;name&quot;:&quot;Mongolian&quot;,&quot;value&quot;:&quot;mn&quot;},{&quot;name&quot;:&quot;Nepali&quot;,&quot;value&quot;:&quot;ne&quot;},{&quot;name&quot;:&quot;Norwegian&quot;,&quot;value&quot;:&quot;no&quot;},{&quot;name&quot;:&quot;Nynorsk (Norway)&quot;,&quot;value&quot;:&quot;nn&quot;},{&quot;name&quot;:&quot;Ossetic&quot;,&quot;value&quot;:&quot;os&quot;},{&quot;name&quot;:&quot;Persian&quot;,&quot;value&quot;:&quot;fa&quot;},{&quot;name&quot;:&quot;Polish&quot;,&quot;value&quot;:&quot;pl&quot;},{&quot;name&quot;:&quot;Portuguese&quot;,&quot;value&quot;:&quot;pt&quot;},{&quot;name&quot;:&quot;Portuguese (Brazil)&quot;,&quot;value&quot;:&quot;pt-br&quot;},{&quot;name&quot;:&quot;Punjabi&quot;,&quot;value&quot;:&quot;pa&quot;},{&quot;name&quot;:&quot;Romanian&quot;,&quot;value&quot;:&quot;ro&quot;},{&quot;name&quot;:&quot;Russian&quot;,&quot;value&quot;:&quot;ru&quot;},{&quot;name&quot;:&quot;Serbian&quot;,&quot;value&quot;:&quot;sr&quot;},{&quot;name&quot;:&quot;Slovak&quot;,&quot;value&quot;:&quot;sk&quot;},{&quot;name&quot;:&quot;Slovenian&quot;,&quot;value&quot;:&quot;sl&quot;},{&quot;name&quot;:&quot;Spanish&quot;,&quot;value&quot;:&quot;es&quot;},{&quot;name&quot;:&quot;Spanish (Argentinia)&quot;,&quot;value&quot;:&quot;es-ar&quot;},{&quot;name&quot;:&quot;Spanish (Mexico)&quot;,&quot;value&quot;:&quot;es-mx&quot;},{&quot;name&quot;:&quot;Spanish (Nicaragua)&quot;,&quot;value&quot;:&quot;es-ni&quot;},{&quot;name&quot;:&quot;Spanish (Venezuela)&quot;,&quot;value&quot;:&quot;es-ve&quot;},{&quot;name&quot;:&quot;Swahili&quot;,&quot;value&quot;:&quot;sw&quot;},{&quot;name&quot;:&quot;Swedish&quot;,&quot;value&quot;:&quot;sv&quot;},{&quot;name&quot;:&quot;Tamil&quot;,&quot;value&quot;:&quot;ta&quot;},{&quot;name&quot;:&quot;Tatar&quot;,&quot;value&quot;:&quot;tt&quot;},{&quot;name&quot;:&quot;Telugu&quot;,&quot;value&quot;:&quot;te&quot;},{&quot;name&quot;:&quot;Thai&quot;,&quot;value&quot;:&quot;th&quot;},{&quot;name&quot;:&quot;Turkish&quot;,&quot;value&quot;:&quot;tr&quot;},{&quot;name&quot;:&quot;Udmurt&quot;,&quot;value&quot;:&quot;udm&quot;},{&quot;name&quot;:&quot;Ukrainian&quot;,&quot;value&quot;:&quot;uk&quot;},{&quot;name&quot;:&quot;Urdu&quot;,&quot;value&quot;:&quot;ur&quot;},{&quot;name&quot;:&quot;Vietnamese&quot;,&quot;value&quot;:&quot;vi&quot;},{&quot;name&quot;:&quot;Welsh&quot;,&quot;value&quot;:&quot;cy&quot;}]"></div>
</div>
</script>
<script type="text/ng-template" id="payment-and-refunds">
<div ng-if="!payment.isDeferred && !payment.initialReceipt.gross && !payment.initialReceipt.bookingFee" ng-then="customRefund">
<table class="overview-payment-row">
<tr>
<td>
<span class="fh-grey">Custom refund:</span> <b>[! payment.displayType !]</b>
</td>
<td class="op-amount-td">
<span ng-repeat="refund in payment.refunds"
class="op-amount negative"
>
-[! refund.receipt.gross|amount:payment !]
</span>
</td>
</tr>
</table>
<div ng-repeat="refund in payment.refunds"
ng-inline="overview-payment-refund-meta"
></div>
</div>
<div ng-else="customRefund">
<table class="overview-payment-row">
<tr>
<td ng-if-once="payment.isDeferred" ng-then="savedCard">
<span class="fh-grey">Saved card:</span> <b>[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]</b>
</td>
<td ng-else="savedCard">
<span ng-if-once="payment.isCardOnFile" ng-then="isCardOnFilePayment">
<span class="fh-grey">Company card:</span> <b>[! payment.cardName !]</b>
</span>
<b ng-if-once="payment.isProcessorBasedType && !payment.isCardOnFile" ng-then="ccPayment">
[! payment.displayProcessorBasedType !] [! payment.processorBasedIdentifier !]
</b>
<span ng-if="!isCardOnFilePayment && !ccPayment">
<b ng-if-once="payment.type === Payment.AFFILIATE_TYPE && !payment.inStorePaymentType" ng-then="affiliatePayment">
Collected by affiliate
</b>
<b ng-else="affiliatePayment">
[! payment.displayType !]
</b>
</span>
<div class="fh-grey"
ng-if-once="payment.noteSafeHtml"
ng-bind-html="payment.noteSafeHtml"
></div>
</td>
<td class="op-amount-td">
<div ng-if="savedCard" class="op-saved-card">
Verified
</div>
<div ng-else="savedCard">
<span ng-if-once="showTotals && payment.receipt.bookingFee" ng-then="showBookingFee"
ng-tip="[! T('Booking fee included') !]" ng-tip-location=".help-icon-small-grey" ng-tip-touch="true"
>
<span class="op-amount
[! payment.disputeStatus === Payment.LOST_DISPUTE_STATUS ? 'strike' : 'positive' !]
">[! (payment.initialReceipt.gross + payment.initialReceipt.bookingFee)|amount:payment !]</span>
<i class="help-icon-small-grey"></i>
</span>
<span ng-else="showBookingFee">
<span class="op-amount
[! payment.disputeStatus === Payment.LOST_DISPUTE_STATUS ? 'strike' : 'positive' !]
">[! payment.initialReceipt.gross|amount:payment !]</span>
<span ng-inline="booking-fee-flag"></span>
</span>
</div>
</td>
</tr>
</table>
<table class="overview-payment-row">
<tr>
<td>
<div class="overview-payment-meta">
<div ng-if-once="payment.inStorePaymentNote">
[! payment.inStorePaymentType.effectiveNoteLabel !]: <b>[! payment.inStorePaymentNote !]</b>
</div>
<div ng-toggled ng-toggled-value="'paymentDetails' + payment.pk">
<div ng-if-once="payment.isProcessorBasedType">
<span ng-if-once="payment.processorBasedAccountholdersName">
Account holder: <b>[! payment.processorBasedAccountholdersName !]</b>
</span>
<span ng-else-once="payment.processorBasedAccountholdersName">
Account holder: <b>Not entered</b>
</span>
</div>
<div ng-if="payment.type === Payment.STORED_VALUE_CARD_TYPE">
Card number:
<a ng-href="[! payment.storedValueCard.$url(dashboard.settings.storedValue.storedValueCard.index) !]"><b>[! payment.storedValueCard.number || payment.storedValueCard.obscuredNumber !]</b></a>
</div>
<div>
Payment ID: <b>#[! payment.pk !]</b>
</div>
<div>
Payment time: <b>[! payment.createdAt|time !]</b>
</div>
</div>
[! payment.user.name ?
interpolate(T('%(date)s by %(username)s'), { date: (payment.createdAt|date), username: payment.user.name }) :
interpolate(T('%(date)s by online customer'), { date: (payment.createdAt|date) })
!]
</div>
<div ng-if="Payment.isOpenDisputeStatus(payment)"
class="op-disputed"
>
<span class="badge badge-warning">Disputed</span>
<span ng-if-once="payment.disputeStatus === Payment.PENDING_DISPUTE_STATUS" ng-then="canRefundDisputed">
The cardholder has disputed this payment but you are able to refund it.
</span>
<span ng-else="canRefundDisputed">
The cardholder has disputed this payment and it cannot be refunded right now.
</span>
<a ng-href="https://fareharbor.com/help/payments/disputes/refunding-a-disputed-charge/" ng-outbound-link="_blank">Learn more</a>
</div>
<div ng-if="payment.disputeStatus === Payment.LOST_DISPUTE_STATUS"
class="op-disputed"
>
<span class="badge badge-warning">Lost Dispute</span>
This payment was disputed by the cardholder.
<a ng-href="https://fareharbor.com/help/payments/disputes/" ng-outbound-link="_blank">Learn more</a>
</div>
</td>
<td class="op-meta">
<div ng-else="payment.isDeferred">
<ul ng-toggled ng-toggled-value="'paymentDetails' + payment.pk"
class="overview-payment-meta"
>
<li>
Subtotal: <b ng-amount="payment.initialCosts.totalCost.price" ng-amount-currency="payment"></b>
</li>
<li>
<ul ng-with="company = payment.company; taxByType = Payment.taxByType(payment, true)">
<li ng-if="taxByType"
ng-inline="dashboard.bookings.taxByType"
></li>
<li ng-if="!taxByType && payment.initialCosts.totalCost.tax">
[! Company.taxDisplayName(payment.company) !]:
<b ng-amount="payment.initialCosts.totalCost.tax" ng-amount-currency="payment"></b>
</li>
</ul>
</li>
</ul>
</div>
<a class="op-details-link"
ng-toggle ng-toggle-value="'paymentDetails' + payment.pk"
>Details</a>
</td>
</tr>
</table>
<div ng-if="payment.refunds.length" class="overview-refunds">
<div ng-repeat="refund in payment.refunds"
class="overview-refund"
>
<table class="overview-payment-row">
<tr>
<td>Refund</td>
<td class="op-amount-td">
<span class="op-amount negative">-[! refund.receipt.gross|amount:payment !]</span>
<span ng-inline="booking-fee-flag"
ng-if-once="refund.bookingFee && refund.isFull"
></span>
</td>
</tr>
</table>
<div ng-inline="overview-payment-refund-meta"></div>
</div>
<div ng-if="payment.refunds.length"
class="overview-refund"
>
<table class="overview-payment-row">
<tr>
<td>
<i ng-if-once="payment.isRefunded" class="fh-blue bold">Fully refunded</i>
<i ng-if-once="!payment.isRefunded">Unrefunded amount</i>
</td>
<td class="op-amount-td">
<i ng-if-once="!payment.isRefunded"
ng-tip="[! T('Booking fee not yet refunded') !]" ng-tip-location=".help-icon-small-grey" ng-tip-touch="true"
>
[[ (showTotals ? payment.receipt.total : payment.receipt.gross)|amount:payment ]]
<i class="help-icon-small-grey" ng-if-once="!showTotals && payment.receipt.bookingFee"></i>
</i>
</td>
</tr>
<tr class="overview-payment-meta">
<td></td>
<td class="op-meta">
<div ng-if="!payment.isRefunded">
<ul ng-toggled ng-toggled-value="'paymentCurrentDetails' + payment.pk"
class="overview-payment-meta"
>
<li>
Subtotal: <b ng-amount="payment.costs.totalCost.price" ng-amount-currency="payment"></b>
</li>
<li>
<ul ng-with="company = payment.company; taxByType = Payment.taxByType(payment)">
<li ng-if="taxByType"
ng-inline="dashboard.bookings.taxByType"
></li>
<li ng-if="!taxByType && payment.costs.totalCost.tax">
[! Company.taxDisplayName(payment.company) !]:
<b ng-amount="payment.costs.totalCost.tax" ng-amount-currency="payment"></b>
</li>
</ul>
</li>
</ul>
<a class="op-details-link"
ng-toggle ng-toggle-value="'paymentCurrentDetails' + payment.pk"
>Details</a>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.cancelEligiblePayments">
<div class="hint"
ng-if-once="maximumCancellationCutoffAt"
>
<i class="warning-icon"></i>
You can cancel until [! maximumCancellationCutoffAt|datetime:'relative' !].
</div>
<div ng-repeat="groupedPayments in groupedCancelEligiblePayments"
ng-if-once="groupedPayments.payments.length"
>
<br ng-if-once="$index > 0 && groupedCancelEligiblePayments[$index - 1].payments.length" />
<p class="action-sheet-help">
<span ng-if-once="groupedPayments.refundPercentage === 1"
ng-then="fullRefund"
>
These payments will be <b>fully refunded</b>:
</span>
<span ng-if-once="groupedPayments.refundPercentage === 0"
ng-then="noRefund"
>
These payments will <b>not</b> be refunded:
</span>
<span ng-else="fullRefund || noRefund">
These payments will be refunded <b>[[ groupedPayments.refundPercentage|percentage:'hideplus' ]]</b>:
</span>
</p>
<ul>
<li class="refund-form-block is-selectable"
ng-repeat="payment in groupedPayments.payments"
>
<div class="field">
<div ng-if="Payment.isLegacyProcessorBasedType(payment)"
ng-link="dashboard.bookings.paymentLegacyFlag"
></div>
<div class="overview-payment"
ng-link="payment-and-refunds"
ng-with="showTotals = true"
></div>
<div ng-if="!!refundErrors[payment.pk]">
<ul>
<li ng-repeat="error in refundErrors[payment.pk]" class="form-error">
[[ error ]]
</li>
</ul>
</div>
</div>
</li>
</ul>
</div>
</script>
<script type="text/ng-template" id="order-invoice-bookings">
<table class="invoice-table [[ CheckinStatus.checkinStatusClass(CheckinStatus.bookingCheckinStatus(booking)) ]]">
<tbody>
<tr class="invoice-table--row is-shaded is-tall">
<td class="itable-content" colspan="2">
<a ng-href="[! booking|bookingUrl !]"
class="bold booking-pk-color"
>
Booking #[! booking.pk !]</a>
</td>
<td class="itable-amount">
<span ng-can-view-amounts="booking.company"
ng-amount="booking.costs.totalCost.total"
ng-amount-company="booking.company"
></span>
</td>
</tr>
</tbody>
</table>
<ul class="table-nav table-nav--no-top-bottom-borders">
<li>
<a ng-href="[! booking|bookingUrl !]"
class="booking-block test-view-booking-action table-nav-item with-chevron"
ng-class="{ 'fh-grey': booking.isCancelled }"
ng-watch="booking.modifiedAt"
>
<div class="table full-width valign-top table-dont-respond booking-block-header">
<div class="tr">
<h2 class="td">
<i class="[! booking|colorClass:'-swatch inline-swatch' !]"></i>
[! booking.availability.item|name !]
</h2>
<span class="td text-right">
<span ng-can-view-amounts="booking.company"
ng-can-only-when="!booking.rebookedTo"
class="badge nowrap
[! booking.isUnprocessed || booking.isCancelled ? '' : 'badge-' + booking.paidStatus|css !]"
>
[!
booking.isUnprocessed ? T('Pending') : (
booking.isCancelled ?
!booking.receipt.gross ? T('Refunded') : interpolate(T('%(amount)s Paid'), { amount: (booking.receipt.gross|amount:booking) })
: (
booking.amountDue || booking.amountOverpaid ? (
booking.amountDue ?
interpolate(T('%(amount)s Due'), { amount: (booking.amountDue|amount:booking) }) :
interpolate(T('%(amount)s Overpaid'), { amount: (booking.amountOverpaid|amount:booking) })
) : T('Paid')
)
)
!]
</span>
</span>
</div>
</div>
<ul class="booking-block-inner">
<li class="fh-grey">
<span ng-if-once="Availability.isInPast(booking.availability)"
class="badge ghost warning-color"
>Past</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt):'long' !]
</li>
<li class="booking-block-availability">
<ul>
<li>[! booking.customerBreakdownShort !]</li>
</ul>
</li>
</ul>
<div class="booking-block-meta">
<span class="booking-block-affiliate test-view-affiliate-booking-action
[! booking.isOnline ? 'booked-via-online' :
(booking.user.company.pk === booking.affiliation.affiliateCompany.pk ? 'booked-via-affiliate-db' : '') !]
"
ng-if-once="booking.affiliation"
>
<b>
[! navigation.isCurrentCompany(booking.affiliation.affiliateCompany) ? booking.company.name : booking.affiliation.affiliateCompany.name !]
</b>
[! booking.voucherNumber ? '(' + booking.voucherNumber + ')' : '' !]
</span>
<span class="booked-at fh-grey [! addClassIf(!booking.isCancelled && !booking.user, 'booked-at-online') !]">
<span ng-if="booking.isCancelled" ng-then="cancelled"
ng-interval="60"
>
<span class="badge badge-error"
ng-if-once="!booking.rebookedTo"
>Cancelled</span>
<span class="badge"
ng-if-once="!!booking.rebookedTo"
>Rebooked</span>
[[ booking.modifiedAt|datetime:'relative':'relative-time' ]]
</span>
<span ng-else="cancelled"
ng-interval="60"
>
<i ng-if-once="booking.rebookedFrom" class="rebooked-icon" ng-tip="[! T('Rebooked') !]"></i>
<span ng-if-once="!booking.user"
class="test-view-online-booking-action"
>
<i class="booked-online-icon"></i> Booked online
</span>
[[ booking.createdAt|datetime:'relative':'relative-time' ]]
[! booking.user.name ? interpolate(T('by %(personName)s'), { personName: booking.user.name }) : '' !]
<span ng-if-once="!!booking.user && !navigation.isCurrentCompany(booking.user.company)">
([! booking.user.company.name !])
</span>
</span>
</span>
</div>
</a>
</li>
</ul>
</script>
<script type="text/ng-template" id="dashboard.bookings.paymentLegacyFlag">
<a class="refund-legacy-flag"
ng-tip="[! T('Money for this refund may be debited from your bank account. Click to learn more.') !]"
ng-tip-location=".icon-hint"
ng-href="/help/payments/refunds/legacy/"
>Legacy charge <span class="icon-hint"></span></a>
</script>
<script type="text/ng-template" id="payment-processing">
<div class="spinner
no-margin
normal
">
<div class="spinner-inner"></div>
</div>
<div class="booking-action-loading-header">
[[ paymentCtrl.option() === paymentCtrl.EMV_OPTION ? emv.information() : T('Adding payment...') ]]
</div>
<div class="booking-action-loading">
Please do not leave or refresh this page
<div ng-if="paymentCtrl.option() === paymentCtrl.EMV_OPTION">
<a ng-click="emv.cancel()">Cancel</a>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.resourceUses">
<table class="invoice-table"
ng-if="!!resourceUses.length"
>
<tbody ng-repeat="resourceUse in resourceUses"
ng-controller="dashboard.resources.ResourceUseEditableCtrl">
<tr ng-if="editCtrl.editing" ng-then="editing">
<td class="invoice-table--editing" colspan="3">
<form name="resourceUseForm"
ng-submit="editCtrl.submit(resourceUseForm)"
ng-sonar-pause="booking when updated"
>
<div class="fields "
>
<fieldset ng-disabled="warnings.length">
<div class="table layout-fixed valign-middle table-dont-respond resource-use-setup">
<div class="tr">
<div class="td">
<div class="resourceuseform-usecount "
ng-django-field="resourceUseForm [&#39;useCount&#39;]" ng-django-field-model="editableResourceUse [&#39;useCount&#39;]"
ng-django-field-required=""
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_use_count" name="useCount" ng-float-input="" ng-float-input-decimal-places="2" ng-float-input-max-digits="6" ng-model="editableResourceUse [&#39;useCount&#39;]" ng-pattern="/^-?(\d*\.?\d+|\d+\.?\d*)$/" required="required" step="0.01" type="text" value="1.00" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="resourceUseForm [&#39;useCount&#39;].$error['pattern']">Invalid value</li>
<li ng-if="resourceUseForm [&#39;useCount&#39;].$error['invalid']">Enter a number.</li>
<li ng-repeat="error in resourceUseForm [&#39;useCount&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="td">
of
</div>
<div class="td">
<div ng-data="resourceRequirements.$promise"
ng-data-on-error="transclude"
ng-data-small
>
<div class="resourceuseform-resourcerequirement "
ng-django-field="resourceUseForm [&#39;resourceRequirement&#39;]" ng-django-field-model="editableResourceUse [&#39;resourceRequirement&#39;]"
ng-django-field-required=""
>
<div ng-current-option="editableResourceUse [&#39;resourceRequirement&#39;]"
ng-current-option-collection=""
>
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
>
<span class="the-field">
<select name="resource_requirement"
ng-model="editableResourceUse [&#39;resourceRequirement&#39;]"
ng-disabled=""
required="required"
ng-options="resourceRequirement.pk as resourceRequirement.resource.name for resourceRequirement in resourceRequirements"
ng-dropdown
>
</select>
<i ng-link="f-req"></i>
</span>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="resourceUseForm [&#39;resourceRequirement&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in resourceUseForm [&#39;resourceRequirement&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</fieldset>
</div>
<div class="hide">
<div class="resourceuseform-ignorewarnings "
ng-django-field="resourceUseForm [&#39;ignoreWarnings&#39;]" ng-django-field-model="editableResourceUse [&#39;ignoreWarnings&#39;]"
>
<label >
<span class="label-text">
Ignore warnings
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_ignore_warnings" name="ignoreWarnings" ng-model="editableResourceUse [&#39;ignoreWarnings&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in resourceUseForm [&#39;ignoreWarnings&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in resourceUseForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="prose prose-section"
ng-if="warnings.length"
>
<p ng-repeat="warning in warnings">
<b><i class="warning-icon"></i> [! warning !]</b>
</p>
</div>
<div class="btns btns--reversed">
<button class="btn btn-right btn-green"
ng-disabled="resourceUseForm.$invalid || resourceUseForm.$submitting || resourceUseForm.$pristine"
type="submit"
>
[[ resourceUseForm.$submitting ? T('Saving...') : warnings.length ? T('Save anyway') : T('Save') ]]
</button>
<button class="btn btn-grey btn--push-left" type="button"
ng-disabled="resourceUseForm.$submitting"
ng-click="cancel(resourceUseForm)"
ng-sonar-unpause="booking when updated"
>
[[ warnings.length ? T('Change options') : T('Cancel') ]]
</button>
<div ng-generic-form="removeResourceUseForm" ng-can-remove="resourceUse">
<ul class="errors"
ng-if="removeResourceUseForm.all.$error.$server"
>
<li ng-repeat="error in removeResourceUseForm.all.$error.$server">
[[ error ]]
</li>
</ul>
<button class="btn btn-red" type="button"
ng-click="editCtrl.remove(removeResourceUseForm)"
ng-confirm-click="[! T('Are you sure you want to remove this use? It cannot be added back without rebooking.') !]"
ng-disabled="removeResourceUseForm.$submitting || warnings.length"
>
[[ removeResourceUseForm.$submitting ? T('Removing...') : T('Remove') ]]
</button>
</div>
</div>
</form>
</td>
</tr>
<tr class="invoice-table--row [! canUpdateResourceUse ? 'is-editable' : '' !]"
ng-else="editing"
ng-click="canUpdateResourceUse ? editCtrl.edit() : null"
>
<td colspan="[! canUpdateResourceUse ? 2 : 3 !]" class="itable-content">
<span class="fh-grey">[! resourceUse.resourceRequirement.resource.name !]:</span>
[! resourceUse.useCount !]
</td>
<td
ng-if-once="canUpdateResourceUse"
class="itable-edit with-button respond-print-hide"
></td>
</tr>
</tbody>
</table>
</script>
<script type="text/ng-template" id="dashboard.bookings.taxByType">
<div ng-repeat="taxType in taxTypes"
ng-if="taxByType[taxType.pk]"
>
[! taxType|name !]:
[! isRefund ? '-' : '' !]<b
ng-amount="taxByType[taxType.pk]"
ng-amount-company="company"
></b>
</div>
</script>
<script type="text/ng-template" id="
aggregated-use-popover
">
<div class="popover "
ng-body-class="'hide-body-overflow--handhelds is-popover-open'"
>
<div class="triangle js-triangle"></div>
<div class="popover-content-wrap">
<div class="popover-content">
<p>
[!
aggregatedUse.popoverMessage ?
interpolate(nT('%(count)s use %(message)s', '%(count)s uses %(message)s', aggregatedUse.useCount), { count: (aggregatedUse.useCount|count), message: aggregatedUse.popoverMessage }) :
interpolate(nT('%(count)s use', '%(count)s uses', aggregatedUse.useCount), { count: (aggregatedUse.useCount|count) })
!]
</p>
<p class="fh-grey">
[! aggregatedUse.startAt|datetimeRange:(aggregatedUse.endAt):'12am+1':'always-hide-date':(popoverCtrl.date) !]
</p>
</div>
<div class="popover-content"
ng-if-once="aggregatedUse.displayLines && aggregatedUse.displayLines.length && !popoverCtrl.hasOneBookingAndAvailability"
>
<p ng-repeat="line in aggregatedUse.displayLines">
[! line !]
</p>
</div>
<ul class="popover-menu"
ng-if="popoverCtrl.view === 'main' && aggregatedUse.bookings.length && !popoverCtrl.hasOneBookingAndAvailability"
>
<li ng-if="popoverCtrl.availabilities.length">
<a class="popover-menu-action with-chevron"
ng-click="popoverCtrl.view = 'availabilities'"
ng-preserve-popover
>
[!
interpolate(nT('%(count)s availability', '%(count)s availabilities', popoverCtrl.availabilities.length), { count: popoverCtrl.availabilities.length })
!]
</a>
</li>
<li ng-else="popoverCtrl.availabilities.length">
<span class="popover-menu-content"><i class="spinner-ticker-css"><span></span></i></span>
</li>
<li ng-if="popoverCtrl.bookings.length">
<a class="popover-menu-action with-chevron"
ng-click="popoverCtrl.view = 'bookings'"
ng-preserve-popover
>
[!
interpolate(nT('%(count)s booking', '%(count)s bookings', popoverCtrl.bookings.length), { count: popoverCtrl.bookings.length })
!]
</a>
</li>
<li ng-else="popoverCtrl.bookings.length">
<span class="popover-menu-content"><i class="spinner-ticker-css"><span></span></i></span>
</li>
</ul>
<div class="popover-content popover-back"
ng-if="popoverCtrl.view !== 'main' && !popoverCtrl.hasOneBookingAndAvailability"
ng-click="popoverCtrl.view = 'main'"
ng-preserve-popover
>
Overview
</div>
<ul class="popover-content popover-scrollable"
ng-if="popoverCtrl.view === 'availabilities' || popoverCtrl.hasOneBookingAndAvailability"
>
<li ng-repeat="availability in popoverCtrl.availabilities"
ng-inline="timeline-popover-availability"
></li>
</ul>
<ul class="table-nav table-nav--no-top-bottom-borders popover-scrollable"
ng-if="popoverCtrl.view === 'bookings' || popoverCtrl.hasOneBookingAndAvailability"
>
<li ng-repeat="booking in popoverCtrl.bookings">
<a ng-href="[! booking|bookingUrl !]"
class="booking-block test-view-booking-action table-nav-item with-overlay-arrow"
ng-class="{ 'fh-grey': booking.isCancelled }"
ng-watch="booking.modifiedAt"
>
<div class="table full-width valign-top table-dont-respond booking-block-header">
<div class="tr">
<h2 class="td">
[[ booking.contact.name ]]
</h2>
<span class="td text-right">
<span ng-can-view-amounts="booking.company"
ng-can-only-when="!booking.rebookedTo"
class="badge nowrap
[! booking.isUnprocessed || booking.isCancelled ? '' : 'badge-' + booking.paidStatus|css !]"
>
[!
booking.isUnprocessed ? T('Pending') : (
booking.isCancelled ?
!booking.receipt.gross ? T('Refunded') : interpolate(T('%(amount)s Paid'), { amount: (booking.receipt.gross|amount:booking) })
: (
booking.amountDue || booking.amountOverpaid ? (
booking.amountDue ?
interpolate(T('%(amount)s Due'), { amount: (booking.amountDue|amount:booking) }) :
interpolate(T('%(amount)s Overpaid'), { amount: (booking.amountOverpaid|amount:booking) })
) : T('Paid')
)
)
!]
</span>
</span>
</div>
</div>
<ul class="booking-block-inner">
<li class="fh-grey">
[! booking.customerBreakdownShort !]
</li>
<li class="booking-block-availability">
<ul>
<li>
<div class="bold">
<i class="[! booking|colorClass:'-swatch inline-swatch' !]"></i> [! booking.availability.item|name !]
<span ng-if-once="booking.availability.headline">&mdash; [! booking.availability.headline !]</span>
</div>
</li>
<li>
<span ng-if-once="Availability.isInPast(booking.availability)"
class="badge ghost warning-color"
>Past</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt):'long' !]
</li>
<li ng-if-once="booking.isOrder" class="booking-block-order">
<i class="tb-icon stack"></i> Order #[! booking.order.identifier !]
</li>
</ul>
</li>
</ul>
<div class="booking-block-meta">
<span class="booking-block-affiliate test-view-affiliate-booking-action
[! booking.isOnline ? 'booked-via-online' :
(booking.user.company.pk === booking.affiliation.affiliateCompany.pk ? 'booked-via-affiliate-db' : '') !]
"
ng-if-once="booking.affiliation"
>
<b>
[! navigation.isCurrentCompany(booking.affiliation.affiliateCompany) ? booking.company.name : booking.affiliation.affiliateCompany.name !]
</b>
[! booking.voucherNumber ? '(' + booking.voucherNumber + ')' : '' !]
</span>
</div>
</a>
</li>
</ul>
</div>
</div>
</script>
<script type="text/ng-template" id="
create-use-popover
">
<div class="popover "
ng-body-class="'hide-body-overflow--handhelds is-popover-open'"
>
<div class="triangle js-triangle"></div>
<div class="popover-content-wrap">
<div class="popover-content">
<p ng-if-once="popoverCtrl.range && (popoverCtrl.range.availableUseCount >= 0 || !popoverCtrl.range.isSpaceFinite)">
[! popoverCtrl.range.isSpaceFinite ?
(
popoverCtrl.range.availableUseCount ?
interpolate(T('%(count)s "%(resourceName)s" available'), { count: (popoverCtrl.range.availableUseCount|count), resourceName: (popoverCtrl.range.resource|name) }) :
interpolate(T('No "%(resourceName)s" available'), { resourceName: (popoverCtrl.range.resource|name) })
) :
interpolate(T('Unlimited "%(resourceName)s" available'), { resourceName: (popoverCtrl.range.resource|name) })
!]
</p>
<p class="warning-color"
ng-if-once="popoverCtrl.range && popoverCtrl.range.availableUseCount < 0 && popoverCtrl.range.isSpaceFinite"
>
"[! popoverCtrl.range.resource|name !]" overused by [! popoverCtrl.range.availableUseCount|abs|count !].
</p>
<p class="fh-grey">
[! popoverCtrl.range.startAt|datetimeRange:(popoverCtrl.range.endAt):'12am+1':'always-hide-date':(popoverCtrl.date) !]
</p>
</div>
<div ng-data="popoverCtrl.$promise" ng-data-small>
<div class="popover-content fh-grey"
ng-if="!popoverCtrl.noAvailabilities && (!popoverCtrl.isGrouped || !popoverCtrl.selectedItem || !popoverCtrl.range.availableUseCount)"
>
<p class="fh-grey">
[! popoverCtrl.isGrouped ?
T('Choose an item to book using this resource.') :
T('Choose an availability to book using this resource.')
!]
</p>
<p class="warning-color"
ng-if-once="popoverCtrl.range && !popoverCtrl.range.availableUseCount"
>
Booking may cause overuse.
</p>
</div>
<ul class="popover-menu"
ng-if="popoverCtrl.isGrouped && !popoverCtrl.selectedItem"
>
<li ng-repeat="item in popoverCtrl.items">
<span class="popover-menu-action with-chevron"
ng-click="popoverCtrl.selectItem(item)"
ng-preserve-popover
>
[! item|name !]
</span>
</li>
</ul>
<div ng-if="(!popoverCtrl.isGrouped || popoverCtrl.selectedItem) && !popoverCtrl.noAvailabilities">
<div class="popover-content"
ng-if="popoverCtrl.isGrouped"
>
<p class="popover-back"
ng-click="popoverCtrl.selectItem()"
ng-preserve-popover
>
All items
</p>
<p>
<b>[[ popoverCtrl.selectedItem|name ]]</b>
</p>
</div>
<ul class="popover-content popover-scrollable"
ng-class="{ 'availabilities-hide-item': popoverCtrl.isGrouped }"
>
<li ng-repeat="availability in popoverCtrl.availabilities"
ng-inline="timeline-popover-availability"
></li>
</ul>
</div>
<p class="popover-content fh-grey"
ng-if="popoverCtrl.noAvailabilities"
>
[! popoverCtrl.date ?
T('No availabilities on this day will use this resource.') :
T('No availabilities in this time range will use this resource.')
!]
</p>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timeline">
<div class="timeline-timeline">
<div class="timeline-slot"
ng-repeat="slot in timelineDirectiveCtrl.slots"
>
<div class="
timeline-node js-timeline-node
[! {
'timeline-node--is-zero-length': node.isZeroLength,
'timeline-node--clipped-start': node.isStartClipped,
'timeline-node--clipped-end': node.isEndClipped,
'timeline-node--first': node.isFirst,
'timeline-node--last': node.isLast
}|addClasses !]
"
ng-style-once="node.css"
ng-repeat="node in slot"
ng-tip="[! node.instance.startAt|datetimeRange:(node.instance.endAt):'12am+1':'always-hide-date':(timelineDirectiveCtrl.date) !]"
ng-tip-classes="tip-indent"
ng-tip-when="timelineDirectiveCtrl.needsTip"
ng-init="instance = node.instance"
>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineDefaultTemplate">
<div></div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineTimeHeading">
<div class="timeline-time">
[! instance.displayName !]
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineAvailability">
<a
ng-open-availability-popover="availability"
ng-open-availability-popover-resource="resource"
ng-open-availability-popover-with-cal-block
ng-open-popover-near-cursor
ng-start-booking
ng-shift-or-alt-navigate="[! !rebook.currentBooking ? (availability.$url(urls.company.item.book) + (resource ? '?select-resource=' + resource.pk : '' )) : (availability|availabilityUrl) !]"
ng-confirm-click="[! T('This availability is in the past. Do you still want to rebook to it?') !]"
ng-confirm-click-when="Availability.isInPast(availability) && ($event.shiftKey || $event.altKey)"
ng-class="{
highlight: availabilityUpdater && availabilityUpdater.highlightedAvailabilityPks[availability.pk]
}"
ng-init="
availability = instance;
bookableCapacity = calendarFilter.countBlockedAsFilled !== false ? availability.bookableCapacity : availability.blocksIncludedBookableCapacity;
nonResourceBookableCapacity = calendarFilter.countBlockedAsFilled !== false ? availability.nonResourceBookableCapacity : availability.blocksIncludedNonResourceBookableCapacity;
"
class="cal-block test-select-availability-action
is-timeline-node
[! calendarFilter.isColorCoded ?
(availability|colorClass:'-fill') + ' ava-no-capacity-color' :
''
!]
[! availability|capacityClass:undefined:calendarFilter.countBlockedAsFilled !]
[! availability.customerCount ? (bookableCapacity !== null ? 'is-showing-progress' : '') : 'is-empty' !]
[! availability.isResourcesAvailable ? '' : 'is-dimmed-when-empty' !]
"
>
<div class="timeline-node-content-wrap">
<i class="presence-small-editing"
ng-presence-indicator="[! availability.uri !]:book"
ng-presence-tip="[[ interpolate(nT('%(count)s user booking', '%(count)s users booking', channel.userCount), { count: channel.userCount }) ]]"
></i>
<i class="cb-icon [! availability|onlineStatusClass !]"></i>
<i ng-if-once="!availability.item.company.companyFeatures.isResourceBookableCapacityEnabled && !availability.isResourcesAvailable"
class="ab-icon-lock icon-lock-red respond-print-hide"
ng-tip="[! T('No open resources') !]"
></i>
<b ng-else-once="availability|isAllDay" class="cb-time">
[! (availability.startAt|time:(availability.endAt)) !]
</b>
<b class="cb-item">
[! availability.item|name !]
</b>
<b class="cb-headline" ng-show-once="availability.headline">
&mdash;
<span ng-bind-once="availability.headline"></span>
</b>
<b class="cb-private-headline"
ng-if="availability.headlinePrivate && (calendarFilter.showPrivateHeadline || !calendarFilter)"
>[! availability.headlinePrivate !]</b>
<div class="cb-stat"
ng-can="viewCapacities on availability"
ng-can-only-when="calendarFilter.showEmptySeats || calendarFilter.showFilledSeats || !calendarFilter"
ng-init="
isFull = bookableCapacity === 0;
isOverbooked = 0 > nonResourceBookableCapacity;
"
>
<div ng-if-once="company.companyFeatures.isResourceBookableCapacityEnabled" ng-then="resourceBookableCapacityEnabled">
<span class="badge" ng-if-once="availability.customerCount && isFull && !isOverbooked">Full</span>
<span ng-if="calendarFilter.showFilledSeats || !calendarFilter" ng-tip="[! T('Booked') !]" ng-tip-location="i" class="cb-inline-stat">
<i class="cb-square filled"></i>
[! availability.customerCount !]
</span>
<span ng-if="(calendarFilter.showEmptySeats || !calendarFilter) && bookableCapacity !== null"
ng-tip="[! T('Available to book') !]" ng-tip-location="i"
class="cb-inline-stat"
>
<i class="cb-square"></i>
[! bookableCapacity !]
</span>
<div ng-if-once="availability.customerCount > 0 && isOverbooked">
<span class="badge">
[! interpolate(T('Overbooked by %(count)s'), { count: (-nonResourceBookableCapacity) }) !]
</span>
</div>
<div ng-if-once="availability.isOverusingResources">
Overusing resources
</div>
</div>
<div ng-else-once="resourceBookableCapacityEnabled">
<div ng-if-once="availability.capacity === null" ng-then="nullCapacity">
<div ng-if="calendarFilter.showFilledSeats">
<i ng-svg="svg-user" ng-tip="[! T('Booked') !]"></i>
[! availability.customerCount !]
</div>
</div>
<div ng-else="nullCapacity">
<div ng-if-once="bookableCapacity > 0 || (availability.customerCount === 0 && bookableCapacity === 0)">
<div ng-if="calendarFilter.showFilledSeats">
<i ng-svg="svg-user" ng-tip="[! T('Booked') !]"></i>
[! availability.customerCount !]/[! availability.capacity !]
</div>
<div ng-if="calendarFilter.showEmptySeats || !calendarFilter">
<i ng-svg="svg-user-outline" ng-tip="[! T('Available to book') !]"></i>
[! bookableCapacity !== availability.capacity ? bookableCapacity + '/' : '' !][! availability.capacity !]
</div>
</div>
[! (availability.customerCount > 0) && (nonResourceBookableCapacity === 0) ?
interpolate(T('All %(count)s full'), { count: availability.customerCount }) :
''
!]
<span class="[! calendarFilter.isColorCoded ? 'color-fill-primary color-coded-overbooked-message' : '' !]"
ng-if-once="availability.customerCount > 0 && isOverbooked"
>
[! interpolate(T('Overbooked by %(count)s'), { count: (-nonResourceBookableCapacity) }) !]
</span>
</div>
</div>
</div>
<ul class="cb-list crew" ng-if="availability.groupedCrewMembers.length && calendarFilter.showCrew">
<li ng-repeat="group in availability.groupedCrewMembers">
<span ng-if="!!group.role" class="fh-grey">[[ group.role.shortName ]]:</span>
<span ng-repeat="crewMember in group.crewMembers">
[! crewMember.user.name + ($last ? '' : ',') !]
</span>
</li>
</ul>
<ul ng-if="availability.resourceUseSummaries.length && calendarFilter.showResources" class="cb-list resources">
<li ng-repeat="resourceUseSummary in availability.resourceUseSummaries"
ng-if="
(calendarFilter.showAllResources || calendarFilter.visibleResources[resourceUseSummary.resource.uri])
&&
(resourceUseSummary.totalUseCount > 0 || calendarFilter.showVirtualResources)
&&
(!resource || resource === resourceUseSummary.resource)
"
>
<b>[! resourceUseSummary.resource|name !]:</b> [! resourceUseSummary.totalUseCount|count !]
</li>
</ul>
</div>
<div class="cb-progress"
ng-if-once="availability.customerCount && bookableCapacity !== null"
ng-style-once="{ 'width': ((availability.customerCount / (availability.customerCount + bookableCapacity))|cssPercentage) }"
></div>
</a>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineAggregatedUse">
<div class="
timeline-node-content
timeline-aggregated-use
[[ calendarFilter.isColorCoded ?
(instance.groupingObject|colorClass:'-fill':'color-resource-use') :
'color-resource-use'
]]
"
ng-open-aggregated-use-popover="instance"
ng-open-aggregated-use-popover-date="timelineDirectiveCtrl.date"
ng-open-popover-near-cursor
>
<div class="timeline-node-content-wrap">
<p ng-repeat="line in instance.displayLines">
<span class="timeline-aggregated-use-count"
ng-if-once="$first"
>[! (instance.useCount|count) !]</span>
[! line !]
</p>
<p class="timeline-aggregated-use-count"
ng-else-once="instance.displayLines.length"
>
[! (instance.useCount|count) !]
</p>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineResourceOverride">
<div class="timeline-node-content timeline-resource-override color-resource-override"
ng-open-resource-override-popover="instance"
ng-open-resource-override-popover-date="timelineDirectiveCtrl.date"
ng-open-popover-near-cursor
>
[! instance.maximumUseCount|count !]
<span>
[! instance.maximumUseCount !== null ? cT('Short for maximum', 'max') : T('Unlimited') !]
[! instance.note ? '(' + (instance.note|firstLineOfMarkdown) + ')' : '' !]
</span>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineUseOverviewRange">
<div class="timeline-node-multiple-content">
<div class="timeline-node-content timeline-overview-range timeline-zero-length-overview color-resource-use"
ng-if-once="instance.zeroLengthOverview"
ng-open-aggregated-use-popover="instance.zeroLengthOverview"
ng-open-aggregated-use-popover-date="timelineDirectiveCtrl.date"
ng-open-popover-near-cursor
ng-tip="[! instance.startAt|datetime:(instance.startAt):'always-hide-date':(timelineDirectiveCtrl.date) !]"
ng-tip-classes="tip-indent"
></div>
<div class="timeline-node-content timeline-overview-range color-resource-use"
ng-open-aggregated-use-popover="instance"
ng-open-aggregated-use-popover-date="timelineDirectiveCtrl.date"
ng-open-popover-near-cursor
ng-tip="[! instance.startAt|datetimeRange:(instance.endAt):'12am+1':'always-hide-date':(timelineDirectiveCtrl.date) !]"
ng-tip-classes="tip-indent"
>
<div>
[! (instance.useCount|count) !] <span>used</span>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineTotalCapacityOverviewRange">
<div class="timeline-node-content timeline-overview-range color-resource-override"
ng-open-total-capacity-overview-range-popover="instance"
ng-open-total-capacity-overview-range-popover-date="timelineDirectiveCtrl.date"
ng-open-popover-near-cursor
>
<div>
[! instance.isMaxFinite ? (instance.maximumUseCount|count) : '' !]
<span>
[! instance.isMaxFinite ? cT('Short for maximum', 'max') : T('Unlimited') !]
</span>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineSpaceOverviewRange">
<div class="timeline-node-multiple-content">
<div class="
timeline-node-content timeline-overview-range timeline-zero-length-overview color-timeline-space-overview
[! addClassIf(instance.availableUseCount < 0, 'color-timeline-space-overview--overused') !]
"
ng-if-once="instance.zeroLengthOverview"
ng-open-create-use-popover="instance.resource"
ng-open-create-use-popover-date="timelineDirectiveCtrl.date"
ng-open-create-use-popover-range="instance.zeroLengthOverview"
ng-open-popover-near-cursor
ng-tip="[! instance.startAt|datetime:(instance.startAt):'always-hide-date':(timelineDirectiveCtrl.date) !]"
ng-tip-classes="tip-indent"
></div>
<div class="
timeline-node-content timeline-overview-range color-timeline-space-overview
[! addClassIf(instance.availableUseCount < 0, 'color-timeline-space-overview--overused') !]
"
ng-open-create-use-popover="instance.resource"
ng-open-create-use-popover-date="timelineDirectiveCtrl.date"
ng-open-create-use-popover-range="instance"
ng-open-popover-near-cursor
ng-tip="[! instance.startAt|datetimeRange:(instance.endAt):'12am+1':'always-hide-date':(timelineDirectiveCtrl.date) !]"
ng-tip-classes="tip-indent"
>
<div>
[! instance.isSpaceFinite ? (instance.availableUseCount|abs|count) : '' !]
<span>
[! instance.isSpaceFinite ? (instance.availableUseCount >= 0 ? cT('As in "available"', 'free') : T('overused')) : T('Unlimited') !]
</span>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.bookings.timelineHeading">
<div ng-dimensions="timelineHeadingDimensions">
<div ng-timeline="timelineHeadingCtrl.timeHeadings(timelineHeadingDimensions.width)"
ng-timeline-template="dashboard.bookings.timelineTimeHeading"
ng-timeline-start-at="timelineHeadingCtrl.minStartAt"
ng-timeline-end-at="timelineHeadingCtrl.maxEndAt"
ng-timeline-date="timelineHeadingCtrl.date"
></div>
</div>
</script>
<script type="text/ng-template" id="
resource-override-popover
">
<div class="popover "
ng-body-class="'hide-body-overflow--handhelds is-popover-open'"
>
<div class="triangle js-triangle"></div>
<div class="popover-content-wrap">
<div class="popover-content">
<p>
[! override.maximumUseCount !== null ?
interpolate(T('Changes the maximum capacity of "%(resourceName)s" to %(maxCount)s, overriding the default value of %(minCount)s.'),
{ resourceName: (override.resource|name), maxCount: (override.maximumUseCount|count), minCount: (override.resource.maximumUseCount|count) }) :
interpolate(T('Changes the maximum capacity of "%(resourceName)s" to unlimited, overriding the default value of %(count)s.'),
{ resourceName: (override.resource|name), count: (override.resource.maximumUseCount|count) })
!]
</p>
<p class="fh-grey">
[! override.startAt|datetimeRange:(override.endAt):'12am+1':'always-hide-date':(popoverCtrl.date) !]
</p>
</div>
<div class="popover-content prose"
ng-if-once="override.noteSafeHtml"
ng-bind-html-once="override.noteSafeHtml"
></div>
</div>
</div>
</script>
<script type="text/ng-template" id="timeline-popover-availability">
<a
ng-open-availability-popover="availability"
ng-open-availability-popover-resource="resource"
ng-open-popover-preserving-others
ng-start-booking
ng-shift-or-alt-navigate="[! !rebook.currentBooking ? (availability.$url(urls.company.item.book) + (resource ? '?select-resource=' + resource.pk : '' )) : (availability|availabilityUrl) !]"
ng-confirm-click="[! T('This availability is in the past. Do you still want to rebook to it?') !]"
ng-confirm-click-when="Availability.isInPast(availability) && ($event.shiftKey || $event.altKey)"
ng-class="{
highlight: availabilityUpdater && availabilityUpdater.highlightedAvailabilityPks[availability.pk]
}"
ng-init="
bookableCapacity = calendarFilter.countBlockedAsFilled !== false ? availability.bookableCapacity : availability.blocksIncludedBookableCapacity;
nonResourceBookableCapacity = calendarFilter.countBlockedAsFilled !== false ? availability.nonResourceBookableCapacity : availability.blocksIncludedNonResourceBookableCapacity;
"
class="cal-block test-select-availability-action
[! calendarFilter.isColorCoded ?
(availability|colorClass:'-fill') + ' ava-no-capacity-color' :
''
!]
[! availability|capacityClass:undefined:calendarFilter.countBlockedAsFilled !]
[! availability.customerCount ? (bookableCapacity !== null ? 'is-showing-progress' : '') : 'is-empty' !]
[! availability.isResourcesAvailable ? '' : 'is-dimmed-when-empty' !]
"
>
<i class="presence-small-editing"
ng-presence-indicator="[! availability.uri !]:book"
ng-presence-tip="[[ interpolate(nT('%(count)s user booking', '%(count)s users booking', channel.userCount), { count: channel.userCount }) ]]"
></i>
<i class="cb-icon [! availability|onlineStatusClass !]"></i>
<i ng-if-once="!availability.item.company.companyFeatures.isResourceBookableCapacityEnabled && !availability.isResourcesAvailable"
class="ab-icon-lock icon-lock-red respond-print-hide"
ng-tip="[! T('No open resources') !]"
></i>
<b ng-else-once="availability|isAllDay" class="cb-time">
[! (availability.startAt|time:(availability.endAt)) !]
</b>
<b class="cb-item">
[! availability.item|name !]
</b>
<b class="cb-headline" ng-show-once="availability.headline">
&mdash;
<span ng-bind-once="availability.headline"></span>
</b>
<b class="cb-private-headline"
ng-if="availability.headlinePrivate && (calendarFilter.showPrivateHeadline || !calendarFilter)"
>[! availability.headlinePrivate !]</b>
<div class="cb-stat"
ng-can="viewCapacities on availability"
ng-can-only-when="calendarFilter.showEmptySeats || calendarFilter.showFilledSeats || !calendarFilter"
ng-init="
isFull = bookableCapacity === 0;
isOverbooked = 0 > nonResourceBookableCapacity;
"
>
<div ng-if-once="company.companyFeatures.isResourceBookableCapacityEnabled" ng-then="resourceBookableCapacityEnabled">
<span class="badge" ng-if-once="availability.customerCount && isFull && !isOverbooked">Full</span>
<span ng-if="calendarFilter.showFilledSeats || !calendarFilter" ng-tip="[! T('Booked') !]" ng-tip-location="i" class="cb-inline-stat">
<i class="cb-square filled"></i>
[! availability.customerCount !]
</span>
<span ng-if="(calendarFilter.showEmptySeats || !calendarFilter) && bookableCapacity !== null"
ng-tip="[! T('Available to book') !]" ng-tip-location="i"
class="cb-inline-stat"
>
<i class="cb-square"></i>
[! bookableCapacity !]
</span>
<div ng-if-once="availability.customerCount > 0 && isOverbooked">
<span class="badge">
[! interpolate(T('Overbooked by %(count)s'), { count: (-nonResourceBookableCapacity) }) !]
</span>
</div>
<div ng-if-once="availability.isOverusingResources">
Overusing resources
</div>
</div>
<div ng-else-once="resourceBookableCapacityEnabled">
<div ng-if-once="availability.capacity === null" ng-then="nullCapacity">
<div ng-if="calendarFilter.showFilledSeats">
<i ng-svg="svg-user" ng-tip="[! T('Booked') !]"></i>
[! availability.customerCount !]
</div>
</div>
<div ng-else="nullCapacity">
<div ng-if-once="bookableCapacity > 0 || (availability.customerCount === 0 && bookableCapacity === 0)">
<div ng-if="calendarFilter.showFilledSeats">
<i ng-svg="svg-user" ng-tip="[! T('Booked') !]"></i>
[! availability.customerCount !]/[! availability.capacity !]
</div>
<div ng-if="calendarFilter.showEmptySeats || !calendarFilter">
<i ng-svg="svg-user-outline" ng-tip="[! T('Available to book') !]"></i>
[! bookableCapacity !== availability.capacity ? bookableCapacity + '/' : '' !][! availability.capacity !]
</div>
</div>
[! (availability.customerCount > 0) && (nonResourceBookableCapacity === 0) ?
interpolate(T('All %(count)s full'), { count: availability.customerCount }) :
''
!]
<span class="[! calendarFilter.isColorCoded ? 'color-fill-primary color-coded-overbooked-message' : '' !]"
ng-if-once="availability.customerCount > 0 && isOverbooked"
>
[! interpolate(T('Overbooked by %(count)s'), { count: (-nonResourceBookableCapacity) }) !]
</span>
</div>
</div>
</div>
<ul class="cb-list crew" ng-if="availability.groupedCrewMembers.length && calendarFilter.showCrew">
<li ng-repeat="group in availability.groupedCrewMembers">
<span ng-if="!!group.role" class="fh-grey">[[ group.role.shortName ]]:</span>
<span ng-repeat="crewMember in group.crewMembers">
[! crewMember.user.name + ($last ? '' : ',') !]
</span>
</li>
</ul>
<ul ng-if="availability.resourceUseSummaries.length && calendarFilter.showResources" class="cb-list resources">
<li ng-repeat="resourceUseSummary in availability.resourceUseSummaries"
ng-if="
(calendarFilter.showAllResources || calendarFilter.visibleResources[resourceUseSummary.resource.uri])
&&
(resourceUseSummary.totalUseCount > 0 || calendarFilter.showVirtualResources)
&&
(!resource || resource === resourceUseSummary.resource)
"
>
<b>[! resourceUseSummary.resource|name !]:</b> [! resourceUseSummary.totalUseCount|count !]
</li>
</ul>
<div class="cb-progress"
ng-if-once="availability.customerCount && bookableCapacity !== null"
ng-style-once="{ 'width': ((availability.customerCount / (availability.customerCount + bookableCapacity))|cssPercentage) }"
></div>
</a>
</script>
<script type="text/ng-template" id="
total-capacity-overview-range-popover
">
<div class="popover "
ng-body-class="'hide-body-overflow--handhelds is-popover-open'"
>
<div class="triangle js-triangle"></div>
<div class="popover-content-wrap">
<div class="popover-content">
<p>
[!
range.isMaxFinite ? (
range.maximumUseCount ?
interpolate(nT('%(count)s use of "%(resourceName)s" is allowed', '%(count)s uses of "%(resourceName)s" are allowed', range.maximumUseCount), { count: (range.maximumUseCount|count), resourceName: (range.resource|name) }) :
interpolate(T('No use of "%(resourceName)s" is allowed'), { resourceName: (range.resource|name) })
) :
interpolate(T('Unlimited use of "%(resourceName)s" is allowed'), { resourceName: (range.resource|name) })
!]
</p>
<p class="fh-grey">
[! range.startAt|datetimeRange:(range.endAt):'12am+1':'always-hide-date':(popoverCtrl.date) !]
</p>
</div>
<div class="popover-content [! addClassIf(!range.overrides.length, 'fh-grey') !]">
[!
range.overrides.length ?
interpolate(nT('%(count)s override in this range', '%(count)s overrides in this range', range.overrides.length), { count: (range.overrides.length|count) }) :
T('No overrides in this range')
!].
<span ng-if-once="range.overrides.length > 1">
The override with the lowest value takes precedence.
</span>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.settings.CampaignValidityRules">
<table class="spreadsheet" ng-table="dateRangeCollection"
ng-init="typeChoices = {&quot;before-ava-midnight&quot;:&quot;Days before midnight on day of availability&quot;,&quot;code-exp-availability&quot;:&quot;Days after code generation (availability start date)&quot;,&quot;range-for-availability&quot;:&quot;Availabilities on&quot;,&quot;range-for-booking&quot;:&quot;Booking on&quot;,&quot;code-exp-booking&quot;:&quot;Days after code generation (booking creation date)&quot;}"
>
<thead class="ss-header ss-header-shade">
<tr>
<td ng-table-header="typeChoices[$row.type]">For</td>
<td ng-table-header="$row.days; $row.startAt" ng-table-header-default>When</td>
<td>Days</td>
<td></td>
</tr>
</thead>
<tbody>
<tr ng-repeat="campaignValidityRule in $table.collection">
<td>[! typeChoices[campaignValidityRule.type] !]</td>
<td ng-if-once="campaignValidityRule.type == CampaignValidityRule.DAYS_BEFORE_AVAILABILITY_MIDNIGHT_TYPE"
ng-then="daysBefore"
>
[! campaignValidityRule.days === 0 ? T('Day of') : interpolate(nT('%(count)s day before', '%(count)s days before', campaignValidityRule.days), { count: campaignValidityRule.days }) !]
</td>
<td ng-if-once="showDaysAfter(campaignValidityRule.type)"
ng-then="daysAfter"
>
[! interpolate(nT('%(count)s day after', '%(count)s days after', campaignValidityRule.days), { count: campaignValidityRule.days }) !]
</td>
<td ng-else="daysBefore || daysAfter">
[! campaignValidityRule.startAt|datetimeRange:(campaignValidityRule.endAt) !]
</td>
<td>
[! CampaignValidityRule.displayDayPattern(campaignValidityRule) !]
</td>
<td class="show-links">
<a
ng-confirm-click="[! T('Are you sure you want to delete these dates?') !]"
ng-click="listCtrl.remove(campaignValidityRule)">
Delete
</a>
</td>
</tr>
</tbody>
</table>
</script>
<script type="text/ng-template" id="dashboard.settings.UseCount">
<div class="tb-flyout-wrap"
ng-if-once="useCountCtrl.canViewUseCount"
ng-with="useCountFlyoutToggle = 'useCountFlyout-' + $id"
>
<div class="tb-btn tb-btn--flyout"
ng-toggle ng-toggle-value="useCountFlyoutToggle"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<span class="respond-handhelds-show">
<i class="tb-icon hamburger"></i>
</span>
<span ng-if="useCountCtrl.btnText"
ng-bind="useCountCtrl.btnText"
></span>
<span ng-else="useCountCtrl.btnText">
[[ interpolate(nT('Added to %(count)s %(singularName)s', 'Added to %(count)s %(pluralName)s', useCountCtrl.count),
{ count: useCountCtrl.count, singularName: useCountCtrl.model.verboseName, pluralName: useCountCtrl.model.verboseNamePlural }) ]]
</span>
</div>
<div ng-toggled ng-toggled-value="useCountFlyoutToggle"
ng-toggle-group="tb-flyouts"
class="tb-flyout"
>
<div ng-link="mobile-flyout-close" ng-with="toggle = useCountFlyoutToggle"></div>
<div ng-uses></div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.settings.uses">
<div ng-if="usesCtrl.status === 'loading'">
<div class="flyout-section">
<span class="hint">Loading...</span>
</div>
</div>
<div ng-if="usesCtrl.status === 'success'">
<div ng-if="!usesCtrl.archivedObjects.length && !usesCtrl.unarchivedObjects.length" ng-then="noObjects"
class="flyout-section"
>
<div class="hint">
<span ng-link="dashboard.settings.uses.[! usesCtrl.propertyName !].hint"></span>
</div>
</div>
<div ng-else="noObjects">
<div class="flyout-checklist-header"
ng-link="dashboard.settings.uses.[! usesCtrl.propertyName !].header"
></div>
<ul class="flyout-menu-items with-arrows">
<li ng-repeat="object in usesCtrl.unarchivedObjects">
<a ng-href="[! object.$url(usesCtrl.url) !]">[! usesCtrl.name(object) !]</a>
</li>
</ul>
<div ng-if="usesCtrl.archivedObjects.length">
<a class="flyout-toggle-header small has-border"
ng-toggle="archivedObjectsList"
>
Archived ([[ usesCtrl.archivedObjects.length|count ]])
</a>
<ul class="flyout-menu-items with-arrows"
ng-toggled="archivedObjectsList"
>
<li ng-repeat="object in usesCtrl.archivedObjects">
<a ng-href="[! object.$url(usesCtrl.url) !]">[! usesCtrl.name(object) !]</a>
</li>
</ul>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CustomFieldItems.header">
<span>Items this field is added to:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CustomFieldItems.hint">
<span>
To use this field, add it to an item in the <a ng-href="[! company.$url(urls.dashboard.items.index) !]">Item's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CustomerTypeItems.header">
<span>Items this customer type is used on:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CustomerTypeItems.hint">
<span>
To use this customer type, add it to an item in the <a ng-href="[! company.$url(urls.dashboard.items.index) !]">Item's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.ResourceItems.header">
<span>Items this resource is added to:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.ResourceItems.hint">
<span>
To use this resource, add it to an item in the <a ng-href="[! company.$url(urls.dashboard.items.index) !]">Item's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.ResourceRequirementGroups.header">
<span>Resource requirements this resource is added to:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.ResourceRequirementGroups.hint">
<span>
To use this resource, add it as a resource requirement in an <a ng-href="[! company.$url(urls.dashboard.items.index) !]">Item's settings</a> or the <a ng-href="[! company.$url(urls.dashboard.settings.requirementGroups.index) !]">Company's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CampaignCustomFields.header">
<span>Custom fields this campaign is used on:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CampaignCustomFields.hint">
<span>
To use this campaign, add it to a custom field in the <a ng-href="[! company.$url(urls.dashboard.settings.customFields.index) !]">Custom Field's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CancellationPolicyAffiliations.header">
<span>Affiliates using this cancellation policy:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CancellationPolicyAffiliations.hint">
<span>
Add this cancellation policy to an affiliate by editing the <a ng-href="[! company.$url(urls.dashboard.settings.network.affiliates.index) !]">affiliate's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CancellationPolicyItems.header">
<span>Items this cancellation policy is used on:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CancellationPolicyItems.hint">
<span>
Assign this cancellation policy to an item by adding it in the <a ng-href="[! company.$url(urls.dashboard.items.index) !]">Item's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.ItemFlowNodes.header">
<span>
[[ item.name ]] appears in these flow pages:
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.ItemFlowNodes.hint">
<span>
[[ item.name ]] does not appear in any flow pages. Add it to one in the <a ng-href="[! company.$url(urls.dashboard.settings.flows.index) !]">Booking flow settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CannedMessageItems.header">
<span>Items using this canned message:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.CannedMessageItems.hint">
<span>
Add this canned message to a reminder or follow-up email in an <a ng-href="[! company.$url(urls.dashboard.items.index) !]">Item's settings</a>.
<a ng-href="https://fareharbor.com/help/dashboard/communication/canned-messages/#using"
ng-outbound-link="_blank"
class="hint-help-link nowrap"
>Learn more</a>
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.BookingRestrictionItems.header">
<span>Items using this booking restriction:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.BookingRestrictionItems.hint">
<span>
Assign this booking restriction to an item by adding it in the <a ng-href="[! company.$url(urls.dashboard.items.index) !]">Item's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.scheduleAffiliations.header">
<span>Affiliations using this sheet:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.scheduleAffiliations.hint">
<span>
Assign this schedule to an affiliate by editing the <a ng-href="[! company.$url(urls.dashboard.settings.network.affiliates.index) !]">affiliate's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.totalSheetSchedules.header">
<span>Schedules using this sheet:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.totalSheetSchedules.hint">
<span>
Add this sheet to a schedule by editing a <a ng-href="[! company.$url(urls.dashboard.settings.pricing.schedules) !]">Schedule's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.invoiceSheetSchedules.header">
<span>Schedules using this sheet:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.invoiceSheetSchedules.hint">
<span>
Add this sheet to a schedule by editing a <a ng-href="[! company.$url(urls.dashboard.settings.pricing.schedules) !]">Schedule's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.totalSheetAffiliations.header">
<span>Affiliates using this sheet:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.totalSheetAffiliations.hint">
<span>
Add this sheet to an affiliate by editing the <a ng-href="[! company.$url(urls.dashboard.settings.network.affiliates.index) !]">affiliate's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.invoiceSheetAffiliations.header">
<span>Affiliates using this sheet:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.invoiceSheetAffiliations.hint">
<span>
Add this sheet to an affiliate by editing the <a ng-href="[! company.$url(urls.dashboard.settings.network.affiliates.index) !]">affiliate's settings</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.routeItems.header">
<span>Items using this route:</span>
</script>
<script type="text/ng-template" id="dashboard.settings.uses.routeItems.hint">
<span>
To use this route, add it to an <a ng-href="[! company.$url(urls.dashboard.bookings.index) !]">availability's settings.</a>.
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.ResellerAvailabilityCount">
<span class="tb-text">
Matches up to <b>[[ object['availabilityCount'] ]]</b> future availabilities
<span class="icon-hint" ng-tip="[! tip !]"></span>
</span>
</script>
<script type="text/ng-template" id="dashboard.settings.cancellationRule.summary">
<ul ng-init="
typeField = isUpdate ? 'baseType' : 'type';
hoursBeforeType = isUpdate ? 'hoursBeforeType' : 'type';
">
<li>
<b>When:</b>
<span ng-if="cancellationRule[typeField] === CancellationRule.ALWAYS_TYPE"
ng-then="always"
>
any time
</span>
<span ng-else="always">
<span ng-if="cancellationRule[hoursBeforeType] === CancellationRule.HOURS_BEFORE_AVAILABILITY_MIDNIGHT_TYPE"
ng-then="beforeMidnight"
>
earlier than [[ cancellationRule.hours ]] hours before midnight on day of availability
</span>
<span ng-else="beforeMidnight">
earlier than [[ cancellationRule.hours ]] hours before availability start time
</span>
</span>
</li>
<li ng-if="cancellationRule.isCancellationAllowed"
ng-with="
charterRefundPercentage = ( isUpdate ? (cancellationRule.charterRefundPercentage + '%') : (cancellationRule.charterRefundPercentage|percentage:'hideplus') );
affiliateRefundPercentage = ( isUpdate ? (cancellationRule.affiliateRefundPercentage ? '100%' : '0%') : (cancellationRule.affiliateRefundPercentage|percentage:'hideplus') );
"
>
<b>Refund:</b>
[[ charterRefundPercentage ]] of company payments and [[ affiliateRefundPercentage ]] of affiliate payments
</li>
<li ng-else="cancellationRule.isCancellationAllowed">
<b>Cancellation:</b> Not allowed
</li>
</ul>
</script>
<script type="text/ng-template" id="
flow-node-popover
">
<div class="popover
popover--elevated
"
ng-body-class="'hide-body-overflow--handhelds is-popover-open'"
>
<div class="triangle js-triangle"></div>
<div class="popover-content-wrap">
<div class="ng-dropdown-context"
ng-controller="dashboard.flows.FlowNodeEditableCtrl"
ng-preserve-popover
>
<div class="flyout-section"
ng-if="flowNode.type === FlowNode.PAGE_TYPE"
>
<a class="btn btn-darkgrey btn-wide"
ng-click="expandFlowPage(flowNode)"
>Edit page&nbsp;&raquo;</a>
</div>
<form name="flowNodeForm"
ng-submit="editCtrl.submit(flowNodeForm)"
ng-autofocus
ng-confirm-navigate-away
>
<div class="fields "
>
<div class="flyout-section flyout-section--shade nowrap--desktop"
ng-if="flowNode.type !== FlowNode.PAGE_TYPE"
>
<ul class="list-filters">
<li ng-toggle="blockDisplay"
ng-toggle-group="blockNav"
ng-toggle-default="true"
>
Display
</li>
<li ng-toggle="blockSettings"
ng-toggle-group="blockNav"
>
[! flowNode.type|capitalize !] Settings
</li>
</ul>
</div>
<div class="flyout-section labels-above"
ng-show="toggles.state('blockDisplay') || flowNode.type === FlowNode.PAGE_TYPE"
>
<div class="hint" ng-if="flowNode.type == FlowNode.ITEM_TYPE">
Item name (heading), headline (subheading), and image are used here unless you override them.
</div>
<div class="hint" ng-if="flowNode.type == FlowNode.PAGE_TYPE">
Page name (heading) is used here unless you override it.
</div>
<div class="flownodeform-properties-heading "
ng-django-field="flowNodeForm [&#39;properties&#39; + &#39;-&#39; + &#39;heading&#39;]" ng-django-field-model="editableFlowNode [&#39;properties&#39; + &#39;-&#39; + &#39;heading&#39;]"
>
<label >
<span class="label-text">
Heading
</span>
<span class="the-field-outer"
ng-class="{ '-is-translatable': company.companyFeatures.isContentTranslationEnabled && auth.permissions.canList(SupportedLanguage, company) && editableFlowNode.pk }"
>
<span class="the-field">
<input data-lpignore="true" id="id_properties-heading" maxlength="128" name="heading" ng-model="editableFlowNode [&#39;properties&#39; + &#39;-&#39; + &#39;heading&#39;]" ng-placeholder="[[ (currentOptions.chosenItem || flowNode).name ]]" ng-prefix="'properties'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<a class="translation-jump-link"
ng-open-supported-languages-popover="&#39;properties&#39; + &#39;-&#39; + &#39;heading&#39;"
ng-open-supported-languages-popover-field-name="heading"
ng-open-supported-languages-popover-field-ng-model="editableFlowNode"
ng-open-supported-languages-popover-parent-field="'properties'"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableFlowNode.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
</a>
<ul class="errors">
<li ng-repeat="error in flowNodeForm [&#39;properties&#39; + &#39;-&#39; + &#39;heading&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="flownodeform-properties-subheading "
ng-django-field="flowNodeForm [&#39;properties&#39; + &#39;-&#39; + &#39;subheading&#39;]" ng-django-field-model="editableFlowNode [&#39;properties&#39; + &#39;-&#39; + &#39;subheading&#39;]"
>
<label >
<span class="label-text">
Subheading
</span>
<span class="the-field-outer"
ng-class="{ '-is-translatable': company.companyFeatures.isContentTranslationEnabled && auth.permissions.canList(SupportedLanguage, company) && editableFlowNode.pk }"
>
<span class="the-field">
<input data-lpignore="true" id="id_properties-subheading" maxlength="100" name="subheading" ng-model="editableFlowNode [&#39;properties&#39; + &#39;-&#39; + &#39;subheading&#39;]" ng-placeholder="[[ currentOptions.chosenItem ? currentOptions.chosenItem.headline : '' ]]" ng-prefix="'properties'" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<a class="translation-jump-link"
ng-open-supported-languages-popover="&#39;properties&#39; + &#39;-&#39; + &#39;subheading&#39;"
ng-open-supported-languages-popover-field-name="subheading"
ng-open-supported-languages-popover-field-ng-model="editableFlowNode"
ng-open-supported-languages-popover-parent-field="'properties'"
ng-open-popover-preserving-others
ng-can-list="SupportedLanguage on company"
ng-can-only-when="company.isCharter && company.companyFeatures.isContentTranslationEnabled && editableFlowNode.pk"
ng-tip="[! T('Translations') !]"
ng-tip-classes="tip-indent"
>
<i class="tb-icon globe"></i>
</a>
<ul class="errors">
<li ng-repeat="error in flowNodeForm [&#39;properties&#39; + &#39;-&#39; + &#39;subheading&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="field field-imageupload">
<label>
<span class="label-text">
Background image
</span>
<span class="the-field-outer">
<span class="the-field">
<div >
<span ng-if="imageUploadCtrl.image.isSelected"
class="image-upload-preview"
>
<img ng-image="imageUploadCtrl.image.url"
/>
</span>
<div ng-can-create="Image on company">
<div ng-if="imageUploadCtrl.image.isSelected" ng-then="hasImage">
<a class="fh-red underline"
ng-click="imageUploadCtrl.image.clear()"
>Remove</a>
</div>
<button class="btn btn-darkgrey" type="button"
ng-else="hasImage"
ng-click="imageUploadCtrl.image.select()"
ng-disabled="imageUploadCtrl.image.isUploading"
>
<span ng-if="imageUploadCtrl.image.isUploading" ng-then="isUploading">
Uploading...
</span>
<span ng-else="isUploading">
Upload image
</span>
</button>
</div>
</div>
</span>
</span>
</label>
</div>
<div ng-flow-node-size-field="editableFlowNode" ng-prefix="properties"></div>
</div>
<div ng-toggled-show="blockSettings">
<div class="flyout-section"
ng-if="flowNode.type === FlowNode.ITEM_TYPE"
>
<div class="flownodeform-item "
ng-django-field="flowNodeForm [&#39;item&#39;]" ng-django-field-model="editableFlowNode [&#39;item&#39;]"
ng-django-field-required=""
>
<div ng-current-option="editableFlowNode [&#39;item&#39;]"
ng-current-option-collection="itemChoices"
ng-current-option-target="currentOptions.chosenItem"
>
<label>
<span class="label-text">
Flow node
</span>
<span class="the-field-outer">
<span class="select-field-wrap"
ng-with="currentOptionUrl = currentOptionCtrl.currentOption ? currentOptionCtrl.currentOption.$url() : ''"
ng-class="{ 'has-jump-link': !!currentOptionUrl }"
>
<span class="the-field">
<select name="item"
ng-model="editableFlowNode [&#39;item&#39;]"
ng-disabled=""
required="required"
ng-options="item.pk as (item.name + ' (' + cT('ID is abbreviation of Identifier', 'ID:') + ' ' + item.pk + ')') for item in itemChoices"
ng-dropdown
ng-placeholder="Choose an item"
ng-dropdown-allow-clear="false"
>
</select>
<i ng-link="f-req"></i>
</span>
<a ng-if="!!currentOptionUrl" ng-href="[[ currentOptionUrl ]]"
class="select-jump-link"
ng-tip="[! T('View selected option') !]"
ng-tip-classes="tip-indent"
></a>
</span>
</span>
</label>
</div>
<ul class="errors">
<li ng-if="flowNodeForm [&#39;item&#39;].$error['invalid_choice']">Select a valid choice. That choice is not one of the available choices.</li>
<li ng-repeat="error in flowNodeForm [&#39;item&#39;].$error.$server">[[ error ]]</li>
</ul>
</div>
</div>
<div class="flyout-section"
ng-if="flowNode.type === FlowNode.ITEM_TYPE || flowNode.type === FlowNode.LINK_TYPE"
>
<div class="flownodeform-externalurl "
ng-django-field="flowNodeForm [&#39;externalUrl&#39;]" ng-django-field-model="editableFlowNode [&#39;externalUrl&#39;]"
ng-django-field-required="flowNode.type === FlowNode.LINK_TYPE"
>
<label >
<span class="label-text">
External URL
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_external_url" maxlength="250" name="externalUrl" ng-model="editableFlowNode [&#39;externalUrl&#39;]" ng-required="flowNode.type === FlowNode.LINK_TYPE" type="text" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-if="flowNodeForm [&#39;externalUrl&#39;].$error['invalid']">Enter a valid URL.</li>
<li ng-repeat="error in flowNodeForm [&#39;externalUrl&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
<div class="hint"
ng-if="flowNode.type === FlowNode.ITEM_TYPE"
>
(Optional) Direct customers to a specific URL when they click this item
</div>
</div>
</div>
</div>
<div class="hide">
<div class="flownodeform-imageurl "
ng-django-field="flowNodeForm [&#39;imageUrl&#39;]" ng-django-field-model="editableFlowNode [&#39;imageUrl&#39;]"
>
<label >
<span class="label-text">
</span>
<span class="the-field-outer"
>
<span class="the-field">
<input data-lpignore="true" id="id_image_url" name="imageUrl" ng-model="editableFlowNode [&#39;imageUrl&#39;]" type="hidden" />
<span class="field-style-hook"></span>
<i ng-link="f-req"></i>
</span>
<ul class="errors">
<li ng-repeat="error in flowNodeForm [&#39;imageUrl&#39;].$error.$server">[[ error ]]</li>
</ul>
</span>
</label>
</div>
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<li ng-repeat="error in flowNodeForm.all.$error.$server">[[ error ]]</li>
</ul>
</div>
<div class="btns flyout-section flyout-section--shade">
<button class="btn-tiny btn-green btn-left" type="submit"
ng-disabled="flowNodeForm.$invalid || flowNodeForm.$submitting || (flowNodeForm.$pristine && imageUploadCtrl.isPristine())"
ng-shortcut="'shift+enter'"
ng-shortcut-click
title="[! T('Shortcut: shift+enter') !]"
>
Save
</button>
<a class="btn-tiny btn-grey btn-left"
ng-close-flow-node-popover
ng-shortcut="'esc'"
ng-shortcut-click
title="[! T('Shortcut: escape') !]"
>
Cancel
</a>
<button class="btn-tiny btn-red btn--push-left" type="button"
ng-can-remove="flowNode"
ng-click="removeFromParent(flowNodeForm)"
ng-disabled="flowNodeForm.$submitting"
ng-confirm-click="
[! T('Are you sure want to remove this block?') !]
[! flowNode.type === FlowNode.PAGE_TYPE ?
interpolate(T('After removing, %(flowBlockName)s will appear at the bottom of your Booking Flows list.'), { flowBlockName: flowNode.name }) : ''
!]
"
>
Remove
</button>
</div>
</form>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="ng-company-card-affiliations">
<div class="prose prose-section">
<h3>
Your cards
<span ng-can-create="Card on company">
(<a ng-href="[! company.$url(urls.dashboard.settings.payments.cards.index) !]"
>manage</a>)
</span>
</h3>
</div>
<div class="table-wrap">
<div ng-if="cardAffiliations.length">
<table class="spreadsheet highlight-rows white-bg width-auto"
ng-table="cardAffiliations"
>
<thead class="ss-header ss-header-shade">
<tr class="ss-header ss-header-shade">
<td ng-table-header="$row.card.name" ng-table-header-default>Card Name</td>
<td>
Is company<br>payment method?
<i class="icon-hint" ng-tip="[! T('Allow this card to be used when you make bookings tagged to this company') !]"></i>
</td>
<td>
Shared?
</td>
</tr>
</thead>
<tbody class="respond-print-hide"
ng-repeat="cardAffiliation in $table.collection"
>
<tr>
<td>[! cardAffiliation.card.name !]</td>
<td>
<span ng-show="cardAffiliation.isCompanyPaymentMethod" class="fh-green"></span>
</td>
<td>
<span ng-show="cardAffiliation.isShared" class="fh-green"></span>
</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li ng-if="!cardAffiliations.length" class="fh-grey">
No cards added
</li>
</ul>
</div>
</script>
<script type="text/ng-template" id="dashboard.settings.affiliateCardAffiliations">
<div class="prose prose-section">
<h3>
Shared with you
</h3>
</div>
<div class="table-wrap">
<div ng-if="cardAffiliations.length">
<table class="spreadsheet highlight-rows white-bg"
ng-table="cardAffiliations"
>
<thead class="ss-header ss-header-shade">
<tr class="ss-header ss-header-shade">
<td ng-table-header="$row.card.name" ng-table-header-default>Card Name</td>
</tr>
</thead>
<tbody class="respond-print-hide"
ng-repeat="cardAffiliation in $table.collection"
>
<tr>
<td>[! cardAffiliation.card.name !]</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li ng-if="!cardAffiliations.length" class="fh-grey">
No cards shared
</li>
</ul>
</div>
</script>
<script type="text/ng-template" id="cards-help-flyout">
<div class="tb-btn tb-btn--flyout"
ng-toggle="cardsHelp"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="tb-icon help"></i> Get help with cards
</div>
<div class="tb-flyout tb-flyout--auto-width-narrow"
ng-toggled="cardsHelp"
>
<ul class="flyout-menu-items"
ng-toggle="cardsHelp"
>
<li>
<a ng-href="https://fareharbor.com/help/getting-started/setup/company-cards/#adding" ng-outbound-link="_blank">
Adding a card
</a>
</li>
<li>
<a ng-href="https://fareharbor.com/help/getting-started/setup/company-cards/#sharing" ng-outbound-link="_blank">
Sharing access to a card
</a>
</li>
</ul>
</div>
</script>
<script type="text/ng-template" id="sidepanel-booking-placeholder">
<div class="sidepanel-block is-placeholder"
ng-if="plusbook.isOrderizing && order && plusbook.currentOrder === order"
>
Your new booking will be added to Order #[! order.identifier !]
</div>
<div class="sidepanel-block is-placeholder"
ng-if="plusbook.isOrderizing && booking && plusbook.currentBooking === booking"
>
Your new booking will be added to a new order
</div>
<div class="sidepanel-block is-placeholder"
ng-if="plusbook.isPlusbooking && plusbook.currentContact === contact"
>
New booking
</div>
</script>
<script type="text/ng-template" id="sidepanel-custom-field-values">
<td colspan="[[ auth.permissions.can('viewAmounts', booking.company) && customFieldValue.costs.totalCost.price ? 1 : 2 ]]">
<label>
<span class="fh-grey">
[! (customFieldValue.customFieldInstance.customField.shortName || customFieldValue.customFieldInstance.customField.name)|colonless !]:
</span>
<input value="[! customFieldValue.displayValue !]" type="text" ng-autoselect
ng-if="customFieldValue.displayValue && (customFieldValue.customFieldInstance.customField.type == CustomField.SHORT_TYPE || customFieldValue.customFieldInstance.customField.type == CustomField.MULTI_CAMPAIGN_TYPE)" ng-then="copyValue"
/>
<span ng-else="copyValue">
[! customFieldValue.displayValue !]
</span>
</label>
</td>
<td ng-if="auth.permissions.can('viewAmounts', booking.company) && customFieldValue.costs.totalCost.price"
ng-costs="customFieldValue.costs" ng-costs-company="booking.company"
class="text-right"
></td>
</script>
<script type="text/ng-template" id="sidepanel-booking">
<div class="sidepanel-booking" ng-controller="rebook.BookingCtrl">
<span class="badge badge-booking-pk">
Booking #[! booking.pk !]</span>
<br>
<a ng-href="[! booking|bookingUrl !]"
class="booking-block test-view-booking-action "
ng-class="{ 'fh-grey': booking.isCancelled }"
ng-watch="booking.modifiedAt"
>
<div class="table full-width valign-top table-dont-respond booking-block-header">
<div class="tr">
<h2 class="td">
<i class="[! booking|colorClass:'-swatch inline-swatch' !]"></i>
[! booking.availability.item|name !]
</h2>
<span class="td text-right">
<span ng-can-view-amounts="booking.company"
ng-can-only-when="!booking.rebookedTo"
class="badge nowrap
[! booking.isUnprocessed || booking.isCancelled ? '' : 'badge-' + booking.paidStatus|css !]"
>
[!
booking.isUnprocessed ? T('Pending') : (
booking.isCancelled ?
!booking.receipt.gross ? T('Refunded') : interpolate(T('%(amount)s Paid'), { amount: (booking.receipt.gross|amount:booking) })
: (
booking.amountDue || booking.amountOverpaid ? (
booking.amountDue ?
interpolate(T('%(amount)s Due'), { amount: (booking.amountDue|amount:booking) }) :
interpolate(T('%(amount)s Overpaid'), { amount: (booking.amountOverpaid|amount:booking) })
) : T('Paid')
)
)
!]
</span>
</span>
</div>
</div>
<ul class="booking-block-inner">
<li class="fh-grey">
<span ng-if-once="Availability.isInPast(booking.availability)"
class="badge ghost warning-color"
>Past</span>
[! booking.availability.startAt|datetime:(booking.availability.endAt):'long' !]
</li>
<li class="booking-block-availability">
<ul>
<li>[! booking.customerBreakdownShort !]</li>
</ul>
</li>
</ul>
<div class="booking-block-meta">
<span class="booking-block-affiliate test-view-affiliate-booking-action
[! booking.isOnline ? 'booked-via-online' :
(booking.user.company.pk === booking.affiliation.affiliateCompany.pk ? 'booked-via-affiliate-db' : '') !]
"
ng-if-once="booking.affiliation"
>
<b>
[! navigation.isCurrentCompany(booking.affiliation.affiliateCompany) ? booking.company.name : booking.affiliation.affiliateCompany.name !]
</b>
[! booking.voucherNumber ? '(' + booking.voucherNumber + ')' : '' !]
</span>
<span class="booked-at fh-grey [! addClassIf(!booking.isCancelled && !booking.user, 'booked-at-online') !]">
<span ng-if="booking.isCancelled" ng-then="cancelled"
ng-interval="60"
>
<span class="badge badge-error"
ng-if-once="!booking.rebookedTo"
>Cancelled</span>
<span class="badge"
ng-if-once="!!booking.rebookedTo"
>Rebooked</span>
[[ booking.modifiedAt|datetime:'relative':'relative-time' ]]
</span>
<span ng-else="cancelled"
ng-interval="60"
>
<i ng-if-once="booking.rebookedFrom" class="rebooked-icon" ng-tip="[! T('Rebooked') !]"></i>
<span ng-if-once="!booking.user"
class="test-view-online-booking-action"
>
<i class="booked-online-icon"></i> Booked online
</span>
[[ booking.createdAt|datetime:'relative':'relative-time' ]]
[! booking.user.name ? interpolate(T('by %(personName)s'), { personName: booking.user.name }) : '' !]
<span ng-if-once="!!booking.user && !navigation.isCurrentCompany(booking.user.company)">
([! booking.user.company.name !])
</span>
</span>
</span>
</div>
</a>
<a ng-href="[! booking.availability.$url(urls.company.item.book) !]"
ng-shortcut="'t'" ng-shortcut-click
></a>
<div class="sidepanel-customer-card-wrap">
<table class="sidepanel-customer-card">
<tbody>
<tr ng-if="booking.note">
<td colspan="2">
<span class="fh-grey">Note:</span> [! booking.note !]
</td>
</tr>
<tr ng-can-view-amounts="booking.company">
<td>Booking total:</td>
<td class="text-right">[! booking.costs.totalCost.total|amount:booking !]</td>
</tr>
<tr ng-can-view-amounts="booking.company">
<td>Payments:</td>
<td class="text-right">[! booking.receipt.gross|amount:booking !]</td>
</tr>
</tbody>
</table>
</div>
<div ng-data="booking.$promise" ng-data-small>
<div class="sidepanel-customer-card-wrap">
<table class="sidepanel-customer-card">
<tbody ng-repeat="customer in booking.customers">
<tr class="is-header">
<td>
<b>[! customer.customerTypeRate.customerPrototype.customerType.shortName || customer.customerTypeRate.customerPrototype.customerType.singular !]</b>
</td>
<td class="text-right"
ng-can-view-amounts="booking.company"
ng-costs="customer.costs"
ng-costs-company="booking.company"
></td>
</tr>
<tr ng-if="rebook.isCustomerNonRebookable(customer)" class="sidepanel-not-fillable">
<td colspan="100">
<i class="warning-icon"></i> Could not be auto-filled
</td>
</tr>
<tr ng-repeat="customFieldValue in customer.customFieldValues"
ng-inline="sidepanel-custom-field-values"
ng-if="customFieldValue.isSelected"
></tr>
</tbody>
</table>
</div>
<div class="sidepanel-customer-card-wrap"
ng-if="booking.customFieldValues.length"
>
<table class="sidepanel-customer-card">
<tbody ng-repeat="customFieldValue in booking.customFieldValues"
ng-if="customFieldValue.isSelected"
>
<tr ng-inline="sidepanel-custom-field-values"></tr>
</tbody>
</table>
</div>
</div>
</div>
</script>
<script type="text/ng-template" id="sidepanel-contact">
<ul class="sidepanel-booking-contact">
<li><b>[! contact.name !]</b></li>
<li ng-if="contact.phone">[! contact|contactPhone !]</li>
<li ng-if="contact.email">[! contact.email !]</li>
</ul>
</script>
<script type="text/ng-template" id="sidepanel-toggled-booking">
<ul ng-toggle ng-toggle-value="'bookingDetails' + booking.pk"
class="sidepanel-block is-toggle"
>
<li>
<div class="table full-width table-dont-respond">
<div class="tr">
<div class="td break-words bold">
<i class="[! booking|colorClass:'-swatch inline-swatch' !]"></i> [! booking.availability.item|name !]
<span ng-if-once="booking.availability.headline">&ndash; [! booking.availability.headline !]</span>
</div>
<div class="td text-right">
<span ng-can-view-amounts="booking.company"
ng-can-only-when="!booking.rebookedTo"
class="badge nowrap
[! booking.isUnprocessed || booking.isCancelled ? '' : 'badge-' + booking.paidStatus|css !]"
>
[!
booking.isUnprocessed ? T('Pending') : (
booking.isCancelled ?
!booking.receipt.gross ? T('Refunded') : interpolate(T('%(amount)s Paid'), { amount: (booking.receipt.gross|amount:booking) })
: (
booking.amountDue || booking.amountOverpaid ? (
booking.amountDue ?
interpolate(T('%(amount)s Due'), { amount: (booking.amountDue|amount:booking) }) :
interpolate(T('%(amount)s Overpaid'), { amount: (booking.amountOverpaid|amount:booking) })
) : T('Paid')
)
)
!]
</span>
</div>
</div>
</div>
</li>
<li class="ava">
<div>[! booking.availability.startAt|datetime:(booking.availability.endAt) !]</div>
<div>[! booking.customerBreakdownShort !]</div>
</li>
</ul>
<div ng-toggled ng-toggled-value="'bookingDetails' + booking.pk"
ng-link="sidepanel-booking"
ng-with="showAvailability = true;"
></div>
</script>
<script type="text/ng-template" id="ng-boca-styles-for-layout">
<style type="text/css" ng-if="ngBocaStylesForLayout">
@page {
size: [[ ngBocaStylesForLayout.settings.len ]]in [[ ngBocaStylesForLayout.settings.height ]]in;
margin: 0;
}
@media screen {
.boca-ticket-wrap {
width: [[ ngBocaStylesForLayout.settings.height ]]in;
height: [[ ngBocaStylesForLayout.settings.len ]]in;
}
}
.boca-ticket {
width: [[ ngBocaStylesForLayout.settings.len ]]in;
height: [[ ngBocaStylesForLayout.settings.height ]]in;
}
.boca-main {
top: [[ ngBocaStylesForLayout.settings.marginTop ]]in;
right: [[ TicketLayout.mainRight(ngBocaStylesForLayout) ]]in;
bottom: [[ ngBocaStylesForLayout.settings.marginBottom ]]in;
left: [[ TicketLayout.mainLeft(ngBocaStylesForLayout) ]]in;
}
.boca-qr {
width: [[ TicketLayout.qrCodeSize(ngBocaStylesForLayout) ]]in;
height: [[ TicketLayout.qrCodeSize(ngBocaStylesForLayout) ]]in;
}
.boca-stub {
height: [[ ngBocaStylesForLayout.settings.height ]]in;
}
.boca-stub-inner {
width: [[ ngBocaStylesForLayout.settings.height ]]in;
padding-right: [[ ngBocaStylesForLayout.settings.marginTop ]]in;
padding-left: [[ ngBocaStylesForLayout.settings.marginBottom ]]in;
}
.boca-stub-leading {
width: [[ ngBocaStylesForLayout.settings.leadingStubLength ]]in;
}
.boca-stub-leading .boca-stub-inner {
height: [[ ngBocaStylesForLayout.settings.leadingStubLength ]]in;
padding-top: [[ ngBocaStylesForLayout.settings.leadingStubMarginTop ]]in;
padding-bottom: [[ ngBocaStylesForLayout.settings.leadingStubMarginBottom ]]in;
}
.boca-stub-trailing {
width: [[ ngBocaStylesForLayout.settings.trailingStubLength ]]in;
}
.boca-stub-trailing .boca-stub-inner {
height: [[ ngBocaStylesForLayout.settings.trailingStubLength ]]in;
padding-top: [[ ngBocaStylesForLayout.settings.trailingStubMarginTop ]]in;
padding-bottom: [[ ngBocaStylesForLayout.settings.trailingStubMarginBottom ]]in;
}
.boca-receipt-company-info {
width: [[ ngBocaStylesForLayout.settings.height - (ngBocaStylesForLayout.settings.marginTop + ngBocaStylesForLayout.settings.marginBottom) ]]in;
}
</style>
</script>
<!-- ngIf: rebook.currentBooking || plusbook.currentContact -->
<!-- ngNavigationSection: root -->
<!-- ngNavigationSection: company -->
<!-- ngNavigationSection: dashboard --><div ng-navigation-section="dashboard" ng-then="dashboardSection" ng-supported-languages-popover="">
<div ng-controller="dashboard.IndexCtrl" class="test-dashboard-section success" ng-title="Dashboard | Screaming Eagle Sports">
<!-- ngIf: dataCtrl.status === 'loading' -->
<!-- ngIf: dataCtrl.status === 'success' --><div ng-if="dataCtrl.status === &#39;success&#39;">
<!-- ngCanViewDashboardSection: company --><div ng-can-view-dashboard-section="company" ng-then="allowed">
<!-- ngIf: auth.currentUser.isAuthenticated --><div class="db-header respond-print-hide " ng-if="auth.currentUser.isAuthenticated" ng-controller="dashboard.HeaderCtrl" ng-body-class="{ &#39;is-single-color-printer&#39;: headerCtrl.company.features.isSingleColorPrinterEnabled }">
<h1 class="db-fh-logo" ng-sonar-booking-indicator="company">
FareHarbor
</h1>
<div class="db-header-right" ng-style="{ &#39;max-width&#39;: &#39;calc(100% - &#39; + (mainNavDimensions.width + 65) + &#39;px)&#39;}" style="max-width: calc(100% - 656px);">
<div class="db-header-user-wrap respond-handhelds-hide">
<div class="db-header-user is-flyout test-logged-in-indicator test-current-user-indicator" ng-toggle="headerUserMenu" ng-toggle-group="tb-flyouts" ng-toggle-group-closeable="" ng-toggle-auto-close="">
<!-- ngIf: auth.currentUser.imageCdnUrl -->
Alexandria Hampton
<!-- ngCanViewAdminSection: auth.currentUser.company --><span ng-can-view-admin-section="auth.currentUser.company" class="badge ghost">FH</span>
</div>
<!-- ngToggled: headerUserMenu -->
</div><div class="db-header-company-wrap"><!-- ngCanAdminView: company --><div class="db-header-admin-notes-indicator" ng-class="{ &#39;is-flagged&#39;: company.isAdminFlagged }" ng-can-admin-view="company" ng-can-only-when="!!company.adminNotes" ng-click="shortcutsOverlay.show()" title="See notes about this company">
<i class="tb-icon snippet-white"></i>
</div><!-- ngIf: !headerCtrl.relatedCompanies.length --><a class="db-header-company-name" ng-href="/destinspeedboat/dashboard/" ng-alt-navigate="/destinspeedboat/" ng-if="!headerCtrl.relatedCompanies.length" ng-then="noRelatedCompanies" href="https://fareharbor.com/destinspeedboat/dashboard/">
Screaming Eagle Sports
<!-- ngIf: company.isDemoModeEnabled -->
</a><!-- ngElse: noRelatedCompanies -->
<!-- ngToggled: relatedCompaniesFlyout -->
</div>
</div>
<ul class="db-nav respond-handhelds-hide" ng-dimensions="mainNavDimensions">
<!-- ngIfOnce: isReadonlyEnabled -->
<!-- ngIf: !!headerCtrl.company --><ul class="db-nav-normal" ng-if="!!headerCtrl.company">
<!-- ngCan: viewAdminSection on headerCtrl.company -->
<!-- ngCan: viewBookingsSection on headerCtrl.company --><li ng-can="viewBookingsSection on headerCtrl.company" ng-can-only-when="headerCtrl.company.isCharter || headerCtrl.company.isAffiliate">
<a ng-href="/destinspeedboat/dashboard/bookings/" ng-navigation-active="" ng-shortcut="&#39;shift+b&#39;" ng-shortcut-click="" href="https://fareharbor.com/destinspeedboat/dashboard/bookings/" class="">
<i class="header-icon bookings"></i>
Bookings
</a>
</li>
<!-- ngCan: viewManifestSection on headerCtrl.company --><li ng-can="viewManifestSection on headerCtrl.company" ng-can-only-when="headerCtrl.company.isCharter">
<a ng-href="/destinspeedboat/dashboard/manifest/" ng-navigation-active="" ng-shortcut="&#39;shift+m&#39;" ng-shortcut-click="" href="https://fareharbor.com/destinspeedboat/dashboard/manifest/">
<i class="header-icon manifest"></i>
Manifest
</a>
</li>
<!-- ngCanList: Report on headerCtrl.company --><li ng-can-list="Report on headerCtrl.company">
<a ng-href="/destinspeedboat/dashboard/reports/" ng-navigation-active="" ng-shortcut="&#39;shift+r&#39;" ng-shortcut-click="" href="https://fareharbor.com/destinspeedboat/dashboard/reports/" class="current">
<i class="header-icon reports"></i>
Reports
</a>
</li>
</ul>
<!-- ngIf: !!headerCtrl.company --><ul class=" db-nav-small" ng-if="!!headerCtrl.company">
<!-- ngCan: viewItemsSection on headerCtrl.company --><li ng-can="viewItemsSection on headerCtrl.company" ng-can-only-when="headerCtrl.company.isCharter">
<a ng-href="/destinspeedboat/dashboard/items/" ng-class="
{ &#39;current&#39; : navigation.pathStartsWith(urls.dashboard.items.index) || navigation.pathStartsWith(urls.dashboard.resources.index) }
" ng-shortcut="&#39;shift+i&#39;" ng-shortcut-click="" href="https://fareharbor.com/destinspeedboat/dashboard/items/">
<span>
<i class="header-icon-small items"></i>
Items
</span>
</a>
</li>
<li>
<a ng-href="/destinspeedboat/dashboard/settings/" ng-navigation-active="" ng-shortcut="&#39;shift+e&#39;" ng-shortcut-click="" ng-tip="Payouts are not set up" ng-tip-classes="tip-right-indent" ng-tip-position="right" ng-tip-when="!headerCtrl.company.isPaymentSetupComplete &amp;&amp; headerCtrl.company.isCharter" href="https://fareharbor.com/destinspeedboat/dashboard/settings/">
<span>
<i class="header-icon-small settings"></i>
Settings
<!-- ngIf: !headerCtrl.company.isPaymentSetupComplete && headerCtrl.company.isCharter -->
</span>
</a>
</li>
<li>
<a ng-href="/help/" ng-outbound-link="_blank" target="_blank" href="https://fareharbor.com/help/">
<span>
<i class="header-icon-small help"></i>
Help
</span>
</a>
</li>
</ul>
</ul>
<div class="respond-handhelds-show clearfix">
<!-- ngIfOnce: isReadonlyEnabled -->
<div class="db-header-user is-flyout test-logged-in-indicator test-current-user-indicator handhelds-user-header-left" ng-toggle="mobileHeaderUserMenu" ng-toggle-group="mobileHeaderMenus" ng-toggle-group-closeable="" ng-toggle-auto-close="">
<!-- ngIf: auth.currentUser.imageCdnUrl -->
Alexandria Hampton
<!-- ngCanViewAdminSection: auth.currentUser.company --><span ng-can-view-admin-section="auth.currentUser.company" class="badge ghost">FH</span>
</div>
<div class="db-header-user is-flyout handhelds-user-header-right" ng-toggle="mobileDbNav" ng-toggle-group="mobileHeaderMenus" ng-toggle-group-closeable="" ng-toggle-auto-close="">
<i class="tb-icon hamburger-white"></i>
Dashboard
</div>
</div>
<!-- ngToggled: mobileHeaderUserMenu -->
<!-- ngToggled: mobileDbNav -->
</div>
<div ng-shortcuts-overlay="">
<div ng-shortcut="&#39;shift+/&#39;" ng-shortcut-action="shortcutsOverlay.show()">
<!-- ngIf: shortcutsOverlay.isShowing -->
</div>
</div>
<!-- ngNavigationPath: urls.dashboard.index -->
<!-- ngNavigationPrefix: urls.dashboard.overlay.index -->
<!-- ngNavigationPrefix: urls.dashboard.translationsOverlay.index -->
<!-- ngNavigationPrefix: urls.dashboard.bookings.index -->
<!-- ngNavigationPrefix: urls.dashboard.admin.index -->
<!-- ngNavigationPrefix: urls.dashboard.manifest.index -->
<!-- ngNavigationPrefix: [ urls.dashboard.items.index, urls.dashboard.resources.index ] -->
<!-- ngNavigationPrefix: urls.dashboard.reports.index --><div ng-navigation-prefix="urls.dashboard.reports.index" ng-then="reportsSubsection">
<div ng-load="partials/dashboard/reports/index.partial?99774cb15b0528a7a2caeeb2a01921cc3e14532e"><script type="text/ng-template" id="invoices-table">
<div ng-if="invoicesByCurrency|any"
ng-init="numCurrencies = (invoicesByCurrency|map).length"
>
<div ng-if="numCurrencies > 1"><b>Invoices for your bookings</b></div>
<table class="spreadsheet width-auto [! addClassIf(numCurrencies > 1, 'no-top-border') !]"
ng-repeat="(currency, invoices) in invoicesByCurrency"
ng-with="processorCurrency = currency"
ng-group="invoices"
ng-table="invoices"
ng-auto-export="report"
>
<tbody>
<tr ng-auto-export-skip>
<td colspan="100" class="td-no-padding">
<div class="tb tb--inset-mobile respond-print-hide">
<div class="tb-left">
<div class="tb-text">
<span ng-if="numCurrencies > 1" ng-then="multiCurrency">
Currency: <b>[! currency !]</b>
</span>
<span ng-else="multiCurrency">
<b>Invoices for your bookings</b>
</span>
</div>
</div>
<div class="tb-right">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="tableGroupingyourBookings-[[ $index ]]"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="tb-icon collection"></i> Group by
</div>
<div class="tb-flyout tb-flyout--left tb-flyout--auto-width-narrow"
ng-toggled-show="tableGroupingyourBookings-[[ $index ]]"
>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'tableGrouping'"></div>
<ul class="flyout-menu-items-lis"
ng-toggle="tableGroupingyourBookings"
>
<li ng-group-by ng-group-default>None</li>
<li ng-group-by="$row.affiliation.affiliateCompany.pk"
ng-group-as="$row.affiliation.affiliateCompany.name"
ng-group-name="[! T('Company') !]"
>
Company
</li>
<li ng-group-by="$row.dueAt"
ng-group-as="$row.dueAt|date"
ng-group-name="[! T('Due date') !]"
>
Due date
</li>
<li ng-group-by="$row.status"
ng-group-as="$row.status"
ng-group-name="[! T('Payment status') !]"
>
Status
</li>
</ul>
</div>
</div>
</div>
</div>
</td>
</tr>
</tbody>
<tbody ng-repeat="group in $groups" ng-table="group.rows">
<tr ng-if="group.isGrouped" ng-auto-export-skip>
<td colspan="100">
<div class="ss-group-header">
<div class="group-header-left">[[ group.name ]]: <b>[[ group.as ]]</b></div>
<div class="group-header-right fh-grey">
[[ interpolate(nT('%(count)s invoice', '%(count)s invoices', group.rows.length), { count: group.rows.length }) ]]
</div>
</div>
</td>
</tr>
<tr class="ss-header-shade bold">
<td
ng-table-header="$row.identifier"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Invoice ID") !]'
>
Invoice
</td>
<td
ng-table-header="$row.affiliation.affiliateCompany.name; $row.createdAt"
>
Company
</td>
<td
ng-table-header="-$row.createdAt"
ng-table-header-default
>
Created
</td>
<td
ng-table-header="$row.dueAt"
>
Due
</td>
<td
ng-table-header="$row.periodStartAt"
>
Date Range
</td>
<td
ng-table-header="$row.invoicedToCharter || $row.invoicedToAffiliate || 0"
>
Total
</td>
<td
ng-table-header="$row.status"
>
Status
</td>
<td>
Email Status
</td>
</tr>
<tr ng-repeat="entry in $table.collection"
ng-navigate="[! entry.$url(urls.dashboard.reports.invoices.invoice.index) !]"
class="highlight-row pointer"
ng-with="invoice = entry"
>
<td
title='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Invoice ID") !]'
>
<a ng-href="[! entry.$url(urls.dashboard.reports.invoices.invoice.index) !]">
[! invoice.identifier !]
</a>
</td>
<td
>
<b>[! invoice.affiliation.affiliateCompany.name !]</b>
</td>
<td
title="[! T('Created At') !]"
>
[! invoice.createdAt|date !]
</td>
<td
title="[! T('Due At') !]"
>
[! invoice.dueAt|date !]
</td>
<td
title="[! T('Date Range') !]"
>
[! invoice.periodStartAt|dateRange:invoice.periodEndAt:'dateOnlyShort':'absolute' !]
</td>
<td
title="[! T('Total') !]"
>
[! (invoice.invoicedToCharter || invoice.invoicedToAffiliate)|amount:processorCurrency !]
</td>
<td
ng-link="invoice-paid-status"
>
</td>
<td>
<div ng-repeat="notification in Notification.invoicePaymentRequestNotifications(invoice.notifications)|filter:{isSubscription:false}">
<i ng-if="Notification.isFailed(notification.status)" ng-then="isFailed"
class="icon-email-status-red"
ng-tip="[! interpolate(T('Email to %(emailAddress)s could not be delivered'), { emailAddress: (notification.email|lowercase) }) !]"
></i>
<i ng-if="Notification.isOpened(notification.status)" ng-then="isOpened"
class="icon-email-status-opened"
ng-tip="[! interpolate(T('Opened by %(emailAddress)s on %(datetime)s'), { emailAddress: (notification.email|lowercase), datetime: (notification.modifiedAt|datetime) }) !]"
></i>
<i ng-if="!isFailed && !isOpened"
class="icon-email-status-grey"
ng-tip="[! interpolate(T('Sent to %(emailAddress)s on %(datetime)s'), { emailAddress: (notification.email|lowercase), datetime: (notification.modifiedAt|datetime) }) !]"
></i>
</div>
</td>
</tr>
<tr ng-auto-export-skip
class="bold"
>
<td
>
<a ng-href="[! invoicesUrl($table.collection) !]">View all &raquo;</a>
</td>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td
ng-table-summary="($row.invoicedToCharter || 0) + ($row.invoicedToAffiliate || 0)"
>
[[ $summary|amount:processorCurrency ]]
</td>
<td
title="[! T('Paid Status') !]"
>
</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
</script>
<script type="text/ng-template" id="partner-invoices-table">
<div ng-if="invoicesByCurrency|any"
ng-init="numCurrencies = (invoicesByCurrency|map).length"
>
<div ng-if="numCurrencies > 1"><b>Invoices for other companies&#039; bookings</b></div>
<table class="spreadsheet width-auto [! addClassIf(numCurrencies > 1, 'no-top-border') !]"
ng-repeat="(currency, invoices) in invoicesByCurrency"
ng-with="processorCurrency = currency"
ng-group="invoices"
ng-table="invoices"
ng-auto-export="report"
>
<tbody>
<tr ng-auto-export-skip>
<td colspan="100" class="td-no-padding">
<div class="tb tb--inset-mobile respond-print-hide">
<div class="tb-left">
<div class="tb-text">
<span ng-if="numCurrencies > 1" ng-then="multiCurrency">
Currency: <b>[! currency !]</b>
</span>
<span ng-else="multiCurrency">
<b>Invoices for other companies&#039; bookings</b>
</span>
</div>
</div>
<div class="tb-right">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout"
ng-toggle="tableGroupingaffiliateBookings-[[ $index ]]"
ng-toggle-group="tb-flyouts"
ng-toggle-group-closeable
ng-toggle-auto-close
>
<i class="tb-icon collection"></i> Group by
</div>
<div class="tb-flyout tb-flyout--left tb-flyout--auto-width-narrow"
ng-toggled-show="tableGroupingaffiliateBookings-[[ $index ]]"
>
<div ng-link="mobile-flyout-close" ng-with="toggle = 'tableGrouping'"></div>
<ul class="flyout-menu-items-lis"
ng-toggle="tableGroupingaffiliateBookings"
>
<li ng-group-by ng-group-default>None</li>
<li ng-group-by="$row.company.pk"
ng-group-as="$row.company.name"
ng-group-name="[! T('Company') !]"
>
Company
</li>
<li ng-group-by="$row.dueAt"
ng-group-as="$row.dueAt|date"
ng-group-name="[! T('Due date') !]"
>
Due date
</li>
</ul>
</div>
</div>
</div>
</div>
</td>
</tr>
</tbody>
<tbody ng-repeat="group in $groups" ng-table="group.rows">
<tr ng-if="group.isGrouped" ng-auto-export-skip>
<td colspan="100">
<div class="ss-group-header">
<div class="group-header-left">[[ group.name ]]: <b>[[ group.as ]]</b></div>
<div class="group-header-right fh-grey">
[[ interpolate(nT('%(count)s invoice', '%(count)s invoices', group.rows.length), { count: group.rows.length }) ]]
</div>
</div>
</td>
</tr>
<tr class="ss-header-shade bold">
<td
ng-table-header="$row.identifier"
ng-auto-export-value='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Invoice ID") !]'
>
Invoice
</td>
<td
ng-table-header="$row.company.name; $row.createdAt"
>
Company
</td>
<td
ng-table-header="-$row.createdAt"
ng-table-header-default
>
Created
</td>
<td
ng-table-header="$row.dueAt"
>
Due
</td>
<td
ng-table-header="$row.periodStartAt"
>
Date Range
</td>
<td
ng-table-header="$row.invoicedToCharter || $row.invoicedToAffiliate || 0"
>
Total
</td>
<td
ng-table-header="$row.status"
>
Status
</td>
</tr>
<tr ng-repeat="entry in $table.collection"
ng-navigate="[! invoice.$url(urls.dashboard.reports.invoices.partnerInvoice.index) !]"
class="highlight-row pointer"
ng-with="invoice = entry"
>
<td
title='[! cT("\"ID\" is abbreviation of \"Identifier\"", "Invoice ID") !]'
>
<a ng-href="[! invoice.$url(urls.dashboard.reports.invoices.partnerInvoice.index) !]">
[! invoice.identifier !]
</a>
</td>
<td
>
<b>[! invoice.company.name !]</b>
</td>
<td
title="[! T('Created At') !]"
>
[! invoice.createdAt|date !]
</td>
<td
title="[! T('Due At') !]"
>
[! invoice.dueAt|date !]
</td>
<td
title="[! T('Date Range') !]"
>
[! invoice.periodStartAt|dateRange:invoice.periodEndAt:'dateOnlyShort':'absolute' !]
</td>
<td
title="[! T('Total') !]"
>
[! (invoice.invoicedToCharter || invoice.invoicedToAffiliate)|amount:processorCurrency !]
</td>
<td
ng-link="invoice-paid-status"
>
</td>
</tr>
<tr ng-auto-export-skip
class="bold"
>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td
>
</td>
<td
ng-table-summary="($row.invoicedToCharter || 0) + ($row.invoicedToAffiliate || 0)"
>
[[ $summary|amount:processorCurrency ]]
</td>
<td
title="[! T('Paid Status') !]"
>
</td>
</tr>
</tbody>
</table>
</div>
</script>
<div ng-toggle="showReportsNav" ng-toggle-group="tb-flyouts" ng-toggle-group-closeable="" ng-toggle-auto-close=""></div>
<div class="reports-subsection test-reports-subsection-indicator " ng-body-class="&#39;dashboard-reports-section dashboard-reports-section-bg&#39;">
<div class="settings-nav-fixed respond-print-hide showing-secondary toggleable" ng-with="
isToggleable = !navigation.pathEquals(urls.dashboard.reports.index);
isShowingSecondary = toggles.state(&#39;legacyReportsList&#39;) || toggles.state(&#39;adminReportsList&#39;) || toggles.state(&#39;advancedSidebar-Booking&#39;) || toggles.state(&#39;advancedSidebar-CustomFieldValue&#39;) || toggles.state(&#39;advancedSidebar-Customer&#39;) || toggles.state(&#39;advancedSidebar-LineItem&#39;) || toggles.state(&#39;advancedSidebar-Payment&#39;)
" ng-class="{
&#39;toggleable&#39;: isToggleable,
&#39;toggled&#39;: toggles.state(&#39;showReportsNav&#39;),
&#39;showing-secondary&#39;: isShowingSecondary
}">
<!-- ngIf: !isToggleable && isShowingSecondary -->
<!-- ngElse: toggleSecondary --><div class="settings-nav-shade" ng-else="toggleSecondary" ng-toggle="showReportsNav" ng-toggle-group="tb-flyouts" ng-toggle-group-closeable="" ng-toggle-auto-close="" ng-shortcut="&#39;esc&#39;" ng-shortcut-click=""></div>
<div class="settings-nav respond-handhelds-hide" ng-shortcut="&#39;esc&#39;" ng-shortcut-click="">
<a class="reports-help-link" ng-href="/help/reporting/" ng-outbound-link="_blank" target="_blank" href="https://fareharbor.com/help/reporting/">
<b>Need help?</b> Learn about working with reports and important terms. 
</a>
<div class="settings-nav-list">
<div ng-controller="dashboard.reports.NavigationCtrl" class="">
<!-- ngCanList: Report on company --><div ng-can-list="Report on company" ng-then="allowed">
<!-- ngCanAny: ['viewPayoutsType','viewInvoicesType','viewContactsType'] --><ul ng-can-any="[&#39;viewPayoutsType&#39;,&#39;viewInvoicesType&#39;,&#39;viewContactsType&#39;]" ng-can-any-on="Report" ng-can-any-with="company">
<li>
<a ng-href="/destinspeedboat/dashboard/reports/" ng-navigation-active="" ng-navigation-exact="" class="" href="https://fareharbor.com/destinspeedboat/dashboard/reports/">
<span class="tb-icon compass"></span> Overview
</a>
</li>
<!-- ngCan: viewPayoutsType on Report with company --><li ng-can="viewPayoutsType on Report with company" ng-can-only-when="company.isAffiliate || company.isCharter">
<a ng-href="/destinspeedboat/dashboard/reports/payouts/" ng-navigation-active="" href="https://fareharbor.com/destinspeedboat/dashboard/reports/payouts/">
<span class="tb-icon bank"></span> Payouts &amp; Refunds
</a>
</li>
<!-- ngCanList: Upload on company -->
<!-- ngCanList: Invoice on company --><li ng-can-list="Invoice on company" ng-can-only-when="company.isAffiliate || company.affiliatesCount">
<a ng-href="/destinspeedboat/dashboard/reports/invoices/" ng-navigation-active="" href="https://fareharbor.com/destinspeedboat/dashboard/reports/invoices/">
<span class="tb-icon swap"></span> Invoices
</a>
</li>
<!-- ngCan: viewContactsType on Report with company --><li ng-can="viewContactsType on Report with company" ng-can-only-when="company.isCharter">
<a ng-href="/destinspeedboat/dashboard/reports/contacts/" ng-navigation-active="" href="https://fareharbor.com/destinspeedboat/dashboard/reports/contacts/">
<span class="tb-icon user-empty"></span> Contacts
</a>
</li>
</ul>
<!-- ngCan: viewAdvancedType on Report with company --><div ng-can="viewAdvancedType on Report with company" ng-can-only-when="company.isCharter || company.isAffiliate" class="settings-nav-header has-top-padding">
Advanced
<!-- ngIf: company.features.isLegacyReportsEnabled --><span class="badge badge-green" ng-if="company.features.isLegacyReportsEnabled">New</span>
</div>
<!-- ngCan: viewAdvancedType on Report with company --><ul ng-can="viewAdvancedType on Report with company" ng-can-only-when="company.isCharter || company.isAffiliate">
<!-- ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><li ng-repeat="model in Report.ORDERED_MODELS|filter:allowAdvancedModel" ng-init="spec = Report.MODELS[model.cls]">
<a class="has-secondary-nav toggled current" ng-toggle="" ng-toggle-value="&#39;advancedSidebar-&#39; + spec.model.cls" ng-toggle-group="secondarySettingsNav" ng-toggle-group-closeable="" ng-navigation-active="Report.advancedUrl(company, spec.model.cls)">Sales</a>
</li><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><li ng-repeat="model in Report.ORDERED_MODELS|filter:allowAdvancedModel" ng-init="spec = Report.MODELS[model.cls]">
<a class="has-secondary-nav" ng-toggle="" ng-toggle-value="&#39;advancedSidebar-&#39; + spec.model.cls" ng-toggle-group="secondarySettingsNav" ng-toggle-group-closeable="" ng-navigation-active="Report.advancedUrl(company, spec.model.cls)">Bookings</a>
</li><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><li ng-repeat="model in Report.ORDERED_MODELS|filter:allowAdvancedModel" ng-init="spec = Report.MODELS[model.cls]">
<a class="has-secondary-nav" ng-toggle="" ng-toggle-value="&#39;advancedSidebar-&#39; + spec.model.cls" ng-toggle-group="secondarySettingsNav" ng-toggle-group-closeable="" ng-navigation-active="Report.advancedUrl(company, spec.model.cls)">Customers</a>
</li><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><li ng-repeat="model in Report.ORDERED_MODELS|filter:allowAdvancedModel" ng-init="spec = Report.MODELS[model.cls]">
<a class="has-secondary-nav" ng-toggle="" ng-toggle-value="&#39;advancedSidebar-&#39; + spec.model.cls" ng-toggle-group="secondarySettingsNav" ng-toggle-group-closeable="" ng-navigation-active="Report.advancedUrl(company, spec.model.cls)">Custom Field Answers</a>
</li><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><li ng-repeat="model in Report.ORDERED_MODELS|filter:allowAdvancedModel" ng-init="spec = Report.MODELS[model.cls]">
<a class="has-secondary-nav" ng-toggle="" ng-toggle-value="&#39;advancedSidebar-&#39; + spec.model.cls" ng-toggle-group="secondarySettingsNav" ng-toggle-group-closeable="" ng-navigation-active="Report.advancedUrl(company, spec.model.cls)">Expenses and Discounts</a>
</li><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel -->
</ul>
<!-- ngIf: !company.features.isPaymentsReportLegacy -->
<!-- ngCanAny: ['viewCrewSummaryType','viewDisputesType'] --><div ng-can-any="[&#39;viewCrewSummaryType&#39;,&#39;viewDisputesType&#39;]" ng-can-any-on="Report" ng-can-any-with="company" ng-can-only-when="company.isCharter" ng-can-also-when="auth.currentUser.company.isAdmin" class="settings-nav-header has-top-padding">
Other
</div>
<!-- ngCanAny: ['viewCrewSummaryType','viewCampaignsSummaryType','viewDisputesType'] --><div ng-can-any="[&#39;viewCrewSummaryType&#39;,&#39;viewCampaignsSummaryType&#39;,&#39;viewDisputesType&#39;]" ng-can-any-on="Report" ng-can-any-with="company" ng-can-only-when="company.isCharter" ng-can-also-when="auth.currentUser.company.isAdmin">
<ul>
<!-- ngCan: viewCrewSummaryType on Report with company --><li ng-can="viewCrewSummaryType on Report with company" ng-can-only-when="company.isCharter">
<a ng-href="/destinspeedboat/dashboard/reports/crew-summary/" ng-navigation-active="" href="https://fareharbor.com/destinspeedboat/dashboard/reports/crew-summary/">Crew</a>
</li>
<!-- ngCan: viewCampaignsSummaryType on Report with company --><li ng-can="viewCampaignsSummaryType on Report with company" ng-can-only-when="company.isCharter">
<a ng-href="/destinspeedboat/dashboard/reports/campaigns-summary/" ng-navigation-active="" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" href="https://fareharbor.com/destinspeedboat/dashboard/reports/campaigns-summary/">Campaigns</a>
</li>
<!-- ngCan: viewDisputesType on Report with company --><li ng-can="viewDisputesType on Report with company" ng-can-only-when="company.isCharter">
<a ng-href="/destinspeedboat/dashboard/reports/disputes/" ng-navigation-active="" href="https://fareharbor.com/destinspeedboat/dashboard/reports/disputes/">
Credit Card Disputes
</a>
</li>
<!-- ngIf: auth.currentUser.company.isAdmin --><li ng-if="auth.currentUser.company.isAdmin">
<a class="has-secondary-nav" ng-toggle="adminReportsList" ng-toggle-group="secondarySettingsNav" ng-toggle-group-closeable="">Admin Reports</a>
</li>
</ul>
</div>
<!-- ngIf: company.features.isLegacyReportsEnabled && (company.isAffiliate || company.isCharter) --><div ng-if="company.features.isLegacyReportsEnabled &amp;&amp; (company.isAffiliate || company.isCharter)" class="settings-nav-header has-top-padding">
Legacy <span class="badge">Old</span>
</div>
<!-- ngIf: company.features.isLegacyReportsEnabled && (company.isAffiliate || company.isCharter) --><ul ng-if="company.features.isLegacyReportsEnabled &amp;&amp; (company.isAffiliate || company.isCharter)">
<!-- ngCan: viewBookingsType on Report with company --><li ng-can="viewBookingsType on Report with company">
<a ng-href="/destinspeedboat/dashboard/reports/bookings/" ng-navigation-active="" href="https://fareharbor.com/destinspeedboat/dashboard/reports/bookings/">Detailed Bookings</a>
</li>
<li>
<a class="has-secondary-nav" ng-toggle="legacyReportsList" ng-toggle-group="secondarySettingsNav" ng-toggle-group-closeable="">Legacy Reports</a>
</li>
</ul>
</div>
<!-- ngElse: allowed -->
</div>
</div>
</div>
<div class="tb tb--shaded tb--inset-mobile settings-nav-tb respond-print-hide respond-handhelds-show">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout" ng-toggle="reportsNav" ng-toggle-group="tb-flyouts" ng-toggle-group-closeable="" ng-toggle-auto-close="">
<i class="tb-icon hamburger"></i> Reports
</div>
<!-- ngToggled: reportsNav -->
</div>
</div>
<!-- ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><!-- ngToggled:  --><div ng-repeat="model in Report.ORDERED_MODELS|filter:allowAdvancedModel" ng-link="dashboard.reports.advanced.sidebar" class="settings-nav is-secondary no-top-padding" ng-toggled="" ng-toggled-value="&#39;advancedSidebar-&#39; + model.cls"><div ng-controller="dashboard.reports.SidebarCtrl">
<div class="settings-nav-mobile-close toggled" ng-toggle="" ng-toggle-value="&#39;advancedSidebar-&#39; + model.cls" ng-toggle-group="secondarySettingsNav" ng-toggle-group-closeable="">
<i class="tb-icon back"></i> Back
</div>
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=default" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" class="report-without-presets" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=default">
New Sales report</a>
<!-- ngNavigationPrefix: urls.dashboard.reports.advanced.index -->
<!-- ngIf: suggestedReports.length > 1 --><div ng-if="suggestedReports.length &gt; 1" class="settings-nav-section">
<div class="settings-nav-header">Suggested Reports</div>
<ul class="settings-nav-list has-dark-hovers">
<!-- ngRepeat: suggestedReport in suggestedReports --><!-- ngIfOnce: $index > 0 --><!-- end ngRepeat: suggestedReport in suggestedReports --><!-- ngIfOnce: $index > 0 --><li ng-repeat="suggestedReport in suggestedReports" ng-if-once="$index &gt; 0">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-user" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-user">
Sales by User
<!-- ngIf: suggestedReport.note --><span class="settings-nav-list-note" ng-if="suggestedReport.note">
Transactions grouped by user, then payment type
</span>
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports --><!-- ngIfOnce: $index > 0 --><li ng-repeat="suggestedReport in suggestedReports" ng-if-once="$index &gt; 0">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-availability" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-availability">
Sales by Availability
<!-- ngIf: suggestedReport.note --><span class="settings-nav-list-note" ng-if="suggestedReport.note">
Transactions grouped by availability, then payment type
</span>
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports --><!-- ngIfOnce: $index > 0 --><li ng-repeat="suggestedReport in suggestedReports" ng-if-once="$index &gt; 0">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-item" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-item">
Sales by Item
<!-- ngIf: suggestedReport.note --><span class="settings-nav-list-note" ng-if="suggestedReport.note">
Transactions grouped by item
</span>
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports --><!-- ngIfOnce: $index > 0 --><li ng-repeat="suggestedReport in suggestedReports" ng-if-once="$index &gt; 0">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=revenue-by-type" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=revenue-by-type">
Revenue by Type
<!-- ngIf: suggestedReport.note --><span class="settings-nav-list-note" ng-if="suggestedReport.note">
Transactions grouped by accrual status, then payment type, then item
</span>
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports -->
</ul>
</div>
<!-- ngIf: customReports.length --><div ng-if="customReports.length" class="settings-nav-section">
<div class="settings-nav-header">Saved Reports</div>
<ul class="settings-nav-list has-dark-hovers">
<!-- ngRepeat: customReport in customReports --><li ng-repeat="customReport in customReports">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=14462" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=14462">
Tax Report
<!-- ngIf: customReport.note -->
</a>
</li><!-- end ngRepeat: customReport in customReports --><li ng-repeat="customReport in customReports">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=15554" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=15554">
2018 Sales Report
<!-- ngIf: customReport.note -->
</a>
</li><!-- end ngRepeat: customReport in customReports --><li ng-repeat="customReport in customReports">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=20338" ng-click="toggles.toggle(&#39;showReportsNav&#39;, false)" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=20338">
March 2019
<!-- ngIf: customReport.note -->
</a>
</li><!-- end ngRepeat: customReport in customReports -->
</ul>
</div>
</div></div><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><!-- ngToggled:  --><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><!-- ngToggled:  --><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><!-- ngToggled:  --><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel --><!-- ngToggled:  --><!-- end ngRepeat: model in Report.ORDERED_MODELS|filter:allowAdvancedModel -->
<!-- ngToggled: legacyReportsList -->
<!-- ngToggled: adminReportsList -->
</div>
<!-- ngNavigationPath: urls.dashboard.reports.index -->
<!-- ngNavigationPrefix: urls.dashboard.reports.advanced.index --><div ng-navigation-prefix="urls.dashboard.reports.advanced.index" ng-navigation-prefix-when="!company.isAdmin" ng-then="advancedReports">
<div ng-load="partials/dashboard/reports/advanced-index.partial?99774cb15b0528a7a2caeeb2a01921cc3e14532e"><div ng-controller="dashboard.reports.AdvancedIndexCtrl" class="success" ng-title="Sales | Screaming Eagle Sports">
<!-- ngIf: dataCtrl.status === 'loading' -->
<!-- ngIf: dataCtrl.status === 'success' --><div ng-if="dataCtrl.status === &#39;success&#39;">
<!-- ngCanList: Report on company --><div ng-can-list="Report on company" ng-then="allowed">
<div class="db-primary-tb respond-print-hide" ng-link="dashboard.reports.advanced.navigation"><div class="tb tb--shaded tb--inset-mobile">
<div class="tb-left">
<div class="tb-group respond-handhelds-hide">
<div class="tb-btn" ng-toggle="showReportsNav" ng-toggle-group="tb-flyouts" ng-toggle-group-closeable="" ng-toggle-auto-close="">
<i class="tb-icon hamburger"></i>
Report type
</div>
</div>
<div class="tb-group">
<a class="tb-btn tb-btn--popup" ng-href="https://fareharbor.com/help/reporting/advanced-reports" ng-outbound-link="_blank" target="_blank" href="https://fareharbor.com/help/reporting/advanced-reports"><i class="tb-icon help"></i> Advanced reports help</a>
</div>
<div class="tb-group">
<div class="tb-flyout-wrap" ng-controller="dashboard.reports.SuggestedReportsCtrl">
<div class="tb-btn tb-btn--flyout tb-collapse-on-mobile" ng-toggle="suggestedReportsList" ng-toggle-group="tb-flyouts" ng-toggle-group-closeable="" ng-toggle-auto-close="">
<span class="respond-handhelds-show">
<i class="tb-icon hamburger "></i>
</span>
Suggested reports
</div>
<div ng-toggled-show="suggestedReportsList" class="tb-flyout" ng-toggled-action="currentSuggestedReport.refresh(newReport)" style="display: none;">
<ul class="flyout-menu-items flyout-scrollable" ng-style="{ &#39;max-height&#39;: dimensions.height - 100 }" style="max-height: 563px;">
<!-- ngRepeat: suggestedReport in suggestedReports --><li ng-repeat="suggestedReport in suggestedReports" ng-class="{ &#39;flyout-menu-item--is-tall&#39;: suggestedReport.slug === &#39;default&#39; }" class="flyout-menu-item--is-tall">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=default" ng-toggle="suggestedReportsList" ng-class="{ &#39;current&#39;: currentSuggestedReport.is(suggestedReport) }" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=default">
<!-- ngIf: suggestedReport.slug === 'default' --><span ng-if="suggestedReport.slug === &#39;default&#39;" ng-then="isDefault">
<i class="tb-icon plus"></i>
New Sales report
</span>
<!-- ngElse: isDefault -->
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports --><li ng-repeat="suggestedReport in suggestedReports" ng-class="{ &#39;flyout-menu-item--is-tall&#39;: suggestedReport.slug === &#39;default&#39; }">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-user" ng-toggle="suggestedReportsList" ng-class="{ &#39;current&#39;: currentSuggestedReport.is(suggestedReport) }" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-user" class="current">
<!-- ngIf: suggestedReport.slug === 'default' -->
<!-- ngElse: isDefault --><span ng-else="isDefault">
Sales by User
<!-- ngIf: suggestedReport.note --><span class="flyout-menu-item-note" ng-if="suggestedReport.note">
Transactions grouped by user, then payment type
</span>
</span>
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports --><li ng-repeat="suggestedReport in suggestedReports" ng-class="{ &#39;flyout-menu-item--is-tall&#39;: suggestedReport.slug === &#39;default&#39; }">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-availability" ng-toggle="suggestedReportsList" ng-class="{ &#39;current&#39;: currentSuggestedReport.is(suggestedReport) }" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-availability">
<!-- ngIf: suggestedReport.slug === 'default' -->
<!-- ngElse: isDefault --><span ng-else="isDefault">
Sales by Availability
<!-- ngIf: suggestedReport.note --><span class="flyout-menu-item-note" ng-if="suggestedReport.note">
Transactions grouped by availability, then payment type
</span>
</span>
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports --><li ng-repeat="suggestedReport in suggestedReports" ng-class="{ &#39;flyout-menu-item--is-tall&#39;: suggestedReport.slug === &#39;default&#39; }">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-item" ng-toggle="suggestedReportsList" ng-class="{ &#39;current&#39;: currentSuggestedReport.is(suggestedReport) }" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=sales-by-item">
<!-- ngIf: suggestedReport.slug === 'default' -->
<!-- ngElse: isDefault --><span ng-else="isDefault">
Sales by Item
<!-- ngIf: suggestedReport.note --><span class="flyout-menu-item-note" ng-if="suggestedReport.note">
Transactions grouped by item
</span>
</span>
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports --><li ng-repeat="suggestedReport in suggestedReports" ng-class="{ &#39;flyout-menu-item--is-tall&#39;: suggestedReport.slug === &#39;default&#39; }">
<a ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=revenue-by-type" ng-toggle="suggestedReportsList" ng-class="{ &#39;current&#39;: currentSuggestedReport.is(suggestedReport) }" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?suggested=revenue-by-type">
<!-- ngIf: suggestedReport.slug === 'default' -->
<!-- ngElse: isDefault --><span ng-else="isDefault">
Revenue by Type
<!-- ngIf: suggestedReport.note --><span class="flyout-menu-item-note" ng-if="suggestedReport.note">
Transactions grouped by accrual status, then payment type, then item
</span>
</span>
</a>
</li><!-- end ngRepeat: suggestedReport in suggestedReports -->
<li class="flyout-menu-items-empty ng-hide" ng-hide="suggestedReports.length">No suggested reports</li>
</ul>
<div ng-link="mobile-flyout-close" ng-with="toggle = &#39;suggestedReportsList&#39;"><!-- ngToggled:  --></div>
</div>
</div>
<div ng-controller="dashboard.reports.CustomReportsCtrl" class="tb-data success">
<!-- ngIf: dataCtrl.status === 'loading' -->
<!-- ngIf: dataCtrl.status === 'success' --><div ng-if="dataCtrl.status === &#39;success&#39;">
<!-- ngCanList: CustomReport on company --><div ng-can-list="CustomReport on company" ng-then="allowed">
<div class="tb-flyout-wrap">
<div class="tb-btn tb-btn--flyout tb-collapse-on-mobile" ng-toggle="customReportsList" ng-toggle-group="tb-flyouts" ng-toggle-group-closeable="" ng-toggle-auto-close="">
<span class="respond-handhelds-show">
<i class="tb-icon hamburger "></i>
</span>
Saved reports
</div>
<div ng-toggled-show="customReportsList" class="tb-flyout" ng-toggled-action="currentCustomReport.refresh(newReport)" style="display: none;">
<ul class="flyout-presets flyout-presets--sortable flyout-scrollable" ng-sortable="listCtrl.reorder" ng-style="{ &#39;max-height&#39;: dimensions.height - 275 }" data-listidx="0" style="max-height: 388px;">
<!-- ngRepeat: customReport in customReports --><li ng-repeat="customReport in customReports" ng-sortable-item="customReport" class="sortable">
<!-- ngCanUpdate: customReport --><span class="sortable-handle small" ng-tip="Drag to reorder" ng-tip-classes="tip-indent" ng-can-update="customReport" ng-can-only-when="customReports.length &gt; 0"></span>
<div ng-controller="dashboard.shared.CustomReportEditableCtrl" class="">
<!-- ngCanView: customReport --><div ng-can-view="customReport" ng-then="allowed">
<!-- ngCanUpdate: customReport -->
<!-- ngElse: editing --><div ng-else="editing">
<a class="flyout-preset-apply can-wrap is-editable" ng-class="{ &#39;is-active&#39;: currentCustomReport.is(customReport) }" ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=14462" ng-toggle="customReportsList" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=14462">
Tax Report
<!-- ngIf: customReport.note -->
</a>
<!-- ngCanUpdate: customReport --><a ng-click="editCtrl.edit()" ng-can-update="customReport" class="flyout-preset-edit-btn"><span>Edit</span></a>
</div>
</div>
<!-- ngElse: allowed -->
</div>
</li><!-- end ngRepeat: customReport in customReports --><li ng-repeat="customReport in customReports" ng-sortable-item="customReport" class="sortable">
<!-- ngCanUpdate: customReport --><span class="sortable-handle small" ng-tip="Drag to reorder" ng-tip-classes="tip-indent" ng-can-update="customReport" ng-can-only-when="customReports.length &gt; 0"></span>
<div ng-controller="dashboard.shared.CustomReportEditableCtrl" class="">
<!-- ngCanView: customReport --><div ng-can-view="customReport" ng-then="allowed">
<!-- ngCanUpdate: customReport -->
<!-- ngElse: editing --><div ng-else="editing">
<a class="flyout-preset-apply can-wrap is-editable" ng-class="{ &#39;is-active&#39;: currentCustomReport.is(customReport) }" ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=15554" ng-toggle="customReportsList" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=15554">
2018 Sales Report
<!-- ngIf: customReport.note -->
</a>
<!-- ngCanUpdate: customReport --><a ng-click="editCtrl.edit()" ng-can-update="customReport" class="flyout-preset-edit-btn"><span>Edit</span></a>
</div>
</div>
<!-- ngElse: allowed -->
</div>
</li><!-- end ngRepeat: customReport in customReports --><li ng-repeat="customReport in customReports" ng-sortable-item="customReport" class="sortable">
<!-- ngCanUpdate: customReport --><span class="sortable-handle small" ng-tip="Drag to reorder" ng-tip-classes="tip-indent" ng-can-update="customReport" ng-can-only-when="customReports.length &gt; 0"></span>
<div ng-controller="dashboard.shared.CustomReportEditableCtrl" class="">
<!-- ngCanView: customReport --><div ng-can-view="customReport" ng-then="allowed">
<!-- ngCanUpdate: customReport -->
<!-- ngElse: editing --><div ng-else="editing">
<a class="flyout-preset-apply can-wrap is-editable" ng-class="{ &#39;is-active&#39;: currentCustomReport.is(customReport) }" ng-href="/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=20338" ng-toggle="customReportsList" href="https://fareharbor.com/destinspeedboat/dashboard/reports/advanced/payments-and-refunds/?saved=20338">
March 2019
<!-- ngIf: customReport.note -->
</a>
<!-- ngCanUpdate: customReport --><a ng-click="editCtrl.edit()" ng-can-update="customReport" class="flyout-preset-edit-btn"><span>Edit</span></a>
</div>
</div>
<!-- ngElse: allowed -->
</div>
</li><!-- end ngRepeat: customReport in customReports -->
<li class="flyout-presets-empty ng-hide" ng-hide="customReports.length">No saved reports</li>
</ul>
<!-- ngCanCreate: CustomReport on company --><div ng-can-create="CustomReport on company">
<!-- ngIf: !listCtrl.adding --><div class="flyout-create-form-toggle shaded" ng-if="!listCtrl.adding" ng-click="listCtrl.add()">New saved report</div>
<!-- ngIf: listCtrl.adding -->
<div class="flyout-section">
<div class="hint">
<a ng-href="https://fareharbor.com/help/reporting/advanced-reports/saving/" ng-outbound-link="_blank" class="hint-help-link" target="_blank" href="https://fareharbor.com/help/reporting/advanced-reports/saving/">How to save a report</a>
</div>
</div>
</div>
<div ng-link="mobile-flyout-close" ng-with="toggle = &#39;customReportsList&#39;"><!-- ngToggled:  --></div>
</div>
</div>
</div>
<!-- ngElse: allowed -->
</div>
<!-- ngIf: dataCtrl.status === 'error' -->
<!-- ngIf: dataCtrl.status === 'not-found' -->
<!-- ngIf: dataCtrl.status === 'disconnect' -->
<!-- ngIf: dataCtrl.status === 'forbidden' -->
</div>
</div>
<div class="tb-group" ng-controller="dashboard.reports.ReportShareCtrl">
<!-- ngIf: makeShareLink() --><div class="tb-flyout-wrap" ng-if="makeShareLink()" ng-with="reportPermalink = makeShareLink()" ng-link="dashboard.reports.shareTools"><div class="tb-btn tb-btn--flyout" ng-toggle="reportLinkMenu" ng-toggle-group="tb-flyouts" ng-toggle-group-closeable="" ng-toggle-auto-close="">
<i class="tb-icon share"></i> Share
</div>
<!-- ngToggled: reportLinkMenu --></div>

<span ng-if="autoExport.canExport(namespace)" class="respond-handhelds-hide tb-data" ng-auto-exporter="report" ng-auto-exporter-filename="Sales--2019-01-01--2019-10-15.csv">
<!-- ngIf: autoExport.isDownloadSupported --><a ng-if="autoExport.isDownloadSupported" ng-then="downloadsSupported" class="tb-btn" ng-tip="Download CSV" ng-disabled="!autoExport.ready()" ng-click="autoExport.autoExport(namespace, filename)">
<i class="tb-icon download"></i> <abbr>Download CSV</abbr>
</a>
<!-- ngElse: downloadsSupported -->
</span><!-- ngIf: report -->
<a class="tb-btn respond-handhelds-hide" ng-tip="Print" ng-print="" ng-if="report">
<i class="tb-icon print"></i> <abbr>Print</abbr>
</a></div>
</div>
</div></div>
<div ng-controller="dashboard.reports.AdvancedReportEditableCtrl">
<form class="respond-print-hide ng-valid ng-valid-parse ng-valid-required ng-valid-range-field ng-dirty ng-submitted" name="reportForm" ng-submit="submit(reportForm)" novalidate="novalidate">
<div class="ar-main-header">
<div class="table full-width valign-middle">
<div class="tr">
<div class="td">
<h1>
<!-- ngIf: currentCustomReport.object.isEdited -->
<!-- ngIf: currentCustomReport.object -->
<!-- ngIf: currentSuggestedReport.object &&
currentSuggestedReport.object.slug !== 'default' --><span ng-if="
currentSuggestedReport.object &amp;&amp;
currentSuggestedReport.object.slug !== &#39;default&#39;
" ng-then="isSuggestedReport">
Sales by User
</span>
<!-- ngElse: isCustomReport || isSuggestedReport -->
</h1>
<!-- ngIf: isCustomReport || isSuggestedReport --><div class="fh-grey" ng-if="isCustomReport || isSuggestedReport">
<span class="badge">Sales</span>
Transactions grouped by user, then payment type
</div>
</div>
<div class="td ar-main-header-buttons nowrap--desktop">
<span class="ar-main-header-details">
<!-- ngIf: createdReport.status === Report.SUCCEEDED_STATUS --><span ng-if="createdReport.status === Report.SUCCEEDED_STATUS" ng-interval="60">
Report accurate as of 5 minutes ago
</span>
<!-- ngIf: createdReport.status === Report.CANCELLED_STATUS -->
<!-- ngIf: createdReport.status === Report.FAILED_STATUS -->
<!-- ngIf: createdReport.status === Report.NEW_STATUS -->
<!-- ngIf: reportForm.$submitting || (createdReport && createdReport.isInProgress) -->
</span>
<!-- ngIf: !createdReport.isInProgress && !reportForm.$submitting --><button class="btn btn-green" type="submit" ng-disabled="reportForm.$submitting || reportForm.$invalid || (createdReport &amp;&amp; createdReport.isInProgress)" ng-if="!createdReport.isInProgress &amp;&amp; !reportForm.$submitting" ng-then="isGenerating" ng-shortcut="&#39;return&#39;" ng-shortcut-click="">
<i class="tb-icon play white"></i>
Generate
</button>
<!-- ngElse: isGenerating -->
</div>
</div>
</div>
</div>
<div class="ar-wrap is-full" ng-class="{ &#39;is-tall&#39;: toggles.state(&#39;tallReportForm&#39;) }">
<!-- ngWatch: tracker.modifiedAt --><div class="fields
ar-fields-wrap
" ng-watch="tracker.modifiedAt">
<span class="ng-hide" ng-shortcut-action="newReport.options.isOpened = !newReport.options.isOpened" ng-shortcut="&#39;/&#39;"></span>
<div class="tb tb--simple-advanced-report ar-form-simple">
<div class="tb-left">
<div class="tb-group">
<span class="tb-btn" ng-click="newReport.options.isOpened = true">
<i class="tb-icon chevron-down"></i> Advanced
</span>
</div>
<div class="tb-group">
<div class="tb-select" ng-preset-date-range="newReport.options.presetDateRange" ng-preset-date-range-start="newReport.options.startDate" ng-preset-date-range-end="newReport.options.endDate">
<div class="reportform-presetdaterange field-select-max-width-100 field  ng-dirty" ng-django-field="reportForm [&#39;presetDateRange&#39;]" ng-django-field-model="newReport.options [&#39;presetDateRange&#39;]">
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="the-field">
<select data-lpignore="true" id="id_preset_date_range" name="presetDateRange" ng-model="newReport.options [&#39;presetDateRange&#39;]" class="ng-pristine ng-untouched ng-valid">
<option value="" selected="selected">Custom Range</option>
<option value="today">Today</option>
<option value="this-week">This Week</option>
<option value="week-to-date">This Week-to-date</option>
<option value="this-month">This Month</option>
<option value="month-to-date">This Month-to-date</option>
<option value="this-quarter">This Quarter</option>
<option value="quarter-to-date">This Quarter-to-date</option>
<option value="this-year">This Year</option>
<option value="year-to-date">This Year-to-date</option>
<option value="remaining-this-year">Remaining this Year</option>
<option value="yesterday">Yesterday</option>
<option value="last-7-days">Last 7 Days</option>
<option value="last-week">Last Week</option>
<option value="last-week-to-date">Last Week-to-date</option>
<option value="last-30-days">Last 30 Days</option>
<option value="last-month">Last Month</option>
<option value="last-month-to-date">Last Month-to-date</option>
<option value="last-quarter">Last Quarter</option>
<option value="last-quarter-to-date">Last Quarter-to-date</option>
<option value="last-year">Last Year</option>
<option value="last-year-to-date">Last Year-to-date</option>
<option value="tomorrow">Tomorrow</option>
<option value="next-7-days">Next 7 Days</option>
<option value="next-week">Next Week</option>
<option value="next-30-days">Next 30 Days</option>
<option value="next-month">Next Month</option>
<option value="next-year">Next Year</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"><i class="field-required-flag" ng-tip="Answer is required" ng-tip-location="i" ng-tip-touch="true"><i></i></i></i>
</span>
<ul class="errors">
<!-- ngIf: reportForm ['presetDateRange'].$error['invalid_choice'] -->
<!-- ngRepeat: error in reportForm ['presetDateRange'].$error.$server -->
</ul>
</span>
</label>
</div>
</div>
<div ng-range-field="[newReport.options.startDate, newReport.options.endDate]" class="tb-date-picker">
<div class="reportform-startdate datepicker field ng-pristine ng-disabled ng-required" ng-django-field="reportForm [&#39;startDate&#39;]" ng-django-field-model="newReport.options [&#39;startDate&#39;]" ng-django-field-required="" ng-django-field-disabled="newReport.options.presetDateRange">
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="the-field">
<input data-lpignore="true" id="id_start_date" name="startDate" ng-datepicker="true" ng-datepicker-min-date="minDate" ng-disabled="newReport.options.presetDateRange" ng-model="newReport.options [&#39;startDate&#39;]" required="required" type="text" class="ng-pristine ng-untouched ng-valid ng-valid-required" disabled="disabled">
<span class="field-style-hook"></span>
<i ng-link="f-req"><i class="field-required-flag" ng-tip="Answer is required" ng-tip-location="i" ng-tip-touch="true"><i></i></i></i>
</span>
<ul class="errors">
<!-- ngIf: reportForm ['startDate'].$error['invalid'] -->
<!-- ngRepeat: error in reportForm ['startDate'].$error.$server -->
</ul>
</span>
</label>
</div>
<div class="tb-date-picker-divider">&nbsp;&nbsp;</div>
<div class="reportform-enddate datepicker field ng-pristine ng-disabled ng-required" ng-django-field="reportForm [&#39;endDate&#39;]" ng-django-field-model="newReport.options [&#39;endDate&#39;]" ng-django-field-required="" ng-django-field-disabled="newReport.options.presetDateRange">
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="the-field">
<input data-lpignore="true" id="id_end_date" name="endDate" ng-datepicker="true" ng-datepicker-min-date="minDate" ng-disabled="newReport.options.presetDateRange" ng-model="newReport.options [&#39;endDate&#39;]" required="required" type="text" class="ng-pristine ng-untouched ng-valid ng-valid-parse ng-valid-required" disabled="disabled">
<span class="field-style-hook"></span>
<i ng-link="f-req"><i class="field-required-flag" ng-tip="Answer is required" ng-tip-location="i" ng-tip-touch="true"><i></i></i></i>
</span>
<ul class="errors">
<!-- ngIf: reportForm ['endDate'].$error['invalid'] -->
<!-- ngRepeat: error in reportForm ['endDate'].$error.$server -->
</ul>
</span>
</label>
</div>
<!-- ngIf: rangeFieldCtrl.isInverted -->
</div>
</div>
<div class="tb-group">
<label class="tb-select">
<div class="tb-label fh-grey">Report on:</div>
<div class="field-select-max-width-100 field">
<label>
<span class="the-field-outer">
<span class="the-field">
<select ng-init="dateTypeChoices = [{&quot;name&quot;:&quot;Availability date&quot;,&quot;value&quot;:&quot;availability&quot;},{&quot;name&quot;:&quot;Booking date&quot;,&quot;value&quot;:&quot;booking&quot;},{&quot;name&quot;:&quot;Original booking date&quot;,&quot;value&quot;:&quot;booking-original&quot;},{&quot;name&quot;:&quot;Expense and Discount date&quot;,&quot;value&quot;:&quot;line-item&quot;},{&quot;name&quot;:&quot;Payment created date&quot;,&quot;value&quot;:&quot;payment-or-refund&quot;},{&quot;name&quot;:&quot;Accrual date&quot;,&quot;value&quot;:&quot;payment-or-refund-accrual&quot;}]" ng-model="newReport.options.dateType" ng-options="choice.value as choice.name for choice in dateTypeChoices|filter:allowDateTypeChoice" class="ng-pristine ng-untouched ng-valid"><option value="0" label="Availability date">Availability date</option><option value="1" selected="selected" label="Payment created date">Payment created date</option><option value="2" label="Accrual date">Accrual date</option></select>
</span>
</span>
</label>
</div>
</label>
</div>
</div>
</div>
<div class="ar-form-full">
<div class="ar-report-on">
<div class="ar-advanced-toggle respond-handhelds-hide">
<span ng-click="newReport.options.isOpened = false" class="ar-advanced-simple-toggle">
Hide
</span>
<span ng-toggle="tallReportForm" class="ar-advanced-tall-toggle" ng-tip="Expand" ng-tip-classes="tip-indent"></span>
</div>
<div class="flyout-toggle-header has-border respond-desktop-hide" ng-toggle="mobileReportOn">Dates</div>
<div class="ar-setup-inner toggled-handhelds-only" ng-class="{ &#39;toggled&#39;: toggles.state(&#39;mobileReportOn&#39;) }">
<!-- ngIf: reportModel === CustomFieldValue -->
<div class="flyout-checklist-header">Dates:</div>
<div class="flyout-inner">
<div ng-preset-date-range="newReport.options.presetDateRange" ng-preset-date-range-start="newReport.options.startDate" ng-preset-date-range-end="newReport.options.endDate">
<div class="reportform-presetdaterange field-select-max-width-100 field  ng-dirty" ng-django-field="reportForm [&#39;presetDateRange&#39;]" ng-django-field-model="newReport.options [&#39;presetDateRange&#39;]">
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="the-field">
<select data-lpignore="true" id="id_preset_date_range" name="presetDateRange" ng-model="newReport.options [&#39;presetDateRange&#39;]" class="ng-valid ng-dirty ng-valid-parse ng-touched">
<option value="" selected="selected">Custom Range</option>
<option value="today">Today</option>
<option value="this-week">This Week</option>
<option value="week-to-date">This Week-to-date</option>
<option value="this-month">This Month</option>
<option value="month-to-date">This Month-to-date</option>
<option value="this-quarter">This Quarter</option>
<option value="quarter-to-date">This Quarter-to-date</option>
<option value="this-year">This Year</option>
<option value="year-to-date">This Year-to-date</option>
<option value="remaining-this-year">Remaining this Year</option>
<option value="yesterday">Yesterday</option>
<option value="last-7-days">Last 7 Days</option>
<option value="last-week">Last Week</option>
<option value="last-week-to-date">Last Week-to-date</option>
<option value="last-30-days">Last 30 Days</option>
<option value="last-month">Last Month</option>
<option value="last-month-to-date">Last Month-to-date</option>
<option value="last-quarter">Last Quarter</option>
<option value="last-quarter-to-date">Last Quarter-to-date</option>
<option value="last-year">Last Year</option>
<option value="last-year-to-date">Last Year-to-date</option>
<option value="tomorrow">Tomorrow</option>
<option value="next-7-days">Next 7 Days</option>
<option value="next-week">Next Week</option>
<option value="next-30-days">Next 30 Days</option>
<option value="next-month">Next Month</option>
<option value="next-year">Next Year</option>
</select>
<span class="field-style-hook"></span>
<i ng-link="f-req"><i class="field-required-flag" ng-tip="Answer is required" ng-tip-location="i" ng-tip-touch="true"><i></i></i></i>
</span>
<ul class="errors">
<!-- ngIf: reportForm ['presetDateRange'].$error['invalid_choice'] -->
<!-- ngRepeat: error in reportForm ['presetDateRange'].$error.$server -->
</ul>
</span>
</label>
</div>
</div>
<div ng-range-field="[newReport.options.startDate, newReport.options.endDate]" class="report-on-range">
<div class="datepicker-with-dash">
<div class="reportform-startdate datepicker field ng-pristine ng-disabled ng-required" ng-django-field="reportForm [&#39;startDate&#39;]" ng-django-field-model="newReport.options [&#39;startDate&#39;]" ng-django-field-required="" ng-django-field-disabled="newReport.options.presetDateRange">
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="the-field">
<input data-lpignore="true" id="id_start_date" name="startDate" ng-datepicker="true" ng-datepicker-min-date="minDate" ng-disabled="newReport.options.presetDateRange" ng-model="newReport.options [&#39;startDate&#39;]" required="required" type="text" class="ng-pristine ng-untouched ng-valid ng-valid-required" disabled="disabled">
<span class="field-style-hook"></span>
<i ng-link="f-req"><i class="field-required-flag" ng-tip="Answer is required" ng-tip-location="i" ng-tip-touch="true"><i></i></i></i>
</span>
<ul class="errors">
<!-- ngIf: reportForm ['startDate'].$error['invalid'] -->
<!-- ngRepeat: error in reportForm ['startDate'].$error.$server -->
</ul>
</span>
</label>
</div>
<div class="datepicker-dash">-</div>
</div>
<div class="reportform-enddate datepicker field ng-pristine ng-disabled ng-required" ng-django-field="reportForm [&#39;endDate&#39;]" ng-django-field-model="newReport.options [&#39;endDate&#39;]" ng-django-field-required="" ng-django-field-disabled="newReport.options.presetDateRange">
<label>
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="the-field">
<input data-lpignore="true" id="id_end_date" name="endDate" ng-datepicker="true" ng-datepicker-min-date="minDate" ng-disabled="newReport.options.presetDateRange" ng-model="newReport.options [&#39;endDate&#39;]" required="required" type="text" class="ng-pristine ng-untouched ng-valid ng-valid-required" disabled="disabled">
<span class="field-style-hook"></span>
<i ng-link="f-req"><i class="field-required-flag" ng-tip="Answer is required" ng-tip-location="i" ng-tip-touch="true"><i></i></i></i>
</span>
<ul class="errors">
<!-- ngIf: reportForm ['endDate'].$error['invalid'] -->
<!-- ngRepeat: error in reportForm ['endDate'].$error.$server -->
</ul>
</span>
</label>
</div>
<!-- ngIf: rangeFieldCtrl.isInverted -->
</div>
</div>
<div class="flyout-checklist-header">Report on:</div>
<div class="flyout-inner">
<div class="field-select-max-width-100 field">
<label>
<span class="the-field-outer">
<span class="the-field">
<select ng-init="dateTypeChoices = [{&quot;name&quot;:&quot;Availability date&quot;,&quot;value&quot;:&quot;availability&quot;},{&quot;name&quot;:&quot;Booking date&quot;,&quot;value&quot;:&quot;booking&quot;},{&quot;name&quot;:&quot;Original booking date&quot;,&quot;value&quot;:&quot;booking-original&quot;},{&quot;name&quot;:&quot;Expense and Discount date&quot;,&quot;value&quot;:&quot;line-item&quot;},{&quot;name&quot;:&quot;Payment created date&quot;,&quot;value&quot;:&quot;payment-or-refund&quot;},{&quot;name&quot;:&quot;Accrual date&quot;,&quot;value&quot;:&quot;payment-or-refund-accrual&quot;}]" ng-model="newReport.options.dateType" ng-options="choice.value as choice.name for choice in dateTypeChoices|filter:allowDateTypeChoice" class="ng-pristine ng-untouched ng-valid"><option value="0" label="Availability date">Availability date</option><option value="1" selected="selected" label="Payment created date">Payment created date</option><option value="2" label="Accrual date">Accrual date</option></select>
</span>
</span>
</label>
</div>
</div>
<!-- ngRepeat: relevantCompany in relevantCompanies --><div ng-repeat="relevantCompany in relevantCompanies" class="ar-report-on-companies">
<!-- ngIf: relevantCompanies.length > 1 -->
<ul class="flyout-checklist">
<!-- ngIf: relevantCompany.isCharter && (relevantCompanies.length > 1 || relevantCompany.isAffiliate) -->
<!-- ngIf: relevantCompany.isAffiliate && relevantCompany === company && (relevantCompanies.length > 1 || relevantCompany.isCharter) -->
<li>
<!-- ngIf: newReport.options.selectedAffiliates[relevantCompany.pk] -->
</li>
</ul>
</div><!-- end ngRepeat: relevantCompany in relevantCompanies -->
</div>
</div>
<div class="table valign-top ar-setup-table">
<div class="tr">
<div class="td">
<div class="flyout-toggle-header has-border respond-desktop-hide" ng-toggle="mobileFilter">Filters</div>
<div class="ar-setup-inner toggled-handhelds-only" ng-class="{ &#39;toggled&#39;: toggles.state(&#39;mobileFilter&#39;) }">
<!-- ngIf: newReport.options.modelName === Booking.cls -->
<!-- ngElse: onlyBookingsFilter --><div class="advanced-filter-toggle-wrap" ng-else="onlyBookingsFilter">
<div class="advanced-filter-toggle table valign-middle full-width">
<div class="tr">
<div class="td fh-grey">
Filter:
</div>
<div class="td">
<!-- ngIf: newReport.options.modelName !== Booking.cls --><div class="giant-toggle-fluid table table-dont-respond valign-middle" ng-if="newReport.options.modelName !== Booking.cls" ng-advanced-filter-group-count="">
<div class="tr">
<!-- ngIf: isCoveredByReport(newReport, Payment) --><div class="td toggled" ng-if="isCoveredByReport(newReport, Payment)" ng-click="setModelBeingFiltered(Payment)" ng-class="{ toggled: modelBeingFiltered === Payment }">
Sales
<!-- ngIf: filterGroupCountCtrl.count(Payment.cls) !== 0 -->
</div>
<!-- ngIf: isCoveredByReport(newReport, LineItem) -->
<!-- ngIf: isCoveredByReport(newReport, CustomFieldValue) -->
<!-- ngIf: isCoveredByReport(newReport, Customer) -->
<div class="td" ng-click="setModelBeingFiltered(Booking)" ng-class="{ toggled: modelBeingFiltered === Booking }">
Bookings
<!-- ngIf: filterGroupCountCtrl.count(Booking.cls) !== 0 -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- ngWatch: modelBeingFiltered --><ul ng-watch="modelBeingFiltered">
<!-- ngIf: seperateUniversalFilters || company.isAdmin -->
<!-- ngRepeat: company in relevantCompanies --><!-- ngIf: newReport.options.selectedCharters[company.pk] ||
newReport.options.selectedAffiliates[company.pk] --><li ng-repeat="company in relevantCompanies" ng-if="
newReport.options.selectedCharters[company.pk] ||
newReport.options.selectedAffiliates[company.pk]
">
<!-- ngIf: newReport.options.selectedCharters[company.pk] --><div ng-if="newReport.options.selectedCharters[company.pk]">
<!-- ngIf: !seperateUniversalFilters --><div ng-if="!seperateUniversalFilters" ng-advanced-filter-group="[
newReport.options.filters[modelBeingFiltered.cls],
newReport.options.companies[company.pk].filters[modelBeingFiltered.cls],
]" ng-advanced-filter-group-multi-types="[
validFilters.universal[modelBeingFiltered.cls],
validFilters.company[modelBeingFiltered.cls]
]" ng-advanced-filter-group-company="company">
<!-- ngIf: filterGroupCtrl.requireCustomFields -->
<!-- ngIf: filterGroupCtrl.filters.length -->
<!-- ngIf: !filterGroupCtrl.isAdding && filterGroupCtrl.allowAdding() --><a class="flyout-create-form-toggle" ng-if="!filterGroupCtrl.isAdding &amp;&amp; filterGroupCtrl.allowAdding()" ng-click="filterGroupCtrl.add()">Add Filter</a>
<!-- ngIf: filterGroupCtrl.isAdding -->
</div>
<!-- ngIf: seperateUniversalFilters &&
validFilters.company[modelBeingFiltered.cls].length -->
</div>
<!-- ngIf: newReport.options.selectedAffiliates[company.pk] && (
validFilters.allPartners[modelBeingFiltered.cls].length || (
!newReport.options.companies[company.pk].selectedAllPartners &&
validFilters.partner[modelBeingFiltered.cls].length
)
) -->
</li><!-- end ngRepeat: company in relevantCompanies -->
</ul>
</div>
</div>
<div class="td">
<div class="flyout-toggle-header has-border respond-desktop-hide" ng-toggle="mobileGroupBy">Group by</div>
<div class="ar-setup-inner toggled-handhelds-only" ng-class="{ &#39;toggled&#39;: toggles.state(&#39;mobileGroupBy&#39;) }">
<div class="flyout-checklist-header">Group by:</div>
<ul class="flyout-checklist ar-selected-groups" ng-sortable="reorderGroups" ng-class="{ &#39;disable-sorting&#39;:newReport.options.groups.length &lt; 2 }" data-listidx="0">
<!-- ngRepeat: group in newReport.options.groups --><!-- ngIf: showGroup(group) --><li ng-repeat="group in newReport.options.groups" ng-if="showGroup(group)" ng-sortable-item="group" class="sortable">
<span class="sortable-handle small" ng-tip="Drag to reorder" ng-tip-classes="tip-indent"></span>
<label ng-click="unselectGroup(group)">
<input type="checkbox" ng-checked="true" checked="checked">
<span>Created By</span>
</label>
</li><!-- end ngRepeat: group in newReport.options.groups --><!-- ngIf: showGroup(group) --><li ng-repeat="group in newReport.options.groups" ng-if="showGroup(group)" ng-sortable-item="group" class="sortable">
<span class="sortable-handle small" ng-tip="Drag to reorder" ng-tip-classes="tip-indent"></span>
<label ng-click="unselectGroup(group)">
<input type="checkbox" ng-checked="true" checked="checked">
<span>Payment Type</span>
</label>
</li><!-- end ngRepeat: group in newReport.options.groups -->
</ul>
<ul class="flyout-checklist">
<!-- ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Credit Card Type</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Booking</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Dispute Status</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Accrual Status</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Payment Date</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Payment Week</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Payment Month</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Payment Year</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Payment Hour</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Payment Day</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Affiliate</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Availability</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Agent</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Desk</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Item</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Source</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Paid Status</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Invoice Sheet Relationship</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Crew Member</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Crew Role</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Booking Resource</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Customer Resource</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Check-in Status</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Booking Date</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Booking Week</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Booking Month</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Booking Year</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Booking Hour</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Booking Day</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Availability Date</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Availability Week</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Availability Month</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Availability Year</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Availability Hour</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Availability Day</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Invoice Sheet</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Total Sheet</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups --><!-- ngIf: showGroup(group) && !(newReport.options.groups|contains:group) --><li ng-repeat="group in flattenedGroups" ng-if="showGroup(group) &amp;&amp; !(newReport.options.groups|contains:group)">
<label ng-click="selectGroup(group)">
<input type="checkbox" ng-checked="false">
<span>Contact Language</span>
</label>
</li><!-- end ngRepeat: group in flattenedGroups -->
</ul>
</div>
</div>
<div class="td">
<div class="flyout-toggle-header has-border respond-desktop-hide" ng-toggle="mobileColumns">Columns</div>
<div class="ar-setup-inner toggled-handhelds-only" ng-class="{ &#39;toggled&#39;: toggles.state(&#39;mobileColumns&#39;) }">
<div class="flyout-checklist-header">Columns:</div>
<div class="flyout-inner">
<div class="reportform-isdetailed  field" ng-django-field="reportForm [&#39;isDetailed&#39;]" ng-django-field-model="newReport.options [&#39;isDetailed&#39;]">
<span class="label-text">
</span>
<span class="the-field-outer">
<span class="the-field">
<ul id="id_is_detailed">
<li><label for="id_is_detailed_0"><input data-lpignore="true" id="id_is_detailed_0" name="is_detailed" ng-boolean-select="" ng-model="newReport.options [&#39;isDetailed&#39;]" type="radio" value="False" class="ng-pristine ng-untouched ng-valid"> Summary report</label></li>
<li><label for="id_is_detailed_1"><input data-lpignore="true" id="id_is_detailed_1" name="is_detailed" ng-boolean-select="" ng-model="newReport.options [&#39;isDetailed&#39;]" type="radio" value="True" class="ng-pristine ng-untouched ng-valid"> Detailed report</label></li>
</ul>
<span class="field-style-hook"></span>
<i ng-link="f-req"><i class="field-required-flag" ng-tip="Answer is required" ng-tip-location="i" ng-tip-touch="true"><i></i></i></i>
</span>
<ul class="errors">
<!-- ngRepeat: error in reportForm ['isDetailed'].$error.$server -->
</ul>
</span>
</div>
</div>
<!-- ngIf: !newReport.options.isDetailed --><div class="flyout-inner" ng-if="!newReport.options.isDetailed">
<ul class="list-filters">
<!-- ngRepeat: columnGroup in columnGroups --><li ng-repeat="columnGroup in columnGroups" ng-click="columnGroupToggle.current = columnGroup.name" ng-class="{ toggled: columnGroupToggle.current === columnGroup.name }" class="toggled">
Summary
</li><!-- end ngRepeat: columnGroup in columnGroups --><li ng-repeat="columnGroup in columnGroups" ng-click="columnGroupToggle.current = columnGroup.name" ng-class="{ toggled: columnGroupToggle.current === columnGroup.name }">
Detail
</li><!-- end ngRepeat: columnGroup in columnGroups --><li ng-repeat="columnGroup in columnGroups" ng-click="columnGroupToggle.current = columnGroup.name" ng-class="{ toggled: columnGroupToggle.current === columnGroup.name }">
All
</li><!-- end ngRepeat: columnGroup in columnGroups -->
</ul>
<!-- ngIf: columnGroupToggle.current === 'detail' -->
</div>
<div class="flyout-inner">
<div class="field-search-wrap">
<input class="field-search js-disable-shortcuts ng-pristine ng-untouched ng-valid" type="text" ng-model="searchTerms.reportColumn" placeholder="Find column">
<div ng-clear-input="searchTerms.reportColumn" class="ng-clear-input ng-hide"></div>
</div>
</div>
<!-- ngRepeat: columnGroup in columnGroups --><!-- ngIf: columnGroupToggle.current === columnGroup.name --><div ng-repeat="columnGroup in columnGroups" ng-if="columnGroupToggle.current === columnGroup.name">
<!-- ngRepeat: model in reportModelWithSubmodels --><!-- ngIf: columnGroupToggle.current !== 'summary' || !isModelColumnsProhibited(model) --><div ng-repeat="model in reportModelWithSubmodels" ng-if="columnGroupToggle.current !== &#39;summary&#39; || !isModelColumnsProhibited(model)">
<div ng-multiple-choice-field="newReport.options.columns[model.cls]" ng-filtered="searchTerms.reportColumn" ng-filtered-objects="columnsByModel[model.cls][columnGroup.name]" ng-filtered-search-document="columnName($obj)">
<!-- ngIf: multipleChoiceCtrl.showNoneChoice || multipleChoiceCtrl.showAnyChoice -->
<!-- ngIf: !multipleChoiceCtrl.selections[multipleChoiceCtrl.ANY_CHOICE] --><div ng-if="!multipleChoiceCtrl.selections[multipleChoiceCtrl.ANY_CHOICE]" ng-transclude="">
<div class="flyout-checklist-header">
<div><b>
Sales columns
</b></div>
<span ng-select-all="filteredCtrl.objects|filter:showColumn" ng-select-all-model="newReport.options.columns[model.cls][$element]" ng-select-all-defaults="Report.defaultColumns()[model.cls]">
<span class="select-all">
<span>Select:</span>
<a ng-click="selectAll()">all</a>,
<a ng-click="selectNone()">none</a>,
<!-- ngIf: allowDefaults --><a ng-if="allowDefaults" ng-click="selectDefaults()">default</a>
</span>
</span>
</div>
<div ng-multiple-choice-field-choices="filteredCtrl.objects|filter:showColumn" ng-multiple-choice-field-choices-name-field="columnName">
<div ng-data="choicesCtrl.choices.$promise" ng-data-small="" class="flyout-ng-data">
<!-- ngIf: dataCtrl.type === 'manual' -->
<!-- ngElse: manual --><div ng-else="manual">
<!-- ngIf: dataCtrl.status === 'loading' -->
<!-- ngIf: dataCtrl.status === 'success' || (dataCtrl.status === 'error' && dataCtrl.transcludeOnError) --><div ng-if="dataCtrl.status === &#39;success&#39; || (dataCtrl.status === &#39;error&#39; &amp;&amp; dataCtrl.transcludeOnError)">
<div ng-transclude="">
<!-- ngIf: choicesCtrl.choices.length --><div ng-if="choicesCtrl.choices.length" ng-then="hasChoices">
<!-- ngIfOnce: choicesCtrl.header -->
<!-- ngToggled:  --><div ng-toggled="" ng-toggled-value="choicesCtrl.$id" ng-toggled-always-when="!choicesCtrl.allowToggle">
<!-- ngIfOnce: choicesCtrl.showSelectAll -->
<ul class="flyout-checklist">
<!-- ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Gross</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Processing Fees</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Net</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Payment Gross</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Payment Processing Fees</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Payment Net</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Refund Gross</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Refund Processing Fee</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Refund Net</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Subtotal Paid</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Tax Paid By Type</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Tax Paid</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Payment and Refund Count</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Payment Count</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Refund Count</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices -->
</ul>
</div>
</div>
<!-- ngElse: hasChoices -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div><!-- end ngRepeat: model in reportModelWithSubmodels --><!-- ngIf: columnGroupToggle.current !== 'summary' || !isModelColumnsProhibited(model) --><div ng-repeat="model in reportModelWithSubmodels" ng-if="columnGroupToggle.current !== &#39;summary&#39; || !isModelColumnsProhibited(model)">
<div ng-multiple-choice-field="newReport.options.columns[model.cls]" ng-filtered="searchTerms.reportColumn" ng-filtered-objects="columnsByModel[model.cls][columnGroup.name]" ng-filtered-search-document="columnName($obj)">
<!-- ngIf: multipleChoiceCtrl.showNoneChoice || multipleChoiceCtrl.showAnyChoice -->
<!-- ngIf: !multipleChoiceCtrl.selections[multipleChoiceCtrl.ANY_CHOICE] --><div ng-if="!multipleChoiceCtrl.selections[multipleChoiceCtrl.ANY_CHOICE]" ng-transclude="">
<div class="flyout-checklist-header">
<div><b>
Booking columns
</b></div>
<span ng-select-all="filteredCtrl.objects|filter:showColumn" ng-select-all-model="newReport.options.columns[model.cls][$element]" ng-select-all-defaults="Report.defaultColumns()[model.cls]">
<span class="select-all">
<span>Select:</span>
<a ng-click="selectAll()">all</a>,
<a ng-click="selectNone()">none</a>,
<!-- ngIf: allowDefaults --><a ng-if="allowDefaults" ng-click="selectDefaults()">default</a>
</span>
</span>
</div>
<div ng-multiple-choice-field-choices="filteredCtrl.objects|filter:showColumn" ng-multiple-choice-field-choices-name-field="columnName">
<div ng-data="choicesCtrl.choices.$promise" ng-data-small="" class="flyout-ng-data">
<!-- ngIf: dataCtrl.type === 'manual' -->
<!-- ngElse: manual --><div ng-else="manual">
<!-- ngIf: dataCtrl.status === 'loading' -->
<!-- ngIf: dataCtrl.status === 'success' || (dataCtrl.status === 'error' && dataCtrl.transcludeOnError) --><div ng-if="dataCtrl.status === &#39;success&#39; || (dataCtrl.status === &#39;error&#39; &amp;&amp; dataCtrl.transcludeOnError)">
<div ng-transclude="">
<!-- ngIf: choicesCtrl.choices.length --><div ng-if="choicesCtrl.choices.length" ng-then="hasChoices">
<!-- ngIfOnce: choicesCtrl.header -->
<!-- ngToggled:  --><div ng-toggled="" ng-toggled-value="choicesCtrl.$id" ng-toggled-always-when="!choicesCtrl.allowToggle">
<!-- ngIfOnce: choicesCtrl.showSelectAll -->
<ul class="flyout-checklist">
<!-- ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)"># of Bookings</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)"># Cancelled</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)"># Subscribed to SMS</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)"># Subscribed to Email</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)"># of Pax (Customer Count)</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Subtotal</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Tax By Type</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Tax</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">% Total</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Subtotal Paid</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Tax Paid By Type</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Tax Paid</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Paid</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">% Total Paid</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Subtotal Paid to Provider</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Tax Paid to Provider</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Paid to Provider</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Subtotal Paid to Affiliate</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Tax Paid to Affiliate</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Paid to Affiliate</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Net Revenue Collected</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Card Processing Fees</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Paid after Processing Fees</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Card Processing Fees Charged to Provider</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Paid to Provider after Processing Fees</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Card Processing Fees Charged to Affiliate</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Total Paid to Affiliate after Processing Fees</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)"><span class="admin-badge">FH</span> Booking Fees</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Amount Due</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Invoice Subtotal</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Invoice Tax</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Invoice Total</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)"># Invoiced</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Payable to Affiliate</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Paid to Affiliate</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Receivable from Affiliate</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices --><li ng-repeat="choice in choicesCtrl.choices" ng-init="value = choicesCtrl.valueField(choice)">
<label>
<input ng-model="multipleChoiceCtrl.selections[value]" ng-change="multipleChoiceCtrl.onChange(value)" type="checkbox" class="ng-pristine ng-untouched ng-valid">
<span ng-bind-html="choicesCtrl.nameField(choice)">Received from Affiliate</span>
</label>
</li><!-- end ngRepeat: choice in choicesCtrl.choices -->
</ul>
</div>
</div>
<!-- ngElse: hasChoices -->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div><!-- end ngRepeat: model in reportModelWithSubmodels -->
</div><!-- end ngRepeat: columnGroup in columnGroups --><!-- ngIf: columnGroupToggle.current === columnGroup.name --><!-- end ngRepeat: columnGroup in columnGroups --><!-- ngIf: columnGroupToggle.current === columnGroup.name --><!-- end ngRepeat: columnGroup in columnGroups -->
</div>
</div>
</div>
</div>
</div>
</div>
<div class="hide">
</div>
<div class="form-errors form-errors--bottom">
<ul class="errors test-server-error-indicator">
<!-- ngIf: reportForm.all.$error.companies_required -->
<!-- ngIf: reportForm.all.$error.invalid_filters -->
<!-- ngIf: reportForm.all.$error.custom_field_value_level -->
<!-- ngIf: reportForm.all.$error.partners_required -->
<!-- ngIf: reportForm.all.$error.invalid_model_filter -->
<!-- ngIf: reportForm.all.$error.date_range_required -->
<!-- ngIf: reportForm.all.$error.required -->
<!-- ngIf: reportForm.all.$error.unauthorized_filter -->
<!-- ngIf: reportForm.all.$error.invalid_charter_company -->
<!-- ngIf: reportForm.all.$error.invalid_companies -->
<!-- ngIf: reportForm.all.$error.custom_field_value_model_required -->
<!-- ngIf: reportForm.all.$error.invalid_affiliate_company -->
<!-- ngIf: reportForm.all.$error.invalid_date_type -->
<!-- ngIf: reportForm.all.$error.inverted_dates -->
<!-- ngIf: reportForm.all.$error.invalid_group -->
<!-- ngIf: reportForm.all.$error.invalid_filter_type -->
<!-- ngIf: reportForm.all.$error.unauthorized_group -->
<!-- ngIf: reportForm.all.$error.unauthorized_company -->
<!-- ngIf: reportForm.all.$error.invalid_company -->
<!-- ngIf: reportForm.all.$error.unauthorized_column -->
<!-- ngRepeat: error in reportForm.all.$error.$server -->
</ul>
</div>
</div>
</form>
</div>
<!-- ngNavigationPath: urls.dashboard.reports.advanced.permalink --><div class="ar-the-report" ng-navigation-path="urls.dashboard.reports.advanced.permalink" ng-then="hasReport">
<div ng-controller="dashboard.reports.AdvancedReportCtrl" class="">
<!-- ngCan: viewReports on company --><div ng-can="viewReports on company" ng-then="allowed">
<div ng-advanced-breadcrumbs="">
<!-- ngIf: breadcrumbs.length > 1 -->
</div>
<!-- ngWatch: report --><div ng-watch="report">
<!-- ngIf: status === 'loading' -->
<!-- ngElse: loading --><div ng-else="loading">
<!-- ngIf: report.isInProgress -->
<!-- ngIf: report.status === Report.SUCCEEDED_STATUS --><div ng-if="report.status === Report.SUCCEEDED_STATUS">
<!-- ngIf: isProcessing -->
<!-- ngElse: processing --><div ng-else="processing">
<div class="report-wrap">
<div ng-advanced-print-description="">
<div class="print-header respond-print-show">
<!-- ngIf: report.status === Report.SUCCEEDED_STATUS --><div class="print-header-generated" ng-if="report.status === Report.SUCCEEDED_STATUS">
Generated 10/15/19 @ 2:49pm
</div>
<div class="print-header-date">
<b>Sales</b>
<div>
<!-- ngIfOnce: report.options.dateType === Report.AVAILABILITY_DATE_TYPE -->
<!-- ngIfOnce: report.options.dateType === Report.BOOKING_DATE_TYPE -->
<!-- ngIfOnce: report.options.dateType === Report.BOOKING_ORIGINAL_DATE_TYPE -->
<!-- ngIfOnce: report.options.dateType === Report.LINE_ITEM_DATE_TYPE -->
<!-- ngIfOnce: report.options.dateType === Report.PAYMENT_OR_REFUND_DATE_TYPE --><span ng-if-once="report.options.dateType === Report.PAYMENT_OR_REFUND_DATE_TYPE">
Paid or refunded on
</span>
<!-- ngIfOnce: report.options.dateType === Report.PAYMENT_OR_REFUND_ACCRUAL_DATE_TYPE -->
<!-- ngIfOnce: report.options.presetDateRange --><span ng-if-once="report.options.presetDateRange" ng-init="range = (report.options.presetDateRange|parsePresetDateRange:report.company)">
1/1/19 - 10/15/19
</span>
<!-- ngIfOnce: !report.options.presetDateRange -->
</div>
<!-- ngRepeat: company in report.options.companies --><div ng-repeat="company in report.options.companies">
<!-- ngIfOnce: company.selectedAsCharter && !company.selectedAsAffiliate --><div ng-if-once="company.selectedAsCharter &amp;&amp; !company.selectedAsAffiliate">
Screaming Eagle Sports
</div>
<!-- ngIfOnce: company.selectedAsAffiliate -->
</div><!-- end ngRepeat: company in report.options.companies -->
</div>
</div>
</div>
<!-- ngIf: !report.data.groups.length -->
<!-- ngElse: noData --><div ng-else="noData">
<!-- ngIfOnce: report.options.modelName === Booking.cls -->
<!-- ngIfOnce: report.options.modelName === Customer.cls -->
<!-- ngIfOnce: report.options.modelName === CustomFieldValue.cls -->
<!-- ngIfOnce: report.options.modelName === LineItem.cls -->
<!-- ngIfOnce: report.options.modelName === Payment.cls --><div ng-if-once="report.options.modelName === Payment.cls">
<table class="spreadsheet width-auto highlight-rows spreadsheet--nowrap no-margin" ng-auto-export="report" ng-tables="">
<thead class="ss-header ss-header-shade sticky--reports">
<tr>
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings"></td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings"></td><!-- end ngRepeat: grouping in report.data.groupings -->
<td class="payments-header spanned-header" ng-advanced-super-header-model="Payment" ng-advanced-super-header="[
&#39;created-at&#39;,
&#39;created-at-time&#39;,
&#39;created-at-date&#39;,
&#39;payment-or-refund&#39;,
&#39;payment-or-refund-id&#39;,
&#39;payment-user&#39;,
&#39;payment-note-label&#39;,
&#39;payment-note&#39;,
&#39;payment-type&#39;,
&#39;affiliate-payment-type&#39;,
&#39;credit-card-type&#39;,
&#39;credit-card-last-four&#39;,
&#39;credit-card-postal-code&#39;,
&#39;dispute-status&#39;,
&#39;stored-value-card-number&#39;,
&#39;stored-value-card-type&#39;,
&#39;payment-and-refund-gross&#39;,
&#39;payment-and-refund-processing-fee&#39;,
&#39;payment-and-refund-net&#39;,
&#39;payment-initial-gross&#39;,
&#39;payment-initial-processing-fee&#39;,
&#39;payment-initial-net&#39;,
&#39;refund-gross&#39;,
&#39;refund-processing-fee&#39;,
&#39;refund-net&#39;,
&#39;payment-and-refund-total-price&#39;,
&#39;payment-and-refund-total-tax-by-type&#39;,
&#39;payment-and-refund-total-tax&#39;,
&#39;payment-and-refund-count&#39;,
&#39;payment-count&#39;,
&#39;refund-count&#39;,
]" colspan="5">Sales</td>
<td class="bookings-header spanned-header ng-hide" ng-advanced-super-header-model="Booking" ng-advanced-super-header="[
&#39;booking-id&#39;,
&#39;booking-count&#39;,
&#39;is-cancelled&#39;,
&#39;cancelled-count&#39;,
&#39;created-at&#39;,
&#39;created-at-time&#39;,
&#39;created-at-date&#39;,
&#39;originally-booked-by&#39;,
&#39;last-rebooked-at&#39;,
&#39;last-rebooked-at-date&#39;,
&#39;last-rebooked-at-time&#39;,
&#39;booked-by&#39;,
&#39;company&#39;,
&#39;item-id&#39;,
&#39;item-name&#39;,
&#39;availability-datetime&#39;,
&#39;availability-start-time&#39;,
&#39;availability-start-date&#39;,
&#39;availability-end-time&#39;,
&#39;availability-end-date&#39;,
&#39;availability-id&#39;,
&#39;day-of-week&#39;,
&#39;availability-public-headline&#39;,
&#39;availability-private-headline&#39;,
&#39;custom-fields-group&#39;,
&#39;contact-name&#39;,
&#39;contact-phone&#39;,
&#39;contact-language&#39;,
&#39;sms-subscribed-count&#39;,
&#39;is-subscribed-to-sms&#39;,
&#39;contact-email&#39;,
&#39;email-subscribed-count&#39;,
&#39;is-subscribed-to-email&#39;,
&#39;booking-notes&#39;,
&#39;customer-count&#39;,
&#39;customer-breakdown&#39;,
&#39;online-booking-reference&#39;,
&#39;lodging&#39;,
&#39;room-number&#39;,
&#39;pickup&#39;,
&#39;stop-time&#39;,
&#39;route&#39;,
&#39;total-sheet&#39;,
&#39;total-cost-price&#39;,
&#39;total-cost-tax-by-type&#39;,
&#39;total-cost-tax&#39;,
&#39;total-cost-total&#39;,
&#39;total-cost-total-percentage&#39;,
&#39;collected-total-cost-price&#39;,
&#39;collected-total-cost-tax-by-type&#39;,
&#39;collected-total-cost-tax&#39;,
&#39;collected-total-cost-total&#39;,
&#39;collected-total-cost-total-percentage&#39;,
&#39;collected-by-charter-total-cost-price&#39;,
&#39;collected-by-charter-total-cost-tax&#39;,
&#39;collected-by-charter-total-cost-total&#39;,
&#39;collected-by-affiliate-total-cost-price&#39;,
&#39;collected-by-affiliate-total-cost-tax&#39;,
&#39;collected-by-affiliate-total-cost-total&#39;,
&#39;net-charter-revenue&#39;,
&#39;receipt-processing-fee&#39;,
&#39;receipt-net&#39;,
&#39;receipt-collected-by-charter-processing-fee&#39;,
&#39;receipt-collected-by-charter-net&#39;,
&#39;receipt-collected-by-affiliate-processing-fee&#39;,
&#39;receipt-collected-by-affiliate-net&#39;,
&#39;receipt-booking-fee&#39;,
&#39;amount-due&#39;,
&#39;paid-status&#39;,
&#39;billing-zip-codes&#39;,
&#39;affiliate&#39;,
&#39;voucher-number&#39;,
&#39;agent&#39;,
&#39;desk&#39;,
&#39;affiliate-percentage&#39;,
&#39;invoice-sheet-description&#39;,
&#39;invoice-sheet&#39;,
&#39;invoice-cost-price&#39;,
&#39;invoice-cost-tax&#39;,
&#39;invoice-cost-total&#39;,
&#39;invoiced-count&#39;,
&#39;is-invoiced&#39;,
&#39;invoiceable-to-affiliate&#39;,
&#39;invoiced-to-affiliate&#39;,
&#39;invoiceable-to-charter&#39;,
&#39;invoiced-to-charter&#39;,
]">Bookings</td>
</tr>
<tr>
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" ng-table-header="$row|advancedGroupingSort:grouping" ng-table-header-when="$last">
<span ng-advanced-display-grouping="grouping">
<span>Created by</span>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" ng-table-header="$row|advancedGroupingSort:grouping" ng-table-header-when="$last" class="ng-table-header">
<span ng-advanced-display-grouping="grouping">
<span>Payment type</span>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-table-header-key="object" ng-table-header="!report.options.isDetailed ? object.summary[&#39;Payment-paymentAndRefundGross&#39;] : (
object.paymentOrRefundReceipt.gross
)" class="ng-table-header">
Gross
</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-table-header-key="object" ng-table-header="!report.options.isDetailed ? object.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;] : (
object.paymentOrRefundReceipt.processingFee
)" class="ng-table-header">
Processing<br>Fee
</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-table-header-key="object" ng-table-header="!report.options.isDetailed ? object.summary[&#39;Payment-paymentAndRefundNet&#39;] : (
object.paymentOrRefundReceipt.net
)" class="ng-table-header">
Net
</td>










<td ng-advanced-show-column="Payment-payment-count" ng-table-header-key="object" ng-table-header="!report.options.isDetailed ? object.summary[&#39;Payment-paymentCount&#39;] : (
0
)" class="ng-table-header">
Payment<br>Count
</td>
<td ng-advanced-show-column="Payment-refund-count" ng-table-header-key="object" ng-table-header="!report.options.isDetailed ? object.summary[&#39;Payment-refundCount&#39;] : (
0
)" class="ng-table-header">
Refund<br>Count
</td>






















































































</tr>
</thead>
<!-- ngRepeat: groupSet in report.options.isDetailed ? groupSets : [] -->
<!-- ngRepeat: groupSet in !report.options.isDetailed ? groupSets : [] --><tbody ng-repeat-start="groupSet in !report.options.isDetailed ? groupSets : []" ng-table="groupSet" ng-table-name="groupSetTable" ng-table-tables="" ng-advanced-currency="">
<!-- ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Online
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Credit card
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible">$34,032.70</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible negative">-$707.88</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible">$33,324.82</td>










<td ng-advanced-show-column="Payment-payment-count">
204
</td>
<td ng-advanced-show-column="Payment-refund-count">
0
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection -->
</tbody>
<tbody ng-repeat-end="" ng-table="groupSet">
<!-- ngIf: groupSets.length > 1 && groupSet.length > 1 -->
<tr ng-auto-export-skip="">
<td colspan="100">
&nbsp;
</td>
</tr>
</tbody><!-- end ngRepeat: groupSet in !report.options.isDetailed ? groupSets : [] --><tbody ng-repeat-start="groupSet in !report.options.isDetailed ? groupSets : []" ng-table="groupSet" ng-table-name="groupSetTable" ng-table-tables="" ng-advanced-currency="">
<!-- ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/mobilesportsllc/dashboard/settings/permissions/users/angelacarr/" class="" href="https://fareharbor.com/mobilesportsllc/dashboard/settings/permissions/users/angelacarr/">
Angela Carr
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Affiliate
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible negative">-$7,602.75</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible">$0.00</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible negative">-$7,602.75</td>










<td ng-advanced-show-column="Payment-payment-count">
0
</td>
<td ng-advanced-show-column="Payment-refund-count">
54
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject" class="ng-invisible">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/mobilesportsllc/dashboard/settings/permissions/users/angelacarr/" class="" href="https://fareharbor.com/mobilesportsllc/dashboard/settings/permissions/users/angelacarr/">
Angela Carr
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Credit card
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible">$24,097.82</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible negative">-$510.43</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible">$23,587.39</td>










<td ng-advanced-show-column="Payment-payment-count">
201
</td>
<td ng-advanced-show-column="Payment-refund-count">
32
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject" class="ng-invisible">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/mobilesportsllc/dashboard/settings/permissions/users/angelacarr/" class="" href="https://fareharbor.com/mobilesportsllc/dashboard/settings/permissions/users/angelacarr/">
Angela Carr
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Cash
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible">$2,557.40</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible">$0.00</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible">$2,557.40</td>










<td ng-advanced-show-column="Payment-payment-count">
19
</td>
<td ng-advanced-show-column="Payment-refund-count">
1
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection -->
</tbody>
<tbody ng-repeat-end="" ng-table="groupSet">
<!-- ngIf: groupSets.length > 1 && groupSet.length > 1 --><tr ng-if="groupSets.length &gt; 1 &amp;&amp; groupSet.length &gt; 1" class="bold" ng-auto-export-skip="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings">
<!-- ngIfOnce: $last -->
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings">
<!-- ngIfOnce: $last --><span ng-if-once="$last">
3 payment types
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundGross&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible">$19,052.47</span>
</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible negative">-$510.43</span>
</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundNet&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible">$18,542.04</span>
</td>










<td ng-advanced-show-column="Payment-payment-count" ng-table-summary="$row.summary[&#39;Payment-paymentCount&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
220
</td>
<td ng-advanced-show-column="Payment-refund-count" ng-table-summary="$row.summary[&#39;Payment-refundCount&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
87
</td>






















































































</tr>
<tr ng-auto-export-skip="">
<td colspan="100">
&nbsp;
</td>
</tr>
</tbody><!-- end ngRepeat: groupSet in !report.options.isDetailed ? groupSets : [] --><tbody ng-repeat-start="groupSet in !report.options.isDetailed ? groupSets : []" ng-table="groupSet" ng-table-name="groupSetTable" ng-table-tables="" ng-advanced-currency="">
<!-- ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/destinspeedboat/dashboard/settings/permissions/users/angelacarr/" class="" href="https://fareharbor.com/destinspeedboat/dashboard/settings/permissions/users/angelacarr/">
Angela Carr
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Affiliate
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible negative">-$3,692.30</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible">$0.00</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible negative">-$3,692.30</td>










<td ng-advanced-show-column="Payment-payment-count">
0
</td>
<td ng-advanced-show-column="Payment-refund-count">
27
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject" class="ng-invisible">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/destinspeedboat/dashboard/settings/permissions/users/angelacarr/" class="" href="https://fareharbor.com/destinspeedboat/dashboard/settings/permissions/users/angelacarr/">
Angela Carr
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Credit card
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible">$22,186.06</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible negative">-$475.45</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible">$21,710.61</td>










<td ng-advanced-show-column="Payment-payment-count">
198
</td>
<td ng-advanced-show-column="Payment-refund-count">
20
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject" class="ng-invisible">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/destinspeedboat/dashboard/settings/permissions/users/angelacarr/" class="" href="https://fareharbor.com/destinspeedboat/dashboard/settings/permissions/users/angelacarr/">
Angela Carr
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Cash
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible">$3,071.79</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible">$0.00</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible">$3,071.79</td>










<td ng-advanced-show-column="Payment-payment-count">
25
</td>
<td ng-advanced-show-column="Payment-refund-count">
0
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection -->
</tbody>
<tbody ng-repeat-end="" ng-table="groupSet">
<!-- ngIf: groupSets.length > 1 && groupSet.length > 1 --><tr ng-if="groupSets.length &gt; 1 &amp;&amp; groupSet.length &gt; 1" class="bold" ng-auto-export-skip="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings">
<!-- ngIfOnce: $last -->
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings">
<!-- ngIfOnce: $last --><span ng-if-once="$last">
3 payment types
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundGross&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible">$21,565.55</span>
</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible negative">-$475.45</span>
</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundNet&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible">$21,090.10</span>
</td>










<td ng-advanced-show-column="Payment-payment-count" ng-table-summary="$row.summary[&#39;Payment-paymentCount&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
223
</td>
<td ng-advanced-show-column="Payment-refund-count" ng-table-summary="$row.summary[&#39;Payment-refundCount&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
47
</td>






















































































</tr>
<tr ng-auto-export-skip="">
<td colspan="100">
&nbsp;
</td>
</tr>
</tbody><!-- end ngRepeat: groupSet in !report.options.isDetailed ? groupSets : [] --><tbody ng-repeat-start="groupSet in !report.options.isDetailed ? groupSets : []" ng-table="groupSet" ng-table-name="groupSetTable" ng-table-tables="" ng-advanced-currency="">
<!-- ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/google/dashboard/settings/permissions/users/google-api/" class="" href="https://fareharbor.com/google/dashboard/settings/permissions/users/google-api/">
API
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Credit card
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible">$1,106.47</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible negative">-$22.52</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible">$1,083.95</td>










<td ng-advanced-show-column="Payment-payment-count">
5
</td>
<td ng-advanced-show-column="Payment-refund-count">
0
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection -->
</tbody>
<tbody ng-repeat-end="" ng-table="groupSet">
<!-- ngIf: groupSets.length > 1 && groupSet.length > 1 -->
<tr ng-auto-export-skip="">
<td colspan="100">
&nbsp;
</td>
</tr>
</tbody><!-- end ngRepeat: groupSet in !report.options.isDetailed ? groupSets : [] --><tbody ng-repeat-start="groupSet in !report.options.isDetailed ? groupSets : []" ng-table="groupSet" ng-table-name="groupSetTable" ng-table-tables="" ng-advanced-currency="">
<!-- ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/tripshock/dashboard/settings/permissions/users/api/" class="" href="https://fareharbor.com/tripshock/dashboard/settings/permissions/users/api/">
Tripshock API
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Affiliate
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible">$11,361.22</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible">$0.00</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible">$11,361.22</td>










<td ng-advanced-show-column="Payment-payment-count">
70
</td>
<td ng-advanced-show-column="Payment-refund-count">
0
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection -->
</tbody>
<tbody ng-repeat-end="" ng-table="groupSet">
<!-- ngIf: groupSets.length > 1 && groupSet.length > 1 -->
<tr ng-auto-export-skip="">
<td colspan="100">
&nbsp;
</td>
</tr>
</tbody><!-- end ngRepeat: groupSet in !report.options.isDetailed ? groupSets : [] --><tbody ng-repeat-start="groupSet in !report.options.isDetailed ? groupSets : []" ng-table="groupSet" ng-table-name="groupSetTable" ng-table-tables="" ng-advanced-currency="">
<!-- ngRepeat: group in groupSetTable.collection --><tr ng-repeat="group in groupSetTable.collection" ng-advanced-currency="">
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown bold">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl --><a ng-if-once="!!objectUrl" ng-href="/viator/dashboard/settings/permissions/users/viator-api/" class="" href="https://fareharbor.com/viator/dashboard/settings/permissions/users/viator-api/">
Viator-API
</a>
<!-- ngElseOnce: !!objectUrl -->
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings" class="has-drilldown ">
<span ng-advanced-show-group="" ng-advanced-show-group-when="!report.options.isDetailed || $firstObject">
<span ng-advanced-display-object="">
<!-- ngIfOnce: !!objectUrl -->
<!-- ngElseOnce: !!objectUrl --><span ng-else-once="!!objectUrl">
Affiliate
</span>
</span>
<a class="ss-drilldown" ng-click="drilldown(grouping, group)" ng-tip="Go to detail"></a>
</span>
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-amount="group.summary[&#39;Payment-paymentAndRefundGross&#39;]" class="notranslate amount amount-visible">$104,165.30</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-amount="group.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" class="notranslate amount amount-visible">$0.00</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-amount="group.summary[&#39;Payment-paymentAndRefundNet&#39;]" class="notranslate amount amount-visible">$104,165.30</td>










<td ng-advanced-show-column="Payment-payment-count">
747
</td>
<td ng-advanced-show-column="Payment-refund-count">
27
</td>






















































































</tr><!-- end ngRepeat: group in groupSetTable.collection -->
</tbody>
<tbody ng-repeat-end="" ng-table="groupSet">
<!-- ngIf: groupSets.length > 1 && groupSet.length > 1 -->
<tr ng-auto-export-skip="">
<td colspan="100">
&nbsp;
</td>
</tr>
</tbody><!-- end ngRepeat: groupSet in !report.options.isDetailed ? groupSets : [] -->
<tfoot ng-auto-export-skip="" ng-table="report.data.groups" ng-init="isFooter = true">
<tr>
<!-- ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings">
5 users
</td><!-- end ngRepeat: grouping in report.data.groupings --><td ng-repeat="grouping in report.data.groupings">
3 payment types
</td><!-- end ngRepeat: grouping in report.data.groupings -->
















<td ng-advanced-show-column="Payment-payment-and-refund-gross" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundGross&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible">$191,283.71</span>
</td>
<td ng-advanced-show-column="Payment-payment-and-refund-processing-fee" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundProcessingFee&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible negative">-$1,716.28</span>
</td>
<td ng-advanced-show-column="Payment-payment-and-refund-net" ng-table-summary="$row.summary[&#39;Payment-paymentAndRefundNet&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
<span ng-amount="!isAggregateUnsound(Payment, true) ? $summary : null" class="notranslate amount amount-visible">$189,567.43</span>
</td>










<td ng-advanced-show-column="Payment-payment-count" ng-table-summary="$row.summary[&#39;Payment-paymentCount&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
1469
</td>
<td ng-advanced-show-column="Payment-refund-count" ng-table-summary="$row.summary[&#39;Payment-refundCount&#39;]" ng-table-summary-when="!isAggregateUnsound(Payment)" ng-table-summary-table-only="">
161
</td>






















































































</tr>
</tfoot>
</table>
</div>
</div>
</div>
</div>
</div>
<!-- ngIf: report.status === Report.FAILED_STATUS -->
<!-- ngIf: report.status === Report.CANCELLED_STATUS -->
</div>
</div>
</div>
<!-- ngElse: allowed -->
</div>
</div>
<!-- ngElse: hasReport -->
</div>
<!-- ngElse: allowed -->
</div>
<!-- ngIf: dataCtrl.status === 'error' -->
<!-- ngIf: dataCtrl.status === 'not-found' -->
<!-- ngIf: dataCtrl.status === 'disconnect' -->
<!-- ngIf: dataCtrl.status === 'forbidden' -->
</div></div>
</div>
<!-- ngNavigationPath: urls.dashboard.reports.advanced.redirect -->
<!-- ngElse: overview || advancedReports -->
</div></div>
</div>
<!-- ngNavigationPrefix: urls.dashboard.settings.index -->
<!-- ngElse: overlaySubsection || translationOverlaySubsection || adminSubsection || bookingsSubsection || manifestSubsection || itemsSubsection || networkSubsection || reportsSubsection || settingsSubsection -->
<div ng-sonar-paused="">
<!-- ngIf: sonar.paused.length > 0 -->
</div>
<div ng-link="nag-overlay"><!-- ngIf: User.showNag(auth.currentUser, 'downtimeAlert') && !isReadonlyEnabled --></div>
</div>
<!-- ngElse: allowed -->
</div>
<!-- ngIf: dataCtrl.status === 'error' -->
<!-- ngIf: dataCtrl.status === 'not-found' -->
<!-- ngIf: dataCtrl.status === 'disconnect' -->
<!-- ngIf: dataCtrl.status === 'forbidden' -->
</div>
</div>
<!-- ngIf: auth.currentUser.company && auth.currentUser.company.isAdmin --><div ng-if="auth.currentUser.company &amp;&amp; auth.currentUser.company.isAdmin">
<div ng-controller="dashboard.admin.JumpCtrl">
<!-- ngIf: !!navigation.currentCompany --><div ng-if="!!navigation.currentCompany">
<a ng-href="/destinspeedboat/dashboard/settings/advanced/" ng-shortcut="&#39;shift+,&#39;" ng-shortcut-click="" ng-shortcut-only="" class="ng-hide" href="https://fareharbor.com/destinspeedboat/dashboard/settings/advanced/"></a>
<a ng-href="/destinspeedboat/dashboard/settings/pricing/overview/" ng-shortcut="&#39;shift+alt+o&#39;" ng-shortcut-click="" ng-shortcut-only="" class="ng-hide" href="https://fareharbor.com/destinspeedboat/dashboard/settings/pricing/overview/"></a>
</div>
<div ng-toggle="adminJump" ng-shortcut="&#39;shift+j&#39;" ng-shortcut-click="" ng-shortcut-only="" class="ng-hide"></div>
<!-- ngToggled: adminJump -->
</div>
</div>
<!-- ngElse: rootSection || companySection || dashboardSection || legacyManifestSection -->
<div ng-controller="heartbeat.UpgradeCtrl">
<!-- ngIf: needsFailover() -->
<!-- ngIf: !failover && needsUpgrade() -->
</div>
<ul class="flashes respond-print-hide" ng-controller="flash.FlashesCtrl">
<!-- ngRepeat: flash in flashes -->
</ul>
</div>
<noscript class="no-js">
<div class="full-page-error">
<h2>JavaScript is not enabled</h2>
<p>
JavaScript is required to use FareHarbor but your browser doesn&#039;t have it enabled. Please enable it or try a different web browser.
</p>
<div class="btns">
<a href="https://fareharbor.com/help/getting-started/recommended-hardware-software/#javascript"
target="_blank"
class="btn btn-big btn-blue btn-left"
>Learn more</a>
</div>
<div class="error-code">
If you believe you're seeing this message in error, please contact <a href="mailto:support@fareharbor.com" ng-outbound-link>support@fareharbor.com</a>.
Error code: <b>no-js</b>.
</div>
</div>
</noscript>


    
    

    
      
      <script type="text/javascript" src="./Sales _ Screaming Eagle Sports_files/642e1c8e2efc.js"></script>

      
      
  
  
  
        

  <script type="text/javascript">
    (function(){
      window.slipstream = window.slipstream || {};
      window.slipstream.googleAnalyticsId = 'UA-30982219-1';
      window.slipstream.googleAnalyticsAnonymousId = 'UA-30982219-3';
      window.slipstream.googleAnalyticsCompanyId = 'UA-30982219-5';
      window.slipstream.googleAnalyticsAdminId = 'UA-30982219-7';
      window.slipstream.googleAnalyticsFhMeIds = JSON.parse("[\u0022UA\u002D72993211\u002D1\u0022,\u0022UA\u002D61019755\u002D1\u0022]");

      
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','_gaTracker');

      

      window._gaTracker('create', window.slipstream.googleAnalyticsId, 'auto');
      window._gaTracker('set', 'anonymizeIp', true);
      window._gaTracker('create', window.slipstream.googleAnalyticsAnonymousId, 'auto', {
        name: 'anonymous'
      });
      window._gaTracker('anonymous.set', 'anonymizeIp', true);
      window._gaTracker('anonymous.require', 'ecommerce');
      window._gaTracker('create', window.slipstream.googleAnalyticsCompanyId, 'auto', {
        name: 'company'
      });
      window._gaTracker('company.set', 'anonymizeIp', true);
      window._gaTracker('create', window.slipstream.googleAnalyticsAdminId, 'auto', {
        name: 'admin'
      });
      window._gaTracker('admin.set', 'anonymizeIp', true);

      
    })();
  </script>


      

  
  
    <script type="text/javascript">
  (function(){    
    
      window.slipstream.isMixpanelEnabled = true;
      
      (function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement("script");a.type="text/javascript";
      a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';
      f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){
      var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}
      var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";
      "mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};
      i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
      for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2}})(document,window.mixpanel||[]);
    
      window.mixpanel.init("ec17ab267df6688013d497b75ddd3308", {
        track_pageview: false
      }, "anonymous");
      window.mixpanel.init("ac6482ea6d5da620bb15ce24d0d328ca", {
        track_pageview: false
      }, "company");
      
      
    
  })();
</script>

  

  

  
  <script type="text/javascript">
  if(!window.Raven){
    window.Raven = {};
  }

  if (!window.slipstream.isSentryClientSideEnabled){
    window.Raven = {
      captureException: function(ex, options) {
        console.warn(ex, options, ' (Sentry is disabled)');
      },
      captureMessage: function(msg, options) {
        console.warn(msg, options, ' (Sentry is disabled)');
      }
    };
  }
  else if (window.Raven.config){
    // If the error is a blacklisted error, don't bother sending to Sentry.
    var BLACKLIST_SENTRY_ERRORS = [/\[\$rootScope:infdig\]/];
    window.Raven.config('', {
      maxMessageLength: 4096,
      ignoreErrors: BLACKLIST_SENTRY_ERRORS
    }).install();
  }
</script>


  
  <script type="text/javascript" src="./Sales _ Screaming Eagle Sports_files/djangojs.js"></script>
  <script type="text/javascript">
    // Assign aliases to gettext utils from djangojs.js.
    window.T = window.gettext;
    window.cT = window.pgettext;
    window.nT = window.ngettext;
    window.ncT = window.npgettext;
    var djangoJsInterpolate = window.interpolate;
    var interpolate = function() {
      if(arguments.length === 2){
        // Infer whether to use named or positional interpolation.
        var args = [];
        for(var i = 0, ii = arguments.length; i < ii; i++){
          args.push(arguments[i]);
        }
        args.push(!Array.isArray(args[1]));
        return djangoJsInterpolate.apply(this, args);
      }
      return djangoJsInterpolate.apply(this, arguments);
    };
    window.interpolate = interpolate;
  </script>


  <script type="text/javascript">
    window.slipstream.isAnonymous = false;
  </script>

  <script type="text/javascript">
  window.slipstream.stripeLivePublishableKey = "pk_live_5FCeUYuVtc0RN4Pa3C17g82R";
  window.slipstream.stripeTestPublishableKey = "pk_test_yIFtb0M1nxAeL2fNgB6y4EiR";
</script>
<script type="text/javascript" src="./Sales _ Screaming Eagle Sports_files/saved_resource"></script>
<script type="text/javascript" src="./Sales _ Screaming Eagle Sports_files/saved_resource(1)"></script>


  <script src="./Sales _ Screaming Eagle Sports_files/saved_resource(2)"></script>




  <script type="text/javascript">
  (function(a){if(window.filepicker){return}var b=a.createElement("script");b.type="text/javascript";b.async=!0;b.src=("https:"===a.location.protocol?"https:":"http:")+"//api.filestackapi.com/filestack.js";var c=a.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c);var d={};d._queue=[];var e="pick,pickMultiple,pickAndStore,read,write,writeUrl,export,convert,store,storeUrl,remove,stat,setKey,constructWidget,makeDropPane".split(",");var f=function(a,b){return function(){b.push([a,arguments])}};for(var g=0;g<e.length;g++){d[e[g]]=f(e[g],d._queue)}window.filepicker=d})(document);
  window.filepicker.setKey('A5KCYnAsQ2m11jv2naisSz');
</script>



      
      <script type="text/javascript" src="./Sales _ Screaming Eagle Sports_files/2d7086b64122.js"></script>

      
      <script type="text/javascript">
        try {
          window.parent.postMessage('{ "type": "fareharbor.ready" }', '*');
        }
        catch(e){}
      </script>
    
  

<iframe name="stripeXDM_default991944_provider" id="stripeXDM_default991944_provider" aria-hidden="true" src="./Sales _ Screaming Eagle Sports_files/channel.html" frameborder="0" style="position: absolute; top: -2000px; left: 0px;"></iframe><iframe frameborder="0" allowtransparency="true" scrolling="no" name="__privateStripeMetricsController0" allowpaymentrequest="true" src="./Sales _ Screaming Eagle Sports_files/outer.html" aria-hidden="true" tabindex="-1" style="border: none !important; margin: 0px !important; padding: 0px !important; width: 1px !important; min-width: 100% !important; overflow: hidden !important; display: block !important; visibility: hidden !important; position: fixed !important; height: 1px !important; pointer-events: none !important; user-select: none !important;"></iframe><iframe name="filepicker_comm_iframe" id="filepicker_comm_iframe" src="./Sales _ Screaming Eagle Sports_files/saved_resource.html" style="display: none;"></iframe><iframe name="fpapi_comm_iframe" id="fpapi_comm_iframe" src="./Sales _ Screaming Eagle Sports_files/saved_resource(3).html" style="display: none;"></iframe><span class="tip" aria-live="polite" style="top: -100px; left: -100px; width: auto;">Download CSV</span><div class="pika-single is-hidden is-bound" style=""></div><div class="pika-single is-hidden is-bound" style=""></div><div class="pika-single is-hidden is-bound" style=""></div><div class="pika-single is-hidden is-bound" style=""></div></body></html>